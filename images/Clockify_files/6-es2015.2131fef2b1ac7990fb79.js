(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"+W0u":function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("WjWa"),s=i("1Tmk"),c=i("fXoL"),r=i("tyNb"),o=i("ofXK");function a(e,t){if(1&e&&(c.Xb(0,"a",4),c.Yc(1,"Screenshots"),c.Wb()),2&e){const e=c.nc();c.Hb("cl-active",e.page===e.ActivityPills.SCREENSHOTS)}}function l(e,t){if(1&e&&(c.Xb(0,"a",5),c.Yc(1,"Locations"),c.Wb()),2&e){const e=c.nc();c.Hb("cl-active",e.page===e.ActivityPills.LOCATIONS)}}let b=(()=>{class e{constructor(e,t){this.router=e,this.workspaceService=t,this.ActivityPills=n.a}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(r.c),c.Rb(s.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["activity-tabs"]],inputs:{page:"page"},decls:5,vars:2,consts:[[1,"cl-btn-group"],[1,"cl-btn","cl-btn-outline-light","cl-page-switcher-name","cl-d-none","cl-d-sm-inline-flex"],["routerLink","/activity/screenshots","class","cl-btn cl-btn-outline-light",3,"cl-active",4,"ngIf"],["routerLink","/activity/locations","class","cl-btn cl-btn-outline-light",3,"cl-active",4,"ngIf"],["routerLink","/activity/screenshots",1,"cl-btn","cl-btn-outline-light"],["routerLink","/activity/locations",1,"cl-btn","cl-btn-outline-light"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"span",1),c.Yc(2," Activity "),c.Wb(),c.Wc(3,a,2,2,"a",2),c.Wc(4,l,2,2,"a",3),c.Wb()),2&e&&(c.Cb(3),c.wc("ngIf",t.workspace.screenshotsEnabled),c.Cb(1),c.wc("ngIf",t.workspace.locationsEnabled))},directives:[o.u,r.f],encapsulation:2}),e})()},"0Mwv":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("lvCY"),s=i("xoOP"),c=i("fXoL"),r=i("ofXK");function o(e,t){if(1&e&&(c.Vb(0),c.Sb(1,"img",2),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.wc("src",e.src,c.Qc)}}const a=function(e,t){return[e,t]};function l(e,t){if(1&e&&(c.Xb(0,"div",4),c.Xb(1,"span"),c.Yc(2),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.wc("ngClass",c.Cc(2,a,e.bgClass,e.classSize)),c.Cb(2),c.Zc(e.initials)}}function b(e,t){if(1&e&&c.Wc(0,l,3,5,"div",3),2&e){const e=c.nc();c.wc("ngIf",e.initials)}}let u=(()=>{class e{constructor(){this.classes=["cl-bg-red","cl-bg-pink","cl-bg-purple","cl-bg-deep-purple","cl-bg-indigo","cl-bg-blue","cl-bg-cyan","cl-bg-teal","cl-bg-green","cl-bg-light-green","cl-bg-amber","cl-bg-orange","cl-bg-deep-orange","cl-bg-brown","cl-bg-yellow"],this.classSize="cl-no-image-wrapper-md"}set src(e){this._src=e,this.checkForUpdates&&this.checkAvatart()}get src(){return this._src}set name(e){e&&(e=e.trim()),this._name=e,this.checkForUpdates&&this.checkAvatart()}get name(){return this._name}ngOnInit(){this.checkAvatart(),this.checkForUpdates=!0}checkAvatart(){if(this.name&&(!this.src||this.src.indexOf(n.t)>-1))return this.initials=Object(s.k)(this.name),void(this.bgClass=this.setColor(this.initials));this.initials=null}setColor(e){const t=this.getHashCode(e),i=this.getKey(t);return this.classes[i]}getHashCode(e){let t=0;for(let i=0,n=e.length;i<n;i++)t=e.charCodeAt(i)+((t<<5)-t);return t}getKey(e,t=0,i=this.classes.length-1){let n=e%100;if(n<t)return t;for(;n>i;)n/=10;return n=Math.ceil(n),n=n>i?i:n,n}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["avatar"],["","avatar",""]],inputs:{src:"src",name:"name",classSize:"classSize"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["lettersTemplate",""],[1,"cl-avatar-image",3,"src"],[3,"ngClass",4,"ngIf"],[3,"ngClass"]],template:function(e,t){if(1&e&&(c.Wc(0,o,2,1,"ng-container",0),c.Wc(1,b,1,1,"ng-template",null,1,c.Xc)),2&e){const e=c.Lc(2);c.wc("ngIf",!t.initials)("ngIfElse",e)}},directives:[r.u,r.r],encapsulation:2,changeDetection:0}),e})()},"2qzj":function(e,t,i){"use strict";i.d(t,"a",(function(){return O}));var n=i("fXoL"),s=i("Tj/N"),c=i("1Tmk"),r=i("XNiG"),o=i("NHP+");function a(e){return e.sort((e,t)=>{if(e.name){if(t.name){const i=e.name.toLowerCase(),n=t.name.toLowerCase();return i<n?-1:i>n?1:0}return-1}return 1}),e}var l=i("Kj3r"),b=i("1G5W"),u=i("pLZG"),d=i("d0Wf"),p=i("8v23"),h=i("Jzhb"),m=i("1kSV"),g=i("ofXK"),f=i("tyNb");const v=["searchInput"],w=["featurePopover"];function y(e,t){1&e&&(n.Xb(0,"span",14),n.Sb(1,"img",15),n.Xb(2,"span",16),n.Yc(3," Active "),n.Wb(),n.Wb())}function W(e,t){if(1&e){const e=n.Yb();n.Xb(0,"a",17),n.jc("click",(function(){n.Oc(e);const t=n.nc();return t.selectUser(t.user)})),n.Yc(1),n.Wb()}if(2&e){const e=n.nc();n.Db("closeDropdown",!!e.hasAddTimeForOthersFeature||null),n.Cb(1),n.Zc(e.user.name)}}function C(e,t){if(1&e){const e=n.Yb();n.Xb(0,"a",17),n.jc("click",(function(){n.Oc(e);const t=n.nc().$implicit;return n.nc().selectUser(t)})),n.Yc(1),n.Wb()}if(2&e){const e=n.nc().$implicit,t=n.nc();n.Db("closeDropdown",!!t.hasAddTimeForOthersFeature||null),n.Cb(1),n.ad(" ",e.name," ")}}function k(e,t){if(1&e&&(n.Vb(0),n.Wc(1,C,2,2,"a",11),n.Ub()),2&e){const e=t.$implicit,i=n.nc();n.Cb(1),n.wc("ngIf",e.id!==i.selectedUser.id&&e.id!==i.user.id)}}const S=function(){return["/upgrade"]};function I(e,t){1&e&&(n.Xb(0,"div"),n.Xb(1,"a",18),n.Yc(2,"Upgrade"),n.Wb(),n.Yc(3," to add time for others "),n.Wb()),2&e&&(n.Cb(1),n.wc("routerLink",n.Ac(1,S)))}let O=(()=>{class e{constructor(e,t,i){this.workspaceService=e,this.roleService=t,this.cd=i,this.userSelected=new n.n,this.inputValue="",this.filteredUsersToShow=[],this.filterDebouncer=new r.a,this.unsubscribe$=new o.a}ngOnInit(){this.selectedUser||(this.selectedUser=this.user),this.filterDebouncer.pipe(Object(l.a)(180),Object(b.a)(this.unsubscribe$)).subscribe(e=>{this.inputValue=e,this.filterAndSortTeamMembers()}),this.getRoleInfoAndPopulateUsers()}ngAfterViewInit(){this.searchInput.nativeElement.focus()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}selectUser(e){this.hasAddTimeForOthersFeature?(this.userSelected.emit(e),this.selectedUser=e):this.togglePopover()}filterChanged(e){this.filterDebouncer.next(e.target.value)}filterAndSortTeamMembers(){let e=[];if(this.inputValue){const t=this.inputValue.toLowerCase();e=this.users.filter(e=>!!e.name&&-1!==e.name.toLowerCase().indexOf(t))}else e=this.users.slice();this.filteredUsersToShow=a(e),this.cd.detectChanges()}togglePopover(e=this.featurePopover){e.isOpen()?e.close():e.open()}getRoleInfoAndPopulateUsers(){this.roleService.roles$.pipe(Object(u.a)(e=>null!==e),Object(b.a)(this.unsubscribe$)).subscribe(e=>{var t;const i=p.a.getRoleData(e);if(i.isAdmin||i.isOwner)this.getAllActiveUsers();else if(i.isTeamManager){const i=null===(t=e.find(e=>e.role===h.a.TEAM_MANAGER))||void 0===t?void 0:t.entities.filter(e=>!!e.name).map(e=>new s.a({id:e.entityId,name:e.name}));this.filteredUsersToShow=a(i),this.users=this.filteredUsersToShow,this.cd.detectChanges()}}),this.roleService.getRolesForUser(this.user.id)}getAllActiveUsers(){this.workspaceService.activeUsers.pipe(Object(b.a)(this.unsubscribe$)).subscribe(e=>{this.filteredUsersToShow=a(e),this.users=this.filteredUsersToShow,this.cd.detectChanges()}),this.workspaceService.getAllUsersForTeamPage(!1)}}return e.\u0275fac=function(t){return new(t||e)(n.Rb(c.a),n.Rb(d.a),n.Rb(n.h))},e.\u0275cmp=n.Lb({type:e,selectors:[["teammate-picker"]],viewQuery:function(e,t){var i;1&e&&(n.ed(v,!0),n.ed(w,!0)),2&e&&(n.Kc(i=n.kc())&&(t.searchInput=i.first),n.Kc(i=n.kc())&&(t.featurePopover=i.first))},inputs:{user:"user",selectedUser:"selectedUser",showSelectedAsActive:"showSelectedAsActive",hasAddTimeForOthersFeature:"hasAddTimeForOthersFeature"},outputs:{userSelected:"userSelected"},decls:16,vars:6,consts:[["aria-labelledby","navbarDropdown",1,"cl-dropdown-menu"],[1,"cl-dropdown-menu-header"],["type","text","autofocus","","placeholder","Search teammates",1,"cl-form-control",3,"input"],["searchInput",""],["triggers","manual","container","body","placement","left",1,"cl-dropdown-menu-sub-header",3,"ngbPopover"],["featurePopover","ngbPopover"],[1,"cl-dropdown-item-padding","cl-cut-text-wrapper"],[1,"cl-item-between","cl-hover-pointer",3,"click"],[1,"cl-cut-text"],["class","cl-dropdown-item-workspace-right cl-d-flex",4,"ngIf"],[1,"cl-scroll-area"],["class","cl-dropdown-item",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["popContent",""],[1,"cl-dropdown-item-workspace-right","cl-d-flex"],["src","assets/images/ui-icons/checkmark-green.svg"],[1,"cl-dropdown-active-workspace-label","cl-d-none","cl-d-lg-inline-block"],[1,"cl-dropdown-item",3,"click"],["doNotCloseDropdown","",3,"routerLink"]],template:function(e,t){if(1&e&&(n.Xb(0,"div",0),n.Xb(1,"div",1),n.Xb(2,"input",2,3),n.jc("input",(function(e){return t.filterChanged(e)})),n.Wb(),n.Wb(),n.Xb(4,"div",4,5),n.Xb(6,"div",6),n.Xb(7,"div",7),n.jc("click",(function(){return!t.showSelectedAsActive&&t.selectUser(t.selectedUser)})),n.Xb(8,"span",8),n.Yc(9),n.Wb(),n.Wc(10,y,4,0,"span",9),n.Wb(),n.Wb(),n.Wb(),n.Xb(11,"div",10),n.Wc(12,W,2,2,"a",11),n.Wc(13,k,2,1,"ng-container",12),n.Wb(),n.Wb(),n.Wc(14,I,4,2,"ng-template",null,13,n.Xc)),2&e){const e=n.Lc(15);n.Cb(4),n.wc("ngbPopover",e),n.Cb(3),n.Db("closeDropdown",!!t.hasAddTimeForOthersFeature||null),n.Cb(2),n.Zc(t.selectedUser.name),n.Cb(1),n.wc("ngIf",t.showSelectedAsActive),n.Cb(2),n.wc("ngIf",t.selectedUser.id!==t.user.id),n.Cb(1),n.wc("ngForOf",t.filteredUsersToShow)}},directives:[m.L,g.u,g.t,f.f],encapsulation:2}),e})()},"4fRq":function(e,t){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var n=new Uint8Array(16);e.exports=function(){return i(n),n}}else{var s=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}},"8N2M":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");let s=(()=>{class e{}return e.\u0275mod=n.Pb({type:e}),e.\u0275inj=n.Ob({factory:function(t){return new(t||e)}}),e})()},EcEN:function(e,t,i){var n=i("xDdU"),s=i("xk4V"),c=s;c.v1=n,c.v4=s,e.exports=c},I2ZF:function(e,t){for(var i=[],n=0;n<256;++n)i[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join("")}},K5US:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("8N2M"),s=i("fXoL");let c=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[n.a]]}),e})()},QzXH:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("ofXK"),s=i("3Pt+"),c=i("fXoL");let r=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[n.c,s.m]]}),e})()},RZdV:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("f0Wu"),s=i("Tj/N"),c=i("qfBg"),r=i("fXoL");let o=(()=>{class e{constructor(e){this.userService=e,this.user=new s.a(JSON.parse(localStorage.getItem("user"))),this.timeZone=this.userService.getTimeZone()}transform(e){var t,i;const s=n.tz(e,this.timeZone),c=(null===(i=null===(t=this.user)||void 0===t?void 0:t.settings)||void 0===i?void 0:i.dateFormat)||"MM/DD/YYYY";return s.format(c)}}return e.\u0275fac=function(t){return new(t||e)(r.Rb(c.a))},e.\u0275pipe=r.Qb({name:"formatDate",type:e,pure:!0}),e})()},TuBP:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("s07H"),s=i("ofXK"),c=i("tyNb"),r=i("fXoL");let o=(()=>{class e{}return e.\u0275mod=r.Pb({type:e}),e.\u0275inj=r.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[n.a,s.c,c.g]]}),e})()},"U5k/":function(e,t,i){"use strict";i.r(t),i.d(t,"DefaultLayoutModule",(function(){return Wx}));var n=i("DVUX"),s=i("ofXK"),c=i("fXoL");let r=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var o=i("d0Wf"),a=i("LPYB"),l=i("EONh"),b=i("VucA"),u=i("NDhe"),d=i("iTUp"),p=i("3Pt+");let h=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c]]}),e})();var m=i("Dfhc"),g=i("1kSV"),f=i("9Trn"),v=i("QzXH"),w=i("jJjg");let y=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,a.b,b.a,u.a,l.a,d.a,p.m,h,m.a,g.ab,f.a,g.r,v.a,w.a]]}),e})();var W=i("tyNb"),C=i("8N2M"),k=i("K5US");let S=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c]]}),e})(),I=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c]]}),e})(),O=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c]]}),e})();var X=i("liYL"),E=i("LM6y");let T=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,d.a,X.a,E.a]]}),e})();var D=i("OC8m");let R=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[D.a],imports:[[s.c,W.g,d.a,p.m,g.ab,T,C.a,k.a,S,I,f.a,O,v.a]]}),e})();var A=i("1Mzi"),j=i("MtJD"),x=i("vwXn"),P=i("tk/3"),M=i("Ymxs"),Y=i("lJxs"),L=i("vkgz");class F{constructor(e){this._id=e&&e.id,this._userId=e&&e.userId,this._apiKey=e&&e.apiKey,this._active=e&&e.active}get id(){return this._id}set id(e){this._id=e}get userId(){return this._userId}set userId(e){this._userId=e}get apiKey(){return this._apiKey}set apiKey(e){this._apiKey=e}get active(){return this._active}set active(e){this._active=e}}class N{constructor(e={}){this.id=e.id||null,this.countOfWorkspaces=e.countOfWorkspaces||null,this.email=e.email||null,this.name=e.name||null,this.status=e.status||null,this.apiKey=new F(e.apiKey)}}var U=i("1Tmk");let $=(()=>{class e{constructor(e,t,i){this.http=e,this.workspaceService=t,this.toaster=i}getUsers(e){const t=this.workspaceService.getDefaultWorkspaceId(),i=(new P.f).append("page",(e.page-1).toString()).append("pageSize",e.pageSize).append("sortOrder",e.sortOrder).append("sortColumn",e.sortColumn).append("searchEmail",e.searchEmail.trim());return this.http.get(`/users/workspaces/${t}/`,{params:i}).pipe(Object(Y.a)(e=>(e.users=e.users.map(e=>new N(e)),e)),Object(L.a)(null,()=>this.toaster.pop("error","Get users failed.")))}resetPassword(e,t){return this.http.post("/password-reset-tokens/",{email:e}).pipe(Object(L.a)(()=>this.toaster.pop("success",t||"Password has been reset successfully."),e=>this.toaster.pop("error",e&&e.error&&e.error.message||"Reset password failed.")))}removeUserAccount(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`/workspaces/${t}/user/${e}`).pipe(Object(L.a)(()=>this.toaster.pop("success","User has been removed successfully."),e=>this.toaster.pop("error",e&&e.error&&e.error.message||"Removing user failed.")))}renameUser(e,t){const i=this.workspaceService.getDefaultWorkspaceId();return this.http.put(`/users/${t}/name/workspaces/${i}/`,{name:e}).pipe(Object(L.a)(()=>this.toaster.pop("success","User name has been updated."),e=>this.toaster.pop("error",e&&e.error&&e.error.message||"User name updated failed.")))}deactivateApiKey(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.put(`/apiKey/deactivateApiKey/${e}/workspaces/${t}/`,null).pipe(Object(Y.a)(e=>new F(e)),Object(L.a)(()=>this.toaster.pop("success","Api key is deactivated."),e=>this.toaster.pop("error",e&&e.error&&e.error.message||"Deactivate Api key failed.")))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(P.b),c.fc(U.a),c.fc(M.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var _=i("0Gvx"),G=i("GJLE"),B=i("sjCC"),V=i("Qyj8"),H=i("tZA+"),z=i("8pWl"),q=i("s07H"),K=i("9lpP"),Z=i("49HY");let Q=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c]]}),e})();var J=i("6FRn");let ee=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c]]}),e})(),te=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m]]}),e})(),ie=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,d.a,f.a]]}),e})(),ne=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[$,V.a,J.a],imports:[[s.c,p.m,f.a,W.g,w.a,x.a,X.a,_.a,p.C,A.a,g.ab,j.a,K.a,Z.a,G.a,d.a,B.a,H.a,te,l.a,p.m,p.C,z.a,q.a,Q,ee,ie]]}),e})();var se=i("B01t"),ce=i("s4Bo"),re=i("ogL9"),oe=i("RH5C");let ae=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[se.a,s.c,p.m,ce.a,k.a,f.a,re.a,oe.a,g.ab]]}),e})();var le=i("dlKe"),be=i("gr2/"),ue=i("1ROj"),de=i("qcnj"),pe=i("9O0/"),he=i("qvXw"),me=i("cDkn"),ge=i("ksGH"),fe=i("brRw");let ve=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,f.a,ge.a,p.m,le.b,pe.a,fe.a,de.a,d.a,me.a]]}),e})();var we=i("QAEb");let ye=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,d.a]]}),e})();var We=i("Qd9e"),Ce=i("lGQG"),ke=i("jtSf"),Se=i("wd/R"),Ie=i("fV9S");let Oe=(()=>{class e{constructor(e){this.authService=e}updateWeekStatusToGroups(e,t,i=!1){if(!e.length)return;const n=this.authService.getUser().settings.weekStart,s=[];e.forEach(e=>{const i=Object(ke.e)(Se(e.date),n).format("YYYY-MM-DD");if(s.includes(i))e.weekStatus=null;else{if(s.push(i),!t[i]){const e={dateRange:{start:Se(i).startOf("day").toISOString(),end:Se(i).add(6,"day").endOf("day").toISOString()},startDayOfWeek:i};t[i]=new Ie.a(e)}e.weekStatus=new Ie.a(t[i])}});let c=!0,r=0,o=0;for(let a=e.length-1;a>-1;a--){const n=e[a];r+=n.timeEntries.length,o+=n.timeEntries.filter(e=>!!e.approvalRequestId).length,r>o&&(c=!1),n.weekStatus&&(n.weekStatus.isApprovedAllOnCurrentPage=c,i&&(t[n.weekStatus.startDayOfWeek].initIsApprovedOnOtherPages(r,o),n.weekStatus.initIsApprovedOnOtherPages(r,o)),c=!0,r=0,o=0)}}getTotalsOfWeek(e,t){const i=e.findIndex((e,i)=>{var n;return(null===(n=e.weekStatus)||void 0===n?void 0:n.startDayOfWeek)===t});let n=0,s=0;if(i<0)return console.warn("Week status missing for "+t),{entriesCount:n,approvedCount:s};for(let c=i;c<e.length;c++){const i=e[c];if(n+=i.timeEntries.length,s+=i.timeEntries.filter(e=>!!e.approvalRequestId).length,i.weekStatus&&i.weekStatus.startDayOfWeek!==t)return{entriesCount:n,approvedCount:s}}return{entriesCount:n,approvedCount:s}}refreshIsWeekApproved(e,t){let i;const n=e.find((e,n)=>{var s;const c=(null===(s=e.weekStatus)||void 0===s?void 0:s.startDayOfWeek)===t;return c&&(i=n),c});let s=!0,c=0,r=0;for(let o=i;o<e.length;o++){const i=e[o];if(c+=n.timeEntries.length,r+=n.timeEntries.filter(e=>!!e.approvalRequestId).length,c>r&&(s=!1),i.weekStatus&&i.weekStatus.startDayOfWeek!==t)return n.weekStatus.isApprovedAllOnCurrentPage=s,void(n.weekStatus=new Ie.a(n.weekStatus))}n.weekStatus.isApprovedAllOnCurrentPage=s,n.weekStatus=new Ie.a(n.weekStatus)}}return e.\u0275fac=function(t){return new(t||e)(c.fc(Ce.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var Xe=i("LNDd"),Ee=i("XNiG"),Te=i("Kj3r"),De=i("1G5W");let Re=(()=>{class e{constructor(){this.debouncer$=new Ee.a,this._debouncer$=new Ee.a,this.unsubscribe$=new Ee.a,this._debouncer$.pipe(Object(Te.a)(200),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.debouncer$.next(e)})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}reset(){this.debouncer$.next(!0),this.debouncer$.complete(),this.debouncer$=new Ee.a}next(e){this._debouncer$.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var Ae=i("zJCG"),je=i("2Vo4");let xe=(()=>{class e{constructor(){this.selectAllChanged$=new Ee.a,this.numberOfSelected$=new je.a(0),this.numberOfEntries$=new je.a(0),this.numberOfSelected=0,this.numberOfEntries=0}recalculateBulkCheckboxes(e=this._entriesReference){this._entriesReference=e;let t=0,i=0;e.forEach(e=>{e.children?e.children.forEach(e=>{e.approvalRequestId||i++,e.bulkEdit&&t++}):(e.approvalRequestId||i++,e.bulkEdit&&t++)}),this.numberOfSelected=t,this.numberOfEntries=i,this.numberOfSelected$.next(this.numberOfSelected),this.numberOfEntries$.next(this.numberOfEntries)}setSelectAll(e){this.numberOfSelected=e?this.numberOfEntries:0,this.numberOfSelected$.next(this.numberOfSelected),this.selectAllChanged$.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})(),Pe=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[Re,xe],imports:[[s.c,p.m,g.ab,we.a,f.a,ce.a,ye,l.a,We.a,g.M,g.ab,W.g,be.a,fe.a,Ae.a,Xe.a]]}),e})();var Me=i("mMUe"),Ye=i("Gajk");let Le=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,f.a,ge.a,Ye.a,g.ab]]}),e})(),Fe=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c]]}),e})(),Ne=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[Oe,Re,xe],imports:[[s.c,p.m,Le,be.a,E.a,f.a,w.a,ae,ce.a,fe.a,d.a,le.b,Fe,ue.a,de.a,g.r,pe.a,he.a,W.g,_.a,ve,we.a,ye,We.a,g.ab,Xe.a,Pe,X.a,l.a,Ae.a,Me.a]]}),e})();var Ue=i("VFot");let $e=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[p.m,s.c,Ue.a,p.C]]}),e})(),_e=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[p.m,s.c,Ue.a,p.C,l.a]]}),e})(),Ge=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,f.a]]}),e})(),Be=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m]]}),e})(),Ve=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[$e,p.m,W.g,s.c,_e,Q,Ge,Be,te,d.a,g.ab,ee]]}),e})(),He=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c]]}),e})(),ze=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[$e,p.m,s.c,_.a,_e,Q,Be,ee]]}),e})(),qe=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[p.m,s.c,ze]]}),e})(),Ke=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[p.m,s.c,q.a,Ve,He,qe]]}),e})();var Ze=i("E10L");let Qe=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[p.m,s.c,p.C]]}),e})(),Je=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,p.C]]}),e})(),et=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m]]}),e})(),tt=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[J.a],imports:[[s.c,p.m,p.C,f.a,z.a,Ze.a,et,X.a,Qe,A.a,_.a,Je,W.g]]}),e})(),it=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[$],imports:[[s.c,p.m,p.C,f.a,w.a,A.a,f.a,x.a,X.a,_.a,W.g]]}),e})();class nt{constructor(e){this._url=e&&e.url,this._name=e&&e.name}get name(){return this._name}set name(e){this._name=e}get url(){return this._url}set url(e){this._url=e}}class st{constructor(e){this.id=e.id,this.name=e.name||"",this.importedClients=e.importedClients,this.importedProjects=e.importedProjects,this.importedTags=e.importedTags,this.importedTasks=e.importedTasks,this.importedTimeEntries=e.importedTimeEntries,this.importWarnings=e.importWarnings||{}}}var ct=i("fkOE");let rt=(()=>{class e{constructor(e,t,i,n){this.http=e,this.toaster=t,this.authService=i,this.workspaceService=n}uploadFile(e,t){return this.http.post(`/file/${t}/`,e).pipe(Object(Y.a)(e=>new nt(e)),Object(L.a)(e=>{this.toaster.pop("success",`File ${e.name} has been uploaded.`)},e=>{var t;400===e.status?this.toaster.pop("error","File not uploaded",(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"File not uploaded"):this.toaster.pop("error","File not uploaded")}))}uploadCsvFile(e,t,i){return this.http.post(`${ct.b}/workspaces/${t}/import-data/upload`,e).pipe(Object(Y.a)(e=>(e.name=i,new st(e))),Object(L.a)(e=>this.toaster.pop("success",`File ${i} has been uploaded.`),e=>{var t;return this.toaster.pop("error",(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"File not uploaded")}))}importCsv(e,t){return this.http.post(`${ct.b}/workspaces/${t}/import-data/import`,{importDataId:e}).pipe(Object(L.a)(e=>{},e=>{var t;this.toaster.pop("error",(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Import failed")}))}checkMissingUsers(e,t){return this.http.get(`${ct.b}/workspaces/${t}/import-data/${e}/check-users`).pipe(Object(Y.a)(e=>e.workspaceNonMembers||[]),Object(L.a)(e=>{},e=>{var t;this.toaster.pop("error",(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Validation failed")}))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(P.b),c.fc(M.a),c.fc(Ce.a),c.fc(U.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var ot=i("OG4e");let at=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,p.C,l.a]]}),e})(),lt=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[rt,ot.a],imports:[[s.c,p.m,_.a,p.C,se.a,et,v.a,l.a,f.a,A.a,g.ab,at,be.a,H.a,W.g,K.a,Z.a]]}),e})(),bt=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,l.a,_.a,W.g]]}),e})();class ut{constructor(e){this._id=e&&e.id,this._workspaceId=e&&e.workspaceId,this._alertType=e&&e.alertType,this._percentage=e&&e.percentage,this._alertPerson=e&&e.alertPerson}get id(){return this._id}set id(e){this._id=e}get workspaceId(){return this._workspaceId}set workspaceId(e){this._workspaceId=e}get alertType(){return this._alertType}set alertType(e){this._alertType=e}get percentage(){return this._percentage}set percentage(e){this._percentage=e}get alertPerson(){return this._alertPerson}set alertPerson(e){this._alertPerson=e}}let dt=(()=>{class e{constructor(e,t){this.http=e,this.toaster=t,this.error=new Ee.a,this.alert=new Ee.a,this.updatedAlert=new Ee.a,this.alerts=new Ee.a}createAlert(e,t){return this.http.post(`/workspaces/${t}/alerts/`,{alertType:e.alertType,percentage:e.percentage,alertPerson:e.alertPerson}).pipe(Object(Y.a)(e=>new ut(e)),Object(L.a)(()=>{this.toaster.pop("success","Alert has been created")},e=>{this.error.next(e),this.toaster.pop("error",e.error&&e.error.message||"Alert already exists")}))}updateAlert(e,t){this.http.put(`/workspaces/${t}/alerts/${e.id}`,{alertType:e.alertType,percentage:e.percentage,alertPerson:e.alertPerson}).subscribe(e=>{this.updatedAlert.next(new ut(e)),this.toaster.pop("success","Alert has been updated.")},e=>{this.error.next(e),this.getAllAlertsForWorkspace(t),this.toaster.pop("error",e.error&&e.error.message||"Alert already exists")})}deleteAlert(e,t){return this.http.delete(`/workspaces/${t}/alerts/${e}`).pipe(Object(Y.a)(e=>new ut(e)),Object(L.a)(()=>{this.toaster.pop("success","Alert successfully deleted")},e=>{this.error.next(e),this.toaster.pop("error","Alert not deleted")}))}getAllAlertsForWorkspace(e){this.http.get(`/workspaces/${e}/alerts/`).pipe(Object(Y.a)(e=>e.map(e=>new ut(e)))).subscribe(e=>{this.alerts.next(e)},e=>{this.error.next(e)})}}return e.\u0275fac=function(t){return new(t||e)(c.fc(P.b),c.fc(M.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var pt=i("DeEi"),ht=i("5lh1");let mt=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,p.C,W.g]]}),e})(),gt=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[p.m,s.c,p.C,W.g,et,mt,_.a]]}),e})(),ft=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[rt,ot.a],imports:[[s.c,p.m,p.C,se.a,et,v.a,l.a,f.a,A.a,g.ab,at,be.a,H.a,W.g,K.a,Z.a]]}),e})(),vt=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[ot.a,dt],imports:[[s.c,lt,ft,p.m,bt,tt,it,gt,q.a,pt.a,ht.a,W.g]]}),e})(),wt=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,f.a,W.g,p.C]]}),e})();var yt=i("+Two"),Wt=i("txdI"),Ct=i("gZQK");let kt=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,f.a,E.a,b.a,w.a,H.a,l.a,Ze.a,yt.a,u.a,j.a,Pe,X.a,W.g,g.ab,d.a,Wt.a,g.M,ye,Xe.a,p.C,Me.a,n.c,Ct.a,A.a]]}),e})();var St=i("l1Fo"),It=i("pLZG"),Ot=function(e){return e.PENDING="PENDING",e.APPROVED="APPROVED",e.WITHDRAWN_APPROVAL="WITHDRAWN_APPROVAL",e.WITHDRAWN_SUBMISSION="WITHDRAWN_SUBMISSION",e.REJECTED="REJECTED",e}({});class Xt{constructor(e,t,i){this.id=e,this.label=t,this.total=i}}class Et{constructor(e,t){this.title=e||"",this.items=(t||[]).map(e=>new Xt(e.id||e.approvalRequestId,e.label,e.total))}}class Tt{constructor(e){this.userId=(e=e||{}).userId,this.userName=e.userName,this.timeZone=e.timeZone,this.strartOfWeek=e.strartOfWeek}}class Dt{constructor(e){this.state=(e=e||{}).state,this.updatedBy=e.updatedBy,this.updatedByUserName=e.updatedByUserName,this.updatedAt=e.updatedAt,this.note=e.note}}class Rt{constructor(e){if(this.id=e.id,this.workspaceId=e.workspaceId,this.dateRange=e.dateRange,this.owner=new Tt(e.owner),this.status=new Dt(e.status),!e.id)return;const t=1e3*parseInt(e.id.substring(0,8),16);this.date=Se(t).toISOString()}}var At=i("5Iok"),jt=i("f0Wu"),xt=i("5pgj"),Pt=i("xoOP");let Mt=(()=>{class e{constructor(e,t,i,n){this.http=e,this.toaster=t,this.authService=i,this.workspaceService=n,this.pendingCount$=new Ee.a,this.subscribeToPermission()}subscribeToPermission(){this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e)).subscribe(e=>{const t=this.authService.getUser().id,i=e.isTeamManagerFor(t);this.canApproveMyApprovals=e.isAdminOrOwner||i})}setPendingCount(e){!Object(Pt.u)(e)||e<0||(this.pendingCount=e,this.pendingCount$.next(e))}getApprovalCount(e){const t=this.workspaceService.getDefaultWorkspaceId(),i=(new P.f).append("state",e||Ot.PENDING),n=new Ee.a;return this.http.get(`/workspaces/${t}/approval-requests/count`,{params:i}).subscribe(t=>{e===Ot.PENDING&&this.setPendingCount(t),n.next(t)},e=>n.error(e)),n}createSubmitRequest(e){const t=this.workspaceService.getDefaultWorkspaceId(),i=this.authService.getUser().id,n={weekTime:Se.utc(e).startOf("day").toISOString()};return this.http.post(`/workspaces/${t}/users/${i}/approval-requests/`,n).pipe(Object(Y.a)(e=>new Rt(e)),Object(L.a)(()=>{this.canApproveMyApprovals&&this.setPendingCount(this.pendingCount+1),this.toaster.pop("success","Successfully submitted")},e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||"Submit failed")}))}getAllApprovalGroups(e){const t=this.workspaceService.getDefaultWorkspaceId(),i=(new P.f).append("page",e.page.toString()).append("page-size",e.pageSize.toString()).append("group-by",e.groupBy).append("state",e.state);return this.http.get(`/workspaces/${t}/approval-requests/stats`,{params:i}).pipe(Object(Y.a)(e=>e.map(e=>new Et(e.title,e.items))),Object(L.a)(t=>{e.state===Ot.PENDING&&this.setPendingCount(t&&t.length||0)},e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||"Get Approval Failed")}))}getApprovalDetails(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`/workspaces/${t}/approval-requests/${e}/details`).pipe(Object(Y.a)(e=>{const t=e.approvalRequest.owner.timeZone,i={};e.entries=e.entries.map(e=>new At.a(e));const n=e.entries.every(e=>e.approvalRequestId);e.entries.forEach(e=>{const n=jt.tz(e.timeInterval.start,t).format("YYYY-MM-DD");i[n]||(i[n]=new xt.a(n,"",[])),i[n].timeEntries.push(e)});const s=[];for(const c in i){const e=i[c];e.time=Object(Pt.d)(e.timeEntries),s.push(e)}return s.sort((e,t)=>{const i=new Date(e.date),n=new Date(t.date);return i>n?-1:i<n?1:0}),{approvalRequest:new Rt(e.approvalRequest),entryGroups:s,tableInfo:{trackedTime:e.trackedTime,pendingTime:e.pendingTime,approvedTime:e.approvedTime,billableTime:e.billableTime,billableAmount:e.billableAmount,costAmount:e.costAmount},equalStatus:n}})).pipe(Object(L.a)(()=>null,e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||"Get Approval Dashboard Failed")}))}getApprovalDashboard(e){const t=this.workspaceService.getDefaultWorkspaceId(),i=(new P.f).append("approvalRequestId",e);return this.http.get(`/workspaces/${t}/approval-requests/${e}/dashboard`,{params:i}).pipe(Object(L.a)(()=>null,e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||"Get Approval Dashboard Failed")}))}approveAll(){const e=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${e}/approval-requests?state=APPROVED`,{}).pipe(Object(Y.a)(()=>null),Object(L.a)(()=>{this.setPendingCount(0),this.toaster.pop("success","Successfully approved")},e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||"Approve All Failed")}))}approve(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${t}/approval-requests/${e}`,{state:Ot.APPROVED}).pipe(Object(Y.a)(e=>new Rt(e)),Object(L.a)(()=>{this.setPendingCount(this.pendingCount-1),this.toaster.pop("success","Timesheet approved")},e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||"Approve Failed")}))}reject(e,t){const i=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${i}/approval-requests/${e}`,{state:Ot.REJECTED,note:t}).pipe(Object(Y.a)(e=>new Rt(e)),Object(L.a)(()=>{this.setPendingCount(this.pendingCount-1),this.toaster.pop("success","Timesheet rejected")},e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||"Reject failed")}))}withdrawSubmission(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${t}/approval-requests/${e}`,{state:Ot.WITHDRAWN_SUBMISSION}).pipe(Object(Y.a)(e=>new Rt(e)),Object(L.a)(()=>{this.canApproveMyApprovals&&this.setPendingCount(this.pendingCount-1),this.toaster.pop("success","Withdraw successfully")},e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||"Withdraw failed")}))}withdrawApproval(e,t){const i=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${i}/approval-requests/${e}`,{state:Ot.WITHDRAWN_APPROVAL,note:t}).pipe(Object(Y.a)(e=>new Rt(e)),Object(L.a)(()=>this.toaster.pop("success","Withdraw successfully"),e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||"Withdraw failed")}))}getWeekStatus(e,t){const i=this.workspaceService.getDefaultWorkspaceId(),n=this.authService.getUser().id,s=(new P.f).append("start",e||"");return this.http.get(`/workspaces/${i}/users/${n}/approval-requests/week-status`,{params:s}).pipe(Object(Y.a)(i=>new Ie.a(Object.assign(Object.assign({},i),{startDayOfWeek:t||Se(e).format("YYYY-MM-DD")}))),Object(L.a)(()=>null,e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||"Get Approval Week status failed")}))}getAllPendingRequestsForAllWorkspaces(){const e=this.workspaceService.getDefaultWorkspaceId(),t=this.authService.getUser().id;return this.http.get(`/workspaces/${e}/users/${t}/approval-requests/all-pending`).pipe(Object(Y.a)(e=>{const t={};for(const n in e){const i=e[n];t[i.workspaceName]||(t[i.workspaceName]=[]),t[i.workspaceName].push(i.dateRange)}const i=[];for(const n in t)i.push({name:n,ranges:t[n]});return i.sort((e,t)=>{const i=e.name,n=t.name;return i>n?-1:i<n?1:0}),i})).pipe(Object(L.a)(()=>null,e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||"Get pending requests failed")}))}withdrawAllRequestsForAllWorkspaces(){const e=this.workspaceService.getDefaultWorkspaceId(),t=this.authService.getUser().id;return this.http.patch(`/workspaces/${e}/users/${t}/approval-requests/withdraw-all`,{}).pipe(Object(Y.a)(()=>null),Object(L.a)(null,e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||"Withdrawn all pending requests failed")}))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(P.b),c.fc(M.a),c.fc(Ce.a),c.fc(U.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var Yt=i("IzEk"),Lt=i("HApq");let Ft=(()=>{class e{constructor(e,t){this.router=e,this.systemSettingsService=t}canActivate(){const e=this.systemSettingsService.systemSettings$.pipe(Object(It.a)(e=>!!e));return this.systemSettingsService.getSystemSettings(),e.pipe(Object(Yt.a)(1),Object(Y.a)(()=>!0))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(W.c),c.fc(Lt.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var Nt=i("hT48");let Ut=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,f.a,Nt.a,d.a,le.b,Xe.a]]}),e})();var $t=function(e){return e.NEW_TIMER_STARTED="NEW_TIMER_STARTED",e.TIMER_STOPPED="TIMER_STOPPED",e.NEW_TIME_ENTRY="NEW_TIME_ENTRY",e.TIME_ENTRY_UPDATED="TIME_ENTRY_UPDATED",e.TIME_ENTRY_DELETED="TIME_ENTRY_DELETED",e.NEW_CLIENT="NEW_CLIENT",e.NEW_PROJECT="NEW_PROJECT",e.NEW_TASK="NEW_TASK",e.NEW_TAG="NEW_TAG",e}({});const _t={[$t.NEW_TIMER_STARTED]:"Timer started",[$t.TIMER_STOPPED]:"Timer stopped",[$t.NEW_TIME_ENTRY]:"Time entry created manually",[$t.TIME_ENTRY_UPDATED]:"Time entry updated",[$t.TIME_ENTRY_DELETED]:"Time entry deleted",[$t.NEW_CLIENT]:"Client created",[$t.NEW_PROJECT]:"Project created",[$t.NEW_TASK]:"Task created",[$t.NEW_TAG]:"Tag created"},Gt=[$t.NEW_TIMER_STARTED,$t.TIMER_STOPPED,$t.NEW_TIME_ENTRY,$t.TIME_ENTRY_UPDATED,$t.TIME_ENTRY_DELETED];function Bt(e,t){let i=_t[e];return Gt.includes(e)&&(i+=t===Vt.WORKSPACE_ID?" (anyone)":" (me)"),i}var Vt=function(e){return e.WORKSPACE_ID="WORKSPACE_ID",e.USER_ID="USER_ID",e.PROJECT_ID="PROJECT_ID",e.TAG_ID="TAG_ID",e.TASK_ID="TASK_ID",e}({});new Map([[Vt.PROJECT_ID,"on project"],[Vt.USER_ID,"by user"],[Vt.TAG_ID,"with tag"],[Vt.TASK_ID,"on task"],[Vt.WORKSPACE_ID,"on workspace"]]);class Ht{constructor(e){this._id=e.id,this._name=e.name,this._workspaceId=e.workspaceId,this._url=e.url,this._authToken=e.authToken,this._webhookEvent=e.webhookEvent,this._triggerSourceType=e.triggerSourceType,this._triggerSource=e.triggerSource,this._enabled=e.enabled,this._webhookEventLabel=Bt(this.webhookEvent,this.triggerSourceType)}get id(){return this._id}set id(e){this._id=e}get name(){return this._name}set name(e){this._name=e}get workspaceId(){return this._workspaceId}set workspaceId(e){this._workspaceId=e}get url(){return this._url}set url(e){this._url=e}get authToken(){return this._authToken}set authToken(e){this._authToken=e}get webhookEvent(){return this._webhookEvent}set webhookEvent(e){this._webhookEvent=e}get triggerSourceType(){return this._triggerSourceType}set triggerSourceType(e){this._triggerSourceType=e}get triggerSource(){return this._triggerSource}set triggerSource(e){this._triggerSource=e}get enabled(){return this._enabled}set enabled(e){this._enabled=e}get webhookEventLabel(){return this._webhookEventLabel}set webhookEventLabel(e){this._webhookEventLabel=e}}class zt{constructor(e){this._id=e.id,this._webhookId=e.webhookId,this.statusCode=e.statusCode,this._requestBody=e.requestBody,this._responseBody=e.responseBody,this._respondedAt=e.respondedAt}get id(){return this._id}set id(e){this._id=e}get webhookId(){return this._webhookId}set webhookId(e){this._webhookId=e}get statusCode(){return this._statusCode}set statusCode(e){this._statusCode=e}get requestBody(){return this._requestBody}set requestBody(e){this._requestBody=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}get respondedAt(){return this._respondedAt}set respondedAt(e){this._respondedAt=e}}var qt=function(e){return e.SUCCEEDED="SUCCEEDED",e.FAILED="FAILED",e.ALL="ALL",e}({});class Kt{constructor(e=qt.ALL,t,i,n){this.status=e,this.from=t,this.to=i,this.sortByNewest=n}}let Zt=(()=>{class e{constructor(e,t){this.http=e,this.toaster=t}getForWorkspace(e){return this.http.get(`/workspaces/${e}/webhooks/`).pipe(Object(Y.a)(e=>({workspaceWebhookCount:e.workspaceWebhookCount,webhooks:e.webhooks.map(e=>new Ht(e))})),Object(L.a)(null,e=>this.toaster.pop("error",e.error&&e.error.message||"Get webhooks failed.")))}getById(e,t){return this.http.get(`/workspaces/${e}/webhooks/${t}`).pipe(Object(Y.a)(e=>new Ht(e)),Object(L.a)(null,e=>this.toaster.pop("error",e.error&&e.error.message||"Get webhook failed.")))}delete(e,t){return this.http.delete(`/workspaces/${e}/webhooks/${t}`).pipe(Object(Y.a)(e=>e),Object(L.a)(()=>this.toaster.pop("success","Webhook deleted."),e=>this.toaster.pop("error",e.error&&e.error.message||"Delete webhook failed.")))}getLogs(e,t,i,n,s=qt.ALL){i-=1;const c=new Kt(s),r=(new P.f).append("page",i.toString()).append("size",n.toString());return this.http.post(`/workspaces/${e}/webhooks/${t}/logs`,c,{params:r}).pipe(Object(Y.a)(e=>e.map(e=>new zt(e))),Object(L.a)(null,e=>this.toaster.pop("error",e.error&&e.error.message||"Get logs failed.")))}getLogCount(e,t,i=qt.ALL){const n=(new P.f).append("status",i);return this.http.get(`/workspaces/${e}/webhooks/${t}/logs/count`,{params:n}).pipe(Object(Y.a)(e=>e),Object(L.a)(null,e=>this.toaster.pop("error",e.error&&e.error.message||"Get log count failed.")))}create(e,t){return this.http.post(`/workspaces/${e}/webhooks/`,t).pipe(Object(Y.a)(e=>new Ht(e)),Object(L.a)(()=>this.toaster.pop("success","Webhook created."),e=>this.toaster.pop("error",e.error&&e.error.message||"Create webhook failed.")))}update(e,t,i){return this.http.put(`/workspaces/${e}/webhooks/${t}`,i).pipe(Object(Y.a)(e=>new Ht(e)),Object(L.a)(()=>this.toaster.pop("success","Webhook updated."),e=>this.toaster.pop("error",e.error&&e.error.message||"Update webhook failed.")))}generateNewToken(e,t){return this.http.patch(`/workspaces/${e}/webhooks/${t}/token`,new Object).pipe(Object(Y.a)(e=>new Ht(e)),Object(L.a)(null,e=>this.toaster.pop("error",e.error&&e.error.message||"Generate new secret failed.")))}test(e,t){return this.http.get(`/workspaces/${e}/webhooks/${t}/test`).pipe(Object(Y.a)(e=>e),Object(L.a)(()=>this.toaster.pop("success","Test sent."),e=>this.toaster.pop("error",e.error&&e.error.message||"Send test failed.")))}resend(e,t,i){return this.http.get(`/workspaces/${e}/webhooks/${t}/resend/${i}`).pipe(Object(Y.a)(e=>e),Object(L.a)(()=>this.toaster.pop("success","Resend successful."),e=>this.toaster.pop("error",e.error&&e.error.message||"Resend failed.")))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(P.b),c.fc(n.d))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var Qt=i("lBcp"),Jt=i("JBiw"),ei=i("lvCY"),ti=i("8+Zx");class ii{constructor(e){this.hasParameters=e,this.query={page:1,limit:ei.f,name:""},this.parameterValues=new Jt.a([]),this.selectedValues=new ti.a,this.label="Choose parameters..."}get hasParameters(){return this._hasParameters}set hasParameters(e){this._hasParameters=e}get parameterValues(){return this._parameterValues}set parameterValues(e){this._parameterValues=e}get query(){return this._query}set query(e){this._query=e}get selectedValues(){return this._selectedValues}set selectedValues(e){this._selectedValues=e}get label(){return this._label}set label(e){this._label=e}selectValues(e){this.selectedValues=e.checkboxValues,this.label=""!=e.label?e.label:"Choose parameters..."}}var ni=i("LfE4");let si=(()=>{class e extends ii{constructor(){super(!0),this.unsubscribe$=new Ee.a}itemsGetter(){this.tagService.getAllTagsV1(ni.a.ACTIVE,null,{page:this.query.page,pageSize:this.query.limit}).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.parameterValues.resetAll(),this.parameterValues.pushToMap("values",e)})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=c.Mb({type:e,features:[c.zb]}),e})();var ci=i("VTb6");let ri=(()=>{class e extends ii{constructor(){super(!0),this.unsubscribe$=new Ee.a}itemsGetter(){this.projectService.getProjects({status:"ACTIVE",page:this.query.page,pageSize:this.query.limit}).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.parameterValues.resetAll(),this.parameterValues.pushToMap("values",e)})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=c.Mb({type:e,features:[c.zb]}),e})();class oi extends ii{constructor(){super(!1)}itemsGetter(){}}let ai=(()=>{class e extends ii{constructor(){super(!0),this.unsubscribe$=new Ee.a}itemsGetter(){const e={page:1,limit:50,statuses:["ACTIVE"]};this.workspaceService.getUsers(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(({users:t})=>{1===e.page&&this.parameterValues.resetMap("values"),this.parameterValues.pushToMap("values",t)})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=c.Mb({type:e,features:[c.zb]}),e})(),li=(()=>{class e{constructor(e,t,i){this.tagService=e,this.projectService=t,this.workspaceService=i}getForTags(){const e=new si;return e.tagService=this.tagService,e}getForProjects(){const e=new ri;return e.projectService=this.projectService,e}getForWorkspace(){return new oi}getForUsers(){const e=new ai;return e.workspaceService=this.workspaceService,e}getForTasks(){return new oi}}return e.\u0275fac=function(t){return new(t||e)(c.fc(Qt.a),c.fc(ci.a),c.fc(U.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})(),bi=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[Zt,li],imports:[[s.c,p.m,p.C,g.s,Ut,j.a,f.a]]}),e})(),ui=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[Zt],imports:[[s.c,p.m,W.g,bi,l.a,f.a,_.a,w.a,x.a,g.M,g.ab,d.a]]}),e})();var di=i("OmiP"),pi=i("tQGB"),hi=i("PW4C"),mi=i("NHP+"),gi=i("Vp8r");class fi{constructor(e,t){this.order=e.order,this.description=e.description||"",this.quantity=e.quantity||0,this.unitPrice=e.unitPrice||0,this.amount=e.amount||0,this.timeEntryIds=[...e.timeEntryIds||[]],t&&this.divideValuesBy100()}static clone(e){return new fi(e,!1)}static areSame(e,t){return e.order===t.order&&e.description.trim()===t.description.trim()&&e.quantity===t.quantity&&e.unitPrice===t.unitPrice&&e.amount===t.amount}patchValues(e){Object.entries(e).forEach(([e,t])=>{this.hasOwnProperty(e)&&(this[e]=t)})}toApiParameters(){return{description:this.description.trim(),quantity:Object(Pt.C)(this.quantity,100),unitPrice:Object(Pt.C)(this.unitPrice,100)}}divideValuesBy100(){this.quantity&&(this.quantity/=100),this.unitPrice&&(this.unitPrice/=100)}}class vi{constructor(e,t){this.id=e.id,this.number=e.number,this.status=e.status,this.issuedDate=e.issuedDate,this.dueDate=e.dueDate,this.subtotal=e.subtotal,this.discount=e.discount||0,this.discountAmount=e.discountAmount||0,this.tax=e.tax||0,this.tax2=e.tax2||0,this.taxAmount=e.taxAmount||0,this.tax2Amount=e.tax2Amount||0,this.amount=e.amount||0,this.currency=e.currency,this.subject=e.subject,this.note=e.note,this.clientId=e.clientId,this.clientName=e.clientName,this.clientAddress=e.clientAddress,this.userId=e.userId,t&&this.divideValuesBy100(),this.items=(e.items||[]).map(e=>new fi(e,t))}static clone(e){return new vi(e,!1)}get statusLabel(){return this.status.toLowerCase()||""}get color(){return ei.E[this.status]}generatePdfFilename(e){return(e=e||"")?`${e}_Invoice_${this.number}.pdf`:`Invoice_${this.number}.pdf`}getAvailableStatuses(){return this.status===gi.a.SENT?[gi.a.PAID,gi.a.UNSENT,gi.a.VOID]:this.status===gi.a.PAID?[gi.a.UNSENT,gi.a.VOID]:this.status===gi.a.UNSENT?[gi.a.SENT,gi.a.PAID,gi.a.VOID]:this.status===gi.a.VOID?[gi.a.SENT,gi.a.UNSENT,gi.a.PAID]:[]}toApiParameters(){return{number:this.number,status:this.status,issuedDate:this.issuedDate,dueDate:this.dueDate,subtotal:this.subtotal,discount:Object(Pt.C)(this.discount,100),tax:Object(Pt.C)(this.tax,100),tax2:Object(Pt.C)(this.tax2,100),currency:this.currency,subject:this.subject,note:this.note}}patchValues(e,t){t=t||[],Object.entries(e).forEach(([e,i])=>{t.includes(e)||this.hasOwnProperty(e)&&(this[e]=i)})}divideValuesBy100(){this.discount&&(this.discount=parseFloat((this.discount/=100).toPrecision(8))),this.tax&&(this.tax=parseFloat((this.tax/=100).toPrecision(8))),this.tax2&&(this.tax2=parseFloat((this.tax2/=100).toPrecision(8)))}}var wi=i("hl/z"),yi=i("kGbF"),Wi=function(e){return e.SINGLE_ITEM="SINGLE_ITEM",e.PROJECT="PROJECT",e.TASK="TASK",e.DETAILED="DETAILED",e}({});class Ci{constructor(e){this.issueDate=e.issueDate||"",this.dueDate=e.dueDate||"",this.billFrom=e.billFrom||"",this.billTo=e.billTo||"",this.description=e.description||"",this.quantity=e.quantity||"",this.unitPrice=e.unitPrice||"",this.amount=e.amount||"",this.subtotal=e.subtotal||"",this.discount=e.discount||"",this.tax=e.tax||"",this.tax2=e.tax2||"",this.totalAmount=e.totalAmount||"",this.notes=e.notes||""}toApiParameters(){return{issueDate:this.issueDate,dueDate:this.dueDate,billFrom:this.billFrom,billTo:this.dueDate,quantity:this.quantity,description:this.description,unitPrice:this.unitPrice,amount:this.amount,subtotal:this.subtotal,discount:this.discount,tax:this.tax,tax2:this.tax2,totalAmount:this.totalAmount,notes:this.notes}}}let ki=(()=>{class e{constructor(e,t,i,n){this.http=e,this.toaster=t,this.loader=i,this.workspaceService=n,this.invoice$=new Ee.a,this.unsubscribe$=new Ee.a}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getInvoices(e){const t=this.workspaceService.getDefaultWorkspaceId(),i=(new P.f).append("page",e.page.toString()).append("page-size",e.pageSize).append("statuses",e.statuses);return this.http.get(`/workspaces/${t}/invoices/info`,{params:i}).pipe(Object(Y.a)(e=>({count:e.total,invoices:e.invoices.map(e=>new vi(e,!0))})),Object(L.a)(()=>{},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Get invoices failed")}))}getInvoice(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`/workspaces/${t}/invoices/${e}`).pipe(Object(Y.a)(e=>new vi(e,!0)),Object(L.a)(()=>{},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Get invoice failed")}))}createInvoice(e){var t,i,n;const s=this.workspaceService.getDefaultWorkspaceId(),c={clientId:null===(t=e.clientId)||void 0===t?void 0:t.trim(),currency:null===(i=e.currency)||void 0===i?void 0:i.trim(),number:null===(n=e.number)||void 0===n?void 0:n.trim(),issuedDate:e.issuedDate,dueDate:e.dueDate};return this.http.post(`/workspaces/${s}/invoices`,c).pipe(Object(Y.a)(e=>new vi(e,!0)),Object(L.a)(()=>this.toaster.success("Invoice successfully created."),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Create invoice failed.")}))}editInvoice(e,t){const i=this.workspaceService.getDefaultWorkspaceId(),n=e.toApiParameters();return t&&(n.clientId=e.clientId),this.http.put(`/workspaces/${i}/invoices/${e.id}`,n).pipe(Object(Y.a)(e=>new vi(e,!0)),Object(L.a)(()=>this.toaster.success("Invoice successfully edited."),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Edit invoice failed.")}))}markAs(e,t){const i=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${i}/invoices/${e}/status`,{invoiceStatus:t}).pipe(Object(L.a)(e=>{this.toaster.success("Status has been changed.")},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Change status failed.")}))}deleteInvoice(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`/workspaces/${t}/invoices/${e}`).pipe(Object(L.a)(e=>{this.toaster.success("Invoice has been deleted.")},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Delete invoice failed.")}))}importTime(e,t){var i;const n=this.workspaceService.getDefaultWorkspaceId(),s=e.groupEntries===Wi.DETAILED&&(null===(i=e.fieldsForDetailed)||void 0===i?void 0:i.length)?e.fieldsForDetailed:null;return this.http.put(`/workspaces/${n}/invoices/${t}/import`,{from:e.from,to:e.to,projectsFilter:e.projectsFilter,groupEntries:e.groupEntries,roundEntries:e.roundEntries,fieldsForDetailed:s}).pipe(Object(Y.a)(e=>new vi(e,!0)),Object(L.a)(()=>this.toaster.success("Imported time successfully."),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Import time failed.")}))}downloadInvoicePdf(e,t){const i=this.workspaceService.getDefaultWorkspaceId(),n=navigator.languages&&navigator.languages[0]||navigator.language||"",s=(new P.f).append("userLocale",n.replace(/\-/g,"_"));this.download(`/workspaces/${i}/invoices/${e}/export`,t,s)}download(e,t,i,n="application/pdf"){this.loader.show("Download "+t,null,{enableClose:!0}).pipe(Object(De.a)(this.unsubscribe$),Object(It.a)(e=>e)).subscribe(()=>window.stop()),this.http.get(e,{params:i,responseType:"blob"}).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{const i=new Blob([e],{type:n||e.type});this.loader.hide(),Object(yi.b)(i,t)},e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Download failed"),this.loader.hide()})}createInvoiceItem(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.post(`/workspaces/${t}/invoices/${e}/invoiceItem`,null).pipe(Object(Y.a)(e=>new fi(e,!0)),Object(L.a)(e=>{this.toaster.success("Invoice item successfully created.")},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Create invoice item failed.")}))}editInvoiceItem(e,t){const i=this.workspaceService.getDefaultWorkspaceId(),n=t.toApiParameters(),s=new Ee.a;return this.http.put(`/workspaces/${i}/invoices/${e}/invoiceItem/${t.order}`,n).pipe(Object(Y.a)(e=>new vi(e,!0)),Object(L.a)(()=>this.toaster.success("Invoice item successfully edited."),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Edit invoice item failed.")})).subscribe(e=>{this.invoice$.next({action:"edit",invoice:e}),s.next(e)},e=>s.error(e)),s}deleteInvoiceItem(e,t){const i=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`/workspaces/${i}/invoices/${e}/invoiceItem/${t}`).pipe(Object(Y.a)(e=>new vi(e,!0)),Object(L.a)(e=>{this.invoice$.next({action:"delete",invoice:e}),this.toaster.success("Invoice item has been deleted.")},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Delete invoice item failed.")}))}bulkEntriesInvoiceStatus(e,t){const i=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${i}/timeEntries/invoiced`,{timeEntries:e,invoiced:t}).pipe(Object(Y.a)(()=>null),Object(L.a)(()=>this.toaster.success("Invoice has been changed."),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Mark invoices failed.")}))}getInvoiceSettings(){const e=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`/workspaces/${e}/invoices/settings`).pipe(Object(Y.a)(e=>new Ci(e.labels)),Object(L.a)(()=>{},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Get invoice settings failed.")}))}editInvoiceSettings(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.put(`/workspaces/${t}/invoices/settings`,{labels:e}).pipe(Object(Y.a)(e=>null),Object(L.a)(()=>this.toaster.success("Invoice settings updated."),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Edit invoice settings failed.")}))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(P.b),c.fc(M.a),c.fc(wi.a),c.fc(U.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var Si=i("2rWG"),Ii=i("sbmM"),Oi=i("qUN8");function Xi(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",7),c.Xb(1,"div",8),c.Xb(2,"input",9),c.jc("ngModelChange",(function(i){return c.Oc(e),t.$implicit.value=i})),c.Wb(),c.Xb(3,"label",10),c.Yc(4),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit,i=t.index,n=c.nc(2);c.Cb(2),c.wc("disabled",0==i&&n.disableFirst)("ngModel",e.value)("id",i),c.Cb(1),c.wc("for",i),c.Cb(1),c.ad(" ",n.showPlaceholder?e.placeholder:e.label," ")}}function Ei(e,t){if(1&e&&(c.Xb(0,"div",3),c.Xb(1,"div",4),c.Wc(2,Xi,5,5,"div",5),c.Sb(3,"span",6),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.wc("ngForOf",e.list)}}var Ti=function(e){return e.TEXT="TEXT",e.BUTTON="BUTTON",e}({});let Di=(()=>{class e{constructor(e){this.cd=e,this.configClasses={[Ti.BUTTON]:"cl-dropdown-item-label cl-btn cl-btn-outline-light cl-w-100 cl-text-left cl-dropdown-toggle cl-cut-text pointer",[Ti.TEXT]:"cl-dropdown-link-text"},this.type=Ti.BUTTON,this.titlePrefix="",this.titleSufix="",this.verboseTitle=!1,this.lowercaseTitle=!0,this.showPlaceholder=!1,this.onChange=new c.n,this.unsubscribe$=new Ee.a}set list(e){this._list=e,this.listBackup=e.map(e=>new di.a(e.value,e.label,e.placeholder)),this.title=this.generateTitle()}get list(){return this._list}ngOnInit(){this.classes=this.configClasses[this.type]}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}generateTitle(){return this.list.filter(e=>e.value).length!==this.list.length||this.verboseTitle?this.lowercaseTitle?this.list.filter(e=>e.value).map(e=>e.label.toLowerCase()).join(", "):this.list.filter(e=>e.value).map(e=>e.label).join(", "):"all"}onDropdownClose(){if(this.title=this.generateTitle(),!this.list.filter(e=>e.value).length&&this.list.forEach(e=>e.value=!0),di.a.areSame(this.listBackup,this.list))return;const e=this.list.map(e=>new di.a(e.value,e.label,e.placeholder));this.onChange.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["dropdown-checkbox-list"]],inputs:{disableFirst:"disableFirst",list:"list",type:"type",titlePrefix:"titlePrefix",titleSufix:"titleSufix",verboseTitle:"verboseTitle",lowercaseTitle:"lowercaseTitle",showPlaceholder:"showPlaceholder"},outputs:{onChange:"onChange"},decls:4,vars:4,consts:[["dropdownKey","",1,"cl-dropdown",3,"onClose"],["tabindex","0","dropdownKeyButton","",3,"ngClass"],["class","cl-dropdown-menu","openUpAtBottom","",4,"dropdownKeyContent"],["openUpAtBottom","",1,"cl-dropdown-menu"],[1,"cl-scroll-area"],["class","cl-dropdown-item cl-dropdown-item-checkbox",4,"ngFor","ngForOf"],["dropdownClose","","tabindex","0"],[1,"cl-dropdown-item","cl-dropdown-item-checkbox"],[1,"cl-custom-control","cl-custom-checkbox","cl-cut-text-wrapper"],["type","checkbox",1,"cl-custom-control-input",3,"disabled","ngModel","id","ngModelChange"],[1,"cl-custom-control-label","cl-cut-text",3,"for"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.jc("onClose",(function(){return t.onDropdownClose()})),c.Xb(1,"span",1),c.Yc(2),c.Wb(),c.Wc(3,Ei,4,1,"div",2),c.Wb()),2&e&&(c.Cb(1),c.wc("ngClass",t.classes),c.Cb(1),c.cd(" ",t.titlePrefix," ",t.title," ",t.titleSufix," "))},directives:[Si.a,Ii.a,s.r,Oi.a,s.t,p.a,p.s,p.v],encapsulation:2,changeDetection:0}),e})();function Ri(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"span",6),c.Yc(2),c.Wb(),c.Ub()),2&e){const e=c.nc();c.Cb(2),c.Zc(e.loadingMessage)}}function Ai(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"span",6),c.Yc(2),c.Wb(),c.Ub()),2&e){const e=c.nc(2);c.Cb(2),c.Zc(e.errorMessage)}}function ji(e,t){if(1&e&&c.Wc(0,Ai,3,1,"ng-container",3),2&e){const e=c.nc(),t=c.Lc(7);c.wc("ngIf",e.isError)("ngIfElse",t)}}function xi(e,t){if(1&e&&(c.Xb(0,"span",7),c.Yc(1),c.Wb(),c.Xb(2,"p",8),c.Yc(3),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.Zc(e.title),c.Cb(2),c.Zc(e.subtitle)}}let Pi=(()=>{class e{constructor(){this.title="No recent time entries to show",this.subtitle="It looks like you haven't tracked any time lately.",this.errorMessage="Something went wrong. Please, try again.",this.loadingMessage="Loading, please wait.",this.imagePath="assets/clockify_illustration.svg",this.isError=!1}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["message-entries"]],inputs:{title:"title",subtitle:"subtitle",errorMessage:"errorMessage",loadingMessage:"loadingMessage",loadInProgress:"loadInProgress",imagePath:"imagePath",isError:"isError"},decls:8,vars:3,consts:[[1,"cl-no-entries"],[1,"cl-no-entries-image-wrapper"],[1,"no__entries--image",3,"src"],[4,"ngIf","ngIfElse"],["errorMessageTemplate",""],["messageTemplate",""],[1,"cl-h2"],[1,"cl-h2","cl-mb-1"],[1,"cl-mb-0"]],template:function(e,t){if(1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Sb(2,"img",2),c.Wb(),c.Wc(3,Ri,3,1,"ng-container",3),c.Wc(4,ji,1,2,"ng-template",null,4,c.Xc),c.Wc(6,xi,4,2,"ng-template",null,5,c.Xc),c.Wb()),2&e){const e=c.Lc(5);c.Cb(2),c.wc("src",t.imagePath,c.Qc),c.Cb(1),c.wc("ngIf",t.loadInProgress)("ngIfElse",e)}},directives:[s.u],encapsulation:2,changeDetection:0}),e})();function Mi(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"th",2),c.Xb(2,"div",3),c.Xb(3,"div",4),c.Yc(4),c.Wb(),c.Wb(),c.Wb(),c.Xb(5,"th",5),c.Xb(6,"div",6),c.Xb(7,"div",4),c.Yc(8),c.Wb(),c.Wb(),c.Wb(),c.Xb(9,"th",5),c.Xb(10,"div",6),c.Xb(11,"div",4),c.Yc(12),c.Wb(),c.Wb(),c.Wb(),c.Xb(13,"th",5),c.Xb(14,"div",6),c.Xb(15,"div",4),c.Yc(16),c.Wb(),c.Wb(),c.Wb(),c.Xb(17,"th",5),c.Xb(18,"div",6),c.Xb(19,"div",7),c.Yc(20),c.Wb(),c.Wb(),c.Wb(),c.Xb(21,"th",8),c.Xb(22,"div",7),c.Yc(23),c.Wb(),c.Wb(),c.Ub()),2&e){const e=c.nc();c.Cb(4),c.Zc(e.labels[0]),c.Cb(4),c.Zc(e.labels[1]),c.Cb(4),c.Zc(e.labels[2]),c.Cb(4),c.Zc(e.labels[3]),c.Cb(4),c.Zc(e.labels[4]),c.Cb(3),c.Zc(e.labels[5])}}function Yi(e,t){if(1&e){const e=c.Yb();c.Xb(0,"th",9),c.Xb(1,"div",3),c.Xb(2,"div",4),c.Yc(3),c.Wb(),c.Xb(4,"a",10),c.jc("click",(function(){return c.Oc(e),c.nc().expandAll()})),c.Xb(5,"span",11),c.Sb(6,"img",12),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.ad(" ",e.labels[0]," "),c.Cb(3),c.wc("src",e.isExpandAll?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",c.Qc)}}let Li=(()=>{class e{constructor(e){this.router=e,this.onExpandAll=new c.n,this.isExpandAll=!1}expandAll(){this.isExpandAll=!this.isExpandAll,this.onExpandAll.emit(this.isExpandAll)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.c))},e.\u0275cmp=c.Lb({type:e,selectors:[["invoice-table-header"],["","invoice-table-header",""]],inputs:{isDesktop:"isDesktop",labels:"labels"},outputs:{onExpandAll:"onExpandAll"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["mobileTemplate",""],[1,"cl-h6","cl-mb-0","cl-pl-lg-3"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-h5","cl-mb-0"],[1,"cl-d-none","cl-d-lg-table-cell"],[1,"cl-ml-lg-custom-n2"],[1,"cl-h5","cl-mb-0","cl-d-lg-none"],[1,"cl-d-none","cl-d-lg-table-cell","cl-lh-0"],[1,"cl-pl-lg-3"],[1,"cl-ml-auto",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"]],template:function(e,t){if(1&e&&(c.Wc(0,Mi,24,6,"ng-container",0),c.Wc(1,Yi,7,2,"ng-template",null,1,c.Xc)),2&e){const e=c.Lc(2);c.wc("ngIf",t.isDesktop)("ngIfElse",e)}},directives:[s.u],encapsulation:2}),e})();var Fi=i("5SNR"),Ni=i("6GAr"),Ui=i("AHJ+"),$i=i("psuR"),_i=i("rg2B"),Gi=i("Lwft");function Bi(e,t){1&e&&c.Tb(0)}function Vi(e,t){if(1&e&&(c.Xb(0,"div",10),c.Xb(1,"a",11),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.yc("routerLink","/invoices/",e.invoice.id,""),c.Cb(2),c.Zc(e.invoice.number)}}function Hi(e,t){if(1&e&&(c.Xb(0,"a",12),c.Xb(1,"div",13),c.Xb(2,"span",14),c.Yc(3),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.yc("routerLink","/invoices/",e.invoice.id,""),c.Cb(3),c.ad(" ",e.invoice.clientName||"-"," ")}}function zi(e,t){if(1&e&&(c.Xb(0,"a",12),c.Xb(1,"div",13),c.Xb(2,"span",14),c.Yc(3),c.oc(4,"momentFormat"),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.yc("routerLink","/invoices/",e.invoice.id,""),c.Cb(3),c.ad(" ",c.pc(4,2,e.invoice.dueDate)," ")}}function qi(e,t){if(1&e&&(c.Xb(0,"a",12),c.Xb(1,"div",13),c.Xb(2,"b",14),c.Yc(3),c.oc(4,"roundIfWholeNumber"),c.oc(5,"centsToDollars"),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.yc("routerLink","/invoices/",e.invoice.id,""),c.Cb(3),c.bd(" ",c.pc(4,3,c.pc(5,5,e.invoice.amount))," ",e.invoice.currency," ")}}function Ki(e,t){if(1&e&&(c.Xb(0,"a",12),c.Xb(1,"div",13),c.Xb(2,"span",15),c.Yc(3),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.yc("routerLink","/invoices/",e.invoice.id,""),c.Cb(2),c.wc("ngClass","cl-badge-status-"+e.invoice.color),c.Cb(1),c.ad(" ",e.invoice.statusLabel," ")}}function Zi(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",24),c.jc("keyup.enter",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).markAs(i)}))("keyup.space",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).markAs(i)}))("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).markAs(i)})),c.Yc(1),c.Wb()}if(2&e){const e=t.$implicit;c.Cb(1),c.ad(" Mark as ",e.toLowerCase()," ")}}function Qi(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",22),c.Xb(1,"list-items"),c.Wc(2,Zi,2,1,"a",23),c.Xb(3,"a",24),c.jc("keyup.enter",(function(){return c.Oc(e),c.nc(2).downloadPdf()}))("keyup.space",(function(){return c.Oc(e),c.nc(2).downloadPdf()}))("click",(function(){return c.Oc(e),c.nc(2).downloadPdf()})),c.Yc(4," Download PDF "),c.Wb(),c.Xb(5,"a",24),c.jc("keyup.enter",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(16);return t.openModal(i)}))("keyup.space",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(16);return t.openModal(i)}))("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(16);return t.openModal(i)})),c.Yc(6," Delete "),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(2),c.wc("ngForOf",e.availableStatuses)}}function Ji(e,t){1&e&&(c.Xb(0,"div",16),c.Xb(1,"div",17),c.Sb(2,"img",18),c.Wb(),c.Wc(3,Qi,7,1,"div",19),c.Sb(4,"span",20,21),c.Wb())}function en(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",25),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().confirmDelete(i)}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Yc(1," All entries in this invoice will become uninvoiced. "),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Delete invoice")("inProgress",e.inProgress)("isDanger",!0)("btnText","Delete")}}const tn=function(e){return{labels:e}},nn=function(e,t,i,n,s,c){return[e,t,i,n,s,c]};let sn=(()=>{class e{constructor(e,t,i){this.cd=e,this.modalService=t,this.invoiceService=i,this.onDelete=new c.n,this.InvoiceStatus=gi.a,this.unsubscribe$=new Ee.a}ngOnInit(){this.availableStatuses=this.invoice.getAvailableStatuses()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}ngAfterViewInit(){this.cd.detectChanges()}openModal(e){this.modalService.open(e,{centered:!0})}confirmDelete(e){this.inProgress=!0,this.invoiceService.deleteInvoice(this.invoice.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{e.close(),this.inProgress=!1,this.onDelete.emit()},()=>{this.inProgress=!1})}markAs(e){this.inProgress||(this.inProgress=!0,this.invoiceService.markAs(this.invoice.id,e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.inProgress=!1,this.invoice.status=e,this.availableStatuses=this.invoice.getAvailableStatuses(),this.cd.markForCheck()},()=>{this.inProgress=!1}))}downloadPdf(){const e=this.invoice.generatePdfFilename(this.invoice.clientName);this.invoiceService.downloadInvoicePdf(this.invoice.id,e)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.h),c.Rb(g.q),c.Rb(ki))},e.\u0275cmp=c.Lb({type:e,selectors:[["invoice-table-row"],["","invoice-table-row",""]],inputs:{isDesktop:"isDesktop",labels:"labels",expandAll:"expandAll",invoice:"invoice"},outputs:{onDelete:"onDelete"},decls:17,vars:14,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-d-none",3,"isDesktop","templates","isExpanded"],["responsive",""],["col1",""],["col2",""],["col3",""],["col4",""],["col5",""],["col6",""],["deleteModal",""],[1,"cl-d-inline-flex","cl-cut-text-wrapper","cl-w-100","cl-py-0","cl-py-lg-custom-2","cl-pr-3"],[1,"cl-cut-text","cl-project-name","cl-project-name-colored","cl-brown","cl-text-dark","cl-text-decoration-none",3,"routerLink"],[1,"cl-component-divided-left","cl-d-flex","cl-text-dark","cl-text-decoration-none",3,"routerLink"],[1,"cl-cut-text-wrapper","cl-w-100","cl-d-flex","cl-justify-content-center","cl-justify-content-lg-start"],[1,"cl-cut-text"],[1,"cl-badge-approve","cl-text-capitalize",3,"ngClass"],["dropdownKey","","tabCell","",1,"cl-dropdown"],["dropdownKeyButton","","tabindex","0",1,"pointer","cl-non-selectable","cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical.svg"],["openUpAtBottom","","class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["tabFocus","","tabindex","0"],["tabFocusDuplicate",""],["openUpAtBottom","",1,"cl-dropdown-menu","cl-dropdown-menu-right"],["class","cl-dropdown-item","tabindex","-1","clickCloseDropdown","",3,"keyup.enter","keyup.space","click",4,"ngFor","ngForOf"],["tabindex","-1","clickCloseDropdown","",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],[3,"title","inProgress","isDanger","btnText","confirmed","close"]],template:function(e,t){if(1&e&&(c.Wc(0,Bi,1,0,"ng-container",0),c.Sb(1,"responsive-row",1,2),c.Wc(3,Vi,4,2,"ng-template",null,3,c.Xc),c.Wc(5,Hi,4,2,"ng-template",null,4,c.Xc),c.Wc(7,zi,5,4,"ng-template",null,5,c.Xc),c.Wc(9,qi,6,7,"ng-template",null,6,c.Xc),c.Wc(11,Ki,4,3,"ng-template",null,7,c.Xc),c.Wc(13,Ji,6,0,"ng-template",null,8,c.Xc),c.Wc(15,en,2,4,"ng-template",null,9,c.Xc)),2&e){const e=c.Lc(2),i=c.Lc(4),n=c.Lc(6),s=c.Lc(8),r=c.Lc(10),o=c.Lc(12),a=c.Lc(14);c.wc("ngTemplateOutlet",e.template)("ngTemplateOutletContext",c.Bc(5,tn,t.labels)),c.Cb(1),c.wc("isDesktop",t.isDesktop)("templates",c.Gc(7,nn,i,n,s,r,o,a))("isExpanded",t.expandAll)}},directives:[s.B,Fi.a,W.f,s.r,Si.a,Ii.a,Oi.a,Ni.a,s.t,Ui.a],pipes:[$i.a,_i.a,Gi.a],encapsulation:2,changeDetection:0}),e})();var cn=i("aDua"),rn=i("Jmk/"),on=i("AY7I"),an=i("6t6a");function ln(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",6),c.jc("click",(function(){return c.Oc(e),c.nc().openDatepicker()})),c.Sb(1,"img",4),c.Xb(2,"span",7),c.Yc(3),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.ad(" ",e.label," ")}}function bn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"input",8),c.jc("showDaterangepicker",(function(){return c.Oc(e),c.nc().onDatepickerOpen()}))("hideDaterangepicker",(function(t){return c.Oc(e),c.nc().onDatepickerClose(t)}))("selected",(function(t){return c.Oc(e),c.nc().setSelectedDate(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("options",e.options)}}let un=(()=>{class e{constructor(e,t){this.authService=e,this.cd=t,this.hideRanges=!1,this.isUtc=!0,this.onDateSelect=new c.n,this.isRendered=!0,this.emitDebouncer$=new Ee.a,this.unsubscribe$=new Ee.a}set minDate(e){this._minDate=e,e&&this.isInitialized&&(this.options.minDate=this.stringDateToObject(e),this.resetView())}get minDate(){return this._minDate}set referenceDay(e){this._referenceDay=e,e&&this.isInitialized&&(this.initRanges(),this.resetView())}get referenceDay(){return this._referenceDay}set date(e){this.applyDate(e)}ngOnInit(){var e,t;const i=this.authService.getUser();this.format=(null===(e=null==i?void 0:i.settings)||void 0===e?void 0:e.dateFormat)||"MM/DD/YYYY",this.startOfWeek=this.startOfWeek||(null===(t=null==i?void 0:i.settings)||void 0===t?void 0:t.weekStart)||"MONDAY",this.initOptions(),this.emitDebouncer$.pipe(Object(Te.a)(400)).subscribe(()=>this.emitDateRange()),this.isInitialized=!0}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}applyDate(e){e&&(this.selectedDate=this.stringDateToObject(e),this.isInitialized&&(this.setDateToPicker(),this.setLabel()),this.backupValue=this.selectedDate.clone())}stringDateToObject(e){const t=this.isUtc?Se.utc(e):Se(e);return Se().set({date:t.date(),month:t.month(),year:t.year()}).startOf("day")}setSelectedDate(e){this.onSelectedDate(e.start,e.label),this.isDateSelected=!0}onDatepickerOpen(){this.isDateSelected=!1,this.isDatepickerOpen=!0}openDatepicker(){this.isDatepickerOpen||this.picker.datePicker&&this.picker.datePicker.show()}onDatepickerClose(e){this.isDatepickerOpen=!1,this.isDateSelected||setTimeout(()=>{this.onSelectedDate(e.picker.startDate,e.picker.chosenLabel)})}onSelectedDate(e,t){const i=e.clone();this.selectedDate=i,this.setLabel(),this.emitDebouncer$.next()}emitDateRange(){var e;if(null===(e=this.backupValue)||void 0===e?void 0:e.isSame(this.selectedDate,"day"))return;this.backupValue=this.selectedDate.clone();const t=this.selectedDate.clone().startOf("day"),i=this.isUtc?t.add(t.utcOffset(),"m").toISOString():t.toISOString();this.onDateSelect.emit({date:i,label:this.label})}setDateToPicker(){this.picker&&(this.picker.datePicker.setStartDate(this.selectedDate.clone()),this.picker.datePicker.setEndDate(this.selectedDate.clone()))}initOptions(){const e=this.minDate?this.stringDateToObject(this.minDate):Se(0);this.selectedDate.isBefore(e)&&console.warn("Single datepicker with list: Selected date is before minimum date!!!"),this.options={singleDatePicker:!0,locale:{format:this.format,firstDay:(["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY","SUNDAY"].indexOf(this.startOfWeek)+1)%7},alwaysShowCalendars:!0,startDate:this.selectedDate,timePicker:!1,autoApply:!0,opens:"left",showCustomRangeLabel:!1,minDate:e},this.initRanges()}initRanges(){if(this.hideRanges)return;this.options.showRanges=!0;const e=this.referenceDay?this.stringDateToObject(this.referenceDay):Se().startOf("day");this.options.ranges={[an.a.UPON_RECEIPT]:[e.clone(),e.clone()],[an.a.AFTER_10]:[e.clone().add(10,"day"),e.clone().add(10,"day")],[an.a.AFTER_15]:[e.clone().add(15,"day"),e.clone().add(15,"day")],[an.a.AFTER_30]:[e.clone().add(30,"day"),e.clone().add(30,"day")],[an.a.AFTER_60]:[e.clone().add(60,"day"),e.clone().add(60,"day")],[an.a.AFTER_90]:[e.clone().add(90,"day"),e.clone().add(90,"day")]},this.setLabel()}setLabel(){if(this.hideRanges)return;const e=this.referenceDay?this.stringDateToObject(this.referenceDay):Se().startOf("day"),{label:t}=Object(ke.a)(this.selectedDate,e);this.label=t}resetView(){this.isRendered=!1,this.isRendered=!0,this.cd.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Ce.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["datepicker-single-with-list"]],viewQuery:function(e,t){var i;1&e&&c.ed(se.b,!0),2&e&&c.Kc(i=c.kc())&&(t.picker=i.first)},inputs:{hideRanges:"hideRanges",isUtc:"isUtc",startOfWeek:"startOfWeek",minDate:"minDate",referenceDay:"referenceDay",date:"date"},outputs:{onDateSelect:"onDateSelect"},decls:6,vars:2,consts:[[1,"cl-btn-group","cl-d-flex"],[1,"cl-relative","cl-datepicker-wrapper","cl-w-100"],["class","cl-datepicker-fake-input cl-d-flex cl-align-items-center cl-px-2 pointer cl-btn cl-btn-outline-light",3,"click",4,"ngIf"],[1,"cl-btn","cl-btn-outline-light","cl-py-0","cl-px-2","cl-d-flex",2,"opacity","1",3,"click"],["src","assets/images/ui-icons/calendar.svg"],["daterangepicker","","class","cl-border-0 cl-bg-transparent cl-datepickerrange cl-btn cl-pr-0 cl-text-left",3,"options","showDaterangepicker","hideDaterangepicker","selected",4,"ngIf"],[1,"cl-datepicker-fake-input","cl-d-flex","cl-align-items-center","cl-px-2","pointer","cl-btn","cl-btn-outline-light",3,"click"],[1,"cl-datepickerrange","cl-pl-2","cl-cut-text","cl-text-left"],["daterangepicker","",1,"cl-border-0","cl-bg-transparent","cl-datepickerrange","cl-btn","cl-pr-0","cl-text-left",3,"options","showDaterangepicker","hideDaterangepicker","selected"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Wc(2,ln,4,1,"div",2),c.Xb(3,"a",3),c.jc("click",(function(){return t.openDatepicker()})),c.Sb(4,"img",4),c.Wc(5,bn,1,1,"input",5),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(2),c.wc("ngIf",t.label&&!t.isDatepickerOpen),c.Cb(3),c.wc("ngIf",t.isRendered))},directives:[s.u,se.b],encapsulation:2}),e})();var dn=i("hkzH"),pn=i("kKK/");const hn=["dropdown"],mn=["dueDateComponent"];function gn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",18),c.Xb(1,"div",19),c.Xb(2,"dropdown-items",20,21),c.jc("onOpen",(function(){c.Oc(e);const t=c.nc();return 1===t.clientQuery.page&&t.fetchClients()}))("loadMore",(function(){return c.Oc(e),c.nc().fetchClients()}))("onFilterOptionChange",(function(t){return c.Oc(e),c.nc().onFilterChange(t)}))("onChanged",(function(t){return c.Oc(e),c.nc().onClientSelect(t)})),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.wc("enableSearch",!0)("offlineSearch",!1)("filterOptions",e.clientFilterOptions)("filterQuery",e.clientQuery)("placeholder","Search "+e.clientLabel)("title",e.clientLabel)("list",e.clients)("itemLabel",e.clientName||"Select "+e.clientLabel)("value",e.form.value.clientId)("type","STANDARD")}}let fn=(()=>{class e{constructor(e,t,i,n,s,r){this.workspaceService=e,this.clientService=t,this.formBuilder=i,this.invoiceService=n,this.cd=s,this.router=r,this.onClose=new c.n,this.isSavingChange=new c.n,this.onSave=new c.n,this.clients=[],this.clientFilterOptions=dn.l,this.clientQuery={},this.unsubscribe$=new Ee.a}ngOnInit(){var e,t,i,n,s;this.isEditing=!!(null===(e=this.invoice)||void 0===e?void 0:e.id),this.invoice=this.invoice?vi.clone(this.invoice):this.invoice,this.clientWasDeleted=this.isEditing&&!this.invoice.clientId;const c=this.workspaceService.getLocalDefaultWorkspace(),r=(null===(t=this.invoice)||void 0===t?void 0:t.issuedDate)||this.toUtcDate(Se().toISOString()),o=(null===(i=this.invoice)||void 0===i?void 0:i.dueDate)||this.toUtcDate(Se(r).add(10,"d").toISOString()),a=(null===(n=this.invoice)||void 0===n?void 0:n.clientId)||null,l=this.generateInvoiceNumber();this.form=this.formBuilder.group({clientId:[a,[p.G.required]],currency:[(null===(s=this.invoice)||void 0===s?void 0:s.currency)||c.hourlyRate.currency||"",[on.a.required,on.a.minLength(1),on.a.maxLength(100)]],number:[l,[on.a.required]],issuedDate:[r,[p.G.required]],dueDate:[o,[p.G.required]]});const b=c.projectGroupingLabel||"client";this.clientLabel=Object(Pt.j)(b),a||(this.clients=[new di.a(null,"Select "+b)]);const{label:u}=Object(ke.a)(Se(o),Se(r));this.dueDateLabel=u,this.resetQuery()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}toUtcDate(e){const t=Se().utcOffset();return Se.utc(e).add(t,"m").startOf("day").toISOString()}onFilterChange(e){this.resetQuery(),this.clientQuery.name=e.searchTerm,this.clientQuery.status=e.status,this.clientsReachedLimit=!1,this.fetchClients()}resetQuery(){this.clientQuery={page:1,limit:ei.f,name:"",sortColumn:"name",status:ni.a.ACTIVE},this.clientsReachedLimit=!1}generateInvoiceNumber(){if(this.isEditing)return this.invoice.number;let e=this.lastInvoiceId||"Invoice";if(e){let t=e.length;for(;Object(Pt.u)(e[t-1]);)e=e.slice(0,-1),t--}return`${e}${(this.totalCount||0)+1}`}submitForm(){this.saveInProgress||(this.isSavingChange.emit(!0),this.isEditing?this.editInvoice():this.createInvoice())}editInvoice(){const e=this.invoice.clientId!==this.form.value.clientId;this.invoice.currency=this.form.value.currency,this.invoice.number=this.form.value.number,this.invoice.issuedDate=this.form.value.issuedDate,this.invoice.dueDate=this.form.value.dueDate,this.invoice.clientId=this.form.value.clientId,this.invoiceService.editInvoice(this.invoice,e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isSavingChange.emit(!1),this.onSave.emit(e)},()=>{this.isSavingChange.emit(!1)})}createInvoice(){const e=di.a.getLabelOf(this.clients,this.form.value.clientId);this.invoiceService.createInvoice(this.form.value).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{t.clientName=e,t.status=gi.a.UNSENT,this.isSavingChange.emit(!1),this.onSave.emit(t)},()=>{this.isSavingChange.emit(!1)})}closeModal(){this.onClose.emit(!1)}onClientSelect(e){this.form.patchValue({clientId:e}),e?(this.clientName=this.clients.find(t=>t.value===e).label,this.clients=this.clients.filter(e=>!!e.value)):this.clientName=""}onIssuedDateChange({date:e}){this.form.patchValue({issuedDate:e}),this.updateDueDate()}onDueDateChange({label:e,date:t}){if(Se(t).isBefore(Se(this.form.value.issuedDate)))return console.warn("*** Due date is before issue date ***"),void this.dueDateComponent.applyDate(this.form.value.dueDate);this.dueDateLabel=e,this.form.patchValue({dueDate:t})}fetchClients(){if(this.clientsReachedLimit)return;const e={name:this.clientQuery.name,status:this.clientQuery.status,page:this.clientQuery.page,limit:this.clientQuery.limit};this.clientService.getClientList(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{1===e.page&&(this.clients=[]),this.clientsReachedLimit=t.length<ei.j,this.clients=[...this.clients,...t.map(e=>new di.a(e.id,e.name))],this.clientQuery.page++,this.cd.markForCheck(),this.dropdownItems&&this.dropdownItems.triggerDetection()})}updateDueDate(){if(this.dueDateLabel){const e=this.form.value.issuedDate;if(this.dueDateLabel===an.a.AFTER_10){const t=Se.utc(e).add(10,"days").toISOString();this.onDueDateChange({label:this.dueDateLabel,date:t})}else if(this.dueDateLabel===an.a.AFTER_15){const t=Se.utc(e).add(15,"days").toISOString();this.onDueDateChange({label:this.dueDateLabel,date:t})}else if(this.dueDateLabel===an.a.AFTER_30){const t=Se.utc(e).add(30,"days").toISOString();this.onDueDateChange({label:this.dueDateLabel,date:t})}else if(this.dueDateLabel===an.a.AFTER_60){const t=Se.utc(e).add(60,"days").toISOString();this.onDueDateChange({label:this.dueDateLabel,date:t})}else if(this.dueDateLabel===an.a.AFTER_90){const t=Se.utc(e).add(90,"days").toISOString();this.onDueDateChange({label:this.dueDateLabel,date:t})}else if(this.dueDateLabel===an.a.UPON_RECEIPT){const t=Se.utc(e).toISOString();this.onDueDateChange({label:this.dueDateLabel,date:t})}}else Se(this.form.value.dueDate).isBefore(Se(this.form.value.issuedDate))&&this.onDueDateChange({label:an.a.UPON_RECEIPT,date:this.form.value.issuedDate})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(rn.a),c.Rb(p.f),c.Rb(ki),c.Rb(c.h),c.Rb(W.c))},e.\u0275cmp=c.Lb({type:e,selectors:[["create-invoice"]],viewQuery:function(e,t){var i;1&e&&(c.ed(hn,!0),c.ed(mn,!0)),2&e&&(c.Kc(i=c.kc())&&(t.dropdownItems=i.first),c.Kc(i=c.kc())&&(t.dueDateComponent=i.first))},inputs:{invoice:"invoice",saveInProgress:"saveInProgress",totalCount:"totalCount",lastInvoiceId:"lastInvoiceId"},outputs:{onClose:"onClose",isSavingChange:"isSavingChange",onSave:"onSave"},decls:32,vars:12,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],["novalidate","",3,"formGroup","ngSubmit"],[1,"cl-modal-body"],["class","cl-form-row cl-mb-2",4,"ngIf"],[1,"cl-form-group"],["formControlName","currency","type","text","ngbAutofocus","","autocomplete","off",1,"cl-form-control"],["formControlName","number","type","text","autocomplete","off",1,"cl-form-control"],[1,"cl-form-row"],[1,"cl-col-sm-6"],[3,"isUtc","hideRanges","date","onDateSelect"],[3,"isUtc","minDate","referenceDay","date","onDateSelect"],["dueDateComponent",""],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-form-row","cl-mb-2"],[1,"cl-col-sm-12"],[3,"enableSearch","offlineSearch","filterOptions","filterQuery","placeholder","title","list","itemLabel","value","type","onOpen","loadMore","onFilterOptionChange","onChanged"],["dropdown",""]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.closeModal()})),c.Xb(4,"span"),c.Sb(5,"img",3),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"form",4),c.jc("ngSubmit",(function(){return t.submitForm()})),c.Xb(7,"div",5),c.Wc(8,gn,4,10,"div",6),c.Xb(9,"div",7),c.Xb(10,"label"),c.Yc(11,"Currency"),c.Wb(),c.Sb(12,"input",8),c.Wb(),c.Xb(13,"div",7),c.Xb(14,"label"),c.Yc(15,"Invoice ID"),c.Wb(),c.Sb(16,"input",9),c.Wb(),c.Xb(17,"div",10),c.Xb(18,"div",11),c.Xb(19,"label"),c.Yc(20,"Issue date"),c.Wb(),c.Xb(21,"datepicker-single-with-list",12),c.jc("onDateSelect",(function(e){return t.onIssuedDateChange(e)})),c.Wb(),c.Wb(),c.Xb(22,"div",11),c.Xb(23,"label"),c.Yc(24,"Due date"),c.Wb(),c.Xb(25,"datepicker-single-with-list",13,14),c.jc("onDateSelect",(function(e){return t.onDueDateChange(e)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(27,"div",15),c.Xb(28,"a",16),c.jc("click",(function(){return t.closeModal()})),c.Yc(29,"Cancel"),c.Wb(),c.Xb(30,"button",17),c.Yc(31),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(2),c.ad("",t.isEditing?"Edit":"Create"," invoice"),c.Cb(4),c.wc("formGroup",t.form),c.Cb(2),c.wc("ngIf",!t.isEditing||t.clientWasDeleted),c.Cb(13),c.wc("isUtc",!0)("hideRanges",!0)("date",t.form.value.issuedDate),c.Cb(4),c.wc("isUtc",!0)("minDate",t.form.value.issuedDate)("referenceDay",t.form.value.issuedDate)("date",t.form.value.dueDate),c.Cb(5),c.wc("disabled",t.saveInProgress||t.form.invalid),c.Cb(1),c.ad(" ",t.isEditing?"Edit":"Create"," "))},directives:[p.I,p.t,p.k,s.u,p.c,p.s,p.i,un,pn.a],encapsulation:2}),e})();function vn(e,t){if(1&e&&c.Sb(0,"message-entries",16),2&e){const e=c.nc();c.wc("title","No invoices yet")("subtitle",e.subtitle)("imagePath","assets/images/no_results_illustration.svg")("isError",e.isError)("loadInProgress",e.loadInProgress)}}function wn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"tr",25),c.jc("onDelete",(function(i){c.Oc(e);const n=t.index;return c.nc(2).removeInvoice(i,n)})),c.Wb()}if(2&e){const e=t.$implicit,i=c.nc(2);c.wc("invoice",e)("isDesktop",i.isDesktop)("labels",i.labels)("expandAll",i.expandAll)}}function yn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"pager",26),c.jc("pageChanged",(function(t){return c.Oc(e),c.nc(2).onPaginationChange(t)}))("limitChanged",(function(t){return c.Oc(e),c.nc(2).onPaginationChange(t)})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("page",e.page)("limit",e.pageSize)("total",e.totalCount)}}function Wn(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",17),c.Xb(2,"div",18),c.Xb(3,"span",19),c.Yc(4,"Invoices"),c.Wb(),c.Wb(),c.Wb(),c.Xb(5,"table",20),c.Xb(6,"thead"),c.Xb(7,"tr",21),c.jc("onExpandAll",(function(t){return c.Oc(e),c.nc().expandAllRows(t)})),c.Wb(),c.Wb(),c.Xb(8,"tbody"),c.Wc(9,wn,1,4,"tr",22),c.Wb(),c.Wb(),c.Xb(10,"div",23),c.Wc(11,yn,1,3,"pager",24),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(7),c.wc("isDesktop",e.isDesktop)("labels",e.labels),c.Cb(2),c.wc("ngForOf",e.invoices),c.Cb(2),c.wc("ngIf",e.totalCount>e.pageSize||e.pageSize>50)}}function Cn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"create-invoice",27),c.jc("isSavingChange",(function(t){return c.Oc(e),c.nc().createInProgress=t}))("onSave",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().onInvoiceCreate(i),n.close()}))("onClose",(function(i){c.Oc(e);const n=t.$implicit;return!c.nc().createInProgress&&n.close(i)})),c.Wb()}if(2&e){const e=c.nc();c.wc("saveInProgress",e.createInProgress)("totalCount",e.totalCountPlaceholder)("lastInvoiceId",e.lastInvoiceId)}}let kn=(()=>{class e{constructor(e,t,i,n,s,c,r,o){this.cd=e,this.modalService=t,this.activatedRoute=i,this.browserService=n,this.invoiceService=s,this.uiSettingsService=c,this.router=r,this.workspaceService=o,this.fetchDataDebouncer$=new Ee.a,this.unsubscribe$=new mi.a}ngOnInit(){var e;const t=(null===(e=this.workspaceService.getLocalDefaultWorkspace().projectGroupingLabel)||void 0===e?void 0:e.toLowerCase())||"client";this.labels=["Invoice Id",t,"Due on","Amount","Status","Edit"],this.initParams(),this.fetchData(),this.setBrowserWidth(),this.subscribeToChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}get subtitle(){return this.statuses.length<3?`Your ${this.statuses.map(e=>e.toLowerCase()).join(" and ")} invoices will show up here.`:"All your invoices will show up here."}subscribeToChanges(){this.fetchDataDebouncer$.pipe(Object(Te.a)(400),Object(De.a)(this.unsubscribe$)).subscribe(()=>this.fetchData())}initParams(){const e=this.activatedRoute.snapshot.queryParams||{},t=this.uiSettingsService.getSettings(hi.b.INVOICE_PARAMS)||{};this.page=Number(e.page)||1,this.pageSize=Number(e.pageSize)||Number(t.pageSize)||ei.j;let i=e.statuses||t.statuses||[];i=Array.isArray(i)?i:[i],i=i.filter(e=>!!gi.a[e]),this.statuses=i.length?i:[gi.a.PAID,gi.a.SENT,gi.a.UNSENT,gi.a.VOID],this.statusesCheckboxList=this.generateStatusesCheckboxes()}generateStatusesCheckboxes(){const e=[];for(const t in gi.a){const i=this.statuses.includes(gi.a[t]),n=new di.a(i,t,"Show "+t.toLowerCase());e.push(n)}return e}onStatusChange(e){this.statusesCheckboxList=e,this.statuses=[gi.a.PAID,gi.a.SENT,gi.a.UNSENT,gi.a.VOID].filter(e=>!!di.a.getValueOf(this.statusesCheckboxList,e)),this.setLocalStorageAndUrl(),this.fetchData()}expandAllRows(e){this.expandAll=e,this.cd.detectChanges()}openCreateModal(e){this.modalService.open(e,{beforeDismiss:()=>!this.createInProgress,centered:!0})}openInvoiceSettings(){this.router.navigate(["invoices/settings"])}onPaginationChange(e){this.page=e.page||this.page,this.pageSize=e.limit||this.pageSize,this.setLocalStorageAndUrl(),this.fetchDataDebouncer$.next()}setLocalStorageAndUrl(){const e={page:this.page,pageSize:this.pageSize,statuses:this.statuses};this.uiSettingsService.setSettings(hi.b.INVOICE_PARAMS,e);const t=this.router.createUrlTree([],{queryParams:e}),i=this.router.serializeUrl(t);this.router.navigateByUrl(i)}removeInvoice(e,t){this.invoices.splice(t,1)}fetchData(){const e={page:this.page,pageSize:this.pageSize,statuses:this.statuses};this.loadInProgress=!0,this.invoiceService.getInvoices(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(({invoices:e,count:t})=>{var i;e.length||1==this.page||this.onPaginationChange({page:1}),this.invoices=e,this.totalCount=t,this.totalCountPlaceholder=t,this.lastInvoiceId=null===(i=e[e.length-1])||void 0===i?void 0:i.number,this.isError=!1,this.loadInProgress=!1,this.cd.detectChanges()},()=>{this.isError=!0,this.loadInProgress=!1,this.cd.markForCheck()})}onInvoiceCreate(e){this.invoices.unshift(e),this.totalCountPlaceholder++,this.lastInvoiceId=e.number,this.router.navigate(["/invoices",e.id])}setBrowserWidth(){this.browserService.isBreakpointLg$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.h),c.Rb(g.q),c.Rb(W.a),c.Rb(pi.a),c.Rb(ki),c.Rb(hi.a),c.Rb(W.c),c.Rb(U.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["invoice-list"]],decls:21,vars:6,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center"],[1,"cl-col-md-6","cl-mb-3","cl-mb-md-0"],[1,"cl-col-md-6"],[1,"cl-d-print-none","cl-d-flex","cl-flex-row","cl-justify-content-md-end"],[3,"list","showPlaceholder","titlePrefix","titleSufix","onChange"],[1,"cl-d-flex","cl-align-items-center","cl-padding"],[1,"cl-btn","cl-btn-outline-light",3,"click"],["src","assets/nav-icons/settings.svg"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end"],[1,"cl-btn","cl-btn-primary",3,"click"],["noInvoicesTemplate",""],[4,"ngIf","ngIfElse"],["newInvoiceListModal",""],[3,"title","subtitle","imagePath","isError","loadInProgress"],[1,"cl-card","cl-border-bottom-0","cl-mb-0","cl-d-print-none"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-invoice-list-table","cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6"],["invoice-table-header","",3,"isDesktop","labels","onExpandAll"],["invoice-table-row","",3,"invoice","isDesktop","labels","expandAll","onDelete",4,"ngFor","ngForOf"],[1,"cl-mt-3"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],["invoice-table-row","",3,"invoice","isDesktop","labels","expandAll","onDelete"],[3,"page","limit","total","pageChanged","limitChanged"],[3,"saveInProgress","totalCount","lastInvoiceId","isSavingChange","onSave","onClose"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"main",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"h1"),c.Yc(6,"Invoices"),c.Wb(),c.Wb(),c.Xb(7,"div",5),c.Xb(8,"div",6),c.Xb(9,"dropdown-checkbox-list",7),c.jc("onChange",(function(e){return t.onStatusChange(e)})),c.Wb(),c.Xb(10,"div",8),c.Xb(11,"button",9),c.jc("click",(function(){return t.openInvoiceSettings()})),c.Sb(12,"img",10),c.Wb(),c.Wb(),c.Xb(13,"div",11),c.Xb(14,"button",12),c.jc("click",(function(){c.Oc(e);const i=c.Lc(20);return t.openCreateModal(i)})),c.Yc(15," Create invoice "),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(16,vn,1,5,"ng-template",null,13,c.Xc),c.Wc(18,Wn,12,4,"ng-container",14),c.Wb(),c.Wb(),c.Wc(19,Cn,1,3,"ng-template",null,15,c.Xc)}if(2&e){const e=c.Lc(17);c.Cb(9),c.wc("list",t.statusesCheckboxList)("showPlaceholder",!0)("titlePrefix","Show")("titleSufix","invoices"),c.Cb(9),c.wc("ngIf",null==t.invoices?null:t.invoices.length)("ngIfElse",e)}},directives:[Di,s.u,Pi,Li,s.t,sn,cn.a,fn],encapsulation:2,changeDetection:0}),e})(),Sn=(()=>{class e{constructor(e,t){this.element=e,this.model=t,this.decimals=2,this.maxNumber=21474836,this.minNumber=0,this.inputChange=new c.n}get hasDecimals(){return!!this.decimals}onInput(e){let t;this.minNumber<0&&e.startsWith("-")&&(t=!0),e=(e=e.replace(/,/g,".")).replace(this.hasDecimals?/[^0-9.]/g:/[^0-9]/g,""),t&&(e="-"+e);const i=e.indexOf(".");if(-1!=i){const t=(e=e.substring(0,i+this.decimals+1)).lastIndexOf(".");i!=t&&(e=e.substring(0,t))}e&&Object(Pt.u)(e)&&Number(e)>this.maxNumber&&(e=e.substring(0,e.length-1)),this.writeValue(e)}onChange(){let e=this.element.nativeElement.value||"0";if(!this.isValid(e))return void this.writeValue(this.ngModel);const t=Number(e);Number(e)%1!=0&&(e=this.hasDecimals?Number(e).toString():Math.floor(t).toString());const i=Number(e);this.emitOnChange(i)}writeValue(e){this.model.valueAccessor.writeValue(e)}emitOnChange(e){e||this.writeValue(this.hasDecimals?"0.00":"0"),Number(this.ngModel)!==Number(e)&&this.inputChange.emit(e)}isValid(e){if(!Object(Pt.u)(e))return!1;const t=Number(e);return!(t<this.minNumber||t>this.maxNumber)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.l),c.Rb(p.v))},e.\u0275dir=c.Mb({type:e,selectors:[["","numericInput",""]],hostBindings:function(e,t){1&e&&c.jc("input",(function(e){return t.onInput(e.target.value)}))("change",(function(){return t.onChange()}))},inputs:{decimals:"decimals",maxNumber:"maxNumber",minNumber:"minNumber",ngModel:"ngModel"},outputs:{inputChange:"inputChange"}}),e})();function In(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",17),c.Xb(1,"div",18),c.Xb(2,"div",19),c.Yc(3,"Are you sure?"),c.Wb(),c.Xb(4,"button",20),c.jc("click",(function(){return c.Oc(e),c.nc(2).onDelete.emit()})),c.Yc(5," Delete "),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(4),c.wc("disabled",e.disableEdit)}}function On(e,t){if(1&e&&(c.Xb(0,"td",12),c.Xb(1,"div",13),c.Xb(2,"button",14),c.Sb(3,"img",15),c.Wb(),c.Wc(4,In,6,1,"div",16),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("dropdownKey",e.disableEdit)}}let Xn=(()=>{class e{constructor(e,t,i){this.loader=e,this.cd=t,this.invoiceService=i,this.onDelete=new c.n,this.debouncer$=new Ee.a,this.unsubscribe$=new mi.a}set invoiceItem(e){this._invoiceItem=e,this.invoiceBackup=fi.clone(e)}get invoiceItem(){return this._invoiceItem}ngOnInit(){this.debouncer$.pipe(Object(Te.a)(100),Object(De.a)(this.unsubscribe$)).subscribe(()=>{"blur"===this.eventType&&this.editInvoiceItem()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete(),this.editInvoiceItem()}onEvent(e){this.eventType=e,this.debouncer$.next()}editInvoiceItem(){fi.areSame(this.invoiceBackup,this.invoiceItem)||this.invoiceService.editInvoiceItem(this.invoiceId,this.invoiceItem).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{const t=this.invoiceItem.order,i=e.items.find(e=>e.order===t);this.invoiceItem.amount=i.amount,this.invoiceBackup=fi.clone(this.invoiceItem),this.cd.markForCheck()},e=>{})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(wi.a),c.Rb(c.h),c.Rb(ki))},e.\u0275cmp=c.Lb({type:e,selectors:[["invoice-items-row"],["","invoice-items-row",""]],inputs:{invoiceItem:"invoiceItem",invoiceId:"invoiceId",disableEdit:"disableEdit"},outputs:{onDelete:"onDelete"},decls:20,vars:18,consts:[[1,"cl-p-0","cl-py-lg-2"],[1,"cl-component-divided-left","cl-no-divider-border","cl-d-flex"],["type","text","placeholder","Enter item description",1,"cl-form-control","cl-style-disabled-inputs","cl-invoice-item-input",3,"disabled","ngModel","blur","focus","ngModelChange"],[1,"cl-component-divided-left","cl-d-flex","cl-align-self-end"],["type","text","numericInput","",1,"cl-form-control","cl-text-right","cl-style-disabled-inputs","cl-invoice-item-input",3,"disabled","minNumber","ngModel","keyup.enter","inputChange","blur","focus"],["quantityInput",""],[1,"cl-component-divided-left","cl-d-flex"],["unitPriceInput",""],[1,"cl-p-0","cl-py-lg-2","cl-text-right"],[1,"cl-component-divided-left","cl-d-flex","cl-text-right"],[1,"cl-w-100"],["class","cl-px-0 cl-relative","style","overflow: visible;",4,"ngIf"],[1,"cl-px-0","cl-relative",2,"overflow","visible"],[1,"cl-relative",3,"dropdownKey"],["dropdownKeyButton","",1,"cl-component-divided-left","cl-d-flex"],["src","assets/images/ui-icons/close.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-d-flex","cl-align-items-center","cl-px-3","cl-py-2"],[1,"cl-cut-text","cl-mr-3"],["tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled","click"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"td",0),c.Xb(1,"div",1),c.Xb(2,"input",2),c.jc("blur",(function(){return t.onEvent("blur")}))("focus",(function(){return t.onEvent("focus")}))("ngModelChange",(function(e){return t.invoiceItem.description=e})),c.Wb(),c.Wb(),c.Wb(),c.Xb(3,"td",0),c.Xb(4,"div",3),c.Xb(5,"input",4,5),c.jc("keyup.enter",(function(){return c.Oc(e),c.Lc(6).blur()}))("inputChange",(function(e){return t.invoiceItem.quantity=e}))("blur",(function(){return t.onEvent("blur")}))("focus",(function(){return t.onEvent("focus")})),c.oc(7,"roundIfWholeNumber"),c.Wb(),c.Wb(),c.Wb(),c.Xb(8,"td",0),c.Xb(9,"div",6),c.Xb(10,"input",4,7),c.jc("keyup.enter",(function(){return c.Oc(e),c.Lc(11).blur()}))("inputChange",(function(e){return t.invoiceItem.unitPrice=e}))("blur",(function(){return t.onEvent("blur")}))("focus",(function(){return t.onEvent("focus")})),c.oc(12,"roundIfWholeNumber"),c.Wb(),c.Wb(),c.Wb(),c.Xb(13,"td",8),c.Xb(14,"div",9),c.Xb(15,"span",10),c.Yc(16),c.oc(17,"roundIfWholeNumber"),c.oc(18,"centsToDollars"),c.Wb(),c.Wb(),c.Wb(),c.Wc(19,On,5,1,"td",11)}2&e&&(c.Cb(2),c.wc("disabled",t.disableEdit)("ngModel",t.invoiceItem.description),c.Cb(3),c.wc("disabled",t.disableEdit)("minNumber",-21474836)("ngModel",c.pc(7,10,t.invoiceItem.quantity)),c.Cb(5),c.wc("disabled",t.disableEdit)("minNumber",-21474836)("ngModel",c.pc(12,12,t.invoiceItem.unitPrice)),c.Cb(6),c.ad(" ",c.pc(17,14,c.pc(18,16,t.invoiceItem.amount))," "),c.Cb(3),c.wc("ngIf",!t.disableEdit))},directives:[p.c,p.s,p.v,Sn,s.u,Si.a,Ii.a,Oi.a],pipes:[_i.a,Gi.a],encapsulation:2,changeDetection:0}),e})();function En(e,t){1&e&&c.Sb(0,"th",10)}function Tn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"tr",11),c.jc("onDelete",(function(){c.Oc(e);const i=t.$implicit;return c.nc().deleteItem(i)})),c.Wb()}if(2&e){const e=t.$implicit,i=c.nc();c.wc("invoiceItem",e)("disableEdit",i.disableEdit)("invoiceId",i.invoiceId)}}let Dn=(()=>{class e{constructor(e,t,i){this.loader=e,this.cd=t,this.invoiceService=i,this.unsubscribe$=new Ee.a}ngOnInit(){}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}deleteItem(e){this.loader.showBarAndDisable(),this.invoiceService.deleteInvoiceItem(this.invoiceId,e.order).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.loader.hide(),this.cd.markForCheck()},()=>this.loader.hide())}addNewItem(){this.loader.showBarAndDisable(),this.invoiceService.createInvoiceItem(this.invoiceId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.invoiceItems.push(e),this.loader.hide(),this.cd.detectChanges()},()=>this.loader.hide())}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(wi.a),c.Rb(c.h),c.Rb(ki))},e.\u0275cmp=c.Lb({type:e,selectors:[["invoice-items-table"]],inputs:{disableEdit:"disableEdit",invoiceItems:"invoiceItems",invoiceId:"invoiceId"},decls:23,vars:2,consts:[[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-table-responsive",2,"overflow","visible"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6"],[1,"cl-pl-lg-3"],[1,"cl-h5"],[1,"cl-pr-lg-3","cl-text-right",2,"width","150px"],["style","width: 46px;",4,"ngIf"],["invoice-items-row","",3,"invoiceItem","disableEdit","invoiceId","onDelete",4,"ngFor","ngForOf"],[2,"width","46px"],["invoice-items-row","",3,"invoiceItem","disableEdit","invoiceId","onDelete"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"span",2),c.Yc(3,"Invoice items"),c.Wb(),c.Wb(),c.Wb(),c.Xb(4,"div",3),c.Xb(5,"table",4),c.Xb(6,"thead"),c.Xb(7,"tr"),c.Xb(8,"th",5),c.Xb(9,"span",6),c.Yc(10,"Description"),c.Wb(),c.Wb(),c.Xb(11,"th",7),c.Xb(12,"span",6),c.Yc(13,"Quantity"),c.Wb(),c.Wb(),c.Xb(14,"th",7),c.Xb(15,"span",6),c.Yc(16,"Unit price"),c.Wb(),c.Wb(),c.Xb(17,"th",7),c.Xb(18,"span",6),c.Yc(19,"Amount"),c.Wb(),c.Wb(),c.Wc(20,En,1,0,"th",8),c.Wb(),c.Wb(),c.Xb(21,"tbody"),c.Wc(22,Tn,1,3,"tr",9),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(20),c.wc("ngIf",!t.disableEdit),c.Cb(2),c.wc("ngForOf",t.invoiceItems))},directives:[s.u,s.t,Xn],encapsulation:2,changeDetection:0}),e})();class Rn{constructor(e){this._round=e&&e.round,this._minutes=e&&e.minutes}get round(){return this._round}set round(e){this._round=e}get minutes(){return this._minutes}set minutes(e){this._minutes=e}}var An=i("rf9C"),jn=i("/DYx");const xn=function(){return{standalone:!0}};function Pn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",24),c.Xb(1,"input",25),c.jc("ngModelChange",(function(i){c.Oc(e);const n=t.$implicit;return c.nc(2).modelChanged(i,n.value)})),c.Wb(),c.Xb(2,"label",26),c.Yc(3),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit,i=c.nc(2);c.Cb(1),c.yc("id","timeEntryDetails_",e.value,""),c.yc("name","timeEntryDetails_",e.value,""),c.wc("ngModel",i.form.value.fieldsForDetailed.includes(e.value))("ngModelOptions",c.Ac(6,xn)),c.Cb(1),c.yc("for","timeEntryDetails_",e.value,""),c.Cb(1),c.Zc(e.label)}}function Mn(e,t){if(1&e&&(c.Xb(0,"div",21),c.Xb(1,"span",22),c.Yc(2," Time entry details "),c.Wb(),c.Wc(3,Pn,4,7,"div",23),c.Wb()),2&e){const e=c.nc();c.Cb(3),c.wc("ngForOf",e.timEntryDetailsCheckboxes)}}let Yn=(()=>{class e{constructor(e,t,i,n){this.formBuilder=e,this.invoiceService=t,this.router=i,this.loader=n,this.onClose=new c.n,this.isSavingChange=new c.n,this.onImport=new c.n,this.InvoiceGroupEntries=Wi,this.groupEntriesList=[new di.a(Wi.PROJECT,"By project (combine all hours for one project into one line)"),new di.a(Wi.TASK,"By task (combine all hours for one task into one line)"),new di.a(Wi.SINGLE_ITEM,"Single item (combine all hours into one line)"),new di.a(Wi.DETAILED,"Detailed (list each time entry as one line)")],this.timEntryDetailsCheckboxes=[{label:"Project",value:"PROJECT"},{label:"Task",value:"TASK"},{label:"Description",value:"DESCRIPTION"},{label:"Tags",value:"TAGS"},{label:"Date",value:"DATE"}],this.optionsTime=[new di.a("1","1 minute"),new di.a("5","5 minutes"),new di.a("6","6 minutes"),new di.a("10","10 minutes"),new di.a("12","12 minutes"),new di.a("15","15 minutes"),new di.a("30","30 minutes"),new di.a("60","1 hour"),new di.a("240","4 hours")],this.projectFilterOptions=dn.p,this.ReportFilter=dn.h,this.projectValuesData=new ti.a,this.unsubscribe$=new Ee.a}ngOnInit(){this.dateRange={start:Se.utc().subtract(1,"month").startOf("month"),end:Se.utc().subtract(1,"month").endOf("month")},this.form=this.formBuilder.group({projectsFilter:[null,[p.G.required]],from:[this.dateRange.start.toISOString(),[p.G.required]],to:[this.dateRange.end.toISOString(),[p.G.required]],groupEntries:[Wi.PROJECT,[p.G.required]],roundEntries:!1,fieldsForDetailed:[["PROJECT","TASK","DESCRIPTION","TAGS","DATE"],[]]}),this.clientFilter={contains:dn.d.CONTAINS,ids:[this.clientId]},this.clientId||console.error("Import time: missing clientId"),this.setRoundingMinutes()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}onProjectChange(e){this.form.patchValue({projectsFilter:e.isDirty()?e.getContainsFilter(dn.h.PROJECTS):null})}updateDateRange({dateRange:e}){this.form.patchValue({from:e.start.toISOString(),to:e.end.toISOString()})}onGroupEntriesSelect(e){this.form.patchValue({groupEntries:e}),this.groupEntriesList=this.groupEntriesList.filter(e=>!!e.value)}updateRoundEntryDuration(e){this.form.patchValue({roundEntries:e.checked})}modelChanged(e,t){let i=[...this.form.value.fieldsForDetailed];e?i.push(t):i=i.filter(e=>e!==t),this.form.patchValue({fieldsForDetailed:i})}submitForm(){setTimeout(()=>{this.saveInProgress||this.form.invalid||(this.isSavingChange.emit(!0),this.loader.show(),this.invoiceService.importTime(this.form.value,this.invoiceId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isSavingChange.emit(!1),this.loader.hide(),this.onImport.emit(e)},()=>{this.loader.hide(),this.isSavingChange.emit(!1)}))})}closeModal(){this.onClose.emit(!1)}setRoundingMinutes(){try{const e=this.roundSetting.minutes;this.roundingMinutes=this.optionsTime.filter(t=>t.value===e)[0].label}catch(e){}}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(p.f),c.Rb(ki),c.Rb(W.c),c.Rb(wi.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["import-invoice-time"]],inputs:{saveInProgress:"saveInProgress",invoiceId:"invoiceId",clientId:"clientId",roundSetting:"roundSetting"},outputs:{onClose:"onClose",isSavingChange:"isSavingChange",onImport:"onImport"},decls:33,vars:18,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],["novalidate","",3,"formGroup","ngSubmit"],[1,"cl-modal-body"],["ngbAutofocus","","tabindex","0",1,"cl-no-outline",2,"width","0","height","0"],[1,"cl-form-group","cl-mb-3"],[1,"cl-mb-1","cl-d-inline-block"],[3,"type","title","filterName","placeholder","constrainContainsFilter","valuesData","filterOptions","onChange"],[1,"cl-form-group","cl-mb-0"],[1,"cl-w-100",2,"margin-left","5px","margin-right","5px",3,"timeEntriesDateRange","removeArrows","dateRangeOut"],[1,"cl-dropdown-full-width",3,"title","list","value","type","onChanged"],["class","cl-form-group",4,"ngIf"],[1,"cl-custom-control","cl-custom-switch","cl-form-group"],["type","checkbox","name","roundEntries","id","roundEntries",1,"cl-custom-control-input",3,"change"],["for","roundEntries",1,"cl-custom-control-label"],["tabindex","0",1,"cl-no-outline",2,"width","0","height","0"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-form-group"],[1,"cl-mb-1","cl-d-block"],["class","cl-custom-control cl-custom-checkbox cl-custom-control-inline",4,"ngFor","ngForOf"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox",1,"cl-custom-control-input",3,"id","ngModel","ngModelOptions","name","ngModelChange"],[1,"cl-custom-control-label",3,"for"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2,"Import time"),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.closeModal()})),c.Xb(4,"span"),c.Sb(5,"img",3),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"form",4),c.jc("ngSubmit",(function(){return t.submitForm()})),c.Xb(7,"div",5),c.Sb(8,"span",6),c.Xb(9,"div",7),c.Xb(10,"span",8),c.Yc(11,"Import uninvoiced billable time from"),c.Wb(),c.Xb(12,"dropdown-checkbox-wrapper",9),c.jc("onChange",(function(e){return t.onProjectChange(e)})),c.Wb(),c.Wb(),c.Xb(13,"div",10),c.Xb(14,"span",8),c.Yc(15,"Date range"),c.Wb(),c.Xb(16,"datepicker-range",11),c.jc("dateRangeOut",(function(e){return t.updateDateRange(e)})),c.Wb(),c.Wb(),c.Xb(17,"div",7),c.Xb(18,"dropdown-items",12),c.jc("onChanged",(function(e){return t.onGroupEntriesSelect(e)})),c.Wb(),c.Wb(),c.Wc(19,Mn,4,1,"div",13),c.Xb(20,"div",7),c.Xb(21,"span",8),c.Yc(22,"Time rounding"),c.Wb(),c.Xb(23,"div",14),c.Xb(24,"input",15),c.jc("change",(function(e){return t.updateRoundEntryDuration(e.target)})),c.Wb(),c.Xb(25,"label",16),c.Yc(26),c.Wb(),c.Wb(),c.Wb(),c.Sb(27,"span",17),c.Wb(),c.Xb(28,"div",18),c.Xb(29,"a",19),c.jc("click",(function(){return t.closeModal()})),c.Yc(30,"Cancel"),c.Wb(),c.Xb(31,"button",20),c.Yc(32," Import "),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(6),c.wc("formGroup",t.form),c.Cb(6),c.wc("type",t.ReportFilter.PROJECTS)("title","Select projects")("filterName","projects")("placeholder","Find projects...")("constrainContainsFilter",t.clientFilter)("valuesData",t.projectValuesData)("filterOptions",t.projectFilterOptions),c.Cb(4),c.wc("timeEntriesDateRange",t.dateRange)("removeArrows",!0),c.Cb(2),c.wc("title","Group hours")("list",t.groupEntriesList)("value",t.form.value.groupEntries)("type","STANDARD"),c.Cb(1),c.wc("ngIf",t.form.value.groupEntries===t.InvoiceGroupEntries.DETAILED),c.Cb(7),c.bd(" ",t.roundSetting.round," ",t.roundingMinutes," "),c.Cb(5),c.wc("disabled",t.saveInProgress||t.form.invalid))},directives:[p.I,p.t,p.k,An.a,jn.a,pn.a,s.u,s.t,p.a,p.s,p.v],encapsulation:2}),e})(),Ln=(()=>{class e{constructor(e){this.formBuilder=e,this.clientLabel="",this.onEdit=new c.n,this.onClose=new c.n}ngOnInit(){this.initName=this.item.name,this.initAddress=this.item.address,this.form=this.formBuilder.group({name:[this.initName,[on.a.required]],address:[this.initAddress,[]]})}get areSame(){const e=this.form.value.name,t=this.form.value.address;return this.initName.trim()===e.trim()&&this.initAddress.trim()===(null==t?void 0:t.trim())}editValue(){var e;this.onEdit.emit({name:this.form.value.name.trim(),address:null===(e=this.form.value.address)||void 0===e?void 0:e.trim()})}closeEditModalWindow(){this.onClose.emit(!1)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(p.f))},e.\u0275cmp=c.Lb({type:e,selectors:[["edit-client-modal"]],inputs:{title:"title",item:"item",clientLabel:"clientLabel"},outputs:{onEdit:"onEdit",onClose:"onClose"},decls:26,vars:5,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[3,"formGroup","ngSubmit"],[1,"cl-modal-body"],[1,"cl-form-group"],["for","editClientName"],[1,"cl-text-capitalize"],["id","editClientName","formControlName","name","type","text","ngbAutofocus","","preventMultipleSpaces","","autocomplete","off",1,"cl-form-control"],["for","editClientAddress"],["placeholder","Enter address","id","editClientAddress","formControlName","address","type","text","cols","30","rows","5","autocomplete","off",1,"cl-form-control"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.closeEditModalWindow()})),c.Xb(4,"span"),c.Sb(5,"img",3),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"form",4),c.jc("ngSubmit",(function(){return t.editValue()})),c.Xb(7,"div",5),c.Xb(8,"div",6),c.Xb(9,"label",7),c.Xb(10,"span",8),c.Yc(11),c.Wb(),c.Yc(12," name "),c.Wb(),c.Sb(13,"input",9),c.Wb(),c.Xb(14,"div",6),c.Xb(15,"label",10),c.Xb(16,"span",8),c.Yc(17),c.Wb(),c.Yc(18," address "),c.Wb(),c.Xb(19,"textarea",11),c.Yc(20,"      "),c.Wb(),c.Wb(),c.Wb(),c.Xb(21,"div",12),c.Xb(22,"a",13),c.jc("click",(function(){return t.closeEditModalWindow()})),c.Yc(23,"Cancel"),c.Wb(),c.Xb(24,"button",14),c.Yc(25,"Save"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(2),c.Zc(t.title),c.Cb(4),c.wc("formGroup",t.form),c.Cb(5),c.Zc(t.clientLabel),c.Cb(6),c.Zc(t.clientLabel),c.Cb(7),c.wc("disabled",t.form.invalid||t.areSame))},directives:[p.I,p.t,p.k,p.c,p.s,p.i],encapsulation:2}),e})();function Fn(e,t){if(1&e&&(c.Xb(0,"span",11),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.wc("ngClass","cl-badge-status-"+e.invoice.color),c.Cb(1),c.ad(" ",e.invoice.statusLabel," ")}}function Nn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",71),c.jc("keyup.enter",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).markAs(i)}))("keyup.space",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).markAs(i)}))("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).markAs(i)})),c.Yc(1),c.Wb()}if(2&e){const e=t.$implicit;c.Cb(1),c.ad(" Mark as ",e.toLowerCase()," ")}}function Un(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",68),c.Xb(1,"list-items"),c.Wc(2,Nn,2,1,"button",69),c.Xb(3,"button",70),c.jc("keyup.enter",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(13);return t.openBlockedModal(i)}))("keyup.space",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(13);return t.openBlockedModal(i)}))("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(13);return t.openBlockedModal(i)})),c.Yc(4," Edit "),c.Wb(),c.Xb(5,"button",71),c.jc("keyup.enter",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(11);return t.openModal(i)}))("keyup.space",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(11);return t.openModal(i)}))("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(11);return t.openModal(i)})),c.Yc(6," Delete "),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(2),c.wc("ngForOf",e.availableStatuses),c.Cb(1),c.wc("disabled",e.disableEdit)}}function $n(e,t){if(1&e&&c.Sb(0,"img",72),2&e){const e=c.nc(2);c.wc("src",e.workspace.image,c.Qc)}}function _n(e,t){if(1&e&&(c.Xb(0,"div",37),c.Xb(1,"strong"),c.Yc(2),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(2),c.Zc(e.clientData.name)}}function Gn(e,t){if(1&e&&(c.Xb(0,"div",38),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" ",e.clientData.address," ")}}function Bn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",75),c.jc("click",(function(){c.Oc(e);const t=c.nc(3),i=c.Lc(17);return t.fetchAndEditClient(i)})),c.Yc(1," Add address "),c.Wb()}if(2&e){const e=c.nc(3);c.wc("disabled",e.editInProgress)}}function Vn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",76),c.jc("click",(function(){c.Oc(e);const t=c.nc(3),i=c.Lc(13);return t.openBlockedModal(i)})),c.Yc(1),c.Wb()}if(2&e){const e=c.nc(3);c.Cb(1),c.ad(" Add ",e.clientLabel," ")}}function Hn(e,t){if(1&e&&(c.Vb(0),c.Wc(1,Bn,2,1,"button",73),c.Wc(2,Vn,2,1,"button",74),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngIf",e.invoice.clientId&&!e.clientData.address),c.Cb(1),c.wc("ngIf",!e.invoice.clientId)}}function zn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",77),c.jc("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(15);return t.openBlockedModal(i)})),c.Yc(1,"Import time"),c.Wb()}}function qn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",78),c.jc("click",(function(){return c.Oc(e),c.nc(),c.Lc(61).addNewItem()})),c.Sb(1,"img",79),c.Xb(2,"span",80),c.Yc(3,"Add new item"),c.Wb(),c.Wb()}}function Kn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",85),c.jc("click",(function(){c.Oc(e);const t=c.nc(3);return t.removeDiscount(),t.showDiscount=!1})),c.Yc(1,"Remove"),c.Wb()}}function Zn(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",81),c.Yc(2,"Discount (%)"),c.Wb(),c.Xb(3,"div"),c.Xb(4,"input",82,83),c.jc("keyup.enter",(function(){return c.Oc(e),c.Lc(5).blur()}))("inputChange",(function(t){c.Oc(e);const i=c.nc(2);return i.invoice.discount=t,i.modelChanged(),i.showDiscount=!0})),c.Wb(),c.Wb(),c.Wc(6,Kn,2,0,"button",84),c.Ub()}if(2&e){const e=c.nc(2);c.Cb(4),c.wc("disabled",e.disableEdit)("decimals",6)("ngModel",e.invoice.discount)("minNumber",-100)("maxNumber",100),c.Cb(2),c.wc("ngIf",!e.disableEdit)}}function Qn(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",87),c.jc("click",(function(){return c.Oc(e),c.nc(3).showDiscount=!0})),c.Yc(1,"Add discount"),c.Wb()}}function Jn(e,t){if(1&e&&c.Wc(0,Qn,2,0,"button",86),2&e){const e=c.nc(2);c.wc("ngIf",!e.disableEdit)}}function es(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",85),c.jc("click",(function(){c.Oc(e);const t=c.nc(3);return t.removeTax(),t.showTax=!1})),c.Yc(1,"Remove"),c.Wb()}}function ts(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",81),c.Yc(2,"Tax (%)"),c.Wb(),c.Xb(3,"div"),c.Xb(4,"input",88,89),c.jc("keyup.enter",(function(){return c.Oc(e),c.Lc(5).blur()}))("inputChange",(function(t){c.Oc(e);const i=c.nc(2);return i.invoice.tax=t,i.modelChanged(),i.showTax=!0})),c.Wb(),c.Wb(),c.Wc(6,es,2,0,"button",84),c.Ub()}if(2&e){const e=c.nc(2);c.Cb(4),c.wc("disabled",e.disableEdit)("decimals",6)("minNumber",-100)("maxNumber",100)("ngModel",e.invoice.tax),c.Cb(2),c.wc("ngIf",!e.disableEdit)}}function is(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",87),c.jc("click",(function(){return c.Oc(e),c.nc(3).showTax=!0})),c.Yc(1,"Add tax"),c.Wb()}}function ns(e,t){if(1&e&&c.Wc(0,is,2,0,"button",86),2&e){const e=c.nc(2);c.wc("ngIf",!e.disableEdit)}}function ss(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"button",87),c.jc("click",(function(){return c.Oc(e),c.nc(2).showTax2=!0})),c.Yc(2,"Add tax 2"),c.Wb(),c.Ub()}}function cs(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",85),c.jc("click",(function(){c.Oc(e);const t=c.nc(3);return t.removeTax2(),t.showTax2=!1})),c.Yc(1,"Remove"),c.Wb()}}function rs(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",81),c.Yc(2,"Tax 2 (%)"),c.Wb(),c.Xb(3,"div"),c.Xb(4,"input",88,89),c.jc("keyup.enter",(function(){return c.Oc(e),c.Lc(5).blur()}))("inputChange",(function(t){c.Oc(e);const i=c.nc(2);return i.invoice.tax2=t,i.modelChanged(),i.showTax2=!0})),c.Wb(),c.Wb(),c.Wc(6,cs,2,0,"button",84),c.Ub()}if(2&e){const e=c.nc(2);c.Cb(4),c.wc("disabled",e.disableEdit)("decimals",6)("minNumber",-100)("maxNumber",100)("ngModel",e.invoice.tax2),c.Cb(2),c.wc("ngIf",!e.disableEdit)}}function os(e,t){if(1&e&&(c.Xb(0,"div",61),c.Xb(1,"span",62),c.Yc(2,"Discount"),c.Wb(),c.Xb(3,"span"),c.Yc(4),c.oc(5,"roundIfWholeNumber"),c.oc(6,"centsToDollars"),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(4),c.bd("",c.pc(5,2,c.pc(6,4,e.invoice.discountAmount))," ",e.invoice.currency,"")}}function as(e,t){if(1&e&&(c.Xb(0,"div",61),c.Xb(1,"span",62),c.Yc(2,"Tax"),c.Wb(),c.Xb(3,"span"),c.Yc(4),c.oc(5,"roundIfWholeNumber"),c.oc(6,"centsToDollars"),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(4),c.bd("",c.pc(5,2,c.pc(6,4,e.invoice.taxAmount))," ",e.invoice.currency,"")}}function ls(e,t){if(1&e&&(c.Xb(0,"div",61),c.Xb(1,"span",62),c.Yc(2,"Tax 2"),c.Wb(),c.Xb(3,"span"),c.Yc(4),c.oc(5,"roundIfWholeNumber"),c.oc(6,"centsToDollars"),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(4),c.bd("",c.pc(5,2,c.pc(6,4,e.invoice.tax2Amount))," ",e.invoice.currency,"")}}function bs(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",12),c.Xb(1,"div",13),c.Xb(2,"div",14),c.Xb(3,"button",15,16),c.jc("click",(function(){c.Oc(e);const t=c.Lc(4);return c.nc().downloadPdf(),t.blur()})),c.Yc(5," Download PDF "),c.Wb(),c.Xb(6,"div",17),c.Xb(7,"a",18),c.Yc(8," Actions "),c.Wb(),c.Wc(9,Un,7,2,"div",19),c.Sb(10,"span",20,21),c.Wb(),c.Wb(),c.Xb(12,"div",22),c.Xb(13,"div",13),c.Xb(14,"div",23),c.Xb(15,"div"),c.Xb(16,"div",24),c.Xb(17,"strong"),c.Yc(18),c.Wb(),c.Wb(),c.Xb(19,"div",25),c.Yc(20),c.oc(21,"momentFormat"),c.Wb(),c.Xb(22,"div",25),c.Yc(23),c.oc(24,"momentFormat"),c.Wb(),c.Wb(),c.Xb(25,"div",26),c.Wc(26,$n,1,1,"img",27),c.Wb(),c.Wb(),c.Xb(27,"div",28),c.Xb(28,"div",29),c.Xb(29,"span",30),c.Yc(30,"Bill from:"),c.Wb(),c.Wb(),c.Xb(31,"div",31),c.Xb(32,"span",30),c.Yc(33,"Bill to:"),c.Wb(),c.Wb(),c.Wb(),c.Xb(34,"div",32),c.Xb(35,"div",33),c.Xb(36,"div",34),c.Xb(37,"div",35),c.Xb(38,"span",36),c.Yc(39,"Bill from:"),c.Wb(),c.Wb(),c.Xb(40,"div",37),c.Xb(41,"strong"),c.Yc(42),c.Wb(),c.Wb(),c.Xb(43,"div",38),c.Yc(44),c.Wb(),c.Wb(),c.Wb(),c.Xb(45,"div",39),c.Xb(46,"div",34),c.Xb(47,"div",35),c.Xb(48,"span",36),c.Yc(49,"Bill to:"),c.Wb(),c.Wb(),c.Wc(50,_n,3,1,"div",40),c.Wc(51,Gn,2,1,"div",41),c.Wc(52,Hn,3,2,"ng-container",42),c.Wb(),c.Wb(),c.Wb(),c.Xb(53,"div",43),c.Xb(54,"label",44),c.Yc(55,"Subject "),c.Xb(56,"span"),c.Yc(57,"(optional)"),c.Wb(),c.Wb(),c.Xb(58,"input",45),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().invoice.subject=t}))("change",(function(){return c.Oc(e),c.nc().modelChanged()})),c.Wb(),c.Wb(),c.Xb(59,"div",46),c.Sb(60,"invoice-items-table",47,48),c.Wb(),c.Xb(62,"div",49),c.Xb(63,"div",50),c.Wc(64,zn,2,0,"button",51),c.Wc(65,qn,4,0,"button",52),c.Wb(),c.Xb(66,"div",53),c.Xb(67,"div",54),c.Wc(68,Zn,7,6,"ng-container",55),c.Wc(69,Jn,1,1,"ng-template",null,56,c.Xc),c.Wb(),c.Wb(),c.Wb(),c.Xb(71,"div",57),c.Xb(72,"div",58),c.Xb(73,"div",59),c.Wc(74,ts,7,6,"ng-container",55),c.Wc(75,ns,1,1,"ng-template",null,60,c.Xc),c.Wb(),c.Xb(77,"div",59),c.Wc(78,ss,3,0,"ng-container",42),c.Wc(79,rs,7,6,"ng-container",42),c.Wb(),c.Xb(80,"div",61),c.Xb(81,"span",62),c.Yc(82,"Subtotal"),c.Wb(),c.Xb(83,"span"),c.Yc(84),c.oc(85,"roundIfWholeNumber"),c.oc(86,"centsToDollars"),c.Wb(),c.Wb(),c.Wc(87,os,7,6,"div",63),c.Wc(88,as,7,6,"div",63),c.Wc(89,ls,7,6,"div",63),c.Xb(90,"div",64),c.Xb(91,"strong",62),c.Yc(92,"Total amount due"),c.Wb(),c.Xb(93,"strong"),c.Yc(94),c.oc(95,"roundIfWholeNumber"),c.oc(96,"centsToDollars"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(97,"div",65),c.Xb(98,"label",66),c.Yc(99,"Notes "),c.Xb(100,"span"),c.Yc(101,"(optional)"),c.Wb(),c.Wb(),c.Xb(102,"textarea",67),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().invoice.note=t}))("change",(function(){return c.Oc(e),c.nc().modelChanged()})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.Lc(70),t=c.Lc(76),i=c.nc();c.Cb(18),c.Zc(i.invoice.number),c.Cb(2),c.ad("Issue date: ",c.pc(21,31,i.invoice.issuedDate),""),c.Cb(3),c.ad("Due date: ",c.pc(24,33,i.invoice.dueDate),""),c.Cb(3),c.wc("ngIf",i.workspace.image),c.Cb(16),c.Zc(i.workspace.name),c.Cb(2),c.ad(" ",i.workspace.companyAddress," "),c.Cb(6),c.wc("ngIf",i.clientData.name),c.Cb(1),c.wc("ngIf",i.clientData.address),c.Cb(1),c.wc("ngIf",!i.disableEdit),c.Cb(6),c.wc("disabled",i.disableEdit)("ngModel",i.invoice.subject),c.Cb(2),c.wc("invoiceItems",i.invoice.items)("invoiceId",i.invoice.id)("disableEdit",i.disableEdit),c.Cb(4),c.wc("ngIf",!i.disableEdit&&i.invoice.clientId),c.Cb(1),c.wc("ngIf",!i.disableEdit),c.Cb(3),c.wc("ngIf",i.invoice.discount||i.showDiscount)("ngIfElse",e),c.Cb(6),c.wc("ngIf",i.invoice.tax||i.showTax)("ngIfElse",t),c.Cb(4),c.wc("ngIf",(i.invoice.tax||i.showTax)&&!i.showTax2),c.Cb(1),c.wc("ngIf",i.showTax2),c.Cb(5),c.bd("",c.pc(85,35,c.pc(86,37,i.invoice.subtotal))," ",i.invoice.currency,""),c.Cb(3),c.wc("ngIf",i.invoice.discountAmount),c.Cb(1),c.wc("ngIf",i.invoice.taxAmount),c.Cb(1),c.wc("ngIf",i.invoice.tax2Amount),c.Cb(5),c.bd("",c.pc(95,39,c.pc(96,41,i.invoice.amount))," ",i.invoice.currency,""),c.Cb(8),c.wc("disabled",i.disableEdit)("ngModel",i.invoice.note)}}function us(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",90),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().confirmDelete(i)}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Yc(1," All entries in this invoice will become uninvoiced. "),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Delete invoice")("inProgress",e.inProgress)("isDanger",!0)("btnText","Delete")}}function ds(e,t){if(1&e){const e=c.Yb();c.Xb(0,"create-invoice",91),c.jc("onSave",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().updateInvoice(i),n.close()}))("isSavingChange",(function(t){return c.Oc(e),c.nc().editInProgress=t}))("onClose",(function(i){c.Oc(e);const n=t.$implicit;return!c.nc().editInProgress&&n.close(i)})),c.Wb()}if(2&e){const e=c.nc();c.wc("invoice",e.invoice)("saveInProgress",e.editInProgress)}}function ps(e,t){if(1&e){const e=c.Yb();c.Xb(0,"import-invoice-time",92),c.jc("isSavingChange",(function(t){return c.Oc(e),c.nc().editInProgress=t}))("onImport",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().updateInvoice(i),n.close()}))("onClose",(function(i){c.Oc(e);const n=t.$implicit;return!c.nc().editInProgress&&n.close(i)})),c.Wb()}if(2&e){const e=c.nc();c.wc("invoiceId",e.invoice.id)("clientId",e.invoice.clientId)("roundSetting",e.workspace.round)("saveInProgress",e.editInProgress)}}function hs(e,t){if(1&e){const e=c.Yb();c.Xb(0,"edit-client-modal",93),c.jc("onEdit",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().confirmEditClient(i.name,i.address,n)}))("onClose",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Edit "+e.clientLabel)("item",e.client)("clientLabel",e.clientLabel)}}let ms=(()=>{class e{constructor(e,t,i,n,s,c,r){this.route=e,this.invoiceService=t,this.worksapceService=i,this.cd=n,this.clientService=s,this.modalService=c,this.router=r,this.InvoiceStatus=gi.a,this.unsubscribe$=new mi.a}set invoice(e){this._invoice=e,this.taxBackup=null==e?void 0:e.tax,this.tax2Backup=null==e?void 0:e.tax2,this.discountBackup=null==e?void 0:e.discount,(null==e?void 0:e.tax)&&(this.showTax=!0),(null==e?void 0:e.tax2)&&(this.showTax2=!0),(null==e?void 0:e.discount)&&(this.showDiscount=!0)}get invoice(){return this._invoice}ngOnInit(){this.workspace=this.worksapceService.getLocalDefaultWorkspace(),this.clientLabel=this.workspace.projectGroupingLabel.toLowerCase(),this.getInvoice(),this.subscribeToInvoiceChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}subscribeToInvoiceChanges(){this.invoiceService.invoice$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(({action:e,invoice:t})=>{"delete"===e?this.invoice=t:this.invoice.patchValues(t,["items"]),this.taxBackup=t.tax,this.tax2Backup=t.tax2,this.discountBackup=t.discount,this.cd.detectChanges()})}openModal(e){this.modalService.open(e,{centered:!0})}openBlockedModal(e){this.modalService.open(e,{beforeDismiss:()=>!this.editInProgress,centered:!0})}updateInvoice(e){const t=this.invoice.clientId!==e.clientId;this.invoice=e,this.cd.detectChanges(),t&&this.getInvoice()}getInvoice(){this.invoiceService.getInvoice(this.route.snapshot.params.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.invoice=e,this.clientData={name:e.clientName,address:e.clientAddress},this.availableStatuses=this.invoice.getAvailableStatuses(),this.cd.markForCheck()})}get disableEdit(){var e;return(null===(e=this.invoice)||void 0===e?void 0:e.status)===gi.a.PAID}downloadPdf(){const e=this.invoice.generatePdfFilename(this.clientData.name);this.invoiceService.downloadInvoicePdf(this.invoice.id,e)}markAs(e){this.inProgress||(this.inProgress=!0,this.invoiceService.markAs(this.invoice.id,e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.inProgress=!1,this.invoice.status=e,this.availableStatuses=this.invoice.getAvailableStatuses(),this.cd.markForCheck()},()=>{this.inProgress=!1}))}confirmDelete(e){this.inProgress=!0,this.invoiceService.deleteInvoice(this.invoice.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{e.close(),this.inProgress=!1,this.router.navigate(["/invoices"])},()=>{this.inProgress=!1})}removeDiscount(){this.invoice.discount=0,this.invoice.discount!==this.discountBackup&&this.modelChanged()}removeTax(){this.invoice.tax=0,this.invoice.tax!==this.taxBackup&&this.modelChanged()}removeTax2(){this.invoice.tax2=0,this.invoice.tax2!==this.tax2Backup&&this.modelChanged()}modelChanged(){this.invoiceService.editInvoice(this.invoice,!1).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>this.updateInvoice(e))}fetchAndEditClient(e){this.editInProgress=!0,this.clientService.getClient(this.invoice.clientId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.editInProgress=!1,this.client=t,this.openModal(e)},()=>{this.editInProgress=!1,this.cd.markForCheck()})}confirmEditClient(e,t,i){this.client.name=e,this.client.address=t,this.editInProgress=!0,this.clientService.update(this.client,!1,this.clientLabel).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.editInProgress=!1,this.clientData={name:e.name,address:e.address},i.close(),this.cd.markForCheck()},e=>{this.editInProgress=!1,this.cd.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.a),c.Rb(ki),c.Rb(U.a),c.Rb(c.h),c.Rb(rn.a),c.Rb(g.q),c.Rb(W.c))},e.\u0275cmp=c.Lb({type:e,selectors:[["invoice-details"]],decls:18,vars:3,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],["routerLink","/invoices",1,"cl-d-inline-block","cl-mb-2","cl-d-print-none"],[1,"cl-d-flex","cl-align-items-center"],["class","cl-badge-approve cl-text-capitalize cl-ml-2",3,"ngClass",4,"ngIf"],["class","cl-card cl-border-bottom",4,"ngIf"],["deleteModal",""],["editModal",""],["importTimeModal",""],["editClientModal",""],[1,"cl-badge-approve","cl-text-capitalize","cl-ml-2",3,"ngClass"],[1,"cl-card","cl-border-bottom"],[1,"cl-card-body"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-mb-3"],[1,"cl-btn","cl-btn-outline-primary",3,"click"],["downloadBtn",""],["dropdownKey","","tabCell","",1,"cl-dropdown"],["dropdownKeyButton","","tabindex","0",1,"cl-btn","cl-btn-outline-light","cl-text-left","cl-dropdown-toggle"],["openUpAtBottom","","class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["tabFocus","","tabindex","0"],["tabFocusDuplicate",""],[1,"cl-card","cl-border-bottom","cl-add-shadow-default"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-py-3","cl-mb-3"],[1,"cl-h1","cl-mb-2","cl-text-dark"],[1,"cl-h2","cl-mb-0","cl-text-gray-6"],[1,"cl-invoice-logo"],["alt","Workspace image","class","cl-w-100",3,"src",4,"ngIf"],[1,"cl-row","cl-no-gutters","cl-mx-n3","cl-border-top","cl-border-bottom","cl-mb-3","cl-d-none","cl-d-lg-flex"],[1,"cl-col-lg-6","cl-mb-3","cl-mb-lg-0","cl-card-header","cl-border-0"],[1,"cl-h6","cl-mb-0","cl-px-3"],[1,"cl-col-lg-6","cl-card-header","cl-border-left","cl-border-bottom-0"],[1,"cl-row","cl-no-gutters","cl-mx-n3","cl-mb-3"],[1,"cl-col-lg-6","cl-mb-3","cl-mb-lg-0"],[1,"cl-px-3"],[1,"cl-mx-n2","cl-mb-3","cl-card-header","cl-px-2","cl-border-top","cl-d-flex","cl-d-lg-none"],[1,"cl-h6","cl-mb-0"],[1,"cl-h2","cl-mb-0"],[2,"white-space","pre-line"],[1,"cl-col-lg-6"],["class","cl-h2 cl-mb-0",4,"ngIf"],["style","white-space: pre-line;",4,"ngIf"],[4,"ngIf"],[1,"cl-form-group","cl-mb-3"],["for","subject"],["type","text","id","subject","placeholder","What is this invoice for?",1,"cl-form-control",3,"disabled","ngModel","ngModelChange","change"],[1,"cl-mb-2"],[3,"invoiceItems","invoiceId","disableEdit"],["itemsTable",""],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-start","cl-justify-content-lg-between","cl-flex-column","cl-flex-lg-row","cl-mb-3"],[1,"cl-mb-2","cl-mb-lg-0","cl-w-100"],["class","cl-btn cl-btn-primary cl-mr-2",3,"click",4,"ngIf"],["class","cl-btn cl-btn-outline-light",3,"click",4,"ngIf"],[1,"cl-w-100"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-lg-end"],[4,"ngIf","ngIfElse"],["addDiscountTemplate",""],[1,"cl-row"],[1,"cl-col-lg-4","cl-ml-auto"],[1,"cl-mb-2","cl-d-flex","cl-justify-content-end","cl-align-items-center"],["addTaxTemplate",""],[1,"cl-d-flex","cl-border-bottom","cl-py-2","cl-justify-content-between"],[1,"cl-text-uppercase"],["class","cl-d-flex cl-border-bottom cl-py-2 cl-justify-content-between",4,"ngIf"],[1,"cl-d-flex","cl-py-2","cl-justify-content-between"],[1,"cl-form-group","cl-mb-0"],["for","note"],["name","note","id","note","cols","30","rows","6",1,"cl-form-control",3,"disabled","ngModel","ngModelChange","change"],["openUpAtBottom","",1,"cl-dropdown-menu","cl-dropdown-menu-right"],["class","cl-dropdown-item","tabindex","-1","clickCloseDropdown","",3,"keyup.enter","keyup.space","click",4,"ngFor","ngForOf"],["tabindex","-1","clickCloseDropdown","",1,"cl-dropdown-item",3,"disabled","keyup.enter","keyup.space","click"],["tabindex","-1","clickCloseDropdown","",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],["alt","Workspace image",1,"cl-w-100",3,"src"],["class","cl-btn cl-btn-outline-primary cl-d-print-none cl-mt-2",3,"disabled","click",4,"ngIf"],["class","cl-btn cl-btn-outline-primary cl-d-print-none cl-mt-2",3,"click",4,"ngIf"],[1,"cl-btn","cl-btn-outline-primary","cl-d-print-none","cl-mt-2",3,"disabled","click"],[1,"cl-btn","cl-btn-outline-primary","cl-d-print-none","cl-mt-2",3,"click"],[1,"cl-btn","cl-btn-primary","cl-mr-2",3,"click"],[1,"cl-btn","cl-btn-outline-light",3,"click"],["src","assets/images/ui-icons/plus-blue.svg"],[1,"cl-ml-2"],[1,"cl-w-100","cl-text-right","cl-text-gray-6"],["numericInput","","type","text",1,"cl-form-control","cl-ml-2","cl-text-right","cl-style-disabled-inputs",2,"width","110px",3,"disabled","decimals","ngModel","minNumber","maxNumber","keyup.enter","inputChange"],["discountInput",""],["class","cl-btn-link cl-ml-3",3,"click",4,"ngIf"],[1,"cl-btn-link","cl-ml-3",3,"click"],["class","cl-btn-link",3,"click",4,"ngIf"],[1,"cl-btn-link",3,"click"],["numericInput","","type","text",1,"cl-form-control","cl-ml-2","cl-text-right","cl-style-disabled-inputs",2,"width","110px",3,"disabled","decimals","minNumber","maxNumber","ngModel","keyup.enter","inputChange"],["taxInput",""],[3,"title","inProgress","isDanger","btnText","confirmed","close"],[3,"invoice","saveInProgress","onSave","isSavingChange","onClose"],[3,"invoiceId","clientId","roundSetting","saveInProgress","isSavingChange","onImport","onClose"],[3,"title","item","clientLabel","onEdit","onClose"]],template:function(e,t){1&e&&(c.Xb(0,"main",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"a",3),c.Yc(4," Invoices "),c.Wb(),c.Xb(5,"h1",4),c.Xb(6,"span"),c.Yc(7),c.Wb(),c.Wc(8,Fn,2,2,"span",5),c.Wb(),c.Wb(),c.Wc(9,bs,103,43,"div",6),c.Wb(),c.Wb(),c.Wc(10,us,2,4,"ng-template",null,7,c.Xc),c.Wc(12,ds,1,2,"ng-template",null,8,c.Xc),c.Wc(14,ps,1,4,"ng-template",null,9,c.Xc),c.Wc(16,hs,1,3,"ng-template",null,10,c.Xc)),2&e&&(c.Cb(7),c.Zc(null==t.invoice?null:t.invoice.number),c.Cb(1),c.wc("ngIf",t.invoice),c.Cb(1),c.wc("ngIf",t.invoice))},directives:[W.f,s.u,s.r,Si.a,Ii.a,Oi.a,p.c,p.s,p.v,Dn,Ni.a,s.t,Sn,Ui.a,fn,Yn,Ln],pipes:[$i.a,_i.a,Gi.a],encapsulation:2,changeDetection:0}),e})();var gs=i("+EM1"),fs=i("KY19"),vs=i("5Ra6"),ws=i("ZHjv"),ys=i("qfBg"),Ws=i("JuMI"),Cs=i("OPDC");class ks{constructor(e,t){this._data=e,this._label=t}toChartReadable(){return{data:this.data,label:this.label}}get data(){return this._data}set data(e){this._data=e}get label(){return this._label}set label(e){this._label=e}}var Ss=i("jy+1"),Is=i("rsZi"),Os=function(e){return e.LATEST_ACTIVITY="LATEST_ACTIVITY",e.TEAM_MEMBER="TEAM_MEMBER",e.TOTAL="TOTAL",e}({}),Xs=i("FwEu"),Es=i("QKuU"),Ts=i("eGqU"),Ds=(i("10sm"),i("0Mwv"));const Rs=function(e,t){return{"background-color":e,width:t}};function As(e,t){if(1&e&&c.Sb(0,"div",2),2&e){const e=t.$implicit;c.wc("ngStyle",c.Cc(1,Rs,e.color,e.percentage))}}const js=function(e){return{width:e}};let xs=(()=>{class e{constructor(){this.dashboardViewType=Cs.a,this.BILLABLE_COLOR="#8BC34A",this.NON_BILLABLE_COLOR="#AED581"}ngOnInit(){if(this.isChart&&this.latestActivityItems&&this.latestActivityItems.length>0){const e=this.latestActivityItems[0];if(this.type===Cs.a.BILLABILITY&&e.duration!==e.billableDuration){const t=Object(Se.duration)(e.duration).subtract(Object(Se.duration)(e.billableDuration)),i=Object(Se.duration)(e.billableDuration).asSeconds()/this.largestDuration*100,n=Object(Se.duration)(t).asSeconds()/this.largestDuration*100,s=[];s.push({label:"Billable",projectName:e.projectName,clientName:e.clientName,color:this.BILLABLE_COLOR,duration:e.billableDuration,earned:e.earned,percentage:+Number(i).toFixed(2)+"%"}),s.push({label:"Non-billable",projectName:e.projectName,clientName:e.clientName,color:this.NON_BILLABLE_COLOR,duration:t,earned:0,percentage:+Number(n).toFixed(2)+"%"}),this.latestActivityItems=s}}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["horizontal-bar-chart"]],inputs:{latestActivityItems:"latestActivityItems",largestDuration:"largestDuration",currencySymbol:"currencySymbol",type:"type",totalPercentage:"totalPercentage",isChart:"isChart"},decls:2,vars:4,consts:[[1,"cl-horizontal-chart--progress",3,"ngStyle"],["class","cl-horizontal-chart--progress--item",3,"ngStyle",4,"ngFor","ngForOf"],[1,"cl-horizontal-chart--progress--item",3,"ngStyle"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Wc(1,As,1,4,"div",1),c.Wb()),2&e&&(c.wc("ngStyle",c.Bc(2,js,t.totalPercentage+"%")),c.Cb(1),c.wc("ngForOf",t.latestActivityItems))},directives:[s.x,s.t],encapsulation:2}),e})();var Ps=i("n0VX"),Ms=i("N2Ql"),Ys=i("DCUz"),Ls=i("9G2T"),Fs=i("4jLH");const Ns=["tooltip"];function Us(e,t){if(1&e&&c.Sb(0,"i",32),2&e){const e=c.nc(2);c.Vc("background",e.activity.projectColor,c.Kb)}}function $s(e,t){1&e&&c.Sb(0,"span",33)}function _s(e,t){if(1&e&&(c.Xb(0,"div",26),c.Xb(1,"div",27),c.Yc(2),c.Wb(),c.Xb(3,"div",27),c.Xb(4,"span",28),c.Wc(5,Us,1,2,"i",29),c.Xb(6,"span"),c.Yc(7),c.Wb(),c.Wc(8,$s,1,0,"span",30),c.Xb(9,"span",31),c.Yc(10),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.Db("title",e.activity.description),c.Cb(1),c.ad(" ",e.activity.description||"(no description)"," "),c.Cb(1),c.Db("title",e.activity.title),c.Cb(2),c.wc("ngIf",e.activity.projectColor),c.Cb(2),c.Zc(e.activity.titleWithoutClient),c.Cb(1),c.wc("ngIf",e.activity.clientName),c.Cb(2),c.Zc(e.activity.clientName)}}function Gs(e,t){1&e&&(c.Xb(0,"div",26),c.Yc(1," (no activity) "),c.Wb())}function Bs(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.oc(2,"stringDurationToTime"),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" ",c.qc(2,1,e.activity.duration,e.format)," ")}}function Vs(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.oc(2,"secondsToDuration"),c.Sb(3,"img",36),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" ",c.qc(2,1,e.activity.timer,e.format)," ")}}function Hs(e,t){if(1&e&&(c.Xb(0,"div",34),c.Wc(1,Bs,3,4,"span",35),c.Wc(2,Vs,4,4,"span",35),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.activity.duration),c.Cb(1),c.wc("ngIf",!e.activity.duration)}}function zs(e,t){1&e&&(c.Xb(0,"div",37),c.Xb(1,"span"),c.Yc(2,"--"),c.Wb(),c.Wb())}function qs(e,t){if(1&e&&(c.Xb(0,"div",38),c.oc(1,"formatStart"),c.Xb(2,"span"),c.Yc(3),c.oc(4,"durationToHumanize"),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Db("title",c.qc(1,2,e.activity.start,e.timeFormat)),c.Cb(3),c.Zc(c.qc(4,5,e.activity.end,e.activity.start))}}function Ks(e,t){1&e&&(c.Xb(0,"div",38),c.Xb(1,"span"),c.Yc(2,"--"),c.Wb(),c.Wb())}function Zs(e,t){if(1&e&&c.Sb(0,"span",32),2&e){const e=c.nc(2).$implicit;c.Vc("background",e.color,c.Kb)}}function Qs(e,t){1&e&&c.Sb(0,"span",33)}function Js(e,t){if(1&e&&(c.Xb(0,"div",20),c.Xb(1,"div",27),c.Xb(2,"span",40),c.Wc(3,Zs,1,2,"span",29),c.Xb(4,"span"),c.Yc(5),c.Wb(),c.Wc(6,Qs,1,0,"span",30),c.Xb(7,"span",31),c.Yc(8),c.Wb(),c.Wb(),c.Wb(),c.Xb(9,"div",41),c.Xb(10,"span"),c.Yc(11),c.oc(12,"stringDurationToTime"),c.Wb(),c.Xb(13,"span"),c.Yc(14),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc().$implicit,t=c.nc();c.Cb(3),c.wc("ngIf",t.type===t.dashboardViewType.PROJECT),c.Cb(2),c.Zc(e.projectName),c.Cb(1),c.wc("ngIf",e.clientName),c.Cb(2),c.Zc(e.clientName),c.Cb(3),c.Zc(c.qc(12,6,e.duration,t.format)),c.Cb(3),c.Zc(e.percentage)}}function ec(e,t){if(1&e&&(c.Vb(0),c.Wc(1,Js,15,9,"div",39),c.Ub()),2&e){const e=t.index;c.Cb(1),c.wc("ngIf",e<10)}}function tc(e,t){if(1&e&&(c.Xb(0,"div",42),c.Sb(1,"img",43),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(3),c.ad("+",e.activity.latestActivityItems.length-10," more (click to see all)")}}function ic(e,t){if(1&e&&c.Sb(0,"i",32),2&e){const e=c.nc().$implicit;c.Vc("background",e.color,c.Kb)}}function nc(e,t){1&e&&c.Sb(0,"span",33)}function sc(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"tr"),c.Xb(2,"td"),c.Xb(3,"span",53),c.Wc(4,ic,1,2,"i",29),c.Xb(5,"span"),c.Yc(6),c.Wb(),c.Wc(7,nc,1,0,"span",30),c.Xb(8,"span",31),c.Yc(9),c.Wb(),c.Wb(),c.Wb(),c.Xb(10,"td",52),c.Yc(11),c.oc(12,"stringDurationToTime"),c.Wb(),c.Xb(13,"td",54),c.Yc(14),c.Wb(),c.Wb(),c.Ub()),2&e){const e=t.$implicit,i=c.nc(2);c.Cb(4),c.wc("ngIf",i.type===i.dashboardViewType.PROJECT),c.Cb(2),c.Zc(e.projectName),c.Cb(1),c.wc("ngIf",e.clientName),c.Cb(2),c.Zc(e.clientName),c.Cb(2),c.Zc(c.qc(12,6,e.duration,i.format)),c.Cb(3),c.Zc(e.percentage)}}function cc(e,t){if(1&e&&(c.Xb(0,"div",44),c.Xb(1,"h1",45),c.Yc(2),c.Wb(),c.Xb(3,"button",46),c.jc("click",(function(){return t.$implicit.dismiss()})),c.Xb(4,"span",47),c.Sb(5,"img",48),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",49),c.Xb(7,"table",50),c.Xb(8,"tr"),c.Xb(9,"th",51),c.Xb(10,"b"),c.Yc(11,"Projects"),c.Wb(),c.Wb(),c.Xb(12,"th",52),c.Xb(13,"b"),c.Yc(14),c.oc(15,"stringDurationToTime"),c.Wb(),c.Wb(),c.Xb(16,"th",21),c.Yc(17),c.oc(18,"localizeEarningWithCurrency"),c.Wb(),c.Wb(),c.Wc(19,sc,15,9,"ng-container",23),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.Zc(e.activity.user.name),c.Cb(12),c.ad(" ",c.qc(15,4,e.activity.totalTime,e.format)," "),c.Cb(3),c.ad(" ",e.type===e.dashboardViewType.BILLABILITY&&e.canSeeRates?c.qc(18,7,e.activity.earning,e.currency):""," "),c.Cb(2),c.wc("ngForOf",e.activity.latestActivityItems)}}let rc=(()=>{class e{constructor(e){this.modalService=e,this.dashboardViewType=Cs.a}ngOnInit(){this.currencySymbol=Object(s.L)(this.currency,"narrow");const e=Object(Se.duration)(this.activity.totalTime).asSeconds();this.totalPercentage=e/this.largestDuration*100}openLatestModal(e){this.modalService.open(e,{centered:!0})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(g.q))},e.\u0275cmp=c.Lb({type:e,selectors:[["dashboard-latest-activity-row"]],viewQuery:function(e,t){var i;1&e&&c.ed(Ns,!0),2&e&&c.Kc(i=c.kc())&&(t.tooltip=i.first)},inputs:{activity:"activity",format:"format",currency:"currency",largestDuration:"largestDuration",type:"type",timeFormat:"timeFormat",pinToTop:"pinToTop",canSeeRates:"canSeeRates"},decls:43,vars:36,consts:[[1,"cl-component-row","cl-flex-column","cl-flex-lg-row"],[1,"cl-dashboard-table-col-1"],[1,"cl-avatar",3,"classSize","src","name"],[1,"cl-mx-2","cl-cut-text",3,"title"],[1,"cl-d-flex","cl-d-lg-none","cl-ml-auto"],[1,"cl-dashboard-table-col-2"],[1,"cl-d-flex","cl-align-items-center"],["class","cl-dashboard-table-col-2-1 cl-add-border-left-lg",4,"ngIf"],[1,"cl-dashboard-table-col-2-2"],["class","cl-dashboard-table-col-2-2-1 cl-text-right",4,"ngIf"],["class","cl-dashboard-table-col-2-2-1",4,"ngIf"],["class","cl-dashboard-table-col-2-2-2",4,"ngIf"],[1,"cl-dashboard-table-col-3","cl-d-none","cl-d-lg-flex"],[1,"cl-d-flex","cl-align-items-center","cl-horizontal-chart"],[1,"cl-dashboard-table-col-3-1","cl-add-border-left-lg","cl-align-items-center"],[1,"cl-text-dark"],[1,"cl-dashboard-table-col-3-2","cl-main-horizontal-chart-container--progress",3,"click"],[1,"cl-main-horizontal-chart-container--progress--bar",3,"latestActivityItems","largestDuration","currencySymbol","type","totalPercentage","isChart"],[1,"cl-custom-tooltip"],[1,"cl-top"],[1,"cl-custom-tooltip-row"],[1,"cl-text-right"],[1,"cl-custom-tooltip-currency"],[4,"ngFor","ngForOf"],["class","cl-custom-tooltip-footer",4,"ngIf"],["content",""],[1,"cl-dashboard-table-col-2-1","cl-add-border-left-lg"],[1,"cl-cut-text"],[1,"cl-project-name","cl-text-dark","cl-listing-project-client"],["class","cl-entry__project__dot",3,"background",4,"ngIf"],["class","cl-h-line-divider",4,"ngIf"],[1,"cl-listing-client"],[1,"cl-entry__project__dot"],[1,"cl-h-line-divider"],[1,"cl-dashboard-table-col-2-2-1","cl-text-right"],[4,"ngIf"],["src","assets/images/ui-icons/recording.svg",1,"cl-recording"],[1,"cl-dashboard-table-col-2-2-1"],[1,"cl-dashboard-table-col-2-2-2"],["class","cl-custom-tooltip-row",4,"ngIf"],[1,"cl-project-name","cl-listing-project-client"],[1,"cl-custom-tooltip-col-right"],[1,"cl-custom-tooltip-footer"],["src","assets/images/ui-icons/info-9.svg"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body","cl-overflow-auto"],[1,"cl-m-0","tr-table-reset"],["ngbAutofocus","",1,"cl-pb-2"],[1,"cl-text-right","cl-px-2"],[1,"cl-project-name"],[1,"cl-text-gray-9","cl-text-right"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",1),c.Sb(2,"avatar",2),c.Xb(3,"div",3),c.Yc(4),c.Wb(),c.Xb(5,"div",4),c.Xb(6,"span"),c.Yc(7),c.oc(8,"stringDurationToTime"),c.Wb(),c.Wb(),c.Wb(),c.Xb(9,"div",5),c.Xb(10,"div",6),c.Wc(11,_s,11,7,"div",7),c.Wc(12,Gs,2,0,"div",7),c.Xb(13,"div",8),c.Wc(14,Hs,3,2,"div",9),c.Wc(15,zs,3,0,"div",10),c.Wc(16,qs,5,8,"div",11),c.Wc(17,Ks,3,0,"div",11),c.Wb(),c.Wb(),c.Wb(),c.Xb(18,"div",12),c.Xb(19,"div",13),c.Xb(20,"div",14),c.Xb(21,"span",15),c.Yc(22),c.oc(23,"stringDurationToTime"),c.Wb(),c.Wb(),c.Xb(24,"div",16),c.jc("click",(function(){c.Oc(e);const i=c.Lc(42);return t.openLatestModal(i)})),c.Sb(25,"horizontal-bar-chart",17),c.Xb(26,"span",18),c.Xb(27,"div",19),c.Xb(28,"div",20),c.Xb(29,"div"),c.Yc(30),c.Wb(),c.Xb(31,"div",21),c.Xb(32,"span"),c.Yc(33),c.oc(34,"stringDurationToTime"),c.Wb(),c.Xb(35,"span",22),c.Yc(36),c.oc(37,"localizeEarningWithCurrency"),c.Wb(),c.Wb(),c.Wb(),c.Wc(38,ec,2,1,"ng-container",23),c.Wc(39,tc,4,1,"div",24),c.Sb(40,"i"),c.Wb(),c.Wb(),c.Wb(),c.Wc(41,cc,20,10,"ng-template",null,25,c.Xc),c.Wb(),c.Wb(),c.Wb()}2&e&&(c.Cb(2),c.wc("classSize","cl-no-image-wrapper-md")("src",t.activity.user.profilePicture)("name",t.activity.user.name),c.Cb(1),c.xc("title",t.activity.user.name),c.Cb(1),c.Zc(t.activity.user.name),c.Cb(3),c.Zc(c.qc(8,24,t.activity.totalTime,t.format)),c.Cb(4),c.wc("ngIf",t.activity.start),c.Cb(1),c.wc("ngIf",!t.activity.start),c.Cb(2),c.wc("ngIf",t.activity.start),c.Cb(1),c.wc("ngIf",!t.activity.start),c.Cb(1),c.wc("ngIf",t.activity.start),c.Cb(1),c.wc("ngIf",!t.activity.start),c.Cb(5),c.ad(" ",c.qc(23,27,t.activity.totalTime,t.format)," "),c.Cb(3),c.wc("latestActivityItems",t.activity.latestActivityItems)("largestDuration",t.largestDuration)("currencySymbol",t.currencySymbol)("type",t.type)("totalPercentage",t.totalPercentage)("isChart",!1),c.Cb(5),c.Zc(t.activity.user.name),c.Cb(3),c.Zc(c.qc(34,30,t.activity.totalTime,t.format)),c.Cb(3),c.ad(" ",t.type===t.dashboardViewType.BILLABILITY&&t.canSeeRates?c.qc(37,33,t.activity.earning,t.currency):""," "),c.Cb(2),c.wc("ngForOf",t.activity.latestActivityItems),c.Cb(1),c.wc("ngIf",t.activity.latestActivityItems&&t.activity.latestActivityItems.length>10))},directives:[Ds.a,s.u,xs,s.t],pipes:[Ps.a,Ms.a,Ys.a,Ls.a,Fs.a],encapsulation:2}),e})();function oc(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",19),c.Xb(1,"a",20),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.sortActivities(t.LatestSortBy.TEAM_MEMBER)})),c.Yc(2," Team member (ascending) "),c.Wb(),c.Xb(3,"a",20),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.sortActivities(t.LatestSortBy.TEAM_MEMBER)})),c.Yc(4," Team member (descending) "),c.Wb(),c.Xb(5,"a",20),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.sortActivities(t.LatestSortBy.LATEST_ACTIVITY)})),c.Yc(6," Latest activity (ascending) "),c.Wb(),c.Xb(7,"a",20),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.sortActivities(t.LatestSortBy.LATEST_ACTIVITY)})),c.Yc(8," Latest activity (descending) "),c.Wb(),c.Xb(9,"a",20),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.sortActivities(t.LatestSortBy.TOTAL)})),c.Yc(10," Total tracked (ascending) "),c.Wb(),c.Xb(11,"a",20),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.sortActivities(t.LatestSortBy.TOTAL)})),c.Yc(12," Total tracked (descending) "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.Hb("cl-active",e.sort.column===e.LatestSortBy.TEAM_MEMBER&&e.sort.order===e.SortOrder.ASCENDING),c.Cb(2),c.Hb("cl-active",e.sort.column===e.LatestSortBy.TEAM_MEMBER&&e.sort.order===e.SortOrder.DESCENDING),c.Cb(2),c.Hb("cl-active",e.sort.column===e.LatestSortBy.LATEST_ACTIVITY&&e.sort.order===e.SortOrder.ASCENDING),c.Cb(2),c.Hb("cl-active",e.sort.column===e.LatestSortBy.LATEST_ACTIVITY&&e.sort.order===e.SortOrder.DESCENDING),c.Cb(2),c.Hb("cl-active",e.sort.column===e.LatestSortBy.TOTAL&&e.sort.order===e.SortOrder.ASCENDING),c.Cb(2),c.Hb("cl-active",e.sort.column===e.LatestSortBy.TOTAL&&e.sort.order===e.SortOrder.DESCENDING)}}function ac(e,t){if(1&e&&(c.Vb(0),c.Sb(1,"dashboard-latest-activity-row",21),c.Ub()),2&e){const e=t.$implicit,i=c.nc();c.Cb(1),c.wc("activity",e)("format",i.format)("currency",i.currency)("largestDuration",i.largestDuration)("type",i.dashboardViewType)("timeFormat",i.timeFormat)("pinToTop",i.pinToTop)("canSeeRates",i.canSeeRates)}}function lc(e,t){if(1&e){const e=c.Yb();c.Xb(0,"pager",22),c.jc("pageChanged",(function(t){return c.Oc(e),c.nc().setPagination(t)}))("limitChanged",(function(t){return c.Oc(e),c.nc().setPagination(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("page",null==e.pager?null:e.pager.page)("limit",null==e.pager?null:e.pager.limit)("total",e.usersCount)}}let bc=(()=>{class e{constructor(e,t,i){this.reportService=e,this.userService=t,this.authService=i,this.pinToTopEmitter=new c.n,this.sort={column:Os.LATEST_ACTIVITY,order:Is.a.DESCENDING},this.SortOrder=Is.a,this.LatestSortBy=Os,this.unsubscribe$=new mi.a}set earningByUser(e){e&&(this._earningByUser=e,this.latestActivity&&this.addEarningByUser(e))}get earningByUser(){return this._earningByUser}ngOnInit(){this.user=this.authService.getUser(),this.timeFormat=this.user.settings.timeFormat,this.getUsersCount()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete(),clearInterval(this.activityTimers)}getLatestActivity(){this.reportService.getLatestActivityOfWorkspace(this.dateRange,this.dashboardViewType,this.sort.column,this.sort.order,this.pager?this.pager.page:1,this.pager?this.pager.limit:ei.j).subscribe(e=>{this.latestActivity=e,this.getLargestDuration(e.map(e=>e)),this.updateTimers(e),this.earningByUser&&this.addEarningByUser(this.earningByUser)})}getUsersCount(){this.userService.getUsersCount(Xs.a.ACTIVE).subscribe(e=>{this.usersCount=e,e>ei.j&&setTimeout(()=>{this.setDefaultPager()})})}setDefaultPager(){this.pager.setPaginationManually({page:1,limit:ei.j,total:this.usersCount})}addEarningByUser(e){this.latestActivity&&this.latestActivity.forEach(t=>{t.earning=e[t.user.id]?e[t.user.id]:0})}getLargestDuration(e){const t=e.sort(Object(Ss.b)(!0,e=>Object(Se.duration)(e.totalTime).asSeconds()));if(t.length>0){const e=t[0];this.largestDuration=Object(Se.duration)(e.totalTime).asSeconds()}else this.largestDuration=0}updateTimers(e){const t=e.filter(e=>!e.end);t.length>0&&(this.activityTimers=setInterval(()=>{t.forEach(e=>{e.timer=Object(Se.duration)(Se().diff(Se(e.start))).asSeconds()})},1e3))}pinTeamActivity(){this.pinToTop=!this.pinToTop,this.user.settings.dashboardPinToTop=this.pinToTop,this.pinToTopEmitter.emit(this.pinToTop),this.userService.updateSettings(this.user).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{})}sortActivities(e){this.usersCount>ei.j&&this.setDefaultPager(),this.sort=this.getSort(e),this.getLatestActivity()}getSort(e){return e===this.sort.column?(this.sort.order=this.sort.order==Is.a.ASCENDING?Is.a.DESCENDING:Is.a.ASCENDING,this.sort):e===Os.TEAM_MEMBER?(this.sort={column:Os.TEAM_MEMBER,order:Is.a.ASCENDING},this.sort):(this.sort={column:e,order:Is.a.DESCENDING},this.sort)}setPagination(e){this.pager.setPaginationManually(e),this.getLatestActivity()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(fs.a),c.Rb(ys.a),c.Rb(Ce.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["dashboard-latest-activity"]],viewQuery:function(e,t){var i;1&e&&c.ed(cn.a,!0),2&e&&c.Kc(i=c.kc())&&(t.pager=i.first)},inputs:{earningByUser:"earningByUser",dateRange:"dateRange",pinToTop:"pinToTop",format:"format",dashboardViewType:"dashboardViewType",currency:"currency",canSeeRates:"canSeeRates"},outputs:{pinToTopEmitter:"pinToTopEmitter"},decls:25,vars:17,consts:[[1,"cl-card"],[1,"cl-card-header","cl-px-2","cl-px-lg-3"],[1,"cl-d-flex","cl-w-100","cl-align-items-center","cl-justify-content-between"],[1,"cl-h6","cl-mb-0"],[3,"click"],[3,"src"],[1,"cl-card-header","cl-bg-white","cl-pl-0","cl-d-flex","cl-d-lg-none"],["dropdown","",1,"cl-dropdown"],["id","dropdownMenuButton","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"cl-component-divided-left","cl-small","cl-no-divider-border","cl-dropdown-toggle"],["class","cl-dropdown-menu cl-prevent-close","aria-labelledby","dropdownMenuButton",4,"dropdownContent"],[1,"cl-card-header","cl-bg-white","cl-d-none","cl-d-lg-flex","cl-small"],[1,"cl-dashboard-table-col-1"],[1,"cl-text-gray-6","cl-sort-by","cl-down",3,"click"],[1,"cl-dashboard-table-col-2"],[1,"cl-text-gray-6","cl-sort-by","cl-up",3,"click"],[1,"cl-dashboard-table-col-3"],[1,"cl-text-gray-6","cl-sort-by",3,"click"],[4,"ngFor","ngForOf"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],["aria-labelledby","dropdownMenuButton",1,"cl-dropdown-menu","cl-prevent-close"],["closeDropdown","",1,"cl-dropdown-item",3,"click"],[1,"cl-border-bottom","cl-hover-shadow",3,"activity","format","currency","largestDuration","type","timeFormat","pinToTop","canSeeRates"],[3,"page","limit","total","pageChanged","limitChanged"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"span",3),c.Yc(4,"Team activities"),c.Wb(),c.Xb(5,"span"),c.Xb(6,"a",4),c.jc("click",(function(){return t.pinTeamActivity()})),c.Sb(7,"img",5),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(8,"div",6),c.Xb(9,"div",7),c.Xb(10,"div",8),c.Yc(11,"Sort "),c.Wb(),c.Wc(12,oc,13,12,"div",9),c.Wb(),c.Wb(),c.Xb(13,"div",10),c.Xb(14,"div",11),c.Xb(15,"a",12),c.jc("click",(function(){return t.sortActivities(t.LatestSortBy.TEAM_MEMBER)})),c.Yc(16," Team member "),c.Wb(),c.Wb(),c.Xb(17,"div",13),c.Xb(18,"a",14),c.jc("click",(function(){return t.sortActivities(t.LatestSortBy.LATEST_ACTIVITY)})),c.Yc(19," Latest activity "),c.Wb(),c.Wb(),c.Xb(20,"div",15),c.Xb(21,"a",16),c.jc("click",(function(){return t.sortActivities(t.LatestSortBy.TOTAL)})),c.Yc(22),c.Wb(),c.Wb(),c.Wb(),c.Wc(23,ac,2,8,"ng-container",17),c.Wb(),c.Wc(24,lc,1,3,"pager",18)),2&e&&(c.Cb(7),c.wc("src",t.pinToTop?"assets/images/ui-icons/pin-active.svg":"assets/images/ui-icons/pin-inactive.svg",c.Qc),c.Db("title",t.pinToTop?"Unpin from top":"Pin to top"),c.Cb(8),c.Hb("cl-up",t.sort.column===t.LatestSortBy.TEAM_MEMBER&&t.sort.order===t.SortOrder.ASCENDING)("cl-down",t.sort.column===t.LatestSortBy.TEAM_MEMBER&&t.sort.order===t.SortOrder.DESCENDING),c.Cb(3),c.Hb("cl-up",t.sort.column===t.LatestSortBy.LATEST_ACTIVITY&&t.sort.order===t.SortOrder.ASCENDING)("cl-down",t.sort.column===t.LatestSortBy.LATEST_ACTIVITY&&t.sort.order===t.SortOrder.DESCENDING),c.Cb(3),c.Hb("cl-up",t.sort.column===t.LatestSortBy.TOTAL&&t.sort.order===t.SortOrder.ASCENDING)("cl-down",t.sort.column===t.LatestSortBy.TOTAL&&t.sort.order===t.SortOrder.DESCENDING),c.Cb(1),c.ad(" Total tracked (",t.dateRange.label,") "),c.Cb(1),c.wc("ngForOf",t.latestActivity),c.Cb(1),c.wc("ngIf",t.usersCount>50))},directives:[Es.a,Ts.a,s.t,s.u,rc,cn.a],encapsulation:2}),e})();var uc=i("VHTt");let dc=(()=>{class e{constructor(e,t){this.http=e,this.workspaceService=t}endStartedTimeEntry(){const e=this.workspaceService.getDefaultWorkspaceId(),t={end:Se().toISOString()};return this.http.put(`/workspaces/${e}/timeEntries/endStarted`,t)}addStartedTimeEntry(e){const t=this.workspaceService.getDefaultWorkspaceId(),i={start:Se().toISOString(),billable:e.billable,description:e.description,projectId:e.projectId,taskId:e.taskId,tagIds:e.tagIds};this.http.post(`/workspaces/${t}/timeEntries/`,i).subscribe(e=>{})}}return e.\u0275fac=function(t){return new(t||e)(c.fc(P.b),c.fc(U.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var pc=i("kZ14"),hc=i("Tj/N"),mc=i("tzGe"),gc=i("j4ir");function fc(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=c.nc().$implicit;c.Db("title",e.title),c.Cb(1),c.ad(" : ",e.taskName," ")}}function vc(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=c.nc().$implicit;c.Db("title",e.title),c.Cb(1),c.ad(" - ",e.clientName," ")}}function wc(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",6),c.Xb(2,"div",7),c.Xb(3,"div",8),c.Yc(4),c.Wb(),c.Xb(5,"div",8),c.Sb(6,"i",9),c.Xb(7,"span"),c.Yc(8),c.Wb(),c.Wc(9,fc,2,2,"span",10),c.Wc(10,vc,2,2,"span",10),c.Wb(),c.Wb(),c.Xb(11,"div",11),c.Xb(12,"div",12),c.Yc(13),c.oc(14,"stringDurationToTime"),c.Wb(),c.Xb(15,"a",13),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc().playEntry(i)})),c.Sb(16,"img",14),c.Wb(),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=t.$implicit,i=c.nc();c.Cb(3),c.Db("title",e.description?e.description:"(no description)"),c.Cb(1),c.ad(" ",e.description?e.description:"(no description)"," "),c.Cb(2),c.Vc("background",e.projectColor?e.projectColor:"#C6D2D9",c.Kb),c.Cb(1),c.Db("title",e.title),c.Cb(1),c.ad(" ",e.projectName?e.projectName:"(no project)"," "),c.Cb(1),c.wc("ngIf",e.taskName),c.Cb(1),c.wc("ngIf",e.clientName),c.Cb(1),c.Hb("data-panel-item-action-show-play",i.workspace.canSeeTracker),c.Cb(2),c.ad(" ",c.qc(14,11,e.duration,i.format)," ")}}let yc=(()=>{class e{constructor(e,t,i,n){this.reportService=e,this.trackerService=t,this.stopwatchService=i,this.toaster=n,this.mostTrackedDropdownValues=[new uc.a("TOP_10","Top 10"),new uc.a("ALL","All")],this.unsubscribe$=new mi.a}ngOnInit(){this.mostTrackedItemsCount=this.mostTrackedDropdownValues[0].value}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getMostTrackedActivities(){this.reportService.getMostTracked(this.mostTrackedItemsCount,this.dateRange).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.mostTracked=e})}playEntry(e){const t=new pc.a({description:e.description,tagIds:e.tagIds,userId:this.user.id,billable:e.billable,projectId:e.projectId,taskId:e.taskId});this.trackerService.endStartedTimeEntry().subscribe(()=>{this.stopwatchService.start(),this.trackerService.addStartedTimeEntry(t),this.toaster.pop("success","Time entry started")})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(fs.a),c.Rb(dc),c.Rb(mc.a),c.Rb(M.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["dashboard-most-tracked"]],inputs:{format:"format",dateRange:"dateRange",user:"user",workspace:"workspace"},decls:7,vars:5,consts:[[1,"cl-card"],[1,"cl-card-header","cl-px-0","cl-py-2"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-w-100","cl-px-2","cl-py-1"],[1,"cl-ml-lg-2","cl-h6","cl-mb-0"],[1,"cl-small",3,"positionRight","type","list","value","onChanged"],[4,"ngFor","ngForOf"],[1,"cl-component-row"],[1,"cl-cut-text-wrapper"],[1,"cl-cut-text"],[1,"entry__project__dot"],[4,"ngIf"],[1,"cl-dashboard-most-tracked-action"],[1,"cl-dashboard-most-tracked-time"],[1,"cl-dashboard-most-tracked-start",3,"click"],["src","assets/play.svg"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Yc(4,"Most tracked activities"),c.Wb(),c.Xb(5,"dropdown-items",4),c.jc("onChanged",(function(e){return t.mostTrackedItemsCount=e,t.getMostTrackedActivities()})),c.Wb(),c.Wb(),c.Wb(),c.Wc(6,wc,17,14,"ng-container",5),c.Wb()),2&e&&(c.Cb(5),c.wc("positionRight",!0)("type","DROPDOWN")("list",t.mostTrackedDropdownValues)("value",t.mostTrackedItemsCount),c.Cb(1),c.wc("ngForOf",t.mostTracked))},directives:[pn.a,s.t,s.u],pipes:[Ps.a],encapsulation:2}),e})();var Wc=i("RWlN"),Cc=i("kRDX"),kc=i("wlsK");function Sc(e,t){if(1&e&&(c.Xb(0,"div",8),c.Xb(1,"div",4),c.Yc(2),c.Wb(),c.Xb(3,"div",5),c.Xb(4,"div",9),c.Xb(5,"span"),c.Yc(6),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.ad(" ",e.viewType===e.dashboardViewType.BILLABILITY?"Amount":"Top project"," "),c.Cb(4),c.Zc(e.topProjectOrEarning)}}function Ic(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",13),c.Xb(1,"bar-chart",21),c.jc("showAllBarValues",(function(t){return c.Oc(e),c.nc().openModalForBar(t)})),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.wc("barChartLabels",e.barChartLabels)("barChartAllLabels",e.barChartAllLabels)("barChartData",e.barChartData)("barChartColors",e.barChartColors)("barChartEarnings",e.barChartEarnings)("totalDurationByDate",e.totalDurationByDate)("billableTimes",e.totalTimeByDate)("format",e.format)("currency",e.currency)("canSeeRates",e.canSeeRates)("isBillabilityType",e.viewType===e.dashboardViewType.BILLABILITY)("projectCountByDate",e.projectCountByDate)}}function Oc(e,t){if(1&e&&c.Sb(0,"doughnut-chart",22),2&e){const e=c.nc();c.wc("doughnutChart",e.pieChartValues)("doughnutChartColors",e.doughnutChartColors)("doughnutChartData",e.doughnutChartData)("doughnutChartLabels",e.doughnutChartLabels)("currency",e.currency)("format",e.format)("totalTime",e.totalTime)("canSeeRates",e.canSeeRates)("isBillabilityType",e.viewType===e.dashboardViewType.BILLABILITY)("tooltipToLeft",!1)}}function Xc(e,t){if(1&e&&(c.Xb(0,"span",28),c.Yc(1),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(1),c.ad(" - ",e.clientName," ")}}function Ec(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=c.nc(3).$implicit;c.Cb(1),c.ad(" - ",e.clientName,"")}}function Tc(e,t){if(1&e&&(c.Xb(0,"div",33),c.Sb(1,"i",34),c.Xb(2,"span"),c.Yc(3),c.Wc(4,Ec,2,1,"span",35),c.Wb(),c.Wb(),c.Xb(5,"span",36),c.Yc(6),c.oc(7,"stringDurationToTime"),c.Wb(),c.Xb(8,"span",37),c.Yc(9),c.Wb()),2&e){const e=c.nc(2).$implicit,t=c.nc();c.Cb(1),c.Vc("background",e.color,c.Kb),c.Cb(2),c.Zc(e.label),c.Cb(1),c.wc("ngIf",e.clientName),c.Cb(2),c.ad(" ",c.qc(7,6,e.duration,t.format)," "),c.Cb(3),c.Zc(e.percentage)}}function Dc(e,t){if(1&e&&(c.Xb(0,"th",39),c.Yc(1),c.oc(2,"localizeEarningWithCurrency"),c.Wb()),2&e){const e=c.nc(3).$implicit,t=c.nc();c.Cb(1),c.ad(" ",c.qc(2,1,e.earned,t.currency)," ")}}function Rc(e,t){if(1&e&&(c.Xb(0,"table"),c.Xb(1,"tr"),c.Xb(2,"th",33),c.Xb(3,"b"),c.Yc(4),c.Wb(),c.Wb(),c.Xb(5,"th"),c.Xb(6,"b"),c.Yc(7),c.oc(8,"stringDurationToTime"),c.Wb(),c.Wb(),c.Wc(9,Dc,3,4,"th",38),c.Wb(),c.Xb(10,"tr"),c.Xb(11,"td"),c.Yc(12,"Billable"),c.Wb(),c.Xb(13,"td"),c.Yc(14),c.oc(15,"stringDurationToTime"),c.Wb(),c.Xb(16,"td",39),c.Yc(17),c.Wb(),c.Wb(),c.Xb(18,"tr"),c.Xb(19,"td"),c.Yc(20,"Non-billable"),c.Wb(),c.Xb(21,"td"),c.Yc(22),c.oc(23,"stringDurationToTime"),c.Wb(),c.Xb(24,"td",39),c.Yc(25),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc(2).$implicit,t=c.nc();c.Cb(4),c.Zc(e.label),c.Cb(3),c.Zc(c.qc(8,7,e.duration,t.format)),c.Cb(2),c.wc("ngIf",t.canSeeRates),c.Cb(5),c.Zc(c.qc(15,10,e.billableDuration,t.format)),c.Cb(3),c.ad(" ",e.billablePercentage," "),c.Cb(5),c.Zc(c.qc(23,13,e.nonBillableDuration,t.format)),c.Cb(3),c.ad(" ",e.nonBillablePercentage," ")}}const Ac=function(e){return[e]};function jc(e,t){if(1&e&&(c.Xb(0,"td",29),c.Sb(1,"horizontal-bar-chart",30),c.Wc(2,Tc,10,9,"ng-template",null,31,c.Xc),c.Wc(4,Rc,26,16,"ng-template",null,32,c.Xc),c.Wb()),2&e){const e=c.Lc(3),t=c.Lc(5),i=c.nc().$implicit,n=c.nc();c.Cb(1),c.wc("latestActivityItems",c.Bc(7,Ac,i))("largestDuration",n.totalTimeInSeconds)("currencySymbol",n.currencySymbol)("type",n.viewType)("totalPercentage",100)("isChart",!0)("ngbTooltip",n.viewType===n.dashboardViewType.PROJECT?e:t)}}function xc(e,t){if(1&e&&(c.Xb(0,"td",40),c.Xb(1,"span"),c.Yc(2),c.oc(3,"localizeEarningWithCurrency"),c.Wb(),c.Wb()),2&e){const e=c.nc().$implicit,t=c.nc();c.Cb(2),c.ad(" ",t.viewType===t.dashboardViewType.PROJECT?e.percentage:c.qc(3,1,e.earned,t.currency)," ")}}function Pc(e,t){if(1&e&&(c.Xb(0,"tr"),c.Xb(1,"td",23),c.Xb(2,"span"),c.Yc(3),c.Wc(4,Xc,2,1,"span",24),c.Wb(),c.Wb(),c.Xb(5,"td",25),c.Xb(6,"span"),c.Yc(7),c.oc(8,"stringDurationToTime"),c.Wb(),c.Wb(),c.Wc(9,jc,6,9,"td",26),c.Wc(10,xc,4,4,"td",27),c.Wb()),2&e){const e=t.$implicit,i=c.nc();c.Cb(2),c.Db("title",e.clientName?e.label+" - "+e.clientName:e.label),c.Cb(1),c.ad(" ",e.label," "),c.Cb(1),c.wc("ngIf",e.clientName),c.Cb(3),c.ad(" ",c.qc(8,6,e.duration,i.format)," "),c.Cb(2),c.wc("ngIf",e),c.Cb(1),c.wc("ngIf",i.viewType===i.dashboardViewType.PROJECT||i.canSeeRates)}}function Mc(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",41),c.Xb(1,"span"),c.Xb(2,"button",42),c.jc("click",(function(){return c.Oc(e),c.nc().loadMore()})),c.Yc(3),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.ad(" Load more (",e.itemsLeftToLoad," left) ")}}let Yc=(()=>{class e{constructor(){this.showAllBarValues=new c.n,this.doughnutChartLabels=[],this.doughnutChartData=[],this.doughnutChartColors=[{backgroundColor:[],hoverBackgroundColor:[]}],this.dashboardViewType=Cs.a,this.numberOfItemsShown=10,this.unsubscribe$=new mi.a}set totalTime(e){this._totalTime=e||"0",this.totalTimeInSeconds=Object(Se.duration)(this._totalTime).asSeconds()}set horizontalChartData(e){e&&(this._horizontalChartData=e,this.projectListValues=e.slice(0,10),this.itemsLeftToLoad=e.length-this.projectListValues.length,this.viewType===Cs.a.BILLABILITY&&this.fillChartWithBillabilityPercentage(this.projectListValues))}set doughnutChart(e){e&&(this._doughnutChart=e,this.pieChartValues=e.slice(0,10),this.updateDoughnutChart(this.pieChartValues))}get totalTime(){return this._totalTime}get horizontalChartData(){return this._horizontalChartData}get doughnutChart(){return this._doughnutChart}ngOnInit(){this.currencySymbol=Object(s.L)(this.currency,"narrow")}loadMore(){this.numberOfItemsShown+=10,this.projectListValues=this.horizontalChartData.slice(0,this.numberOfItemsShown),this.pieChartValues=this.doughnutChart.slice(0,this.numberOfItemsShown),this.itemsLeftToLoad=this.horizontalChartData.length-this.projectListValues.length,this.updateDoughnutChart(this.pieChartValues),this.fillChartWithBillabilityPercentage(this.projectListValues)}openModalForBar(e){this.showAllBarValues.emit(e)}updateDoughnutChart(e){this.showDoughnut=!1;let t=[],i=[],n=[];if(e&&e.length>0)for(const s of e)t.push(s.color),i.push(s.label),n.push(Number(Object(Se.duration)(s.duration).asHours()));else n=[0],i=[""],t=["#000000"];this.doughnutChartData=n,this.doughnutChartLabels=i,this.doughnutChartColors[0].backgroundColor=t,this.doughnutChartColors[0].hoverBackgroundColor=t,this.showDoughnut=!0}fillChartWithBillabilityPercentage(e){e.forEach(e=>{const t=Object(Se.duration)(e.duration).subtract(Object(Se.duration)(e.billableDuration));e.billablePercentage=this.getPercentageOfValues(Object(Se.duration)(e.billableDuration).asSeconds(),Object(Se.duration)(e.duration).asSeconds()),e.nonBillablePercentage=this.getPercentageOfValues(t.asSeconds(),Object(Se.duration)(e.duration).asSeconds()),e.billableDuration=Object(Se.duration)(e.billableDuration),e.nonBillableDuration=Object(Se.duration)(e.duration).subtract(Object(Se.duration)(e.billableDuration))})}getPercentageOfValues(e,t){let i;return i=0===t?0:e/t*100,Number(i).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+"%"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["dashboard-charts"]],inputs:{totalTime:"totalTime",horizontalChartData:"horizontalChartData",doughnutChart:"doughnutChart",totalBillable:"totalBillable",billablePercentage:"billablePercentage",currency:"currency",totalTimeByDate:"totalTimeByDate",totalDurationByDate:"totalDurationByDate",format:"format",barChartLabels:"barChartLabels",barChartAllLabels:"barChartAllLabels",barChartData:"barChartData",barChartColors:"barChartColors",barChartEarnings:"barChartEarnings",viewType:"viewType",topProjectOrEarning:"topProjectOrEarning",topClientOrBillable:"topClientOrBillable",projectGroupingLabel:"projectGroupingLabel",canSeeRates:"canSeeRates",projectCountByDate:"projectCountByDate"},outputs:{showAllBarValues:"showAllBarValues"},decls:29,vars:11,consts:[[1,"cl-card"],[1,"cl-card-header","cl-px-0"],[1,"cl-d-flex","cl-flex-column","cl-flex-md-row","cl-w-100"],[1,"cl-flex-md-fill","cl-dashboard-card-header-item"],[1,"cl-h4","cl-mb-0"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-end","cl-d-md-block"],[1,"cl-h1"],["class","cl-flex-md-fill cl-dashboard-card-header-item cl-cut-text-wrapper",4,"ngIf"],[1,"cl-flex-md-fill","cl-dashboard-card-header-item","cl-cut-text-wrapper"],[1,"cl-h1","cl-cut-text"],[1,"cl-card-body","cl-p-0"],[1,"cl-main-chart-wrapper"],["class","cl-main-chart-container",4,"ngIf"],[1,"cl-main-chart-container"],[1,"cl-row"],[1,"cl-col-md-4","cl-mb-3","cl-mb-md-0"],[3,"doughnutChart","doughnutChartColors","doughnutChartData","doughnutChartLabels","currency","format","totalTime","canSeeRates","isBillabilityType","tooltipToLeft",4,"ngIf"],[1,"cl-col-md-8"],[1,"cl-main-horizontal-chart-container"],[4,"ngFor","ngForOf"],["class","cl-or-divider cl-mt-3",4,"ngIf"],[3,"barChartLabels","barChartAllLabels","barChartData","barChartColors","barChartEarnings","totalDurationByDate","billableTimes","format","currency","canSeeRates","isBillabilityType","projectCountByDate","showAllBarValues"],[3,"doughnutChart","doughnutChartColors","doughnutChartData","doughnutChartLabels","currency","format","totalTime","canSeeRates","isBillabilityType","tooltipToLeft"],[1,"cl-text-truncate","cl-main-horizontal-chart-container--label"],["class","cl-listing-client",4,"ngIf"],[1,"cl-w-10","cl-text-right"],["class","cl-w-50 cl-main-horizontal-chart-container--progress",4,"ngIf"],["class","cl-w-10 cl-text-nowrap cl-text-gray-9 cl-text-right",4,"ngIf"],[1,"cl-listing-client"],[1,"cl-w-50","cl-main-horizontal-chart-container--progress"],["placement","bottom-left",1,"cl-main-horizontal-chart-container--progress--bar",3,"latestActivityItems","largestDuration","currencySymbol","type","totalPercentage","isChart","ngbTooltip"],["projectTooltip",""],["billableTooltip",""],[1,"cl-tooltip-label","cl-text-truncate","cl-text-left"],[1,"cl-entry__project__dot"],[4,"ngIf"],[1,"cl-tooltip-duration"],[1,"cl-text-right","cl-text-gray-9"],["class","cl-text-nowrap cl-text-gray-9 cl-text-right",4,"ngIf"],[1,"cl-text-nowrap","cl-text-gray-9","cl-text-right"],[1,"cl-w-10","cl-text-nowrap","cl-text-gray-9","cl-text-right"],[1,"cl-or-divider","cl-mt-3"],[1,"cl-btn","cl-btn-sm","cl-btn-outline-light","cl-w-max-content",3,"click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Yc(5,"Total time"),c.Wb(),c.Xb(6,"div",5),c.Xb(7,"div",6),c.Yc(8),c.oc(9,"stringDurationToTime"),c.Wb(),c.Wb(),c.Wb(),c.Wc(10,Sc,7,2,"div",7),c.Xb(11,"div",8),c.Xb(12,"div",4),c.Yc(13),c.Wb(),c.Xb(14,"div",5),c.Xb(15,"div",9),c.Yc(16),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(17,"div",10),c.Xb(18,"div",11),c.Wc(19,Ic,2,12,"div",12),c.Wb(),c.Xb(20,"div",11),c.Xb(21,"div",13),c.Xb(22,"div",14),c.Xb(23,"div",15),c.Wc(24,Oc,1,10,"doughnut-chart",16),c.Wb(),c.Xb(25,"div",17),c.Xb(26,"table",18),c.Wc(27,Pc,11,9,"tr",19),c.Wb(),c.Wc(28,Mc,4,1,"div",20),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(8),c.Zc(c.qc(9,8,t.totalTime,t.format)),c.Cb(2),c.wc("ngIf",t.viewType===t.dashboardViewType.PROJECT||t.canSeeRates),c.Cb(3),c.ad(" ",t.viewType===t.dashboardViewType.BILLABILITY?"Billable":"Top "+t.projectGroupingLabel," "),c.Cb(3),c.Zc(t.topClientOrBillable),c.Cb(3),c.wc("ngIf",t.barChartData),c.Cb(5),c.wc("ngIf",t.showDoughnut),c.Cb(3),c.wc("ngForOf",t.projectListValues),c.Cb(1),c.wc("ngIf",t.itemsLeftToLoad>0))},directives:[s.u,s.t,Cc.a,kc.a,xs,g.Z],pipes:[Ps.a,Ms.a],encapsulation:2}),e})();function Lc(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",18),c.Xb(1,"button",19),c.jc("click",(function(){return c.Oc(e),c.nc().toggleShowTeam(!1)})),c.Yc(2," Me "),c.Wb(),c.Xb(3,"button",19),c.jc("click",(function(){return c.Oc(e),c.nc().toggleShowTeam(!0)})),c.Yc(4," Team "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.Hb("cl-btn-primary",e.dashboardSelection==e.DashboardSelection.ME)("cl-btn-outline-primary",e.dashboardSelection==e.DashboardSelection.TEAM),c.Cb(2),c.Hb("cl-btn-primary",e.dashboardSelection==e.DashboardSelection.TEAM)("cl-btn-outline-primary",e.dashboardSelection==e.DashboardSelection.ME)}}function Fc(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",20),c.Xb(1,"a",21),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.changeViewType(t.DashboardViewType.PROJECT)})),c.Yc(2," Project"),c.Wb(),c.Xb(3,"a",21),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.changeViewType(t.DashboardViewType.BILLABILITY)})),c.Yc(4," Billability"),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.Hb("cl-active",e.dashboardViewType===e.DashboardViewType.PROJECT),c.Cb(2),c.Hb("cl-active",e.dashboardViewType===e.DashboardViewType.BILLABILITY)}}function Nc(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",26),c.Xb(1,"a",27),c.jc("click",(function(){return c.Oc(e),c.nc(2).toggleShowTeam(!1)})),c.Yc(2," Only me "),c.Wb(),c.Xb(3,"a",27),c.jc("click",(function(){return c.Oc(e),c.nc(2).toggleShowTeam(!0)})),c.Yc(4," Team "),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(1),c.Hb("cl-active",e.dashboardSelection==e.DashboardSelection.ME),c.Cb(2),c.Hb("cl-active",e.dashboardSelection==e.DashboardSelection.TEAM)}}function Uc(e,t){if(1&e&&(c.Xb(0,"div",22),c.Xb(1,"div",23),c.Xb(2,"button",24),c.Yc(3),c.Wb(),c.Wc(4,Nc,5,4,"div",25),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(3),c.ad(" ",e.dashboardSelection==e.DashboardSelection.ME?"Only me":"Team"," ")}}function $c(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",28),c.Xb(1,"div",29),c.Xb(2,"dashboard-charts",30),c.jc("showAllBarValues",(function(t){c.Oc(e);const i=c.nc(),n=c.Lc(21);return i.openModalForBar(t,n)})),c.Wb(),c.Wb(),c.Xb(3,"div",31),c.Sb(4,"dashboard-most-tracked",32),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.wc("totalTime",e.mainReport&&e.mainReport.totalTime)("horizontalChartData",e.horizontalChartData)("doughnutChart",e.doughnutChart)("totalBillable",e.totalBillable)("billablePercentage",e.billablePercentage)("currency",e.currency)("barChartLabels",e.barChartLabels)("barChartData",e.barChartData)("barChartColors",e.barChartColors)("barChartEarnings",e.barChartEarnings)("barChartAllLabels",e.barChartAllLabels)("totalTimeByDate",e.totalTimeByDate)("totalDurationByDate",e.totalDurationByDate)("format",e.format)("viewType",e.dashboardViewType)("topProjectOrEarning",e.topProjectOrEarning)("topClientOrBillable",e.topClientOrBillable)("projectGroupingLabel",e.projectGroupingLabel)("canSeeRates",e.canSeeRates)("projectCountByDate",e.projectCountByDate),c.Cb(2),c.wc("format",e.format)("dateRange",e.dateRange)("user",e.user)("workspace",e.workspace)}}function _c(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",33),c.Xb(1,"dashboard-latest-activity",35),c.jc("pinToTopEmitter",(function(t){return c.Oc(e),c.nc(2).pinToTopChanged(t)})),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Hb("cl-order-first",e.pinToTop),c.Cb(1),c.wc("dateRange",e.dateRange)("pinToTop",e.pinToTop)("format",e.format)("dashboardViewType",e.dashboardViewType)("currency",e.currency)("canSeeRates",e.canSeeRates)("earningByUser",e.mainReport&&e.mainReport.earningByUserMap)}}function Gc(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",28),c.Xb(1,"div",33),c.Xb(2,"dashboard-charts",30),c.jc("showAllBarValues",(function(t){c.Oc(e);const i=c.nc(),n=c.Lc(21);return i.openModalForBar(t,n)})),c.Wb(),c.Wb(),c.Wc(3,_c,2,9,"div",34),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.Hb("cl-order-first",!e.pinToTop),c.Cb(1),c.wc("totalTime",e.mainReport&&e.mainReport.totalTime)("horizontalChartData",e.horizontalChartData)("doughnutChart",e.doughnutChart)("totalBillable",e.totalBillable)("billablePercentage",e.billablePercentage)("currency",e.currency)("barChartLabels",e.barChartLabels)("barChartData",e.barChartData)("barChartColors",e.barChartColors)("barChartEarnings",e.barChartEarnings)("barChartAllLabels",e.barChartAllLabels)("totalTimeByDate",e.totalTimeByDate)("totalDurationByDate",e.totalDurationByDate)("format",e.format)("viewType",e.dashboardViewType)("topProjectOrEarning",e.topProjectOrEarning)("topClientOrBillable",e.topClientOrBillable)("projectGroupingLabel",e.projectGroupingLabel)("canSeeRates",e.canSeeRates)("projectCountByDate",e.projectCountByDate),c.Cb(1),c.wc("ngIf",e.adminOrOwner||e.teamManager||!e.workspace.onlyAdminsSeeAllTimeEntries)}}function Bc(e,t){if(1&e&&(c.Xb(0,"span",51),c.Yc(1),c.Wb()),2&e){const e=c.nc(2).$implicit;c.Cb(1),c.ad(" - ",e.clientName,"")}}function Vc(e,t){if(1&e&&(c.Xb(0,"span",48),c.Sb(1,"i",49),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Wc(4,Bc,2,1,"span",50),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(1),c.Vc("background",e.color,c.Kb),c.Cb(2),c.Zc(e.projectName?e.projectName:"Without project"),c.Cb(1),c.wc("ngIf",e.clientName)}}function Hc(e,t){if(1&e&&(c.Xb(0,"span",48),c.Xb(1,"span"),c.Yc(2),c.Wb(),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(2),c.Zc(e.label)}}function zc(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"tr"),c.Xb(2,"td"),c.Wc(3,Vc,5,4,"span",46),c.Wc(4,Hc,3,1,"span",46),c.Wb(),c.Xb(5,"td",44),c.Yc(6),c.oc(7,"stringDurationToTime"),c.Wb(),c.Xb(8,"td",47),c.Yc(9),c.Wb(),c.Wb(),c.Ub()),2&e){const e=t.$implicit,i=c.nc(2);c.Cb(3),c.wc("ngIf",i.dashboardViewType===i.DashboardViewType.PROJECT),c.Cb(1),c.wc("ngIf",i.dashboardViewType===i.DashboardViewType.BILLABILITY),c.Cb(2),c.Zc(c.qc(7,4,e.duration,i.format)),c.Cb(3),c.Zc(e.percentage)}}function qc(e,t){if(1&e&&(c.Xb(0,"div",36),c.Xb(1,"h1",37),c.Yc(2),c.Wb(),c.Xb(3,"button",38),c.jc("click",(function(){return t.$implicit.dismiss()})),c.Xb(4,"span",39),c.Sb(5,"img",40),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",41),c.Xb(7,"table",42),c.Xb(8,"tr"),c.Xb(9,"th",43),c.Xb(10,"b"),c.Yc(11,"Projects"),c.Wb(),c.Wb(),c.Xb(12,"th",44),c.Xb(13,"b"),c.Yc(14),c.Wb(),c.Wb(),c.Sb(15,"th"),c.Wb(),c.Wc(16,zc,10,7,"ng-container",45),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.Zc(e.labelForBar),c.Cb(12),c.Zc(e.totalTimeByBar),c.Cb(2),c.wc("ngForOf",e.modalValues)}}let Kc=(()=>{class e{constructor(e,t,i,n,s,c,r,o,a){this.reportService=e,this.authService=t,this.workspaceService=i,this.userService=n,this.uiSettingsService=s,this.loader=c,this.timezoneConverter=r,this.cd=o,this.modalService=a,this.DashboardSelection=Ws.a,this.DashboardViewType=Cs.a,this.zoomLevel="week",this.totalTimeByDate=[],this.totalDurationByDate=[],this.teamPermission=!1,this.barChartEarnings=[],this.labelsForTopTen=[],this.projectCountByDate=[],this.updateDebouncer=new Ee.a,this.unsubscribe$=new mi.a}ngOnInit(){this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(({isTeamManager:e,isAdminOrOwner:t})=>{this.teamManager=e,this.adminOrOwner=t}),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.user=this.authService.getUser(),this.format=this.workspace.getTimeFormat(),this.currency=this.workspace.hourlyRate.currency,this.projectGroupingLabel=this.workspace.getProjectGroupingLabel(),this.teamPermission=!this.workspace.onlyAdminsSeeTeamsDashboard||this.adminOrOwner||this.teamManager,this.canSeeRates=!this.workspace.onlyAdminsSeeBillableRates||this.adminOrOwner,this.dashboardViewType=this.user.settings.dashboardViewType,this.dashboardSelection=this.teamPermission?this.user.settings.dashboardSelection:Ws.a.ME,this.pinToTop=this.user.settings.dashboardPinToTop,this.initDateRange(),this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.format=e.getTimeFormat(),this.currency=e.hourlyRate.currency,this.workspace=e;const t=!this.workspace.onlyAdminsSeeTeamsDashboard||this.adminOrOwner||this.teamManager;this.teamPermission!==t&&(this.teamPermission=t,this.dashboardSelection=this.teamPermission?this.user.settings.dashboardSelection:Ws.a.ME,this.getReport())}),this.reportService.dashboardUpdate.pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.updateDebouncer.next()}),this.updateDebouncer.pipe(Object(Te.a)(6e4),Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.getReport()}),this.getReport()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initDateRange(){const e=this.uiSettingsService.getSettings(hi.b.DASHBOARD_DATE);if(!e||!Se(e.start).isValid())return this.dateRange=Object(ws.c)(this.user.settings.weekStart,this.timezoneConverter),void(this.zoomLevel="week");const t=Object(ke.c)(e.label,this.user.settings.weekStart);this.dateRange=t||{start:Se(e.start),end:Se(e.end)},this.zoomLevel=e.zoomLevel,this.dateRange.label=e.label}getReport(){this.loader.show("Loading..."),this.latest&&this.mostTracked||this.cd.detectChanges(),this.dashboardSelection===this.DashboardSelection.TEAM?(this.adminOrOwner||this.teamManager||!this.workspace.onlyAdminsSeeAllTimeEntries)&&this.latest.getLatestActivity():this.mostTracked.getMostTrackedActivities(),this.reportService.getMainReport(this.dashboardSelection,this.dashboardViewType,this.dateRange,this.zoomLevel).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.wait=!1,this.mainReport=e;const t=e=>Object(Se.duration)(e.duration).asSeconds(),i=Object.keys(this.mainReport.projectAndTotalTime);this.horizontalChartData=i.length>0?i.map(e=>this.mainReport.projectAndTotalTime[e]).sort(Object(Ss.b)(!0,t)):[{clientName:"",color:"#C6D2D9",duration:Object(Se.duration)(0),earned:0,label:"No project",projectName:"",percentage:Number(0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+"%",billableDuration:Object(Se.duration)(0)}];const n=Object.keys(this.mainReport.billableAndTotalTime);if(this.doughnutChart=n.length>0?n.map(e=>this.mainReport.billableAndTotalTime[e]).sort(Object(Ss.b)(!0,t)):[{clientName:"",color:"#C6D2D9",duration:Object(Se.duration)(0),earned:0,label:"No project",projectName:""}],this.labelsForTopTen=[],this.dashboardViewType===Cs.a.PROJECT)this.trimDataForChart();else{this.topTenByDate=this.mainReport.dateAndTotalTime;const e=Object.keys(this.mainReport.projectAndTotalTime);this.labelsForTopTen=e.length>0?[...this.horizontalChartData]:[],this.initChart()}},e=>{this.loader.hide()})}updateDateRange(e){this.areDatesEqual(e.dateRange,this.dateRange)||(this.dateRange.start=e.dateRange.start,this.dateRange.end=e.dateRange.end,this.dateRange.label=e.dateRange.label,this.zoomLevel=e.zoomLevel,this.getReport(),this.setLocalStorageData(e))}setLocalStorageData(e){if(!Object(Pt.y)(e.dateRange.start,e.dateRange.end))return void this.uiSettingsService.setSettings(hi.b.DASHBOARD_DATE,null);const t={start:e.dateRange.start.toISOString(),end:e.dateRange.end.toISOString(),zoomLevel:e.zoomLevel,label:e.dateRange.label};this.uiSettingsService.setSettings(hi.b.DASHBOARD_DATE,t)}areDatesEqual(e,t){return e.start.toISOString()===t.start.toISOString()&&e.end.toISOString()===t.end.toISOString()}toggleShowTeam(e){this.dashboardSelection=e?Ws.a.TEAM:Ws.a.ME,this.userService.updateDashboardMeSelection(this.dashboardSelection),setTimeout(()=>{this.getReport()},100)}changeViewType(e){e!==this.dashboardViewType&&(this.dashboardViewType=e==Cs.a.BILLABILITY?Cs.a.BILLABILITY:Cs.a.PROJECT,this.user.settings.dashboardViewType=this.dashboardViewType,this.userService.updateSettingsWithoutToast(this.user),setTimeout(()=>{this.getReport()},100))}pinToTopChanged(e){this.pinToTop=e}openModalForBar(e,t){this.modalValues=this.mainReport.dateAndTotalTime[this.daysBetweenDateRange[e]].sort(Object(Ss.b)(!0,e=>Object(Se.duration)(e.duration).asSeconds()));const i=Object(Se.duration)(this.totalDurationByDate[e],"s");this.totalTimeByBar=i.format(this.format,{trim:!1}),this.labelForBar="year"===this.zoomLevel?Se(this.daysBetweenDateRange[e]).format("MMMM"):Se(this.daysBetweenDateRange[e]).format("ddd, MMM D"),this.modalValues.forEach(e=>{e.percentage=Number(Object(Se.duration)(e.duration).asSeconds()/i.asSeconds()*100).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+"%"}),this.modalService.open(t,{centered:!0})}initTotals(){this.barColors=[],this.totalTime=this.mainReport.totalTime,this.totalBillableTime=Object(ws.b)(this.mainReport.totalBillable,this.format),this.totalBillable=this.mainReport.totalEarned/100;const e=Object(Se.duration)(this.mainReport.totalTime).asSeconds(),t=Object(Se.duration)(this.mainReport.totalBillable).asSeconds();this.billablePercentage=0!=e?Math.round(t/e*100).toString().concat("%"):"--",this.dashboardViewType===Cs.a.BILLABILITY?(this.topProjectOrEarning=Number(this.totalBillable).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+" "+this.currency,this.topClientOrBillable=this.billablePercentage):(this.topClientOrBillable=this.mainReport.topClient,this.topProjectOrEarning=this.findTopProject())}findTopProject(){for(let e=0;e<this.horizontalChartData.length;e++)if(this.horizontalChartData[e]&&""!==this.horizontalChartData[e].projectName)return this.horizontalChartData[e].projectName;return"--"}initLabels(){let e=[];if(this.dashboardViewType===Cs.a.PROJECT){const t=this.labelsForTopTen.map(e=>e.label).indexOf("Without_project");if(t>-1){const i=this.labelsForTopTen[t];e.push(i),this.barColors.push(new gs.a(i.color).toChartReadable()),this.labelsForTopTen.splice(t,1)}if(this.labelsForTopTen.length>0)for(let i=0;i<this.labelsForTopTen.length;i++){const t=this.labelsForTopTen[i];e.push(t),this.barColors.push(new gs.a(t.color).toChartReadable())}}else e=[{label:"Billable"},{label:"Non-billable"}],this.barColors=[new gs.a("rgba(139,195,74, 1)").toChartReadable(),new gs.a("rgba(174,213,129, 1)").toChartReadable()];return e}initChart(){this.barChartData=[],this.barChartLabels=[],this.barChartAllLabels=[],this.barChartColors=[],this.barChartEarnings=[],this.projectCountByDate=[],this.daysBetweenDateRange=Object(ws.a)(Wc.a[this.zoomLevel.toUpperCase()],this.dateRange),this.initTotals();const e=this.initLabels(),t=[];this.totalTimeByDate=[],this.totalDurationByDate=[],this.daysBetweenDateRange.forEach((i,n)=>{"month"===this.zoomLevel?(this.barChartAllLabels.push(Object(Se.utc)(i).format("ddd, MMM D")),this.barChartLabels.push(n%3==0?Object(Se.utc)(i).format("ddd, MMM D"):"")):"year"===this.zoomLevel?(this.barChartLabels.push(Object(Se.utc)(i).format("MMM")),this.barChartAllLabels.push(Object(Se.utc)(i).format("MMM"))):(this.barChartLabels.push(Object(Se.utc)(i).format("ddd, MMM D")),this.barChartAllLabels.push(Object(Se.utc)(i).format("ddd, MMM D")));const s=[],c=this.mainReport.dateAndTotalTime[i];if(e.forEach(e=>{const t=c?c.filter(t=>t.label===e.label&&(this.dashboardViewType===Cs.a.BILLABILITY||t.clientName===e.clientName))[0]:null;s.push(t?Number(Number(Object(Se.duration)(t.duration).asHours())):0)}),t.push(s),c){let e=0;c.forEach(t=>{e+=t.earned}),this.barChartEarnings.push(e)}else this.barChartEarnings.push(0);const r=Object(Se.duration)(0);if(c)for(let e=0;e<c.length;e++)r.add(Object(Se.duration)(c[e].duration));this.totalDurationByDate.push(r.asSeconds()),this.totalTimeByDate.push(window.innerWidth>500?r.format("hh:mm",{trim:!1}).concat("h"):r.format("h:mm",{trim:!1})),this.projectCountByDate.push(this.mainReport.dateAndTotalTime[i]?this.mainReport.dateAndTotalTime[i].length:0)});const i=[];for(let n=0;n<e.length;n++){const s=[];for(let e=0;e<this.daysBetweenDateRange.length;e++)s.push(t[e][n]);let c=e[n].label;e[n].clientName&&(c+=" - "+e[n].clientName),i.push(new ks(s,c).toChartReadable())}i.length>0?(this.barChartData=i,this.barChartColors=this.barColors):this.fillChartForNoData(),this.wait=!0,this.loader.hide()}fillChartForNoData(){const e=[];e.fill(0,0,this.daysBetweenDateRange.length),this.barChartData=[{data:e,label:""}],this.barChartColors=["#C6D2D9"]}trimDataForChart(){const e=Object.keys(this.mainReport.dateAndTotalTime);this.topTenByDate=JSON.parse(JSON.stringify(this.mainReport.dateAndTotalTime)),e.forEach(e=>{const t=this.mainReport.dateAndTotalTime[e].map(e=>e);if(t.length>10){const i=e=>Object(Se.duration)(e.duration).asSeconds();this.topTenByDate[e]=t.sort(Object(Ss.b)(!0,i)).slice(0,10)}this.topTenByDate[e].forEach(e=>{0!=this.labelsForTopTen.length&&0!==this.labelsForTopTen.filter(t=>t.label===e.label&&(this.dashboardViewType===Cs.a.BILLABILITY||e.clientName===t.clientName)).length||this.labelsForTopTen.push({label:e.label,color:e.color,clientName:e.clientName})})}),this.initChart()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(fs.a),c.Rb(Ce.a),c.Rb(U.a),c.Rb(ys.a),c.Rb(hi.a),c.Rb(wi.a),c.Rb(vs.a),c.Rb(c.h),c.Rb(g.q))},e.\u0275cmp=c.Lb({type:e,selectors:[["dashboard"]],viewQuery:function(e,t){var i;1&e&&(c.ed(bc,!0),c.ed(yc,!0)),2&e&&(c.Kc(i=c.kc())&&(t.latest=i.first),c.Kc(i=c.kc())&&(t.mostTracked=i.first))},decls:22,vars:6,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center"],[1,"cl-col-md-4","cl-mb-3","cl-mb-md-0","cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-md-start"],[1,"cl-float-left"],[1,"cl-col-md-8"],["class","cl-btn-group cl-w-100 cl-d-flex cl-mb-3 cl-d-md-none",4,"ngIf"],[1,"cl-d-flex","cl-align-items-sm-center","cl-justify-content-sm-end","cl-flex-column","cl-flex-sm-row"],[1,"cl-page-header-action","cl-w-md-auto","cl-mr-0","cl-mr-sm-2","cl-mb-3","cl-mb-sm-0"],["dropdownKey","",1,"cl-dropdown","cl-btn-group","cl-d-flex"],["dropdownKeyButton","",1,"cl-btn","cl-btn-outline-light","cl-text-left","cl-dropdown-toggle"],["class","cl-dropdown-menu",4,"dropdownKeyContent"],["class","cl-page-header-action cl-d-none cl-d-md-block",4,"ngIf"],[1,"cl-page-header-action","cl-w-100","cl-w-md-auto"],[3,"timeEntriesDateRange","dateRangeOut"],["class","cl-row",4,"ngIf"],["content",""],[1,"cl-btn-group","cl-w-100","cl-d-flex","cl-mb-3","cl-d-md-none"],["type","button",1,"cl-btn","cl-w-50",3,"click"],[1,"cl-dropdown-menu"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],[1,"cl-page-header-action","cl-d-none","cl-d-md-block"],["dropdown","",1,"cl-dropdown"],["type","button","id","dropdownMenuButton","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"cl-btn","cl-btn-outline-light","cl-dropdown-toggle"],["class","cl-dropdown-menu","aria-labelledby","dropdownMenuButton",4,"dropdownContent"],["aria-labelledby","dropdownMenuButton",1,"cl-dropdown-menu"],["closeDropdown","",1,"cl-dropdown-item",3,"click"],[1,"cl-row"],[1,"cl-col-lg-8","cl-col-xl-9"],[3,"totalTime","horizontalChartData","doughnutChart","totalBillable","billablePercentage","currency","barChartLabels","barChartData","barChartColors","barChartEarnings","barChartAllLabels","totalTimeByDate","totalDurationByDate","format","viewType","topProjectOrEarning","topClientOrBillable","projectGroupingLabel","canSeeRates","projectCountByDate","showAllBarValues"],[1,"cl-col-lg-4","cl-col-xl-3"],[3,"format","dateRange","user","workspace"],[1,"cl-col-12"],["class","cl-col-12",3,"cl-order-first",4,"ngIf"],[3,"dateRange","pinToTop","format","dashboardViewType","currency","canSeeRates","earningByUser","pinToTopEmitter"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body","cl-overflow-auto"],[1,"cl-m-0","tr-table-reset"],["ngbAutofocus","",1,"cl-pb-2"],[1,"cl-text-right","cl-px-2"],[4,"ngFor","ngForOf"],["class","cl-project-name",4,"ngIf"],[1,"cl-text-gray-9","cl-text-right"],[1,"cl-project-name"],[1,"cl-entry__project__dot"],["class","cl-text-gray-9",4,"ngIf"],[1,"cl-text-gray-9"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"h1",5),c.Yc(6,"Dashboard"),c.Wb(),c.Wb(),c.Xb(7,"div",6),c.Wc(8,Lc,5,8,"div",7),c.Xb(9,"div",8),c.Xb(10,"div",9),c.Xb(11,"div",10),c.Xb(12,"button",11),c.Yc(13),c.Wb(),c.Wc(14,Fc,5,4,"div",12),c.Wb(),c.Wb(),c.Wc(15,Uc,5,1,"div",13),c.Xb(16,"div",14),c.Xb(17,"datepicker-range",15),c.jc("dateRangeOut",(function(e){return t.updateDateRange(e)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(18,$c,5,24,"div",16),c.Wc(19,Gc,4,23,"div",16),c.Wb(),c.Wb(),c.Wc(20,qc,17,3,"ng-template",null,17,c.Xc)),2&e&&(c.Cb(8),c.wc("ngIf",t.teamPermission),c.Cb(5),c.ad(" ",t.dashboardViewType===t.DashboardViewType.PROJECT?"Project":"Billability"," "),c.Cb(2),c.wc("ngIf",t.teamPermission),c.Cb(2),c.wc("timeEntriesDateRange",t.dateRange),c.Cb(1),c.wc("ngIf",t.dashboardSelection==t.DashboardSelection.ME),c.Cb(1),c.wc("ngIf",t.dashboardSelection==t.DashboardSelection.TEAM))},directives:[s.u,Si.a,Ii.a,Oi.a,jn.a,Es.a,Ts.a,Yc,yc,bc,s.t],pipes:[Ps.a],encapsulation:2}),e})();var Zc=i("+NYR");let Qc=(()=>{class e{constructor(e){this.authService=e}canActivate(e,t){return this.authService.isLoggedIn()?!!this.authService.getUser()||this.authService.fetchUser().pipe(Object(Yt.a)(1),Object(Y.a)(()=>!0,()=>(this.noPermission(t.url),!1))):(this.noPermission(t.url),!1)}noPermission(e){this.authService.logout(),Zc.a.setRedirectUrl(e)}}return e.\u0275fac=function(t){return new(t||e)(c.fc(Ce.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Jc=i("ujiw"),er=i("33WN"),tr=i("KBaq"),ir=function(e){return e.SETTINGS="SETTINGS",e.PERMISSIONS="PERMISSIONS",e.USER_GROUPS="USER_GROUPS",e.REMINDERS="REMINDERS",e.ALERTS="ALERTS",e.ACCOUNTS="ACCOUNTS",e.AUTH="AUTH",e.CUSTOM_FIELDS="CUSTOM_FIELDS",e.IMPORT="IMPORT",e}({}),nr=i("i/9y"),sr=i("BO2n"),cr=i("EcEN");const rr=["fileInput"];function or(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"label",1),c.Yc(2),c.Wb(),c.Xb(3,"input",2,3),c.jc("change",(function(){return c.Oc(e),c.nc().uploadFile()})),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(1),c.xc("for",e.uid),c.wc("ngClass",e.btnClasses),c.Cb(1),c.ad(" ",e.text,"\n"),c.Cb(1),c.xc("id",e.uid),c.xc("name",e.uid),c.wc("disabled",e.inProgress||e.disabled)("accept",e.accept)}}var ar=function(e){return e.IMAGES="image/*",e.XML="text/xml",e.CSV=".csv",e}({}),lr=function(e){return e.IMAGE="image",e.CONFIG="config",e}({});let br=(()=>{class e{constructor(e,t,i){this.fileService=e,this.toaster=t,this.cd=i,this.text="Upload Image",this.btnClasses="cl-btn cl-btn-primary",this.onUploaded=new c.n,this.onError=new c.n,this.onUploadStart=new c.n,this.maxMB=1,this.accept=ar.IMAGES,this.isVisible=!0,this.unsubscribe$=new Ee.a}ngOnInit(){this.uid=Object(cr.v4)()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}uploadFile(){const e=this.inputEl.nativeElement,t=e.files.length,i=new FormData,n=this.accept===ar.IMAGES?lr.IMAGE:lr.CONFIG;if(t>0&&e.files.item(0)){const t=e.files.item(0),s=t.type;if(this.accept===ar.IMAGES&&ei.w.indexOf(s)<0)return void this.toaster.pop("error","Supported Formats are: png, jpg, gif.");if(this.accept===ar.XML&&s!==this.accept)return void this.toaster.pop("error",`Upload ${this.accept} file instead of ${s}.`);if(this.accept===ar.CSV&&s&&s!==this.accept&&"text/csv"!==s&&"application/vnd.ms-excel"!==s)return void this.toaster.pop("error",`Upload CSV file instead of ${s}.`);if(t.size>1024*this.maxMB*1024)return void this.toaster.pop("error",`Maximum file size is ${this.maxMB}MB.`);i.append("file",t),this.sendRequest(i,n,t.name),this.clearInput()}}sendRequest(e,t,i){this.inProgress=!0,this.onUploadStart.emit(),this.fileService.uploadFile(e,t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.onUploaded.emit(e.url),this.inProgress=!1},this.errorCallback.bind(this))}errorCallback(e){this.inProgress=!1,this.clearInput(),this.onError.emit(e),this.resetView()}clearInput(){try{this.inputEl.nativeElement.value=""}catch(e){}}resetView(){this.isVisible=!1,this.isVisible=!0,this.cd.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(rt),c.Rb(M.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["btn-upload-file"]],viewQuery:function(e,t){var i;1&e&&c.ed(rr,!0),2&e&&c.Kc(i=c.kc())&&(t.inputEl=i.first)},inputs:{text:"text",disabled:"disabled",btnClasses:"btnClasses",maxMB:"maxMB",accept:"accept"},outputs:{onUploaded:"onUploaded",onError:"onError",onUploadStart:"onUploadStart"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"cl-btn","pointer","cl-mb-0",3,"ngClass","for"],["type","file","tabindex","0",1,"pointer",2,"width","0","overflow","hidden",3,"id","disabled","name","accept","change"],["fileInput",""]],template:function(e,t){1&e&&c.Wc(0,or,5,7,"ng-container",0),2&e&&c.wc("ngIf",t.isVisible)},directives:[s.u,s.r],encapsulation:2}),e})();var ur=i("hfeU");const dr=["labelInput"];function pr(e,t){if(1&e){const e=c.Yb();c.Xb(0,"input",4,5),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().customLabel=t}))("change",(function(){return c.Oc(e),c.nc().onValueChanges()}))("keyup.enter",(function(){return c.Oc(e),c.Lc(1).blur()})),c.Wb()}if(2&e){const e=c.nc();c.wc("ngModel",e.customLabel)}}let hr=(()=>{class e{constructor(e){this.cd=e,this.onUpdate=new c.n,this.groupingLabel=ur.a,this.customLabel=""}set projectGroupingLabel(e){e&&(this.projectType=Object.values(ur.a).includes(e.toLowerCase())?e:ur.a.custom,this.customLabel=this.projectType===ur.a.custom?e:"")}ngOnInit(){this.projectOptions=[new di.a(ur.a.client,"Client"),new di.a(ur.a.department,"Department"),new di.a(ur.a.category,"Category"),new di.a(ur.a.custom,"Custom...")]}onValueChanges(e=!1){if(this.customLabel=this.customLabel.trim(),e&&this.projectType===ur.a.custom){this.labelInput||this.cd.detectChanges();try{this.labelInput.nativeElement.focus()}catch(t){}}this.isValid()&&this.onUpdate.emit(this.projectType===ur.a.custom?this.customLabel:this.projectType)}isValid(){return this.projectType!==ur.a.custom||!(this.customLabel.length<1||this.customLabel.length>200)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["client-label"]],viewQuery:function(e,t){var i;1&e&&c.ed(dr,!0),2&e&&c.Kc(i=c.kc())&&(t.labelInput=i.first)},inputs:{projectGroupingLabel:"projectGroupingLabel"},outputs:{onUpdate:"onUpdate"},decls:5,vars:3,consts:[[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-6"],[3,"list","value","onChanged"],["type","text","autocomplete","off","placeholder","Label name",3,"ngModel","ngModelChange","change","keyup.enter",4,"ngIf"],["type","text","autocomplete","off","placeholder","Label name",3,"ngModel","ngModelChange","change","keyup.enter"],["labelInput",""]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"dropdown-items",2),c.jc("onChanged",(function(e){return t.projectType=e,t.onValueChanges(!0)})),c.Wb(),c.Wb(),c.Xb(3,"div",1),c.Wc(4,pr,2,1,"input",3),c.Wb(),c.Wb()),2&e&&(c.Cb(2),c.wc("list",t.projectOptions)("value",t.projectType),c.Cb(2),c.wc("ngIf",t.projectType===t.groupingLabel.custom))},directives:[pn.a,s.u,p.c,p.s,p.v],encapsulation:2,changeDetection:0}),e})();var mr=i("B1Fc");let gr=(()=>{class e extends mr.a{constructor(e,t,i,n,s){super(e,t,i,n,s),this.element=e,this.renderer=t,this.viewContainer=i,this.toaster=n,this.model=s,this.maxLength=100,this.required=!0,this.inputChange=new c.n}onChange(){const e=this.element.nativeElement.value.trim();this.validate(e)?(this.templateError&&this.viewContainer.clear(),this.renderer.removeClass(this.element.nativeElement,this.errorClass),this.model.valueAccessor.writeValue(e),this.inputChange.emit(e)):this.model.valueAccessor.writeValue(this.ngModel)}validate(e){return e.length>this.maxLength?(this.handleError(`Value must be shorter than ${this.maxLength} characters.`),!1):!(this.required&&!e&&(this.handleError("Value is required."),1))}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.l),c.Rb(c.F),c.Rb(c.P),c.Rb(M.a),c.Rb(p.v))},e.\u0275dir=c.Mb({type:e,selectors:[["","inputString",""]],hostBindings:function(e,t){1&e&&c.jc("change",(function(){return t.onChange()}))},inputs:{maxLength:"maxLength",required:"required"},outputs:{inputChange:"inputChange"},features:[c.zb]}),e})();var fr=i("FsCY");let vr=(()=>{class e{constructor(){this.onClose=new c.n,this.onChange=new c.n}set roundData(e){this.round=e.round,this.minutes=e.minutes,this.initData=new Rn(e)}ngOnInit(){this.optionsRound=[new di.a("Round up to","Round up to"),new di.a("Round to nearest","Round to nearest"),new di.a("Round down to","Round down to")]}save(){const e=new Rn({round:this.round,minutes:this.minutes});e.round!==this.initData.round||e.minutes!==this.initData.minutes?this.onChange.emit(e):this.close()}close(){this.onClose.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["rounding-modal"]],inputs:{roundData:"roundData",optionsTime:"optionsTime"},outputs:{onClose:"onClose",onChange:"onChange"},decls:38,vars:5,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group"],[1,"cl-custom-control","cl-custom-radio"],["type","radio","id","rounding1","name","timeRounding","value","Round up to",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","rounding1",1,"cl-custom-control-label"],[1,"cl-text-gray-9"],[1,"cl-mt-0"],["type","radio","id","rounding2","name","timeRounding","value","Round to nearest",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","rounding2",1,"cl-custom-control-label"],["type","radio","id","rounding3","name","timeRounding","value","Round down to",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","rounding3",1,"cl-custom-control-label"],[3,"list","value","onChanged"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2,"Time rounding settings"),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.close()})),c.Xb(4,"span"),c.Sb(5,"img",3),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",4),c.Xb(7,"div"),c.Xb(8,"div",5),c.Xb(9,"div",6),c.Xb(10,"input",7),c.jc("ngModelChange",(function(e){return t.round=e})),c.Wb(),c.Xb(11,"label",8),c.Yc(12,"Round up to"),c.Wb(),c.Wb(),c.Xb(13,"div",9),c.Yc(14," e.g. if you set the interval to 30min, a 26min entry will show up in reports as 30min. "),c.Wb(),c.Wb(),c.Sb(15,"hr",10),c.Xb(16,"div",5),c.Xb(17,"div",6),c.Xb(18,"input",11),c.jc("ngModelChange",(function(e){return t.round=e})),c.Wb(),c.Xb(19,"label",12),c.Yc(20,"Round to nearest"),c.Wb(),c.Wb(),c.Xb(21,"div",9),c.Yc(22," e.g. if you set the interval to 30min, a 14min entry will show up as 0min, and 26min entry as 30min. "),c.Wb(),c.Wb(),c.Sb(23,"hr",10),c.Xb(24,"div",5),c.Xb(25,"div",6),c.Xb(26,"input",13),c.jc("ngModelChange",(function(e){return t.round=e})),c.Wb(),c.Xb(27,"label",14),c.Yc(28,"Round down to"),c.Wb(),c.Wb(),c.Xb(29,"div",9),c.Yc(30," e.g. if you set the interval to 30min, a 26min entry will show up in reports as 0min. "),c.Wb(),c.Wb(),c.Sb(31,"hr",10),c.Xb(32,"dropdown-items",15),c.jc("onChanged",(function(e){return t.minutes=e})),c.Wb(),c.Wb(),c.Wb(),c.Xb(33,"div",16),c.Xb(34,"a",17),c.jc("click",(function(){return t.close()})),c.Yc(35,"Cancel"),c.Wb(),c.Xb(36,"button",18),c.jc("click",(function(){return t.save()})),c.Yc(37," Save "),c.Wb(),c.Wb()),2&e&&(c.Cb(10),c.wc("ngModel",t.round),c.Cb(8),c.wc("ngModel",t.round),c.Cb(8),c.wc("ngModel",t.round),c.Cb(6),c.wc("list",t.optionsTime)("value",t.minutes))},directives:[p.A,p.c,p.s,p.v,pn.a],encapsulation:2,changeDetection:0}),e})();var wr=i("gzhl"),yr=i("/b/a");function Wr(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",85),c.jc("click",(function(){return c.Oc(e),c.nc().saveImage("")})),c.Yc(1,"Remove image"),c.Wb()}}function Cr(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",86),c.Xb(1,"div",32),c.Xb(2,"info",87),c.jc("dismissed",(function(){return c.Oc(e),c.nc().showTimesheetInfo=!1})),c.Yc(3," Project must be a required field. "),c.Wb(),c.Wb(),c.Wb()}2&e&&(c.Cb(2),c.wc("dismiss",!0))}function kr(e,t){1&e&&c.Sb(0,"hr",10)}function Sr(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",15),c.Xb(1,"input",88),c.jc("change",(function(){return c.Oc(e),c.nc().changeTracker()}))("ngModelChange",(function(t){return c.Oc(e),c.nc().hideTracker=t})),c.Wb(),c.Xb(2,"label",89),c.Yc(3," Hide tracker "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.wc("ngModel",e.hideTracker)}}function Ir(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",86),c.Xb(1,"div",32),c.Xb(2,"info",90),c.jc("dismissed",(function(){return c.Oc(e),c.nc().showDurationInfo=!1})),c.Yc(3),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.wc("dismiss",!0),c.Cb(1),c.ad(" ",e.workspace.trackTimeDownToSecond?"Time entries are no longer rounded up.":"All entries are round up to 1 minute while the compact mode (h:mm) is selected."," ")}}const Or=function(){return["/upgrade"]};function Xr(e,t){1&e&&(c.Xb(0,"div",91),c.Xb(1,"info"),c.Yc(2," BASIC features"),c.Xb(3,"a",92),c.Yc(4,"Upgrade"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(3),c.wc("routerLink",c.Ac(1,Or)))}function Er(e,t){1&e&&(c.Xb(0,"div",93),c.Xb(1,"info"),c.Yc(2," STANDARD features "),c.Xb(3,"a",92),c.Yc(4,"Upgrade"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(3),c.wc("routerLink",c.Ac(1,Or)))}function Tr(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.ad(", ",e.roundingMinutes," ")}}function Dr(e,t){if(1&e&&(c.Vb(0),c.Yc(1),c.Wc(2,Tr,2,1,"span",75),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.workspace.round.round,""),c.Cb(1),c.wc("ngIf",e.workspace.round.minutes)}}function Rr(e,t){1&e&&c.Yc(0," Set rounding ")}function Ar(e,t){1&e&&(c.Xb(0,"div",93),c.Xb(1,"info"),c.Yc(2," STANDARD features "),c.Xb(3,"a",92),c.Yc(4,"Upgrade"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(3),c.wc("routerLink",c.Ac(1,Or)))}function jr(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",3),c.Yc(3,"Company address"),c.Wb(),c.Xb(4,"div",4),c.Yc(5," The address of your company that appears on all your invoices under the \u201cBill from\u201d section. "),c.Wb(),c.Wb(),c.Xb(6,"div",11),c.Xb(7,"textarea",94),c.jc("change",(function(){return c.Oc(e),c.nc().modelChanged(!0)}))("ngModelChange",(function(t){return c.Oc(e),c.nc().workspace.companyAddress=t})),c.Yc(8,"          "),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(7),c.wc("ngModel",e.workspace.companyAddress)}}function xr(e,t){1&e&&(c.Xb(0,"div",93),c.Xb(1,"info"),c.Yc(2," PRO features "),c.Xb(3,"a",92),c.Yc(4,"Upgrade"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(3),c.wc("routerLink",c.Ac(1,Or)))}function Pr(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Sb(1,"hr",10),c.Xb(2,"div",0),c.Xb(3,"div",1),c.Xb(4,"div",3),c.Yc(5,"Workspace cost rate"),c.Wb(),c.Xb(6,"div",4),c.Yc(7," Default cost rate of each tracked hour (when a more specific rate isn't defined). "),c.Wb(),c.Wb(),c.Xb(8,"div",37),c.Xb(9,"div",0),c.Xb(10,"div",38),c.Xb(11,"div",39),c.Sb(12,"input",95),c.Xb(13,"div",41),c.Xb(14,"span",42),c.Xb(15,"button",43,96),c.jc("click",(function(){c.Oc(e);const t=c.Lc(16),i=c.nc(),n=c.Lc(247);return t.blur(),i.openModal(n)}))("keyup.enter",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(247);return t.openModal(i)})),c.Yc(17," Change "),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(12),c.wc("ngModel",e.costRateLabel)}}function Mr(e,t){if(1&e){const e=c.Yb();c.Xb(0,"input",97),c.jc("change",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(249);return t.confirmCheckboxChange("locationsEnabled",i)})),c.Wb()}if(2&e){const e=c.nc();c.wc("ngModel",e.workspace.locationsEnabled)}}function Yr(e,t){if(1&e){const e=c.Yb();c.Xb(0,"input",98),c.jc("change",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(251);return t.confirmCheckboxChange("screenshotsEnabled",i)})),c.Wb()}if(2&e){const e=c.nc();c.wc("ngModel",e.workspace.screenshotsEnabled)}}function Lr(e,t){if(1&e){const e=c.Yb();c.Xb(0,"rounding-modal",99),c.jc("onClose",(function(){return t.$implicit.close()}))("onChange",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().roundingSettingsChanged(i),n.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("optionsTime",e.optionsTime)("roundData",e.workspace.round)}}function Fr(e,t){if(1&e){const e=c.Yb();c.Xb(0,"hourly-rate",100),c.jc("onClose",(function(){return t.$implicit.close()}))("saveRate",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().hourlyRateChanged(i),n.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("type",e.rateType.WORKSPACE)("hourlyRate",e.workspace.hourlyRate)("hasHistoricRateFeature",e.hasHistoricRateFeature)}}function Nr(e,t){if(1&e){const e=c.Yb();c.Xb(0,"cost-rate",101),c.jc("onClose",(function(){return t.$implicit.close()}))("saveRate",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().costRateChanged(i),n.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("type",e.rateType.WORKSPACE)("costRate",e.workspace.costRate)("hasHistoricRateFeature",e.hasHistoricRateFeature)}}function Ur(e,t){1&e&&(c.Xb(0,"simple-modal",102),c.jc("confirmed",(function(){return t.$implicit.close(!0)}))("close",(function(){return t.$implicit.close(!1)})),c.Xb(1,"div",103),c.Xb(2,"div",104),c.Yc(3," You are about to activate "),c.Xb(4,"a",105),c.Yc(5,"GPS Tracking"),c.Wb(),c.Yc(6,". "),c.Wb(),c.Xb(7,"div",104),c.Xb(8,"strong",106),c.Yc(9," This feature may prove to be intrusive to the privacy of the users of your Workspace. "),c.Wb(),c.Wb(),c.Yc(10," By consenting to activation, you confirm that you have the authority to activate this feature on behalf of the Enterprise, that you fully understand "),c.Xb(11,"a",105),c.Yc(12,"the description"),c.Wb(),c.Yc(13," and you warrant that the Enterprise has taken measures to comply with the "),c.Xb(14,"a",107),c.Yc(15,"Terms"),c.Wb(),c.Yc(16,", "),c.Xb(17,"a",108),c.Yc(18,"Privacy Policy"),c.Wb(),c.Yc(19," and all applicable data protection and other legislation to the Enterprise. "),c.Wb(),c.Wb()),2&e&&c.wc("title","Confirm")("btnText","I agree")}function $r(e,t){1&e&&(c.Xb(0,"simple-modal",102),c.jc("confirmed",(function(){return t.$implicit.close(!0)}))("close",(function(){return t.$implicit.close(!1)})),c.Xb(1,"div",103),c.Xb(2,"div",104),c.Yc(3," You are about to activate "),c.Xb(4,"a",109),c.Yc(5,"Screenshots"),c.Wb(),c.Yc(6,". "),c.Wb(),c.Xb(7,"div",104),c.Xb(8,"strong",106),c.Yc(9," This feature may prove to be intrusive to the privacy of the users of your Workspace. "),c.Wb(),c.Wb(),c.Yc(10," By consenting to activation, you confirm that you have the authority to activate this feature on behalf of the Enterprise, that you fully understand "),c.Xb(11,"a",109),c.Yc(12,"the description"),c.Wb(),c.Yc(13," and you warrant that the Enterprise has taken measures to comply with the "),c.Xb(14,"a",107),c.Yc(15,"Terms"),c.Wb(),c.Yc(16,", "),c.Xb(17,"a",108),c.Yc(18,"Privacy Policy"),c.Wb(),c.Yc(19," and all applicable data protection and other legislation to the Enterprise. "),c.Wb(),c.Wb()),2&e&&c.wc("title","Confirm")("btnText","I agree")}let _r=(()=>{class e{constructor(e,t,i,n,s,c,r){this.workspaceService=e,this.authService=t,this.toaster=i,this.loader=n,this.cd=s,this.modalService=c,this.systemSettingsService=r,this.rateType=sr.a,this.optionsTime=[new di.a("1","1 minute"),new di.a("5","5 minutes"),new di.a("6","6 minutes"),new di.a("10","10 minutes"),new di.a("12","12 minutes"),new di.a("15","15 minutes"),new di.a("30","30 minutes"),new di.a("60","1 hour"),new di.a("240","4 hours")],this.durationFormats=[new di.a(!0,"Full (hh:mm:ss)"),new di.a(!1,"Compact (h:mm)")],this.renderCheckbox=!0,this.unsubscribe$=new mi.a,this.debouncerWorkspace$=new Ee.a,this.backupWorkspace="",this.Features=nr.a}set workspace(e){e&&(this.isCostRateActiveBackup=e.isCostRateActive,this.backupWorkspace=e.toJson(),this._workspace=gc.a.clone(e),this.setRoundingMinutes())}get workspace(){return this._workspace}ngOnInit(){this.hideTracker=!this.workspace.canSeeTracker,this.debouncerWorkspace$.pipe(Object(Te.a)(600),Object(De.a)(this.unsubscribe$)).subscribe(this.save.bind(this)),this.currency=this.workspace.hourlyRate.currency,this.setRoundingMinutes(),this.systemSettingsService.systemSettings$.pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isSelfHosted=!e.specialFeaturesActivated})}ngOnDestroy(){this.save(),this.unsubscribe$.next(!0),this.unsubscribe$.complete(),this.loader.hide()}get costRateLabel(){return Object(Pt.m)(this.workspace.costRate)}get hourlyRateLabel(){return this.workspace.hourlyRate&&this.workspace.hourlyRate.amount||0}openModal(e){this.modalService.open(e,{centered:!0})}saveImage(e){this.workspace.image=e,this.modelChanged(!0)}roundingSettingsChanged(e){this.workspace.round.minutes=e.minutes,this.workspace.round.round=e.round,this.setRoundingMinutes(),this.modelChanged()}changeTimeSheet(){const e=this.workspace.canSeeTimeSheet;e?this.workspace.forceProjects=!0:this.hasFeature(nr.a.REQUIRED_FIELDS)||(this.workspace.forceProjects=!1),this.showTimesheetInfo=e,this.modelChanged()}changeTracker(){this.workspace.canSeeTracker=!this.hideTracker,this.modelChanged()}durationFormatChanged(e){this.showDurationInfo=!0,this.workspace.trackTimeDownToSecond=e,this.modelChanged()}changedForceProject(){this.workspace.forceProjects||(this.workspace.forceTasks=!1),this.modelChanged()}changedForceTasks(){this.workspace.forceTasks&&(this.workspace.forceProjects=!0),this.modelChanged()}setFirstCostRate(){const e={amount:0,currency:this.currency,since:Se().toISOString()};this.costRateChanged(e)}rerenderInputs(){this.renderCheckbox=!1,this.cd.detectChanges(),this.renderCheckbox=!0,this.cd.detectChanges()}confirmCheckboxChange(e,t){const i=this.workspace[e],n=!i;if(!n)return this.workspace[e]=n,void this.modelChanged();this.modalService.open(t,{centered:!0}).result.then(t=>{t?(this.workspace[e]=n,this.modelChanged(!0)):(this.workspace[e]=i,this.rerenderInputs())},t=>{this.workspace[e]=i,this.rerenderInputs()})}modelChanged(e=!1){e?this.save():this.debouncerWorkspace$.next()}hourlyRateChanged(e){this.loader.show("Updating...","Just a moment please",{minDuration:1e3}),this.workspaceService.setHourlyRate(e.amount,e.currency,e.since).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>this.loader.hide(),()=>this.loader.hide()),this.currency=e.currency}costRateChanged(e){this.loader.show("Updating...","Just a moment please",{minDuration:1e3}),this.workspaceService.setCostRate(e.amount,this.currency,e.since).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>this.loader.hide(),()=>this.loader.hide())}setRoundingMinutes(){try{const e=this.workspace.round.minutes;this.roundingMinutes=this.optionsTime.filter(t=>t.value===e)[0].label}catch(e){}}save(){!this.workspace.hasFeature(nr.a.LABOR_COST)||null!==this.workspace.costRate&&null!==this.workspace.costRate.amount||this.setFirstCostRate();const e=this.workspace.toJson();this.backupWorkspace!==e&&this.workspaceService.updateWorkspaceSettings(this.workspace)}hasFeature(e){return!!this.isSelfHosted||this.workspace.features.includes(e)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(Ce.a),c.Rb(M.a),c.Rb(wi.a),c.Rb(c.h),c.Rb(g.q),c.Rb(Lt.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["settings-tab"]],inputs:{workspace:"workspace",hasHistoricRateFeature:"hasHistoricRateFeature"},decls:252,vars:63,consts:[[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12"],[1,"cl-mb-3"],[1,"cl-h2","cl-mb-0"],[1,"cl-text-gray-9","cl-w-lg-75"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-avatar","cl-upload-img",3,"classSize","src","name"],[1,"cl-upload-btn-wrapper"],[1,"cl-mr-3",3,"onUploaded"],["class","cl-color-blue",3,"click",4,"ngIf"],[1,"cl-mt-0"],[1,"cl-form-group","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-5"],["type","text","autocomplete","off","spellcheck","false","placeholder","Workspace name",1,"cl-form-control",3,"ngModel","change","keyup.enter","ngModelChange"],["nameInput",""],["class","cl-form-row cl-w-100",4,"ngIf"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","name","activateTimesheet","id","activateTimesheet",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","activateTimesheet",1,"cl-custom-control-label"],["class","cl-mt-0",4,"ngIf"],["class","cl-custom-control cl-custom-switch",4,"ngIf"],[1,"cl-custom-control","cl-custom-radio","cl-custom-control-inline"],["type","radio","id","nonBillable","name","defaultBillableProjects",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","nonBillable",1,"cl-custom-control-label"],["type","radio","id","billable","name","defaultBillableProjects",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","billable",1,"cl-custom-control-label"],["type","radio","id","statusPublic","name","isProjectPublicByDefault",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","statusPublic",1,"cl-custom-control-label"],["type","radio","id","statusPrivate","name","isProjectPublicByDefault",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","statusPrivate",1,"cl-custom-control-label"],[1,"cl-form-group","cl-mb-0","cl-col-md-12","cl-col-lg-5"],[3,"projectGroupingLabel","onUpdate"],[1,"cl-text-gray-9","cl-w-lg-100"],[1,"cl-form-group","cl-col-md-12","cl-col-lg-5"],[1,"cl-form-group","cl-mb-0","cl-col-md-6"],[3,"list","value","onChanged"],["type","checkbox","id","projectFavorites",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","projectFavorites",1,"cl-custom-control-label"],[1,"cl-form-group","cl-mb-0","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-5"],[1,"cl-form-group","cl-col-md-6"],[1,"cl-input-group"],["type","text","readonly","",1,"cl-form-control","cl-cut-text","cl-cursor-disabled",3,"ngModel"],[1,"cl-input-group-append"],[1,"cl-input-group-text","cl-bg-white"],["tabindex","0",1,"cl-color-blue",3,"click","keyup.enter"],["hourlyRateBtn",""],[1,"cl-form-group","cl-mb-0","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-4"],[1,"cl-form-group","cl-col-md-3"],["type","text","id","currency","autocomplete","off","inputString","","spellcheck","false","placeholder","Currency",1,"cl-form-control",3,"ngModel","keyup.enter","inputChange"],["currencyInput",""],["class","cl-form-group",4,"ngIf"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox","id","forceProjects",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange","change"],["placement","right","for","forceProjects",1,"cl-custom-control-label",3,"ngbTooltip"],["type","checkbox","id","forceTasks",1,"cl-custom-control-input",3,"ngModel","ngModelChange","change"],["for","forceTasks",1,"cl-custom-control-label"],["type","checkbox","id","forceTags",1,"cl-custom-control-input",3,"ngModel","ngModelChange","change"],["for","forceTags",1,"cl-custom-control-label"],["type","checkbox","id","forceDescription",1,"cl-custom-control-input",3,"ngModel","ngModelChange","change"],["for","forceDescription",1,"cl-custom-control-label"],["class","cl-form-group cl-mt-2 cl-mt-lg-0",4,"ngIf"],[3,"click"],[4,"ngIf","ngIfElse"],["noRounding",""],[1,"cl-custom-control","cl-custom-switch","cl-form-group"],["type","checkbox","id","taskRateEnabled",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","taskRateEnabled",1,"cl-custom-control-label"],["type","checkbox","id","taskBillableEnabled",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","taskBillableEnabled",1,"cl-custom-control-label"],["type","checkbox","id","timeApprovalEnabled",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","timeApprovalEnabled",1,"cl-custom-control-label"],["type","checkbox","id","invoicingEnabled",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","invoicingEnabled",1,"cl-custom-control-label"],["class","cl-form-row",4,"ngIf"],["type","checkbox","name","activateCostRate","id","activateCostRate",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","activateCostRate",1,"cl-custom-control-label"],[4,"ngIf"],["type","checkbox","class","cl-custom-control-input","name","activateGpsTrackingOption","id","activateGpsTrackingOption",3,"ngModel","change",4,"ngIf"],["for","activateGpsTrackingOption",1,"cl-custom-control-label"],["type","checkbox","class","cl-custom-control-input","id","screenshotsEnabled",3,"ngModel","change",4,"ngIf"],["for","screenshotsEnabled",1,"cl-custom-control-label"],["timeRoundingModal",""],["hourlyRateModal",""],["costRateModal",""],["confirmGpsModal",""],["confirmScreenshotsModal",""],[1,"cl-color-blue",3,"click"],[1,"cl-form-row","cl-w-100"],[3,"dismiss","dismissed"],["type","checkbox","name","activateTimesheet2","id","activateTimesheet2",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","activateTimesheet2",1,"cl-custom-control-label"],[1,"cl-d-block","cl-ml-1","cl-mr-n1",3,"dismiss","dismissed"],[1,"cl-form-group"],[1,"cl-btn",3,"routerLink"],[1,"cl-form-group","cl-mt-2","cl-mt-lg-0"],["rows","3","type","text","autocomplete","off","spellcheck","false","placeholder","Company address",1,"cl-form-control",3,"ngModel","change","ngModelChange"],["type","text","readonly","",1,"cl-form-control","cl-cut-text",3,"ngModel"],["costRateBtn",""],["type","checkbox","name","activateGpsTrackingOption","id","activateGpsTrackingOption",1,"cl-custom-control-input",3,"ngModel","change"],["type","checkbox","id","screenshotsEnabled",1,"cl-custom-control-input",3,"ngModel","change"],[3,"optionsTime","roundData","onClose","onChange"],[3,"type","hourlyRate","hasHistoricRateFeature","onClose","saveRate"],[3,"type","costRate","hasHistoricRateFeature","onClose","saveRate"],[3,"title","btnText","confirmed","close"],[1,"cl-text-dark","cl-mb-0"],[1,"cl-mb-2"],["href","https://clockify.me/help/extra-features/gps-tracking","target","_blank"],[1,"cl-uppercase"],["href","https://clockify.me/terms","target","_blank"],["href","https://clockify.me/privacy","target","_blank"],["href","https://clockify.me/help/extra-features/screenshots","target","_blank"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Yc(4,"Company logo"),c.Wb(),c.Xb(5,"div",4),c.Yc(6," Company logo will appear in shared reports and branded PDF exports. Formats: png, jpg, gif. Max size: 1 MB. "),c.Wb(),c.Wb(),c.Xb(7,"div",5),c.Sb(8,"avatar",6),c.Xb(9,"div",7),c.Xb(10,"btn-upload-file",8),c.jc("onUploaded",(function(e){return t.saveImage(e)})),c.Wb(),c.Wc(11,Wr,2,0,"a",9),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(12,"hr",10),c.Xb(13,"div",0),c.Xb(14,"div",1),c.Xb(15,"div",3),c.Yc(16,"Workspace name"),c.Wb(),c.Wb(),c.Xb(17,"div",11),c.Xb(18,"input",12,13),c.jc("change",(function(){return t.modelChanged()}))("keyup.enter",(function(){return c.Oc(e),c.Lc(19).blur()}))("ngModelChange",(function(e){return t.workspace.name=e})),c.Wb(),c.Wb(),c.Wb(),c.Sb(20,"hr",10),c.Xb(21,"div",0),c.Xb(22,"div",1),c.Xb(23,"div",3),c.Yc(24,"Timesheet"),c.Wb(),c.Xb(25,"div",4),c.Yc(26," Enter time on tasks and projects using a weekly timesheet view. While activated, project is a required field for the whole workspace. "),c.Wb(),c.Wb(),c.Wc(27,Cr,4,1,"div",14),c.Xb(28,"div",1),c.Xb(29,"div",15),c.Xb(30,"input",16),c.jc("change",(function(){return t.changeTimeSheet()}))("ngModelChange",(function(e){return t.workspace.canSeeTimeSheet=e})),c.Wb(),c.Xb(31,"label",17),c.Yc(32," Activate timesheet "),c.Wb(),c.Wb(),c.Wc(33,kr,1,0,"hr",18),c.Wc(34,Sr,4,1,"div",19),c.Wb(),c.Wb(),c.Sb(35,"hr",10),c.Xb(36,"div",0),c.Xb(37,"div",1),c.Xb(38,"div",3),c.Yc(39,"New projects are by default"),c.Wb(),c.Xb(40,"div",4),c.Yc(41," When you create a project, make it public so it's available to all users, and billable so its time entries are set as billable. "),c.Wb(),c.Wb(),c.Xb(42,"div",1),c.Xb(43,"div",20),c.Xb(44,"input",21),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.defaultBillableProjects=e})),c.Wb(),c.Xb(45,"label",22),c.Yc(46,"Non-billable"),c.Wb(),c.Wb(),c.Xb(47,"div",20),c.Xb(48,"input",23),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.defaultBillableProjects=e})),c.Wb(),c.Xb(49,"label",24),c.Yc(50,"Billable"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(51,"hr",10),c.Xb(52,"div",0),c.Xb(53,"div",1),c.Xb(54,"div",20),c.Xb(55,"input",25),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.isProjectPublicByDefault=e})),c.Wb(),c.Xb(56,"label",26),c.Yc(57,"Public"),c.Wb(),c.Wb(),c.Xb(58,"div",20),c.Xb(59,"input",27),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.isProjectPublicByDefault=e})),c.Wb(),c.Xb(60,"label",28),c.Yc(61,"Private"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(62,"hr",10),c.Xb(63,"div",0),c.Xb(64,"div",1),c.Xb(65,"div",3),c.Yc(66,"Group projects by"),c.Wb(),c.Xb(67,"div",4),c.Yc(68," If you don\u2019t have clients or departments, you can change the label to something else. "),c.Wb(),c.Wb(),c.Xb(69,"div",29),c.Xb(70,"client-label",30),c.jc("onUpdate",(function(e){return t.workspace.projectGroupingLabel=e,t.modelChanged()})),c.Wb(),c.Wb(),c.Wb(),c.Sb(71,"hr",10),c.Xb(72,"div",0),c.Xb(73,"div",1),c.Xb(74,"div",3),c.Yc(75,"Duration format"),c.Wb(),c.Xb(76,"div",31),c.Yc(77," Display time in clock format (with or without seconds). "),c.Wb(),c.Wb(),c.Wc(78,Ir,4,2,"div",14),c.Xb(79,"div",32),c.Xb(80,"div",0),c.Xb(81,"div",33),c.Xb(82,"dropdown-items",34),c.jc("onChanged",(function(e){return t.durationFormatChanged(e)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(83,"hr",10),c.Xb(84,"div",0),c.Xb(85,"div",1),c.Xb(86,"div",3),c.Yc(87,"Project favorites"),c.Wb(),c.Xb(88,"div",4),c.Yc(89," Let people mark their most used projects as favorite so they appear at the top of their project list when tracking time. "),c.Wb(),c.Wb(),c.Xb(90,"div",32),c.Xb(91,"div",15),c.Xb(92,"input",35),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.projectFavorites=e})),c.Wb(),c.Xb(93,"label",36),c.Yc(94,"Activate project favorites"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(95,"hr",10),c.Xb(96,"div",0),c.Xb(97,"div",1),c.Xb(98,"div",3),c.Yc(99,"Workspace billable rate"),c.Wb(),c.Xb(100,"div",4),c.Yc(101," Default value of each billable hour when there\u2019s no user or project hourly rate. "),c.Wb(),c.Wb(),c.Xb(102,"div",37),c.Xb(103,"div",0),c.Xb(104,"div",38),c.Xb(105,"div",39),c.Sb(106,"input",40),c.Xb(107,"div",41),c.Xb(108,"span",42),c.Xb(109,"a",43,44),c.jc("click",(function(){c.Oc(e);const i=c.Lc(110),n=c.Lc(245);return i.blur(),t.openModal(n)}))("keyup.enter",(function(){c.Oc(e);const i=c.Lc(245);return t.openModal(i)})),c.Yc(111," Change "),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(112,"div",0),c.Xb(113,"div",1),c.Xb(114,"div",3),c.Yc(115,"Currency"),c.Wb(),c.Xb(116,"div",4),c.Yc(117," The currency in which the billable and cost amounts will be displayed in reports. "),c.Wb(),c.Wb(),c.Xb(118,"div",45),c.Xb(119,"div",0),c.Xb(120,"div",46),c.Xb(121,"input",47,48),c.jc("keyup.enter",(function(){return c.Oc(e),c.Lc(122).blur()}))("inputChange",(function(e){return t.workspace.hourlyRate.currency=e,t.hourlyRateChanged(t.workspace.hourlyRate)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(123,"hr",10),c.Wc(124,Xr,5,2,"div",49),c.Xb(125,"div",0),c.Xb(126,"div",1),c.Xb(127,"div",3),c.Yc(128,"Do not allow saving time without"),c.Wb(),c.Xb(129,"div",4),c.Yc(130,"Entries with missing required fields won\u2019t be saved. "),c.Wb(),c.Wb(),c.Xb(131,"div",1),c.Xb(132,"div",50),c.Xb(133,"input",51),c.jc("ngModelChange",(function(e){return t.workspace.forceProjects=e}))("change",(function(){return t.changedForceProject()})),c.Wb(),c.Xb(134,"label",52),c.Yc(135,"Project"),c.Wb(),c.Wb(),c.Xb(136,"div",50),c.Xb(137,"input",53),c.jc("ngModelChange",(function(e){return t.workspace.forceTasks=e}))("change",(function(){return t.changedForceTasks()})),c.Wb(),c.Xb(138,"label",54),c.Yc(139,"Tasks"),c.Wb(),c.Wb(),c.Xb(140,"div",50),c.Xb(141,"input",55),c.jc("ngModelChange",(function(e){return t.workspace.forceTags=e}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Xb(142,"label",56),c.Yc(143,"Tag"),c.Wb(),c.Wb(),c.Xb(144,"div",50),c.Xb(145,"input",57),c.jc("ngModelChange",(function(e){return t.workspace.forceDescription=e}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Xb(146,"label",58),c.Yc(147,"Description"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(148,"hr",10),c.Wc(149,Er,5,2,"div",59),c.Xb(150,"div"),c.Xb(151,"div",0),c.Xb(152,"div",1),c.Xb(153,"div",3),c.Yc(154,"Time rounding"),c.Wb(),c.Xb(155,"div",4),c.Yc(156,"Round time in reports up, down, or to nearest X minutes. "),c.Wb(),c.Wb(),c.Xb(157,"div",1),c.Xb(158,"a",60),c.jc("click",(function(){c.Oc(e);const i=c.Lc(243);return t.openModal(i)})),c.Wc(159,Dr,3,2,"ng-container",61),c.Wc(160,Rr,1,0,"ng-template",null,62,c.Xc),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(162,"hr",10),c.Wc(163,Ar,5,2,"div",59),c.Xb(164,"div"),c.Xb(165,"div",0),c.Xb(166,"div",1),c.Xb(167,"div",3),c.Yc(168,"Task rates"),c.Wb(),c.Xb(169,"div",4),c.Yc(170," Have a different rate depending on the task on a project, plus choose whether tasks are billable by default. "),c.Wb(),c.Wb(),c.Wb(),c.Xb(171,"div",63),c.Xb(172,"input",64),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.taskRateEnabled=e})),c.Wb(),c.Xb(173,"label",65),c.Yc(174," Enable hourly rates for task "),c.Wb(),c.Wb(),c.Xb(175,"div",63),c.Xb(176,"input",66),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.taskBillableEnabled=e})),c.Wb(),c.Xb(177,"label",67),c.Yc(178," Enable billable and non-billable tasks "),c.Wb(),c.Wb(),c.Wb(),c.Sb(179,"hr",10),c.Xb(180,"div"),c.Xb(181,"div",0),c.Xb(182,"div",1),c.Xb(183,"div",3),c.Yc(184,"Time approval"),c.Wb(),c.Xb(185,"div",4),c.Yc(186," Your team can submit their weekly timesheets for review, which you can approve or reject. "),c.Wb(),c.Wb(),c.Wb(),c.Xb(187,"div",63),c.Xb(188,"input",68),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.timeApprovalEnabled=e})),c.Wb(),c.Xb(189,"label",69),c.Yc(190," Enable time approval "),c.Wb(),c.Wb(),c.Wb(),c.Sb(191,"hr",10),c.Xb(192,"div"),c.Xb(193,"div",0),c.Xb(194,"div",1),c.Xb(195,"div",3),c.Yc(196,"Invoicing"),c.Wb(),c.Xb(197,"div",4),c.Yc(198," Create and download invoices for clients based on tracked time. "),c.Wb(),c.Wb(),c.Wb(),c.Xb(199,"div",63),c.Xb(200,"input",70),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.invoicingEnabled=e})),c.Wb(),c.Xb(201,"label",71),c.Yc(202," Enable invoicing "),c.Wb(),c.Wb(),c.Wc(203,jr,9,1,"div",72),c.Wb(),c.Sb(204,"hr",10),c.Wc(205,xr,5,2,"div",59),c.Xb(206,"div"),c.Xb(207,"div",0),c.Xb(208,"div",1),c.Xb(209,"div",3),c.Yc(210,"Cost and profit analysis"),c.Wb(),c.Xb(211,"div",4),c.Yc(212," Set labor cost rates and see in reports what you charge clients vs what you pay your team. "),c.Wb(),c.Wb(),c.Wb(),c.Xb(213,"div",63),c.Xb(214,"input",73),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.isCostRateActive=e})),c.Wb(),c.Xb(215,"label",74),c.Yc(216," Activate cost rate "),c.Wb(),c.Wb(),c.Wc(217,Pr,18,1,"ng-container",75),c.Wb(),c.Sb(218,"hr",10),c.Xb(219,"div"),c.Xb(220,"div",0),c.Xb(221,"div",1),c.Xb(222,"div",3),c.Yc(223,"Track location"),c.Wb(),c.Xb(224,"div",4),c.Yc(225," See all client job sites that were visted by your remote field workers who clock-in via the mobile app (iOS & Android). "),c.Wb(),c.Wb(),c.Wb(),c.Xb(226,"div",63),c.Wc(227,Mr,1,1,"input",76),c.Xb(228,"label",77),c.Yc(229," Activate GPS tracking "),c.Wb(),c.Wb(),c.Wb(),c.Sb(230,"hr",10),c.Xb(231,"div"),c.Xb(232,"div",0),c.Xb(233,"div",1),c.Xb(234,"div",3),c.Yc(235,"Capture screenshots"),c.Wb(),c.Xb(236,"div",31),c.Yc(237," Generate screenshots every 5 minutes while the timer is running (desktop app only). "),c.Wb(),c.Wb(),c.Wb(),c.Xb(238,"div",63),c.Wc(239,Yr,1,1,"input",78),c.Xb(240,"label",79),c.Yc(241," Activate screenshot capturing "),c.Wb(),c.Wb(),c.Wb(),c.Wc(242,Lr,1,2,"ng-template",null,80,c.Xc),c.Wc(244,Fr,1,3,"ng-template",null,81,c.Xc),c.Wc(246,Nr,1,3,"ng-template",null,82,c.Xc),c.Wc(248,Ur,20,2,"ng-template",null,83,c.Xc),c.Wc(250,$r,20,2,"ng-template",null,84,c.Xc)}if(2&e){const e=c.Lc(161);c.Cb(8),c.wc("classSize","cl-no-image-wrapper-lg")("src",t.workspace.image)("name",t.workspace.name),c.Cb(3),c.wc("ngIf",t.workspace.image),c.Cb(7),c.wc("ngModel",t.workspace.name),c.Cb(9),c.wc("ngIf",t.showTimesheetInfo),c.Cb(2),c.Hb("cl-form-group",t.workspace.canSeeTimeSheet),c.Cb(1),c.wc("ngModel",t.workspace.canSeeTimeSheet),c.Cb(3),c.wc("ngIf",t.workspace.canSeeTimeSheet),c.Cb(1),c.wc("ngIf",t.workspace.canSeeTimeSheet),c.Cb(10),c.wc("value",!1)("ngModel",t.workspace.defaultBillableProjects),c.Cb(4),c.wc("value",!0)("ngModel",t.workspace.defaultBillableProjects),c.Cb(7),c.wc("value",!0)("ngModel",t.workspace.isProjectPublicByDefault),c.Cb(4),c.wc("value",!1)("ngModel",t.workspace.isProjectPublicByDefault),c.Cb(11),c.wc("projectGroupingLabel",t.workspace.projectGroupingLabel),c.Cb(8),c.wc("ngIf",t.showDurationInfo),c.Cb(4),c.wc("list",t.durationFormats)("value",t.workspace.trackTimeDownToSecond),c.Cb(10),c.wc("ngModel",t.workspace.projectFavorites),c.Cb(14),c.wc("ngModel",t.hourlyRateLabel),c.Cb(15),c.wc("ngModel",t.workspace.hourlyRate.currency),c.Cb(3),c.wc("ngIf",!t.hasFeature(t.Features.REQUIRED_FIELDS)),c.Cb(1),c.Hb("disable-area",!t.hasFeature(t.Features.REQUIRED_FIELDS)),c.Cb(8),c.wc("ngModel",t.workspace.forceProjects)("disabled",t.workspace.canSeeTimeSheet),c.Cb(1),c.wc("ngbTooltip",t.workspace.canSeeTimeSheet?"To disable required project selection, timesheet must be off":""),c.Cb(3),c.wc("ngModel",t.workspace.forceTasks),c.Cb(4),c.wc("ngModel",t.workspace.forceTags),c.Cb(4),c.wc("ngModel",t.workspace.forceDescription),c.Cb(4),c.wc("ngIf",!t.hasFeature(t.Features.TASK_RATES)&&!t.hasFeature(t.Features.WORKSPACE_TIME_ROUNDING)),c.Cb(1),c.Hb("disable-area",!t.hasFeature(t.Features.WORKSPACE_TIME_ROUNDING)),c.Cb(9),c.wc("ngIf",t.workspace.round.round)("ngIfElse",e),c.Cb(4),c.wc("ngIf",!t.hasFeature(t.Features.TASK_RATES)&&t.hasFeature(t.Features.WORKSPACE_TIME_ROUNDING)),c.Cb(1),c.Hb("disable-area",!t.hasFeature(t.Features.TASK_RATES)),c.Cb(8),c.wc("ngModel",t.workspace.taskRateEnabled),c.Cb(4),c.wc("ngModel",t.workspace.taskBillableEnabled),c.Cb(4),c.Hb("disable-area",!t.hasFeature(t.Features.APPROVAL)),c.Cb(8),c.wc("ngModel",t.workspace.timeApprovalEnabled),c.Cb(4),c.Hb("disable-area",!t.hasFeature(t.Features.INVOICING)),c.Cb(8),c.wc("ngModel",t.workspace.invoicingEnabled),c.Cb(3),c.wc("ngIf",t.workspace.invoicingEnabled),c.Cb(2),c.wc("ngIf",!t.hasFeature(t.Features.SCREENSHOTS)),c.Cb(1),c.Hb("disable-area",!t.hasFeature(t.Features.LABOR_COST)),c.Cb(8),c.wc("ngModel",t.workspace.isCostRateActive),c.Cb(3),c.wc("ngIf",t.isCostRateActiveBackup&&t.workspace.isCostRateActive),c.Cb(2),c.Hb("disable-area",!t.hasFeature(t.Features.LOCATIONS)),c.Cb(8),c.wc("ngIf",t.renderCheckbox),c.Cb(4),c.Hb("disable-area",!t.hasFeature(t.Features.SCREENSHOTS)),c.Cb(8),c.wc("ngIf",t.renderCheckbox)}},directives:[Ds.a,br,s.u,p.c,p.s,p.v,p.a,p.A,hr,pn.a,gr,g.Z,fr.a,W.f,vr,wr.a,yr.a,Ui.a],encapsulation:2,changeDetection:0}),e})();var Gr=function(e){return e.PROJECT="PROJECT",e.TEAM="TEAM",e.REPORTS="REPORTS",e}({}),Br=i("Jl2N"),Vr=function(e){return e[e.ALL=0]="ALL",e[e.PUBLIC=1]="PUBLIC",e[e.OWN=2]="OWN",e}({});let Hr=(()=>{class e{constructor(){this.onChanged=new c.n,this.userCanSee=Vr}set onlyAdminsSeeAllTimeEntries(e){const t=this.onlyAdminsSeeAllTimeEntries!==e;this._onlyAdminsSeeAllTimeEntries=e,this.isInitialized&&t&&this.setInitValues()}get onlyAdminsSeeAllTimeEntries(){return this._onlyAdminsSeeAllTimeEntries}set onlyAdminsSeePublicProjectsEntries(e){const t=this.onlyAdminsSeePublicProjectsEntries!==e;this._onlyAdminsSeePublicProjectsEntries=e,this.isInitialized&&t&&this.setInitValues()}get onlyAdminsSeePublicProjectsEntries(){return this._onlyAdminsSeePublicProjectsEntries}ngOnInit(){this.setInitValues(),this.isInitialized=!0}modelChanged(){this.regularUserCanSee===Vr.ALL?this.onlyAdminsSeeAllTimeEntries=!1:this.regularUserCanSee===Vr.PUBLIC?(this.onlyAdminsSeeAllTimeEntries=!0,this.onlyAdminsSeePublicProjectsEntries=!1):this.regularUserCanSee===Vr.OWN&&(this.onlyAdminsSeeAllTimeEntries=!0,this.onlyAdminsSeePublicProjectsEntries=!0),this.onChanged.emit({onlyAdminsSeeAllTimeEntries:this.onlyAdminsSeeAllTimeEntries,onlyAdminsSeePublicProjectsEntries:this.onlyAdminsSeePublicProjectsEntries})}setInitValues(){this.regularUserCanSee=this.onlyAdminsSeeAllTimeEntries?this.onlyAdminsSeePublicProjectsEntries?Vr.OWN:Vr.PUBLIC:Vr.ALL}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["regular-user-permission"]],inputs:{onlyAdminsSeeAllTimeEntries:"onlyAdminsSeeAllTimeEntries",onlyAdminsSeePublicProjectsEntries:"onlyAdminsSeePublicProjectsEntries"},outputs:{onChanged:"onChanged"},decls:12,vars:6,consts:[[1,"cl-custom-control","cl-custom-radio","cl-custom-control-inline"],["type","radio","id","allTrackedTime","name","allTrackedTime",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","allTrackedTime",1,"cl-custom-control-label"],["type","radio","id","onlyTimeOnPublic","name","onlyTimeOnPublic",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","onlyTimeOnPublic",1,"cl-custom-control-label"],["type","radio","id","onlyOwnTime","name","onlyOwnTime",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","onlyOwnTime",1,"cl-custom-control-label"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"input",1),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.regularUserCanSee=e})),c.Wb(),c.Xb(2,"label",2),c.Yc(3,"All tracked time"),c.Wb(),c.Wb(),c.Xb(4,"div",0),c.Xb(5,"input",3),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.regularUserCanSee=e})),c.Wb(),c.Xb(6,"label",4),c.Yc(7,"Only time on public projects"),c.Wb(),c.Wb(),c.Xb(8,"div",0),c.Xb(9,"input",5),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.regularUserCanSee=e})),c.Wb(),c.Xb(10,"label",6),c.Yc(11,"Only their own time"),c.Wb(),c.Wb()),2&e&&(c.Cb(1),c.wc("value",t.userCanSee.ALL)("ngModel",t.regularUserCanSee),c.Cb(4),c.wc("value",t.userCanSee.PUBLIC)("ngModel",t.regularUserCanSee),c.Cb(4),c.wc("value",t.userCanSee.OWN)("ngModel",t.regularUserCanSee))},directives:[p.A,p.c,p.s,p.v],encapsulation:2,changeDetection:0}),e})();class zr{constructor(e){this._type=e&&e.type,this._changeDay=e&&e.changeDay,this._firstDay=e&&e.firstDay,this._dayOfMonth=e&&Number(e.dayOfMonth)>0?Number(e.dayOfMonth):0,this._olderThanPeriod=e&&e.olderThanPeriod,this._olderThanValue=e&&e.olderThanValue}get type(){return this._type}set type(e){this._type=e}get changeDay(){return this._changeDay}set changeDay(e){this._changeDay=e}get firstDay(){return this._firstDay}set firstDay(e){this._firstDay=e}get dayOfMonth(){return this._dayOfMonth}set dayOfMonth(e){this._dayOfMonth=e}get olderThanPeriod(){return this._olderThanPeriod}set olderThanPeriod(e){this._olderThanPeriod=e}get olderThanValue(){return this._olderThanValue}set olderThanValue(e){this._olderThanValue=e}}var qr=function(e){return e.WEEKLY="WEEKLY",e.MONTHLY="MONTHLY",e.OLDER_THAN="OLDER_THAN",e}({}),Kr=function(e){return e.DAYS="DAYS",e.WEEKS="WEEKS",e.MONTHS="MONTHS",e}({}),Zr=i("+dED");function Qr(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div"),c.Xb(1,"span"),c.Yc(2,"Every "),c.Wb(),c.Xb(3,"dropdown-items",11),c.jc("onChanged",(function(t){c.Oc(e);const i=c.nc(2);return i.automaticLock.changeDay=t,i.valueChanged()})),c.Wb(),c.Xb(4,"span"),c.Yc(5,", lock the previous week (first day of the week is considered "),c.Wb(),c.Xb(6,"dropdown-items",11),c.jc("onChanged",(function(t){c.Oc(e);const i=c.nc(2);return i.automaticLock.firstDay=t,i.valueChanged()})),c.Wb(),c.Yc(7,"). "),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(3),c.wc("type","TEXT")("list",e.weekDays)("value",e.automaticLock.changeDay),c.Cb(3),c.wc("type","TEXT")("list",e.weekDays)("value",e.automaticLock.firstDay)}}function Jr(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div"),c.Xb(1,"span"),c.Yc(2,"On the "),c.Wb(),c.Xb(3,"dropdown-items",11),c.jc("onChanged",(function(t){c.Oc(e);const i=c.nc(2);return i.automaticLock.dayOfMonth=t,i.valueChanged()})),c.Wb(),c.Xb(4,"span"),c.Yc(5," of every month, lock the previous month"),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(3),c.wc("type","TEXT")("list",e.monthDates)("value",e.automaticLock.dayOfMonth)}}function eo(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",12),c.Xb(1,"div",13),c.Xb(2,"input",14),c.jc("inputChange",(function(t){c.Oc(e);const i=c.nc(2);return i.automaticLock.olderThanValue=t,i.valueChanged()})),c.Wb(),c.Wb(),c.Xb(3,"dropdown-items",15),c.jc("onChanged",(function(t){c.Oc(e);const i=c.nc(2);return i.automaticLock.olderThanPeriod=t,i.valueChanged()})),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(2),c.wc("maxNumber",999)("minNumber",1)("decimal",!1)("ngModel",e.automaticLock.olderThanValue),c.Cb(1),c.wc("type","TEXT")("list",e.periods)("value",e.automaticLock.olderThanPeriod)}}function to(e,t){if(1&e&&(c.Xb(0,"span",16),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.bd(" (Everything before ",e.date," will be locked on ",e.nextLockScheduledDate,") ")}}function io(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",6),c.Xb(1,"dropdown-items",7),c.jc("onChanged",(function(t){c.Oc(e);const i=c.nc();return i.automaticLock.type=t,i.setType()})),c.Wb(),c.Wc(2,Qr,8,6,"div",8),c.Wc(3,Jr,6,3,"div",8),c.Wc(4,eo,4,7,"div",9),c.Wc(5,to,2,2,"span",10),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.wc("type","SMALL")("list",e.lockTypes)("value",e.automaticLock.type),c.Cb(1),c.wc("ngIf",e.automaticLock.type===e.automaticLockTypeEnum.WEEKLY),c.Cb(1),c.wc("ngIf",e.automaticLock.type===e.automaticLockTypeEnum.MONTHLY),c.Cb(1),c.wc("ngIf",e.automaticLock.type===e.automaticLockTypeEnum.OLDER_THAN),c.Cb(1),c.wc("ngIf",e.automaticLock.type!==e.automaticLockTypeEnum.OLDER_THAN)}}let no=(()=>{class e{constructor(e){this.authService=e,this.onLockChanged=new c.n,this.automaticLockTypeEnum=qr,this.weekDays=[new di.a("MONDAY","Monday"),new di.a("TUESDAY","Tuesday"),new di.a("WEDNESDAY","Wednesday"),new di.a("THURSDAY","Thursday"),new di.a("FRIDAY","Friday"),new di.a("SATURDAY","Saturday"),new di.a("SUNDAY","Sunday")],this.periods=[new di.a(Kr.DAYS,"Days"),new di.a(Kr.WEEKS,"Weeks"),new di.a(Kr.MONTHS,"Months")],this.lockTypes=[new di.a(qr.WEEKLY,"Weekly"),new di.a(qr.MONTHLY,"Monthly"),new di.a(qr.OLDER_THAN,"Older than")],this.monthDates=[];for(let t=1;t<=31;t++)this.monthDates.push(new di.a(t,Object(Pt.b)(t)))}set automaticLock(e){this.hasLockedData=!!e,e?(this._automaticLock=new zr(e),this.backupLock=new zr(e)):this._automaticLock=null}get automaticLock(){return this._automaticLock}set lockDate(e){this._lockDate=e,this.isInitialized&&this.updateDateForAutomaticLock()}get lockDate(){return this._lockDate}ngOnInit(){this.dateFormat=this.authService.getUser().settings.dateFormat,this.updateDateForAutomaticLock(),this.isInitialized=!0}automaticLockChange(){if(!this.hasLockedData)return this.automaticLock=null,void this.onLockChanged.emit(null);this.automaticLock||(this.automaticLock=this.backupLock||new zr({type:qr.WEEKLY,changeDay:this.weekDays[2].value,firstDay:this.weekDays[0].value,dayOfMonth:this.monthDates[0].value,olderThanPeriod:Kr.DAYS,olderThanValue:1})),this.emit()}setType(){const e=this.automaticLock.type;(e===qr.MONTHLY&&!this.automaticLock.dayOfMonth||isNaN(Number(this.automaticLock.dayOfMonth)))&&(this.automaticLock.dayOfMonth=this.monthDates[0].value),e!==qr.OLDER_THAN||this.automaticLock.olderThanValue||(this.automaticLock.olderThanValue="1"),this.updateDateForAutomaticLock(),this.emit()}valueChanged(){this.updateDateForAutomaticLock(),this.emit()}updateDateForAutomaticLock(){if(this.automaticLock)switch(this.automaticLock.type){case qr.WEEKLY:this.setDatesForWeeklyAutomaticLock();break;case qr.MONTHLY:this.setDatesForMonthlyAutomaticLock();break;case qr.OLDER_THAN:this.setDatesForOlderThanAutomaticLock()}}setDatesForWeeklyAutomaticLock(){const e=jt().isoWeekday(this.automaticLock.changeDay),t=jt(this.lockDate).add(1,"week");e.isBefore(t,"day")&&e.add(1,"week"),this.nextLockScheduledDate=e.format(this.dateFormat),this.date=t.format(this.dateFormat)}setDatesForMonthlyAutomaticLock(){if(isNaN(Number(this.automaticLock.dayOfMonth)))return;const e=jt().date(Number(this.automaticLock.dayOfMonth));e.isSameOrBefore(jt(),"day")&&e.add(1,"month"),this.nextLockScheduledDate=e.format(this.dateFormat),this.date=e.clone().startOf("month").format(this.dateFormat)}setDatesForOlderThanAutomaticLock(){switch(this.automaticLock.olderThanPeriod){case Kr.DAYS:this.date=jt().subtract(this.automaticLock.olderThanValue,"days").format(this.dateFormat);break;case Kr.WEEKS:this.date=jt().subtract(this.automaticLock.olderThanValue,"weeks").format(this.dateFormat);break;case Kr.MONTHS:this.date=jt().subtract(this.automaticLock.olderThanValue,"months").format(this.dateFormat)}}emit(){const e=new zr(this.automaticLock);this.onLockChanged.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Ce.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["automatic-lock"]],inputs:{automaticLock:"automaticLock",lockDate:"lockDate",disabled:"disabled"},outputs:{onLockChanged:"onLockChanged"},decls:8,vars:3,consts:[[1,"cl-form-group","cl-col-md-12"],[1,"cl-custom-control","cl-custom-switch","cl-mb-1"],["type","checkbox","name","automaticallyLock","id","automaticallyLock",1,"cl-custom-control-input",3,"disabled","ngModel","ngModelChange","change"],["for","automaticallyLock",1,"cl-custom-control-label"],[1,"cl-text-gray-9","cl-w-lg-75"],["class","cl-form-group cl-col-12 cl-d-flex cl-align-items-center",4,"ngIf"],[1,"cl-form-group","cl-col-12","cl-d-flex","cl-align-items-center"],[1,"cl-mr-2",3,"type","list","value","onChanged"],[4,"ngIf"],["class","cl-d-flex cl-align-items-center",4,"ngIf"],["class","cl-ml-1 cl-text-gray-9",4,"ngIf"],[1,"cl-d-inline-block",3,"type","list","value","onChanged"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-col-2","cl-px-0","cl-mr-2"],["type","text","inputNumber","",1,"cl-form-control","cl-form-control-sm","cl-text-center",3,"maxNumber","minNumber","decimal","ngModel","inputChange"],[1,"cl-mx-1","cl-d-inline-block",3,"type","list","value","onChanged"],[1,"cl-ml-1","cl-text-gray-9"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"input",2),c.jc("ngModelChange",(function(e){return t.hasLockedData=e}))("change",(function(){return t.automaticLockChange()})),c.Wb(),c.Xb(3,"label",3),c.Yc(4," Automatically update lock date "),c.Wb(),c.Wb(),c.Xb(5,"div",4),c.Yc(6," Your lock date will get auto-updated each day, week, or month. "),c.Wb(),c.Wb(),c.Wc(7,io,6,7,"div",5)),2&e&&(c.Cb(2),c.wc("disabled",t.disabled)("ngModel",t.hasLockedData),c.Cb(5),c.wc("ngIf",t.hasLockedData))},directives:[p.a,p.s,p.v,s.u,pn.a,p.c,Zr.a],encapsulation:2,changeDetection:0}),e})();var so=i("62PR");const co=function(e){return{start:e}};let ro=(()=>{class e{constructor(){this.onPickedDate=new c.n}set lockTimeEntries(e){this.hasLockedDate=!!e,this._lockTimeEntries=jt(e).startOf("day").toISOString()}get lockTimeEntries(){return this._lockTimeEntries}ngOnInit(){this.maxDate=jt(),this.backupValue=jt().startOf("day").toISOString()}pickedDate({start:e}){this.backupValue=e,this.emit(e)}lockChanged(){this.emit(this.hasLockedDate?this.lockTimeEntries||this.backupValue:null)}emit(e){this.isFeatureEnabled&&this.onPickedDate.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["manual-lock"]],inputs:{lockTimeEntries:"lockTimeEntries",automaticLock:"automaticLock",isFeatureEnabled:"isFeatureEnabled"},outputs:{onPickedDate:"onPickedDate"},decls:5,vars:11,consts:[[1,"cl-custom-control","cl-custom-switch","cl-custom-control-inline"],["type","checkbox","id","manualLockSwitch",1,"cl-custom-control-input",3,"disabled","ngModel","change","ngModelChange"],["for","manualLockSwitch",1,"cl-custom-control-label"],["placement","right",1,"cl-d-inline-flex","cl-align-items-center",2,"position","relative","top","-5px",3,"ngbTooltip","disableEdit","maxDate","debounce","mode","textualDate","dateTime","pickedDate"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"input",1),c.jc("change",(function(){return t.lockChanged()}))("ngModelChange",(function(e){return t.hasLockedDate=e})),c.Wb(),c.Xb(2,"label",2),c.Yc(3,"Lock time before"),c.Wb(),c.Wb(),c.Xb(4,"single-date-picker2",3),c.jc("pickedDate",(function(e){return t.pickedDate(e)})),c.Wb()),2&e&&(c.Cb(1),c.wc("disabled",t.automaticLock&&!t.hasLockedDate)("ngModel",t.hasLockedDate),c.Cb(3),c.wc("ngbTooltip",t.automaticLock?"To manually edit lock date, turn off automatic lock.":"")("disableEdit",!t.hasLockedDate||t.automaticLock)("maxDate",t.maxDate)("debounce",!1)("mode","date_only")("textualDate",!0)("dateTime",c.Bc(9,co,t.lockTimeEntries||t.backupValue)))},directives:[p.a,p.s,p.v,so.a,g.Z],encapsulation:2,changeDetection:0}),e})();const oo=function(){return["/upgrade"]};function ao(e,t){1&e&&(c.Xb(0,"div",35),c.Xb(1,"info"),c.Yc(2," BASIC features"),c.Xb(3,"a",36),c.Yc(4,"Upgrade"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(3),c.wc("routerLink",c.Ac(1,oo)))}function lo(e,t){1&e&&c.Tb(0)}function bo(e,t){if(1&e&&(c.Vb(0),c.Wc(1,lo,1,0,"ng-container",37),c.Sb(2,"hr",10),c.Ub()),2&e){c.nc();const e=c.Lc(83);c.Cb(1),c.wc("ngTemplateOutlet",e)}}function uo(e,t){1&e&&(c.Xb(0,"div",35),c.Xb(1,"info"),c.Yc(2," BASIC features"),c.Xb(3,"a",36),c.Yc(4,"Upgrade"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(3),c.wc("routerLink",c.Ac(1,oo)))}function po(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",11),c.Xb(1,"input",38),c.jc("change",(function(){return c.Oc(e),c.nc().modelChanged()}))("ngModelChange",(function(i){return c.Oc(e),t.$implicit.protected=i})),c.Wb(),c.Xb(2,"label",39),c.Yc(3),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit;c.Cb(1),c.yc("id","hide_",e.label,""),c.yc("name","hide_",e.label,""),c.wc("ngModel",e.protected),c.Cb(1),c.yc("for","hide_",e.label,""),c.Cb(1),c.Zc(e.label)}}function ho(e,t){1&e&&(c.Xb(0,"div",40),c.Xb(1,"info"),c.Yc(2," STANDARD features "),c.Xb(3,"a",36),c.Yc(4,"Upgrade"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(3),c.wc("routerLink",c.Ac(1,oo)))}function mo(e,t){1&e&&c.Tb(0)}function go(e,t){if(1&e&&(c.Vb(0),c.Wc(1,mo,1,0,"ng-container",37),c.Ub()),2&e){c.nc();const e=c.Lc(83);c.Cb(1),c.wc("ngTemplateOutlet",e)}}function fo(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",41),c.Xb(2,"div",2),c.Yc(3,"Lock time"),c.Wb(),c.Xb(4,"div",3),c.Yc(5," Prevent regular users from editing their past time or adding new entries to past dates. "),c.Wb(),c.Wb(),c.Xb(6,"div",42),c.Xb(7,"div",0),c.Xb(8,"div",43),c.Xb(9,"manual-lock",44),c.jc("onPickedDate",(function(t){return c.Oc(e),c.nc().manualLockChanged(t)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Hb("disable-area",!e.hasFeature(e.Features.WORKSPACE_LOCK_TIMEENTRIES)),c.Cb(9),c.wc("automaticLock",e.workspace.automaticLock)("isFeatureEnabled",e.hasFeature(e.Features.WORKSPACE_LOCK_TIMEENTRIES))("lockTimeEntries",e.workspace.lockTimeEntries)}}function vo(e,t){1&e&&(c.Xb(0,"div",40),c.Xb(1,"info"),c.Yc(2," PRO features "),c.Xb(3,"a",36),c.Yc(4,"Upgrade"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(3),c.wc("routerLink",c.Ac(1,oo)))}let wo=(()=>{class e{constructor(e,t,i,n,s){this.workspaceService=e,this.authService=t,this.toaster=i,this.loader=n,this.systemSettingsService=s,this.adminOnlyPages=[{label:"Projects",value:Gr.PROJECT,protected:!1},{label:"Team",value:Gr.TEAM,protected:!1},{label:"Reports",value:Gr.REPORTS,protected:!1}],this.unsubscribe$=new mi.a,this.debouncerWorkspace$=new Ee.a,this.backupWorkspace="",this.Features=nr.a}set workspace(e){e&&(this.disableManualMode=e.timeTrackingMode===Br.a.STOPWATCH_ONLY,this.backupWorkspace=e.toJson(),this._workspace=gc.a.clone(e),this.clientLabel=Object(Pt.l)(e.projectGroupingLabel))}get workspace(){return this._workspace}ngOnInit(){this.adminOnlyPages=this.adminOnlyPages.map(e=>(e.protected=this.workspace.adminOnlyPages.indexOf(e.value)>-1,e)),this.debouncerWorkspace$.pipe(Object(Te.a)(600),Object(De.a)(this.unsubscribe$)).subscribe(this.save.bind(this)),this.systemSettingsService.systemSettings$.pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isSelfHosted=!e.specialFeaturesActivated})}ngOnDestroy(){this.save(),this.unsubscribe$.next(!0),this.unsubscribe$.complete(),this.loader.hide()}get moveUpManualLockFeature(){return this.hasFeature(nr.a.WORKSPACE_LOCK_TIMEENTRIES)&&!this.hasFeature(nr.a.AUTOMATIC_LOCK)}manualLockChanged(e){this.workspace.lockTimeEntries=e,e||(this.workspace.automaticLock=null),this.modelChanged()}disableManualModeChange(){this.workspace.timeTrackingMode=this.disableManualMode?Br.a.STOPWATCH_ONLY:Br.a.DEFAULT,this.modelChanged()}modelChanged(e=!1){e?this.save():this.debouncerWorkspace$.next()}save(){this.workspace.adminOnlyPages=this.adminOnlyPages.filter(e=>e.protected).map(e=>e.value);const e=this.workspace.toJson();this.backupWorkspace!==e&&this.workspaceService.updateWorkspaceSettings(this.workspace)}hasFeature(e){return!!this.isSelfHosted||this.workspace.features.includes(e)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(Ce.a),c.Rb(M.a),c.Rb(wi.a),c.Rb(Lt.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["permissions-tab"]],inputs:{workspace:"workspace"},decls:99,vars:38,consts:[[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12"],[1,"cl-h2","cl-mb-0"],[1,"cl-text-gray-9","cl-w-lg-75"],[1,"cl-form-group","col-md-12"],[1,"cl-custom-control","cl-custom-radio","cl-custom-control-inline"],["type","radio","id","billableRatesAdmins","name","billableRatesAdmins",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","billableRatesAdmins",1,"cl-custom-control-label"],["type","radio","id","billableRatesEveryone","name","billableRatesAdmins",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","billableRatesEveryone",1,"cl-custom-control-label"],[1,"cl-mt-0"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox","id","onlyAdminsCreateProject","name","onlyAdminsCreateProject",1,"cl-custom-control-input",3,"ngModel","change"],["for","onlyAdminsCreateProject",1,"cl-custom-control-label"],["type","checkbox","id","onlyAdminsCreateTag","name","onlyAdminsCreateTag",1,"cl-custom-control-input",3,"ngModel","change"],["for","onlyAdminsCreateTag",1,"cl-custom-control-label"],["type","checkbox","id","onlyAdminsCreateTask","name","onlyAdminsCreateTask",1,"cl-custom-control-input",3,"ngModel","change"],["for","onlyAdminsCreateTask",1,"cl-custom-control-label"],["class","cl-form-group",4,"ngIf"],[3,"onlyAdminsSeeAllTimeEntries","onlyAdminsSeePublicProjectsEntries","onChanged"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","id","teamDashboardCheckbox",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","teamDashboardCheckbox",1,"cl-custom-control-label"],[4,"ngIf"],["type","radio","id","projectStatusAdmins","name","projectStatusAdmins",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","projectStatusAdmins",1,"cl-custom-control-label"],["type","radio","id","projectStatusEveryone","name","projectStatusEveryone",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","projectStatusEveryone",1,"cl-custom-control-label"],["class","cl-custom-control cl-custom-checkbox cl-custom-control-inline",4,"ngFor","ngForOf"],["class","cl-form-group cl-mt-2 cl-mt-lg-0",4,"ngIf"],["manualLockTemplate",""],[1,"cl-form-row","cl-relative","cl-z-index",3,"disabled","lockDate","automaticLock","onLockChanged"],[1,"cl-custom-control","cl-custom-switch","cl-form-group"],["type","checkbox","name","disableManualModeOption","id","disableManualModeOption",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","disableManualModeOption",1,"cl-custom-control-label"],[1,"cl-form-group"],[1,"cl-btn",3,"routerLink"],[4,"ngTemplateOutlet"],["type","checkbox",1,"cl-custom-control-input",3,"id","ngModel","name","change","ngModelChange"],[1,"cl-custom-control-label",3,"for"],[1,"cl-form-group","cl-mt-2","cl-mt-lg-0"],[1,"cl-form-group","cl-col-md-12","cl-mb-0"],[1,"cl-form-group","cl-mb-0","cl-col-md-12","cl-d-flex"],[1,"cl-form-group","cl-col-md-12","cl-d-flex","cl-mb-0"],[3,"automaticLock","isFeatureEnabled","lockTimeEntries","onPickedDate"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Yc(3,"Who can see billable rates and amounts"),c.Wb(),c.Xb(4,"div",3),c.Yc(5," Hide billable rates and amounts from regular users so only admins can see them. "),c.Wb(),c.Wb(),c.Xb(6,"div",4),c.Xb(7,"div",5),c.Xb(8,"input",6),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.onlyAdminsSeeBillableRates=e})),c.Wb(),c.Xb(9,"label",7),c.Yc(10," Admins "),c.Wb(),c.Wb(),c.Xb(11,"div",5),c.Xb(12,"input",8),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.onlyAdminsSeeBillableRates=e})),c.Wb(),c.Xb(13,"label",9),c.Yc(14," Everyone "),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(15,"hr",10),c.Xb(16,"div",0),c.Xb(17,"div",1),c.Xb(18,"div",2),c.Yc(19," Regular users can create "),c.Wb(),c.Xb(20,"div",3),c.Yc(21," Control how much freedom your team has when categorizing their tracked time. "),c.Wb(),c.Wb(),c.Xb(22,"div",1),c.Xb(23,"div",11),c.Xb(24,"input",12),c.jc("change",(function(){return t.workspace.onlyAdminsCreateProject=!t.workspace.onlyAdminsCreateProject,t.modelChanged()})),c.Wb(),c.Xb(25,"label",13),c.Yc(26),c.Wb(),c.Wb(),c.Xb(27,"div",11),c.Xb(28,"input",14),c.jc("change",(function(){return t.workspace.onlyAdminsCreateTag=!t.workspace.onlyAdminsCreateTag,t.modelChanged()})),c.Wb(),c.Xb(29,"label",15),c.Yc(30,"Tags"),c.Wb(),c.Wb(),c.Xb(31,"div",11),c.Xb(32,"input",16),c.jc("change",(function(){return t.workspace.onlyAdminsCreateTask=!t.workspace.onlyAdminsCreateTask,t.modelChanged()})),c.Wb(),c.Xb(33,"label",17),c.Yc(34,"Tasks"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(35,"hr",10),c.Wc(36,ao,5,2,"div",18),c.Xb(37,"div",0),c.Xb(38,"div",1),c.Xb(39,"div",2),c.Yc(40,"Regular users can see"),c.Wb(),c.Xb(41,"div",3),c.Yc(42,"Prevent regular users from seeing other people\u2019s time entries. "),c.Wb(),c.Wb(),c.Xb(43,"div",1),c.Xb(44,"regular-user-permission",19),c.jc("onChanged",(function(e){return t.workspace.onlyAdminsSeeAllTimeEntries=e.onlyAdminsSeeAllTimeEntries,t.workspace.onlyAdminsSeePublicProjectsEntries=e.onlyAdminsSeePublicProjectsEntries,t.modelChanged()})),c.Wb(),c.Wb(),c.Wb(),c.Sb(45,"hr",10),c.Xb(46,"div",0),c.Xb(47,"div",1),c.Xb(48,"div",20),c.Xb(49,"input",21),c.jc("ngModelChange",(function(){return t.workspace.onlyAdminsSeeTeamsDashboard=!t.workspace.onlyAdminsSeeTeamsDashboard,t.modelChanged()})),c.Wb(),c.Xb(50,"label",22),c.Yc(51," Users can access Team Dashboard "),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(52,"hr",10),c.Wc(53,bo,3,1,"ng-container",23),c.Xb(54,"div",0),c.Xb(55,"div",1),c.Xb(56,"div",2),c.Yc(57,"Who can see project status"),c.Wb(),c.Xb(58,"div",3),c.Yc(59,"Allow people to see status on their projects so they can know how much of the estimate is left. "),c.Wb(),c.Wb(),c.Xb(60,"div",1),c.Xb(61,"div",5),c.Xb(62,"input",24),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.onlyAdminsSeeProjectStatus=e})),c.Wb(),c.Xb(63,"label",25),c.Yc(64,"Admins"),c.Wb(),c.Wb(),c.Xb(65,"div",5),c.Xb(66,"input",26),c.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.workspace.onlyAdminsSeeProjectStatus=e})),c.Wb(),c.Xb(67,"label",27),c.Yc(68,"Everyone"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(69,"hr",10),c.Wc(70,uo,5,2,"div",18),c.Xb(71,"div",0),c.Xb(72,"div",1),c.Xb(73,"div",2),c.Yc(74,"Hide pages from regular users"),c.Wb(),c.Xb(75,"div",3),c.Yc(76," Remove pages from sidebar so regular users can\u2019t access them. "),c.Wb(),c.Wb(),c.Xb(77,"div",1),c.Wc(78,po,4,5,"div",28),c.Wb(),c.Wb(),c.Sb(79,"hr",10),c.Wc(80,ho,5,2,"div",29),c.Wc(81,go,2,1,"ng-container",23),c.Wc(82,fo,10,5,"ng-template",null,30,c.Xc),c.Xb(84,"div"),c.Xb(85,"automatic-lock",31),c.jc("onLockChanged",(function(e){return t.workspace.automaticLock=e,t.modelChanged()})),c.Wb(),c.Wb(),c.Sb(86,"hr",10),c.Wc(87,vo,5,2,"div",29),c.Xb(88,"div"),c.Xb(89,"div",0),c.Xb(90,"div",1),c.Xb(91,"div",2),c.Yc(92,"Force timer"),c.Wb(),c.Xb(93,"div",3),c.Yc(94," Prevent users from adding time manually and editing time of their existing entries. "),c.Wb(),c.Wb(),c.Wb(),c.Xb(95,"div",32),c.Xb(96,"input",33),c.jc("change",(function(){return t.disableManualModeChange()}))("ngModelChange",(function(e){return t.disableManualMode=e})),c.Wb(),c.Xb(97,"label",34),c.Yc(98," Disable adding and editing time manually "),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(8),c.wc("value",!0)("ngModel",t.workspace.onlyAdminsSeeBillableRates),c.Cb(4),c.wc("value",!1)("ngModel",t.workspace.onlyAdminsSeeBillableRates),c.Cb(12),c.wc("ngModel",!t.workspace.onlyAdminsCreateProject),c.Cb(2),c.ad("Projects and ",t.clientLabel,""),c.Cb(2),c.wc("ngModel",!t.workspace.onlyAdminsCreateTag),c.Cb(4),c.wc("ngModel",!t.workspace.onlyAdminsCreateTask),c.Cb(4),c.wc("ngIf",!t.hasFeature(t.Features.HIDE_PAGES)&&!t.hasFeature(t.Features.WHO_CAN_SEE_ALL_TIME_ENTRIES)),c.Cb(1),c.Hb("disable-area",!t.hasFeature(t.Features.WHO_CAN_SEE_ALL_TIME_ENTRIES)),c.Cb(7),c.wc("onlyAdminsSeeAllTimeEntries",t.workspace.onlyAdminsSeeAllTimeEntries)("onlyAdminsSeePublicProjectsEntries",t.workspace.onlyAdminsSeePublicProjectsEntries),c.Cb(2),c.Hb("disable-area",!t.hasFeature(t.Features.WHO_CAN_SEE_TEAMS_DASHBOARD)),c.Cb(3),c.wc("ngModel",!t.workspace.onlyAdminsSeeTeamsDashboard),c.Cb(4),c.wc("ngIf",t.moveUpManualLockFeature),c.Cb(1),c.Hb("disable-area",!t.hasFeature(t.Features.WHO_CAN_SEE_PROJECT_STATUS)),c.Cb(8),c.wc("value",!0)("ngModel",t.workspace.onlyAdminsSeeProjectStatus),c.Cb(4),c.wc("value",!1)("ngModel",t.workspace.onlyAdminsSeeProjectStatus),c.Cb(4),c.wc("ngIf",!t.hasFeature(t.Features.HIDE_PAGES)&&t.hasFeature(t.Features.WHO_CAN_SEE_ALL_TIME_ENTRIES)),c.Cb(1),c.Hb("disable-area",!t.hasFeature(t.Features.HIDE_PAGES)),c.Cb(7),c.wc("ngForOf",t.adminOnlyPages),c.Cb(2),c.wc("ngIf",!t.hasFeature(t.Features.AUTOMATIC_LOCK)),c.Cb(1),c.wc("ngIf",!t.moveUpManualLockFeature),c.Cb(3),c.Hb("disable-area",!t.hasFeature(t.Features.AUTOMATIC_LOCK)),c.Cb(1),c.wc("disabled",!t.hasFeature(t.Features.AUTOMATIC_LOCK))("lockDate",t.workspace.lockTimeEntries)("automaticLock",t.workspace.automaticLock),c.Cb(2),c.wc("ngIf",!t.hasFeature(t.Features.DISABLE_MANUAL_MODE)),c.Cb(1),c.Hb("disable-area",!t.hasFeature(t.Features.DISABLE_MANUAL_MODE)),c.Cb(8),c.wc("ngModel",t.disableManualMode))},directives:[p.A,p.c,p.s,p.v,p.a,s.u,Hr,s.t,no,fr.a,W.f,s.B,ro],encapsulation:2,changeDetection:0}),e})();var yo=function(e){return e.PROJECT="PROJECT",e.TASK="TASK",e}({}),Wo=function(e){return e.WORKSPACE_ADMIN="WORKSPACE_ADMIN",e.PROJECT_MANAGER="PROJECT_MANAGER",e.TEAM_MEMBERS="TEAM_MEMBERS",e.PROJECT_MEMBERS="PROJECT_MEMBERS",e.TASK_MEMBERS="TASK_MEMBERS",e}({});const Co=[new di.a(yo.PROJECT,"Project"),new di.a(yo.TASK,"Task")],ko=[new di.a(50,"50%"),new di.a(75,"75%"),new di.a(100,"100%")],So=[new di.a(Wo.TEAM_MEMBERS,"Project members"),new di.a(Wo.PROJECT_MANAGER,"Project manager"),new di.a(Wo.WORKSPACE_ADMIN,"Workspace admin")],Io=[new di.a(Wo.TEAM_MEMBERS,"Tasks assignees"),new di.a(Wo.PROJECT_MANAGER,"Project manager"),new di.a(Wo.WORKSPACE_ADMIN,"Workspace admin")];let Oo=(()=>{class e{constructor(e){this.alertService=e,this.createdAlert=new c.n,this.alertTypes=Co,this.percentages=ko,this.alertGroups=So,this.newAlert=new ut,this.inProgress=!1,this.unsubscribe$=new Ee.a}ngOnInit(){this.resetAlert()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}resetAlert(){this.newAlert=new ut({id:null,workspaceId:null,alertType:yo.PROJECT,percentage:50,alertPerson:Wo.WORKSPACE_ADMIN})}addAlert(){this.inProgress=!0,this.alertService.createAlert(this.newAlert,this.workspaceId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.resetAlert(),this.createdAlert.emit(e),this.inProgress=!1},()=>this.inProgress=!1)}changeAlertGroups(e){this.alertGroups=e===yo.PROJECT?So:Io}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(dt))},e.\u0275cmp=c.Lb({type:e,selectors:[["new-alert"]],inputs:{workspaceId:"workspaceId"},outputs:{createdAlert:"createdAlert"},decls:19,vars:10,consts:[[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-row"],[1,"cl-col-12"],[1,"cl-form-group","cl-mb-0"],[1,"cl-form-row","cl-align-items-center","cl-justify-content-lg-end"],[1,"cl-col-auto","cl-mb-2","cl-mb-lg-0"],[1,"cl-mx-1","cl-d-inline-block",3,"type","list","value","onChanged"],[1,"cl-col-auto"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"div",5),c.Xb(6,"div"),c.Xb(7,"span"),c.Yc(8,"If"),c.Wb(),c.Xb(9,"dropdown-items",6),c.jc("onChanged",(function(e){return t.newAlert.alertType=e,t.changeAlertGroups(e)})),c.Wb(),c.Xb(10,"span"),c.Yc(11,"reaches"),c.Wb(),c.Xb(12,"dropdown-items",6),c.jc("onChanged",(function(e){return t.newAlert.percentage=e})),c.Wb(),c.Xb(13,"span"),c.Yc(14,"of estimate, alert"),c.Wb(),c.Xb(15,"dropdown-items",6),c.jc("onChanged",(function(e){return t.newAlert.alertPerson=e})),c.Wb(),c.Wb(),c.Wb(),c.Xb(16,"div",7),c.Xb(17,"button",8),c.jc("click",(function(){return t.addAlert()})),c.Yc(18,"Add"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(9),c.wc("type","TEXT")("list",t.alertTypes)("value",t.newAlert.alertType),c.Cb(3),c.wc("type","TEXT")("list",t.percentages)("value",t.newAlert.percentage),c.Cb(3),c.wc("type","TEXT")("list",t.alertGroups)("value",t.newAlert.alertPerson),c.Cb(2),c.wc("disabled",t.inProgress))},directives:[pn.a],encapsulation:2}),e})();function Xo(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",8),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().deleteAlert(i)}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Xb(1,"p",9),c.Yc(2,"Are you sure you want to delete this alert?"),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Delete alert")("btnText","Delete")("isDanger",!0)("inProgress",e.inProgress)}}let Eo=(()=>{class e{constructor(e,t){this.alertService=e,this.modalService=t,this.deletedAlert=new c.n,this.alertTypes=Co,this.percentages=ko,this.unsubscribe$=new Ee.a,this.alerts=[],this.inProgress=!1}set alert(e){this._alert=e,this.alertGroups=this.alert.alertType===yo.PROJECT?So:Io}get alert(){return this._alert}ngOnInit(){}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}updateAlert(){this.alertService.updateAlert(this.alert,this.workspaceId)}deleteAlert(e){this.inProgress=!0,this.alertService.deleteAlert(this.alert.id,this.workspaceId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.deletedAlert.emit(t.id),this.inProgress=!1,e.close()},()=>this.inProgress=!1)}openDeleteModal(e){this.modalService.open(e,{centered:!0})}changeAlertGroups(e){this.alertGroups=e===yo.PROJECT?So:Io}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(dt),c.Rb(g.q))},e.\u0275cmp=c.Lb({type:e,selectors:[["alert-row"]],inputs:{workspaceId:"workspaceId",alert:"alert"},outputs:{deletedAlert:"deletedAlert"},decls:17,vars:9,consts:[[1,"cl-component-row","cl-px-0"],[1,"cl-d-flex","cl-flex-column","cl-flex-lg-row","cl-w-100","cl-align-items-start","cl-align-items-lg-center"],[1,"cl-px-2","cl-px-lg-3","cl-py-3"],[1,"cl-mx-1","cl-d-inline-block",3,"type","list","value","onChanged"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end","cl-template-separator-mob","cl-min-height-40","cl-w-100","cl-w-lg-auto","cl-ml-auto",3,"click"],[1,"cl-component-divided-left"],["src","assets/images/ui-icons/close.svg"],["deleteModal",""],[3,"title","btnText","isDanger","inProgress","confirmed","close"],[1,"cl-mb-0"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"span"),c.Yc(4,"If"),c.Wb(),c.Xb(5,"dropdown-items",3),c.jc("onChanged",(function(e){return t.alert.alertType=e,t.updateAlert(),t.changeAlertGroups(e)})),c.Wb(),c.Xb(6,"span"),c.Yc(7,"reaches"),c.Wb(),c.Xb(8,"dropdown-items",3),c.jc("onChanged",(function(e){return t.alert.percentage=e,t.updateAlert()})),c.Wb(),c.Xb(9,"span"),c.Yc(10,"of estimate, alert"),c.Wb(),c.Xb(11,"dropdown-items",3),c.jc("onChanged",(function(e){return t.alert.alertPerson=e,t.updateAlert()})),c.Wb(),c.Wb(),c.Xb(12,"div",4),c.jc("click",(function(){c.Oc(e);const i=c.Lc(16);return t.openDeleteModal(i)})),c.Xb(13,"a",5),c.Sb(14,"img",6),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(15,Xo,3,4,"ng-template",null,7,c.Xc)}2&e&&(c.Cb(5),c.wc("type","TEXT")("list",t.alertTypes)("value",t.alert.alertType),c.Cb(3),c.wc("type","TEXT")("list",t.percentages)("value",t.alert.percentage),c.Cb(3),c.wc("type","TEXT")("list",t.alertGroups)("value",t.alert.alertPerson))},directives:[pn.a,Ui.a],encapsulation:2}),e})();const To=function(){return["/upgrade"]};function Do(e,t){1&e&&(c.Xb(0,"div",8),c.Xb(1,"div",9),c.Yc(2," PRO feature "),c.Xb(3,"a",10),c.Yc(4,"Upgrade"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(3),c.wc("routerLink",c.Ac(1,To)))}function Ro(e,t){1&e&&c.Sb(0,"div",11)}function Ao(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"alert-row",12),c.jc("deletedAlert",(function(){c.Oc(e);const i=t.index;return c.nc().deleteAlert(i)})),c.Wb(),c.Ub()}if(2&e){const e=t.$implicit,i=c.nc();c.Cb(1),c.wc("workspaceId",i.workspaceId)("alert",e)}}let jo=(()=>{class e{constructor(e){this.alertService=e,this.unsubscribe$=new Ee.a,this.alerts=[]}set hasAlertsFeature(e){this._hasAlertsFeature=e,e&&this.isInitialized&&this.initialize()}get hasAlertsFeature(){return this._hasAlertsFeature}ngOnInit(){this.alertService.alerts.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>this.alerts=e),this.initialize()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initialize(){this.workspaceId&&this.hasAlertsFeature&&(this.isInitialized=!0,this.alertService.getAllAlertsForWorkspace(this.workspaceId))}deleteAlert(e){this.alerts.splice(e,1)}addNewAlert(e){this.alerts.unshift(e)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(dt))},e.\u0275cmp=c.Lb({type:e,selectors:[["alerts"]],inputs:{workspaceId:"workspaceId",hasAlertsFeature:"hasAlertsFeature"},decls:9,vars:4,consts:[["class","cl-form-group",4,"ngIf"],[1,"cl-relative"],["class","cl-blocker",4,"ngIf"],[3,"workspaceId","createdAlert"],[1,"cl-card","cl-border-bottom","cl-mb-1","cl-mb-lg-2"],[1,"cl-card-header","cl-px-2","cl-px-lg-3"],[1,"cl-h6","cl-mb-0"],[4,"ngFor","ngForOf"],[1,"cl-form-group"],[1,"cl-alert","cl-alert-info","cl-mb-0"],[1,"cl-btn",3,"routerLink"],[1,"cl-blocker"],[3,"workspaceId","alert","deletedAlert"]],template:function(e,t){1&e&&(c.Wc(0,Do,5,2,"div",0),c.Xb(1,"div",1),c.Wc(2,Ro,1,0,"div",2),c.Xb(3,"new-alert",3),c.jc("createdAlert",(function(e){return t.addNewAlert(e)})),c.Wb(),c.Xb(4,"div",4),c.Xb(5,"div",5),c.Xb(6,"span",6),c.Yc(7,"Alerts"),c.Wb(),c.Wb(),c.Wc(8,Ao,2,2,"ng-container",7),c.Wb(),c.Wb()),2&e&&(c.wc("ngIf",!1===t.hasAlertsFeature),c.Cb(2),c.wc("ngIf",!t.hasAlertsFeature),c.Cb(1),c.wc("workspaceId",t.workspaceId),c.Cb(5),c.wc("ngForOf",t.alerts))},directives:[s.u,Oo,s.t,W.f,Eo],encapsulation:2}),e})();function xo(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"th",2),c.Xb(2,"a",3),c.jc("click",(function(){return c.Oc(e),c.nc().changeSort("name")})),c.Yc(3,"Name"),c.Wb(),c.Wb(),c.Xb(4,"th"),c.Xb(5,"div",4),c.Xb(6,"a",3),c.jc("click",(function(){return c.Oc(e),c.nc().changeSort("email")})),c.Yc(7,"Email"),c.Wb(),c.Wb(),c.Wb(),c.Xb(8,"th"),c.Xb(9,"div",4),c.Xb(10,"a",3),c.jc("click",(function(){return c.Oc(e),c.nc().changeSort("_id")})),c.Yc(11,"Registration"),c.Wb(),c.Wb(),c.Wb(),c.Xb(12,"th"),c.Xb(13,"div",4),c.Xb(14,"div",5),c.Yc(15,"Api Key"),c.Wb(),c.Wb(),c.Wb(),c.Xb(16,"th",6),c.Xb(17,"div",4),c.Xb(18,"div",5),c.Yc(19,"Login"),c.Wb(),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(2),c.Hb("cl-up","name"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","name"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),c.Cb(4),c.Hb("cl-up","email"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","email"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),c.Cb(4),c.Hb("cl-up","_id"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","_id"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING)}}function Po(e,t){if(1&e){const e=c.Yb();c.Xb(0,"th",7),c.Xb(1,"div",8),c.Yc(2,"Name "),c.Xb(3,"div",9),c.Xb(4,"a",10),c.jc("click",(function(){return c.Oc(e),c.nc().expandAll()})),c.Xb(5,"span",11),c.Sb(6,"img",12),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(6),c.wc("src",e.isExpandAll?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",c.Qc)}}let Mo=(()=>{class e{constructor(e){this.cd=e,this.onChangeSortOrder=new c.n,this.onChangeSortColumn=new c.n,this.onExpandAll=new c.n,this.isExpandAll=!1,this.SortOrder=Is.a,this.unsubscribe$=new Ee.a}ngOnInit(){}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}expandAll(){this.isExpandAll=!this.isExpandAll,this.onExpandAll.emit(this.isExpandAll)}changeSort(e){e!==this.sortColumn?this.onChangeSortColumn.emit(e):this.onChangeSortOrder.emit()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["account-header"],["","account-header",""]],inputs:{isDesktop:"isDesktop",sortColumn:"sortColumn",sortOrder:"sortOrder"},outputs:{onChangeSortOrder:"onChangeSortOrder",onChangeSortColumn:"onChangeSortColumn",onExpandAll:"onExpandAll"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["mobileTemplate",""],[1,"cl-pl-lg-3"],[1,"cl-text-gray-6","cl-sort-by",3,"click"],[1,"cl-ml-lg-custom-n2"],[1,"cl-h5","cl-mb-0"],["colspan","2"],["colspan","6",1,"cl-pl-lg-custom-3"],[1,"cl-h5","cl-mb-0","cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-ml-auto",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"]],template:function(e,t){if(1&e&&(c.Wc(0,xo,20,12,"ng-container",0),c.Wc(1,Po,7,1,"ng-template",null,1,c.Xc)),2&e){const e=c.Lc(2);c.wc("ngIf",t.isDesktop)("ngIfElse",e)}},directives:[s.u],encapsulation:2,changeDetection:0}),e})(),Yo=(()=>{class e{constructor(e){this.authService=e,this.format="DD-MM-YYYY";try{this.format=this.authService.getUser().settings.dateFormat}catch(t){}}transform(e){return Se(1e3*parseInt(e.substring(0,8),16)).format(this.format)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Ce.a))},e.\u0275pipe=c.Qb({name:"dateFromObjectId",type:e,pure:!0}),e})();function Lo(e,t){1&e&&c.Tb(0)}function Fo(e,t){if(1&e){const e=c.Yb();c.Xb(0,"input",10,11),c.jc("change",(function(){return c.Oc(e),c.nc().onNameChange()}))("keyup.enter",(function(){return c.Oc(e),c.Lc(1).blur()}))("ngModelChange",(function(t){return c.Oc(e),c.nc().user.name=t})),c.Wb()}if(2&e){const e=c.nc();c.wc("ngModel",e.user.name)}}function No(e,t){if(1&e&&(c.Xb(0,"div",12),c.Xb(1,"span",13),c.Yc(2),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.xc("title",e.user.email),c.Cb(1),c.Zc(e.user.email)}}function Uo(e,t){if(1&e&&(c.Xb(0,"div",14),c.Yc(1),c.oc(2,"dateFromObjectId"),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" ",c.pc(2,1,e.user.id)," ")}}function $o(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" ",e.user.apiKey.active?e.user.apiKey.apiKey:"deactivated"," ")}}function _o(e,t){1&e&&(c.Xb(0,"span"),c.Yc(1," not generated "),c.Wb())}function Go(e,t){if(1&e&&(c.Xb(0,"div",14),c.Wc(1,$o,2,1,"span",15),c.Wc(2,_o,2,0,"ng-template",null,16,c.Xc),c.Wb()),2&e){const e=c.Lc(3),t=c.nc();c.Cb(1),c.wc("ngIf",t.user.apiKey.id)("ngIfElse",e)}}function Bo(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",20),c.jc("click",(function(){return c.Oc(e),c.nc(2).loginAs()})),c.Yc(1,"Login As"),c.Wb()}}function Vo(e,t){1&e&&(c.Xb(0,"span",21),c.Yc(1," (active) "),c.Wb())}function Ho(e,t){if(1&e&&(c.Xb(0,"div",17),c.Wc(1,Bo,2,0,"a",18),c.Wc(2,Vo,2,0,"ng-template",null,19,c.Xc),c.Wb()),2&e){const e=c.Lc(3),t=c.nc();c.Cb(1),c.wc("ngIf",t.ownerId!==t.user.id)("ngIfElse",e)}}function zo(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",32),c.jc("click",(function(){return c.Oc(e),c.nc(3).deactivateApiKey()})),c.Yc(1," Deactivate API key "),c.Wb()}if(2&e){const e=c.nc(3);c.wc("disabled",!e.user.apiKey.active)}}function qo(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Sb(1,"div",33),c.Xb(2,"button",34),c.jc("click",(function(){c.Oc(e);const t=c.nc(3),i=c.Lc(16);return t.openModal(i)})),c.Yc(3," Remove account "),c.Wb(),c.Ub()}}function Ko(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",27),c.Xb(1,"div",28),c.Xb(2,"button",29),c.jc("click",(function(){return c.Oc(e),c.nc(2).resetPassword()})),c.Yc(3," Reset password "),c.Wb(),c.Wc(4,zo,2,1,"button",30),c.Wc(5,qo,4,0,"ng-container",31),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(4),c.wc("ngIf",e.user.apiKey.id),c.Cb(1),c.wc("ngIf",e.ownerId!==e.user.id)}}function Zo(e,t){1&e&&(c.Xb(0,"div",22),c.Xb(1,"div",23),c.Sb(2,"img",24),c.Wb(),c.Wc(3,Ko,6,2,"div",25),c.Sb(4,"span",26),c.Wb())}function Qo(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",35),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().removeConfirmed(i)}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Xb(1,"p"),c.Yc(2,"The user will lose access to this workspace, but their tracked data will remain. This action can't be reversed."),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Remove user")("btnText","Remove")("isDanger",!0)("inProgress",e.inProgress)}}const Jo=function(e){return{labels:e}},ea=function(e,t,i,n,s,c){return[e,t,i,n,s,c]};let ta=(()=>{class e{constructor(e,t,i,n){this.modalService=e,this.authService=t,this.accountsUsersService=i,this.cd=n,this.onDeleted=new c.n,this.unsubscribe$=new Ee.a}ngOnInit(){}ngAfterViewInit(){this.cd.detectChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}resetPassword(){this.accountsUsersService.resetPassword(this.user.email,`Password reset link sent to ${this.user.email}.`).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{})}deactivateApiKey(){this.accountsUsersService.deactivateApiKey(this.user.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.user.apiKey=e,this.cd.detectChanges()})}openModal(e){this.modalService.open(e,{centered:!0})}removeConfirmed(e){this.inProgress||(this.inProgress=!0,this.accountsUsersService.removeUserAccount(this.user.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.onDeleted.emit(),this.inProgress=!1,e.close()},()=>{this.inProgress=!1,this.cd.detectChanges()}))}onNameChange(){this.accountsUsersService.renameUser(this.user.name,this.user.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{})}loginAs(){this.loginInProgress||(this.loginInProgress=!0,this.authService.loginAs(this.user.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>this.loginInProgress=!1,()=>this.loginInProgress=!1))}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(g.q),c.Rb(Ce.a),c.Rb($),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["account-row"],["","account-row",""]],inputs:{isDesktop:"isDesktop",user:"user",labels:"labels",ownerId:"ownerId",expandAll:"expandAll"},outputs:{onDeleted:"onDeleted"},decls:17,vars:14,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-d-none",3,"isDesktop","templates","isExpanded"],["responsive",""],["col1",""],["col2",""],["col3",""],["col4",""],["col5",""],["col6",""],["removeModal",""],["type","text","autocomplete","off",1,"cl-form-control","cl-input-description","cl-py-2","cl-ml-n2","tr-reset-min-h",3,"ngModel","change","keyup.enter","ngModelChange"],["name",""],[1,"cl-component-divided-left","cl-cursor-default","cl-d-flex"],[1,"cl-cut-text",3,"title"],[1,"cl-component-divided-left","cl-cursor-default"],[4,"ngIf","ngIfElse"],["notGenerated",""],[1,"cl-component-divided-left"],[3,"click",4,"ngIf","ngIfElse"],["activeTemplate",""],[3,"click"],[1,"cl-cursor-default"],["dropdownKey","",1,"cl-dropdown","cl-d-flex","cl-justify-content-lg-custom-end"],["dropdownKeyButton","","tabindex","0",1,"cl-no-focus-tabindex","cl-component-divided-left","cl-d-flex","cl-w-100","cl-w-lg-auto","cl-dropdown-toggle","cl-no-arrow","pointer"],["src","assets/images/ui-icons/menu-dots-vertical.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right","openUpAtBottom","",4,"dropdownKeyContent"],["dropdownClose","","tabindex","0",1,"cl-no-focus-tabindex"],["openUpAtBottom","",1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],["class","cl-dropdown-item","clickCloseDropdown","",3,"disabled","click",4,"ngIf"],[4,"ngIf"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"disabled","click"],[1,"cl-dropdown-divider"],["clickCloseDropdown","",1,"cl-dropdown-item","cl-text-danger",3,"click"],[3,"title","btnText","isDanger","inProgress","confirmed","close"]],template:function(e,t){if(1&e&&(c.Wc(0,Lo,1,0,"ng-container",0),c.Sb(1,"responsive-row",1,2),c.Wc(3,Fo,2,1,"ng-template",null,3,c.Xc),c.Wc(5,No,3,2,"ng-template",null,4,c.Xc),c.Wc(7,Uo,3,3,"ng-template",null,5,c.Xc),c.Wc(9,Go,4,2,"ng-template",null,6,c.Xc),c.Wc(11,Ho,4,2,"ng-template",null,7,c.Xc),c.Wc(13,Zo,5,0,"ng-template",null,8,c.Xc),c.Wc(15,Qo,3,4,"ng-template",null,9,c.Xc)),2&e){const e=c.Lc(2),i=c.Lc(4),n=c.Lc(6),s=c.Lc(8),r=c.Lc(10),o=c.Lc(12),a=c.Lc(14);c.wc("ngTemplateOutlet",e.template)("ngTemplateOutletContext",c.Bc(5,Jo,t.labels)),c.Cb(1),c.wc("isDesktop",t.isDesktop)("templates",c.Gc(7,ea,i,n,s,r,o,a))("isExpanded",t.expandAll)}},directives:[s.B,Fi.a,p.c,p.s,p.v,s.u,Si.a,Ii.a,Oi.a,Ui.a],pipes:[Yo],encapsulation:2,changeDetection:0}),e})();function ia(e,t){1&e&&(c.Xb(0,"div",16),c.Xb(1,"info"),c.Yc(2,"Only workspace owner can manage user accounts."),c.Wb(),c.Wb())}const na=function(){return["/upgrade"]};function sa(e,t){1&e&&(c.Xb(0,"div",16),c.Xb(1,"info"),c.Yc(2," ENTERPRISE feature "),c.Xb(3,"a",17),c.Yc(4,"Upgrade"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(3),c.wc("routerLink",c.Ac(1,na)))}function ca(e,t){1&e&&c.Sb(0,"div",18)}function ra(e,t){if(1&e){const e=c.Yb();c.Xb(0,"tr",19),c.jc("onDeleted",(function(){c.Oc(e);const i=t.index;return c.nc().onDeleted(i)})),c.Wb()}if(2&e){const e=t.$implicit,i=c.nc();c.wc("labels",i.labels)("user",e)("ownerId",i.ownerId)("isDesktop",i.isDesktop)("expandAll",i.expandAll)}}function oa(e,t){if(1&e){const e=c.Yb();c.Xb(0,"pager",20,21),c.jc("pageChanged",(function(t){return c.Oc(e),c.nc().setPaginationUrl(t)}))("limitChanged",(function(t){return c.Oc(e),c.nc().setPaginationUrl(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("page",null==e.pagination?null:e.pagination.page)("limit",null==e.pagination?null:e.pagination.pageSize)("total",e.totalUserCount)}}let aa=(()=>{class e{constructor(e,t,i,n,s,c,r){this.activatedRoute=e,this.browserService=t,this.router=i,this.accountsUsersService=n,this.authService=s,this.uiSettingsService=c,this.cd=r,this.labels=["Name","Email","Registration","Api Key","Workspaces","Login","Edit"],this.unsubscribe$=new Ee.a,this.pageDebouncer$=new Ee.a}set isOwner(e){const t=this.isOwner;this._isOwner=e,!t&&this.isOwner&&this.isInitialized&&this.subscribeToData()}get isOwner(){return this._isOwner}ngOnInit(){this.initPagination(),this.setBrowserWidth(),this.subscribeToData(),this.isInitialized=!0}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}subscribeToData(){this.isOwner&&this.hasControlAccountFeature&&(this.subscribeToRouteParams(),this.subscribeToRouteDebouncer(),this.ownerId=this.authService.getUser().id)}changeSortColumn(e){this.pagination.sortColumn=e,this.pagination.sortOrder=Is.a.ASCENDING,this.pageDebouncer$.next(),this.setLocalStorageData()}changeSortOrder(){this.pagination.sortOrder=this.pagination.sortOrder===Is.a.ASCENDING?Is.a.DESCENDING:Is.a.ASCENDING,this.pageDebouncer$.next(),this.setLocalStorageData()}onSearchChange(){this.initPagination(),this.pageDebouncer$.next()}setPaginationUrl(e){this.pagination.page=e.page||this.pagination.page,this.pagination.pageSize=e.limit||this.pagination.pageSize,this.setLocalStorageData(),this.pageDebouncer$.next()}onDeleted(e){this.users.splice(e,1),this.cd.detectChanges()}initPagination(){const e=this.uiSettingsService.getSettings(hi.b.USER_ACCOUNTS_PAGESIZE)||{};this.pagination={page:1,pageSize:e.pageSize||ei.z,sortOrder:Is.a[e.sortOrder]||Is.a.ASCENDING,sortColumn:e.sortColumn||"name"}}setLocalStorageData(){this.uiSettingsService.setSettings(hi.b.USER_ACCOUNTS_PAGESIZE,{pageSize:this.pagination.pageSize,sortOrder:this.pagination.sortOrder,sortColumn:this.pagination.sortColumn})}subscribeToRouteDebouncer(){this.pageDebouncer$.pipe(Object(Te.a)(350)).subscribe(()=>{this.router.navigate([],{queryParams:this.pagination,relativeTo:this.activatedRoute,fragment:"accounts"})})}subscribeToRouteParams(){this.activatedRoute.queryParams.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.pagination.searchEmail=e.searchEmail||"",Object(Pt.u)(e.page)&&e.page>0&&(this.pagination.page=Number(e.page)),Object(Pt.u)(e.pageSize)&&e.pageSize>0&&e.pageSize<=200&&(this.pagination.pageSize=Number(e.pageSize)),Is.a[e.sortOrder]&&(this.pagination.sortOrder=e.sortOrder),this.getUsers()})}expandAllRows(e){this.expandAll=e}getUsers(){this.accountsUsersService.getUsers(this.pagination).pipe(Object(De.a)(this.unsubscribe$)).subscribe(({users:e,count:t})=>{this.totalUserCount=t,this.isMultiplePages=t>ei.z||t>this.pagination.pageSize,this.users=e,0===e.length&&this.pagination.page>1&&(this.pagination.page=1,this.router.navigate([],{relativeTo:this.activatedRoute,fragment:"accounts"})),this.cd.detectChanges()})}setBrowserWidth(){this.browserService.isBreakpointLgCustom$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.a),c.Rb(pi.a),c.Rb(W.c),c.Rb($),c.Rb(Ce.a),c.Rb(hi.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["accounts-tab"]],inputs:{isOwner:"isOwner",hasControlAccountFeature:"hasControlAccountFeature"},decls:20,vars:9,consts:[["class","cl-form-group",4,"ngIf"],[1,"cl-relative"],["class","cl-blocker",4,"ngIf"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-form-row","cl-align-items-center"],[1,"cl-col-lg-custom-3"],[1,"cl-form-group","cl-mb-0"],["type","text","tabindex","0","placeholder","Search by email",1,"cl-form-control",3,"ngModel","ngModelChange"],[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-custom-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6"],["account-header","",3,"sortOrder","sortColumn","isDesktop","onChangeSortOrder","onChangeSortColumn","onExpandAll"],["account-row","",3,"labels","user","ownerId","isDesktop","expandAll","onDeleted",4,"ngFor","ngForOf"],[1,"cl-mt-2","cl-mt-lg-3"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],[1,"cl-form-group"],[1,"cl-btn",3,"routerLink"],[1,"cl-blocker"],["account-row","",3,"labels","user","ownerId","isDesktop","expandAll","onDeleted"],[3,"page","limit","total","pageChanged","limitChanged"],["pager",""]],template:function(e,t){1&e&&(c.Wc(0,ia,3,0,"div",0),c.Wc(1,sa,5,2,"div",0),c.Xb(2,"div",1),c.Wc(3,ca,1,0,"div",2),c.Xb(4,"div",3),c.Xb(5,"div",4),c.Xb(6,"div",5),c.Xb(7,"div",6),c.Xb(8,"input",7),c.jc("ngModelChange",(function(){return t.onSearchChange()}))("ngModelChange",(function(e){return t.pagination.searchEmail=e})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(9,"div",8),c.Xb(10,"div",9),c.Xb(11,"span",10),c.Yc(12,"Accounts"),c.Wb(),c.Wb(),c.Wb(),c.Xb(13,"table",11),c.Xb(14,"thead"),c.Xb(15,"tr",12),c.jc("onChangeSortOrder",(function(){return t.changeSortOrder()}))("onChangeSortColumn",(function(e){return t.changeSortColumn(e)}))("onExpandAll",(function(e){return t.expandAllRows(e)})),c.Wb(),c.Wb(),c.Xb(16,"tbody"),c.Wc(17,ra,1,5,"tr",13),c.Wb(),c.Wb(),c.Xb(18,"div",14),c.Wc(19,oa,2,3,"pager",15),c.Wb(),c.Wb()),2&e&&(c.wc("ngIf",!1===t.isOwner),c.Cb(1),c.wc("ngIf",!t.hasControlAccountFeature),c.Cb(2),c.wc("ngIf",!t.isOwner||!t.hasControlAccountFeature),c.Cb(5),c.wc("ngModel",t.pagination.searchEmail),c.Cb(7),c.wc("sortOrder",t.pagination.sortOrder)("sortColumn",t.pagination.sortColumn)("isDesktop",t.isDesktop),c.Cb(2),c.wc("ngForOf",t.users),c.Cb(2),c.wc("ngIf",t.isMultiplePages))},directives:[s.u,p.c,p.s,p.v,Mo,s.t,fr.a,W.f,ta,cn.a],encapsulation:2,changeDetection:0}),e})();var la=i("1uah"),ba=function(e){return e.NATIVE_LOGIN="NATIVE_LOGIN",e.LDAP="LDAP",e.SAML2="SAML2",e.OAUTH2="OAUTH2",e}({});class ua{constructor(e={}){this.id=e.id||null,this.domainName=e.domainName||null,this.automaticJoinOnWorkspace=e.automaticJoinOnWorkspace||!1,this.workspaceId=e.workspaceId||null,this.autoLogin=e.autoLogin||null,this.customSupportLinksSettings=e.customSupportLinksSettings||null,this.logoURL=e.logoURL||null,this.loginPreferences=e.loginPreferences||[ba.NATIVE_LOGIN],this.auth=e.auth||null}}class da{constructor(e={}){this.relyingPartyIdentifier=e.relyingPartyIdentifier||"",this.assertionConsumerServiceUrl=e.assertionConsumerServiceUrl||"",this.metadataUrl=e.metadataUrl||"",this.logoutUrl=e.logoutUrl||"",this.loginUrl=e.loginUrl||"",this.certificates=e.certificates||[]}}class pa{constructor(e={}){this.accessTokenPath=e.accessTokenPath||"",this.clientId=e.clientId||"",this.clientSecret=e.clientSecret||"",this.authorizationCodePath=e.authorizationCodePath||"",this.emailTokenField=e.emailTokenField||"",this.usernameTokenField=e.usernameTokenField||"",this.userInfoOpenIdPath=e.userInfoOpenIdPath||"",this.scope=e.scope||"",this.firstNameTokenField=e.firstNameTokenField||"",this.lastNameTokenField=e.lastNameTokenField||""}}class ha{constructor(e={}){this.emailAttribute=e.emailAttribute||"",this.initialContextFactory=e.initialContextFactory||"",this.providerURI=e.providerURI||"",this.searchBases=e.searchBases||"",this.securityAuthentication=e.securityAuthentication||"",this.securityCredentials=e.securityCredentials||"",this.securityPrincipal=e.securityPrincipal||"",this.userSearchFilter=e.userSearchFilter||""}}let ma=(()=>{class e{constructor(e,t,i){this.toaster=e,this.workspaceService=t,this.http=i,this.subdomain$=new Ee.a,this.enpoints={[ba.LDAP]:"ldap-configuration",[ba.OAUTH2]:"o-auth2-configuration",[ba.SAML2]:"saml2-configuration"}}checkIsValidDomain(e){const t=(new P.f).append("domain-name",e.toLowerCase()),i=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`/workspaces/${i}/organization/subdomain-name/`,{params:t}).pipe(Object(Y.a)(e=>e),Object(L.a)(null,()=>this.toaster.pop("error","Checking subdomain failed.")))}createSubdomain(e){e=e.toLowerCase();const t=this.workspaceService.getDefaultWorkspaceId();return this.http.post(`/v1/workspaces/${t}/organization`,{organizationName:e}).pipe(Object(Y.a)(e=>new ua(e)),Object(L.a)(t=>{this.subdomainSystemSettingsId=t.id,this.toaster.pop("success",`Subdomain ${e} has been created.`)},t=>this.toaster.pop("error",t.error&&t.error.message||`Subdomain ${e} has not been created.`)))}getSubdomain(){const e=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`/v1/workspaces/${e}/organization/`).pipe(Object(Y.a)(e=>new ua(e)),Object(L.a)(e=>this.subdomainSystemSettingsId=e.id,e=>{e.error&&404===e.error.code||this.toaster.pop("error",e.error&&e.error.message||"Subdomain fetch failed.")}))}editDomainData(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/v1/workspaces/${t}/organization/`+this.subdomainSystemSettingsId,e).pipe(Object(Y.a)(e=>new ua(e)),Object(L.a)(()=>this.toaster.pop("success","Successfully edited."),e=>this.toaster.pop("error",e.error&&e.error.message||"Editing failed.")))}patchConfiguration(e,t){const i=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/v1/workspaces/${i}/organization/`+this.subdomainSystemSettingsId+"/"+this.enpoints[t],e).pipe(Object(Y.a)(e=>t===ba.SAML2?new da(e):t===ba.OAUTH2?new pa(e):t===ba.LDAP?new ha(e):void 0),Object(L.a)(()=>this.toaster.pop("success",t+" configuration saved."),e=>this.toaster.pop("error",e.error&&e.error.message||"Save failed.")))}getConfigurations(){const e=`/v1/workspaces/${this.workspaceService.getDefaultWorkspaceId()}/organization/`+this.subdomainSystemSettingsId+"/",t=this.http.get(e+this.enpoints[ba.LDAP]+"/"),i=this.http.get(e+this.enpoints[ba.OAUTH2]+"/"),n=this.http.get(e+this.enpoints[ba.SAML2]+"/");return Object(la.a)(t,i,n).pipe(Object(Y.a)(e=>{const t={},i=e[0],n=e[1],s=e[2];return i&&(t[ba.LDAP]=new ha(i)),n&&(t[ba.OAUTH2]=new pa(n)),s&&(t[ba.SAML2]=new da(s)),t}),Object(L.a)(null,e=>this.toaster.pop("error",e.error&&e.error.message||"Get configuration failed")))}deleteConfiguration(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`/v1/workspaces/${t}/organization/`+this.subdomainSystemSettingsId+"/"+this.enpoints[e]+"/").pipe(Object(L.a)(()=>this.toaster.pop("success",e+" Configuration has been deleted."),e=>this.toaster.pop("error",e.error&&e.error.message||"Delete configuration failed.")))}deleteSubdomain(){const e=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`/v1/workspaces/${e}/organization/`+this.subdomainSystemSettingsId+"/").pipe(Object(L.a)(()=>{this.toaster.pop("success","Subdomain has been deleted."),this.subdomainSystemSettingsId=null},e=>this.toaster.pop("error",e.error&&e.error.message||"Delete failed.")))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(M.a),c.fc(U.a),c.fc(P.b))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const ga=[{value:ba.LDAP,label:"LDAP"},{value:ba.SAML2,label:"SAML2"},{value:ba.OAUTH2,label:"OAuth2"}];var fa=i("huA5");let va=(()=>{class e{constructor(){this.subdomainName=""}setSubdomainName(e){this.subdomainName=e?e.domainName:""}getSubdomainName(){return this.subdomainName}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var wa=i("eIep"),ya=i("DoKE");let Wa=(()=>{class e{constructor(){}onKeyDown(e){(e.keyCode?e.keyCode:e.which)==ya.h&&e.preventDefault()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=c.Mb({type:e,selectors:[["","preventSpace",""]],hostBindings:function(e,t){1&e&&c.jc("keydown",(function(e){return t.onKeyDown(e)}))}}),e})();const Ca=["input"];function ka(e,t){if(1&e&&(c.Vb(0),c.Yc(1),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" Subdomain name should be shorter than ",e.MAX_LENGTH," characters. ")}}function Sa(e,t){if(1&e&&(c.Xb(0,"small",9),c.Yc(1," Enter a valid subdomain name. "),c.Wc(2,ka,2,1,"ng-container",10),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.wc("ngIf",e.domainName.errors.maxlength)}}function Ia(e,t){if(1&e&&(c.Xb(0,"small",13),c.Yc(1),c.Wb()),2&e){const e=c.nc(3);c.Cb(1),c.ad(" Subdomain ",e.checkedDomainName," is available. ")}}function Oa(e,t){if(1&e&&(c.Xb(0,"small",9),c.Yc(1),c.Wb()),2&e){const e=c.nc(3);c.Cb(1),c.ad(" Subdomain ",e.checkedDomainName," is unavailable. ")}}function Xa(e,t){if(1&e&&(c.Vb(0),c.Wc(1,Ia,2,1,"small",11),c.Wc(2,Oa,2,1,"small",12),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngIf",e.isAvailable),c.Cb(1),c.wc("ngIf",!e.isAvailable)}}function Ea(e,t){if(1&e&&c.Wc(0,Xa,3,2,"ng-container",10),2&e){const e=c.nc();c.wc("ngIf",e.checkedDomainName)}}let Ta=(()=>{class e{constructor(e,t){this.formBuilder=e,this.authSSOService=t,this.onAvailableName=new c.n,this.onEnter=new c.n,this._name="",this.autofocus=!1,this.domainDebouncer$=new Ee.a,this.MAX_LENGTH=30,this.unsubscribe$=new Ee.a}set name(e){const t=!e&&!!this.name;this._name=e,t&&(this.onAvailableName.emit(""),this.initForm(),this.subscribeToChanges()),e&&(this.checkedDomainName=null,this.domainForm&&(this.nameChangeSub.unsubscribe(),this.domainForm.updateValueAndValidity(),this.domainForm.patchValue({domainName:e})))}get name(){return this._name}get domainName(){return this.domainForm.get("domainName")}get isDomainNameInvalid(){return this.domainName.dirty&&!!this.domainName.errors}ngOnInit(){this.initForm(),this.subscribeToDebouncer(),this.subscribeToChanges()}ngAfterViewInit(){this.autofocus&&this.input&&setTimeout(()=>{this.input.nativeElement.focus()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}onEnterPressed(){this.onEnter.emit()}initForm(){this.domainForm=this.formBuilder.group({domainName:[this.name||"",[on.a.required,on.a.domain(),on.a.maxLength(this.MAX_LENGTH)]]})}subscribeToChanges(){this.nameChangeSub=this.domainForm.get("domainName").valueChanges.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.checkedDomainName=null,this.onAvailableName.emit(""),this.domainDebouncer$.next(e)})}subscribeToDebouncer(){let e;this.checkIsAvailableSub=this.domainDebouncer$.pipe(Object(Te.a)(250),Object(It.a)(()=>this.domainForm.valid),Object(wa.a)(t=>(e=t.trim(),this.authSSOService.checkIsValidDomain(e))),Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.isAvailable=t,this.checkedDomainName=e,this.onAvailableName.emit(t?e:"")},()=>{this.checkIsAvailableSub&&this.checkIsAvailableSub.unsubscribe(),this.subscribeToDebouncer()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(p.f),c.Rb(ma))},e.\u0275cmp=c.Lb({type:e,selectors:[["domain-input"]],viewQuery:function(e,t){var i;1&e&&c.ed(Ca,!0),2&e&&c.Kc(i=c.kc())&&(t.input=i.first)},inputs:{disable:"disable",name:"name",autofocus:"autofocus"},outputs:{onAvailableName:"onAvailableName",onEnter:"onEnter"},decls:13,vars:8,consts:[[3,"formGroup"],[1,"cl-input-group"],[1,"cl-input-group-prepend"],[1,"cl-input-group-text"],["type","text","preventSpace","","tabindex","0","placeholder","Subdomain name","spellcheck","false","formControlName","domainName","autocomplete","off",1,"cl-form-control",3,"readonly","keyup.enter"],["input",""],[1,"cl-input-group-append"],["class","cl-form-text cl-text-danger",4,"ngIf","ngIfElse"],["inputIsValidTemplate",""],[1,"cl-form-text","cl-text-danger"],[4,"ngIf"],["class","cl-form-text cl-text-success",4,"ngIf"],["class","cl-form-text cl-text-danger",4,"ngIf"],[1,"cl-form-text","cl-text-success"]],template:function(e,t){if(1&e&&(c.Xb(0,"form",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"span",3),c.Yc(4,"https://"),c.Wb(),c.Wb(),c.Xb(5,"input",4,5),c.jc("keyup.enter",(function(){return t.onEnterPressed()})),c.Wb(),c.Xb(7,"div",6),c.Xb(8,"span",3),c.Yc(9,".clockify.me"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(10,Sa,3,1,"small",7),c.Wc(11,Ea,1,1,"ng-template",null,8,c.Xc)),2&e){const e=c.Lc(12);c.wc("formGroup",t.domainForm),c.Cb(5),c.Hb("cl-is-valid",t.checkedDomainName&&t.isAvailable)("cl-is-invalid",t.isDomainNameInvalid||t.checkedDomainName&&!t.isAvailable),c.wc("readonly",t.disable),c.Cb(5),c.wc("ngIf",t.isDomainNameInvalid)("ngIfElse",e)}},directives:[p.I,p.t,p.k,p.c,Wa,p.s,p.i,s.u],encapsulation:2}),e})();function Da(e,t){1&e&&(c.Xb(0,"small",19),c.Yc(1," Enter a valid Provider URI. "),c.Wb())}function Ra(e,t){1&e&&(c.Xb(0,"small",19),c.Yc(1," Enter a valid Security Authentication. "),c.Wb())}function Aa(e,t){1&e&&(c.Xb(0,"small",19),c.Yc(1," Enter a valid Security Principal. "),c.Wb())}function ja(e,t){1&e&&(c.Xb(0,"small",19),c.Yc(1," Enter a valid Security Credentials. "),c.Wb())}function xa(e,t){1&e&&(c.Xb(0,"small",19),c.Yc(1," Enter a valid Search Bases. "),c.Wb())}function Pa(e,t){1&e&&(c.Xb(0,"small",19),c.Yc(1," Enter a valid User Search Filter. "),c.Wb())}function Ma(e,t){1&e&&(c.Xb(0,"small",19),c.Yc(1," Enter a valid Email Attribute. "),c.Wb())}function Ya(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",20),c.Xb(1,"a",21),c.jc("click",(function(){return c.Oc(e),c.nc().onClose.emit()})),c.Yc(2,"Cancel"),c.Wb(),c.Xb(3,"button",22),c.Yc(4," Finish Configuration "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.wc("disabled",e.form.invalid||e.inProgress)}}let La=(()=>{class e{constructor(e){this.formBuilder=e,this.isReadonly=!1,this.isModal=!0,this.onClose=new c.n,this.onSubmit=new c.n,this.unsubscribe$=new Ee.a}set configuration(e){e&&this.initConfig(e)}ngOnInit(){this.form||this.initConfig(new ha)}initConfig(e){this.form=this.formBuilder.group({emailAttribute:[e.emailAttribute,[on.a.required]],providerURI:[e.providerURI,[on.a.required]],searchBases:[e.searchBases,[on.a.required]],securityAuthentication:[e.securityAuthentication,[on.a.required]],securityCredentials:[e.securityCredentials,[]],securityPrincipal:[e.securityPrincipal,[]],userSearchFilter:[e.userSearchFilter,[on.a.required]]})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}submit(){if(this.inProgress)return;const e=Object.assign({},this.form.value);Object.keys(e).map(t=>e[t]="string"==typeof e[t]?e[t].trim():e[t]);const t=new ha(e);this.onSubmit.emit(t)}isValid(e){const t=this.form.get(e);return!!t&&t.dirty&&t.touched&&!!t.errors}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(p.f))},e.\u0275cmp=c.Lb({type:e,selectors:[["form-ldap"]],inputs:{configuration:"configuration",isReadonly:"isReadonly",isModal:"isModal",inProgress:"inProgress"},outputs:{onClose:"onClose",onSubmit:"onSubmit"},decls:48,vars:32,consts:[[3,"formGroup","ngSubmit"],[1,"cl-form-group"],["for","providerURI"],[1,"cl-text-danger","cl-ml-1"],["type","text","id","providerURI","autocomplete","off","formControlName","providerURI",1,"cl-form-control",3,"readonly"],["class","cl-form-text cl-text-danger",4,"ngIf"],["for","securityAuthentication"],["type","text","id","securityAuthentication","autocomplete","off","formControlName","securityAuthentication",1,"cl-form-control",3,"readonly"],["for","securityPrincipal"],["type","text","id","securityPrincipal","autocomplete","off","formControlName","securityPrincipal",1,"cl-form-control",3,"readonly"],["for","securityCredentials"],["type","text","id","securityCredentials","autocomplete","off","formControlName","securityCredentials",1,"cl-form-control",3,"readonly"],["for","searchBases"],["type","text","id","searchBases","autocomplete","off","formControlName","searchBases",1,"cl-form-control",3,"readonly"],["for","userSearchFilter"],["type","text","id","userSearchFilter","autocomplete","off","formControlName","userSearchFilter",1,"cl-form-control",3,"readonly"],["for","emailAttribute"],["type","text","ngbAutofocus","","id","emailAttribute","autocomplete","off","formControlName","emailAttribute",1,"cl-form-control",3,"readonly"],["class","modal-footer",4,"ngIf"],[1,"cl-form-text","cl-text-danger"],[1,"modal-footer"],["tabindex","0",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"]],template:function(e,t){1&e&&(c.Xb(0,"form",0),c.jc("ngSubmit",(function(){return t.submit()})),c.Xb(1,"div"),c.Xb(2,"div",1),c.Xb(3,"label",2),c.Yc(4,"Provider URI"),c.Xb(5,"span",3),c.Yc(6,"*"),c.Wb(),c.Wb(),c.Sb(7,"input",4),c.Wc(8,Da,2,0,"small",5),c.Wb(),c.Xb(9,"div",1),c.Xb(10,"label",6),c.Yc(11," Security Authentication "),c.Xb(12,"span",3),c.Yc(13,"*"),c.Wb(),c.Wb(),c.Sb(14,"input",7),c.Wc(15,Ra,2,0,"small",5),c.Wb(),c.Xb(16,"div",1),c.Xb(17,"label",8),c.Yc(18,"Security Principal"),c.Wb(),c.Sb(19,"input",9),c.Wc(20,Aa,2,0,"small",5),c.Wb(),c.Xb(21,"div",1),c.Xb(22,"label",10),c.Yc(23,"Security Credentials"),c.Wb(),c.Sb(24,"input",11),c.Wc(25,ja,2,0,"small",5),c.Wb(),c.Xb(26,"div",1),c.Xb(27,"label",12),c.Yc(28,"Search Bases"),c.Xb(29,"span",3),c.Yc(30,"*"),c.Wb(),c.Wb(),c.Sb(31,"input",13),c.Wc(32,xa,2,0,"small",5),c.Wb(),c.Xb(33,"div",1),c.Xb(34,"label",14),c.Yc(35," User Search Filter "),c.Xb(36,"span",3),c.Yc(37,"*"),c.Wb(),c.Wb(),c.Sb(38,"input",15),c.Wc(39,Pa,2,0,"small",5),c.Wb(),c.Xb(40,"div",1),c.Xb(41,"label",16),c.Yc(42,"Email Attribute"),c.Xb(43,"span",3),c.Yc(44,"*"),c.Wb(),c.Wb(),c.Sb(45,"input",17),c.Wc(46,Ma,2,0,"small",5),c.Wb(),c.Wb(),c.Wc(47,Ya,5,1,"div",18),c.Wb()),2&e&&(c.wc("formGroup",t.form),c.Cb(1),c.Hb("modal-body",t.isModal),c.Cb(6),c.Hb("cl-border-danger",t.isValid("providerURI")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("providerURI")),c.Cb(6),c.Hb("cl-border-danger",t.isValid("securityAuthentication")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("securityAuthentication")),c.Cb(4),c.Hb("cl-border-danger",t.isValid("securityPrincipal")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("securityPrincipal")),c.Cb(4),c.Hb("cl-border-danger",t.isValid("securityCredentials")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("securityCredentials")),c.Cb(6),c.Hb("cl-border-danger",t.isValid("searchBases")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("searchBases")),c.Cb(6),c.Hb("cl-border-danger",t.isValid("userSearchFilter")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("userSearchFilter")),c.Cb(6),c.Hb("cl-border-danger",t.isValid("emailAttribute")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("emailAttribute")),c.Cb(1),c.wc("ngIf",t.isModal))},directives:[p.I,p.t,p.k,p.c,p.s,p.i,s.u],encapsulation:2,changeDetection:0}),e})();function Fa(e,t){1&e&&(c.Xb(0,"small",26),c.Yc(1," Enter a valid Client ID. "),c.Wb())}function Na(e,t){1&e&&(c.Xb(0,"small",26),c.Yc(1," Enter a valid Client Secret. "),c.Wb())}function Ua(e,t){1&e&&(c.Xb(0,"small",26),c.Yc(1," Enter a valid Access Token Endpoint. "),c.Wb())}function $a(e,t){1&e&&(c.Xb(0,"small",26),c.Yc(1," Enter a valid Access Token Path. "),c.Wb())}function _a(e,t){1&e&&(c.Xb(0,"small",26),c.Yc(1," Enter a valid User Info Open ID Path. "),c.Wb())}function Ga(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",27),c.Xb(1,"label",28),c.Yc(2,"Redirect URL"),c.Wb(),c.Sb(3,"input",29,30),c.Xb(5,"div",31),c.Xb(6,"button",32),c.jc("click",(function(){c.Oc(e);const t=c.Lc(4);return c.nc().copyToClipboard(t)})),c.Yc(7,"Copy"),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.wc("value",e.baseURL+"/login")}}function Ba(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",27),c.Xb(1,"label",28),c.Yc(2,"Android redirect URL"),c.Wb(),c.Sb(3,"input",29,33),c.Xb(5,"div",31),c.Xb(6,"button",32),c.jc("click",(function(){c.Oc(e);const t=c.Lc(4);return c.nc().copyToClipboard(t)})),c.Yc(7,"Copy"),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.wc("value",e.baseURL+"/login/android/oauth2")}}function Va(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",27),c.Xb(1,"label",28),c.Yc(2,"Apple redirect URL"),c.Wb(),c.Sb(3,"input",29,34),c.Xb(5,"div",31),c.Xb(6,"button",32),c.jc("click",(function(){c.Oc(e);const t=c.Lc(4);return c.nc().copyToClipboard(t)})),c.Yc(7,"Copy"),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.wc("value",e.baseURL+"/login/ios/oauth2")}}function Ha(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",27),c.Xb(1,"label",28),c.Yc(2,"Chrome extension redirect URL"),c.Wb(),c.Sb(3,"input",29,35),c.Xb(5,"div",31),c.Xb(6,"button",32),c.jc("click",(function(){c.Oc(e);const t=c.Lc(4);return c.nc().copyToClipboard(t)})),c.Yc(7,"Copy"),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.wc("value",e.baseURL+"/login/extension/chrome/oauth2")}}function za(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",27),c.Xb(1,"label",28),c.Yc(2,"Firefox extension redirect URL"),c.Wb(),c.Sb(3,"input",29,36),c.Xb(5,"div",31),c.Xb(6,"button",32),c.jc("click",(function(){c.Oc(e);const t=c.Lc(4);return c.nc().copyToClipboard(t)})),c.Yc(7,"Copy"),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.wc("value",e.baseURL+"/login/extension/firefox/oauth2")}}function qa(e,t){1&e&&(c.Xb(0,"small",26),c.Yc(1," Enter a valid Email Token Field. "),c.Wb())}function Ka(e,t){1&e&&(c.Xb(0,"small",26),c.Yc(1," Enter a valid Username Token Field. "),c.Wb())}function Za(e,t){1&e&&(c.Xb(0,"small",26),c.Yc(1," Enter a valid First Name Token Field. "),c.Wb())}function Qa(e,t){1&e&&(c.Xb(0,"small",26),c.Yc(1," Enter a valid Last Name Token Field. "),c.Wb())}function Ja(e,t){1&e&&(c.Xb(0,"small",26),c.Yc(1," Enter a valid scope. "),c.Wb())}function el(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",37),c.Xb(1,"a",38),c.jc("click",(function(){return c.Oc(e),c.nc().onClose.emit()})),c.Yc(2,"Cancel"),c.Wb(),c.Xb(3,"button",39),c.Yc(4," Finish Configuration "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.wc("disabled",e.form.invalid||e.inProgress)}}let tl=(()=>{class e{constructor(e,t,i){this.formBuilder=e,this.copyService=t,this.subdomainNameService=i,this.isReadonly=!1,this.isModal=!0,this.onClose=new c.n,this.onSubmit=new c.n,this.unsubscribe$=new Ee.a}set configuration(e){e&&this.initConfig(e)}ngOnInit(){this.form||this.initConfig(new pa),this.baseURL=`${window.location.protocol}//${window.location.host}`}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initConfig(e){this.form=this.formBuilder.group({accessTokenPath:[e.accessTokenPath,[on.a.required]],clientId:[e.clientId,[on.a.required]],clientSecret:[e.clientSecret,[on.a.required]],authorizationCodePath:[e.authorizationCodePath,[on.a.required]],emailTokenField:[e.emailTokenField,[on.a.required]],usernameTokenField:[e.usernameTokenField,[]],userInfoOpenIdPath:[e.userInfoOpenIdPath,[on.a.required]],scope:[e.scope,[on.a.required]],firstNameTokenField:[e.firstNameTokenField,[]],lastNameTokenField:[e.lastNameTokenField,[]]})}submit(){if(this.inProgress)return;const e=Object.assign({},this.form.value);Object.keys(e).map(t=>e[t]="string"==typeof e[t]?e[t].trim():e[t]);const t=new pa(e);this.onSubmit.emit(t)}isValid(e){const t=this.form.get(e);return!!t&&t.dirty&&t.touched&&!!t.errors}copyToClipboard(e){this.copyService.copyToClipboard(e)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(p.f),c.Rb(J.a),c.Rb(va))},e.\u0275cmp=c.Lb({type:e,selectors:[["form-oauth"]],inputs:{configuration:"configuration",inProgress:"inProgress",isReadonly:"isReadonly",isModal:"isModal"},outputs:{onClose:"onClose",onSubmit:"onSubmit"},decls:72,vars:49,consts:[[3,"formGroup","ngSubmit"],[1,"cl-form-group"],["for","clientId"],[1,"cl-text-danger","cl-ml-1"],["type","text","autocomplete","off","id","clientId","formControlName","clientId",1,"cl-form-control",3,"readonly"],["class","cl-form-text cl-text-danger",4,"ngIf"],["for","clientSecret"],["type","text","id","clientSecret","autocomplete","off","formControlName","clientSecret",1,"cl-form-control",3,"readonly"],["for","authorizationCodePath"],["type","text","autocomplete","off","id","authorizationCodePath","formControlName","authorizationCodePath",1,"cl-form-control",3,"readonly"],["for","accessTokenPath"],["type","text","ngbAutofocus","","autocomplete","off","id","accessTokenPath","formControlName","accessTokenPath",1,"cl-form-control",3,"readonly"],["for","userInfoOpenIdPath"],["type","text","autocomplete","off","id","userInfoOpenIdPath","formControlName","userInfoOpenIdPath",1,"cl-form-control",3,"readonly"],["class","cl-input-group cl-mb-3",4,"ngIf"],["for","emailTokenField"],["type","text","id","emailTokenField","autocomplete","off","formControlName","emailTokenField",1,"cl-form-control",3,"readonly"],["for","usernameTokenField"],["type","text","autocomplete","off","id","usernameTokenField","formControlName","usernameTokenField",1,"cl-form-control",3,"readonly"],["for","firstNameTokenField"],["type","text","autocomplete","off","id","firstNameTokenField","formControlName","firstNameTokenField",1,"cl-form-control",3,"readonly"],["for","lastNameTokenField"],["type","text","id","lastNameTokenField","autocomplete","off","formControlName","lastNameTokenField",1,"cl-form-control",3,"readonly"],["for","scope"],["type","text","id","scope","autocomplete","off","formControlName","scope",1,"cl-form-control",3,"readonly"],["class","modal-footer",4,"ngIf"],[1,"cl-form-text","cl-text-danger"],[1,"cl-input-group","cl-mb-3"],[1,"cl-w-100"],["type","text","readonly","",1,"cl-form-control",3,"value"],["redirectUrlInput",""],[1,"cl-input-group-append"],["type","button",1,"cl-btn","cl-btn-outline-light",3,"click"],["androidUrlInput",""],["appleUrlInput",""],["chromeExtRedirectUrlInput",""],["firefoxExtRedirectUrlInput",""],[1,"modal-footer"],["tabindex","0",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"]],template:function(e,t){1&e&&(c.Xb(0,"form",0),c.jc("ngSubmit",(function(){return t.submit()})),c.Xb(1,"div"),c.Xb(2,"div",1),c.Xb(3,"label",2),c.Yc(4,"Client ID"),c.Xb(5,"span",3),c.Yc(6,"*"),c.Wb(),c.Wb(),c.Sb(7,"input",4),c.Wc(8,Fa,2,0,"small",5),c.Wb(),c.Xb(9,"div",1),c.Xb(10,"label",6),c.Yc(11,"Client Secret"),c.Xb(12,"span",3),c.Yc(13,"*"),c.Wb(),c.Wb(),c.Sb(14,"input",7),c.Wc(15,Na,2,0,"small",5),c.Wb(),c.Xb(16,"div",1),c.Xb(17,"label",8),c.Yc(18,"Authorization Code Path"),c.Xb(19,"span",3),c.Yc(20,"*"),c.Wb(),c.Wb(),c.Sb(21,"input",9),c.Wc(22,Ua,2,0,"small",5),c.Wb(),c.Xb(23,"div",1),c.Xb(24,"label",10),c.Yc(25,"Access Token Path"),c.Xb(26,"span",3),c.Yc(27,"*"),c.Wb(),c.Wb(),c.Sb(28,"input",11),c.Wc(29,$a,2,0,"small",5),c.Wb(),c.Xb(30,"div",1),c.Xb(31,"label",12),c.Yc(32,"User Info Open ID Path"),c.Xb(33,"span",3),c.Yc(34,"*"),c.Wb(),c.Wb(),c.Sb(35,"input",13),c.Wc(36,_a,2,0,"small",5),c.Wb(),c.Wc(37,Ga,8,1,"div",14),c.Wc(38,Ba,8,1,"div",14),c.Wc(39,Va,8,1,"div",14),c.Wc(40,Ha,8,1,"div",14),c.Wc(41,za,8,1,"div",14),c.Xb(42,"div",1),c.Xb(43,"label",15),c.Yc(44,"Email Token Field"),c.Xb(45,"span",3),c.Yc(46,"*"),c.Wb(),c.Wb(),c.Sb(47,"input",16),c.Wc(48,qa,2,0,"small",5),c.Wb(),c.Xb(49,"div",1),c.Xb(50,"label",17),c.Yc(51,"Username Token Field"),c.Wb(),c.Sb(52,"input",18),c.Wc(53,Ka,2,0,"small",5),c.Wb(),c.Xb(54,"div",1),c.Xb(55,"label",19),c.Yc(56,"First Name Token Field"),c.Wb(),c.Sb(57,"input",20),c.Wc(58,Za,2,0,"small",5),c.Wb(),c.Xb(59,"div",1),c.Xb(60,"label",21),c.Yc(61,"Last Name Token Field"),c.Wb(),c.Sb(62,"input",22),c.Wc(63,Qa,2,0,"small",5),c.Wb(),c.Xb(64,"div",1),c.Xb(65,"label",23),c.Yc(66,"Scope"),c.Xb(67,"span",3),c.Yc(68,"*"),c.Wb(),c.Wb(),c.Sb(69,"input",24),c.Wc(70,Ja,2,0,"small",5),c.Wb(),c.Wb(),c.Wc(71,el,5,1,"div",25),c.Wb()),2&e&&(c.wc("formGroup",t.form),c.Cb(1),c.Hb("modal-body",t.isModal),c.Cb(6),c.Hb("cl-border-danger",t.isValid("clientId")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("clientId")),c.Cb(6),c.Hb("cl-border-danger",t.isValid("clientSecret")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("clientSecret")),c.Cb(6),c.Hb("cl-border-danger",t.isValid("authorizationCodePath")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("authorizationCodePath")),c.Cb(6),c.Hb("cl-border-danger",t.isValid("accessTokenPath")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("accessTokenPath")),c.Cb(6),c.Hb("cl-border-danger",t.isValid("userInfoOpenIdPath")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("userInfoOpenIdPath")),c.Cb(1),c.wc("ngIf",t.baseURL),c.Cb(1),c.wc("ngIf",t.baseURL),c.Cb(1),c.wc("ngIf",t.baseURL),c.Cb(1),c.wc("ngIf",t.baseURL),c.Cb(1),c.wc("ngIf",t.baseURL),c.Cb(6),c.Hb("cl-border-danger",t.isValid("emailTokenField")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("emailTokenField")),c.Cb(4),c.Hb("cl-border-danger",t.isValid("usernameTokenField")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("usernameTokenField")),c.Cb(4),c.Hb("cl-border-danger",t.isValid("firstNameTokenField")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("firstNameTokenField")),c.Cb(4),c.Hb("cl-border-danger",t.isValid("lastNameTokenField")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("lastNameTokenField")),c.Cb(6),c.Hb("cl-border-danger",t.isValid("scope")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("scope")),c.Cb(1),c.wc("ngIf",t.isModal))},directives:[p.I,p.t,p.k,p.c,p.s,p.i,s.u],encapsulation:2,changeDetection:0}),e})();const il=["fileInput"];let nl=(()=>{class e{constructor(e){this.toaster=e,this.accept=["text/xml"],this.onUploaded=new c.n}ngOnInit(){this.uid=Object(cr.v4)(),this.acceptExtensions||(this.acceptExtensions=this.accept.join(", "))}uploadFile(){const e=this.inputEl.nativeElement;if(!e.files.length||!e.files.item(0))return void this.clearInput();const t=e.files.item(0);this.validate(t.type)?this.readFile(t):this.clearInput()}validate(e){return!(e&&this.accept.indexOf(e)<0&&(this.toaster.pop("error",`Upload ${this.accept} file instead of ${e}.`),1))}readFile(e){const t=new FileReader;t.onload=e=>{const t=e.target&&e.target.result||"";t&&"string"==typeof t?this.onUploaded.emit(t):this.toaster.pop("error","File is empty.")},t.readAsText(e),this.clearInput()}clearInput(){try{this.inputEl.nativeElement.value=""}catch(e){}}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(M.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["btn-upload-file-content"]],viewQuery:function(e,t){var i;1&e&&c.ed(il,!0),2&e&&c.Kc(i=c.kc())&&(t.inputEl=i.first)},inputs:{disabled:"disabled",accept:"accept",acceptExtensions:"acceptExtensions"},outputs:{onUploaded:"onUploaded"},decls:4,vars:5,consts:[[1,"cl-btn","cl-btn-outline-light","cl-btn-primary","cl-color-gray",3,"for"],["type","file","tabindex","0",1,"pointer",2,"width","0",3,"id","disabled","name","accept","change"],["fileInput",""]],template:function(e,t){1&e&&(c.Xb(0,"label",0),c.Yc(1," Choose file\n"),c.Wb(),c.Xb(2,"input",1,2),c.jc("change",(function(){return t.uploadFile()})),c.Wb()),2&e&&(c.xc("for",t.uid),c.Cb(2),c.xc("id",t.uid),c.xc("name",t.uid),c.wc("disabled",t.disabled)("accept",t.acceptExtensions))},encapsulation:2}),e})();function sl(e,t){1&e&&(c.Xb(0,"small",20),c.Yc(1," Enter a valid Relying Party Identifier. "),c.Wb())}function cl(e,t){if(1&e&&(c.Xb(0,"div",1),c.Xb(1,"label",21),c.Yc(2,"Metadata Url"),c.Xb(3,"span",3),c.Yc(4,"*"),c.Wb(),c.Wb(),c.Sb(5,"input",22),c.Wb()),2&e){const e=c.nc();c.Cb(5),c.Hb("cl-border-danger",e.isValid("metadataUrl")),c.wc("readonly",e.isReadonly)}}function rl(e,t){1&e&&(c.Xb(0,"small",20),c.Yc(1," Enter a valid Metadata Url. "),c.Wb())}function ol(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",30,31),c.jc("click",(function(){c.Oc(e);const t=c.Lc(1);return c.nc(2).onUploadedFile("","metadataUrl"),t.blur()}))("keyup.enter",(function(){return c.Oc(e),c.nc(2).onUploadedFile("","metadataUrl")}))("keyup.space",(function(){return c.Oc(e),c.nc(2).onUploadedFile("","metadataUrl")})),c.Yc(2,"Remove"),c.Wb()}}function al(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",23),c.Xb(1,"div",1),c.Xb(2,"label",21),c.Yc(3,"Metadata Url"),c.Xb(4,"span",3),c.Yc(5,"*"),c.Wb(),c.Wb(),c.Sb(6,"input",22),c.Wc(7,rl,2,0,"small",5),c.Wb(),c.Xb(8,"div",1),c.Xb(9,"div",24),c.Xb(10,"span"),c.Yc(11,"OR"),c.Wb(),c.Wb(),c.Wb(),c.Xb(12,"div",25),c.Xb(13,"label"),c.Yc(14,"Upload XML file"),c.Wb(),c.Xb(15,"div",26),c.Xb(16,"div",27),c.Xb(17,"btn-upload-file",28),c.jc("onUploaded",(function(t){return c.Oc(e),c.nc().onUploadedFile(t,"metadataUrl")})),c.Wb(),c.Wb(),c.Wc(18,ol,3,0,"a",29),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(6),c.Hb("cl-border-danger",e.isValid("metadataUrl")),c.wc("readonly",e.isReadonly),c.Cb(1),c.wc("ngIf",e.isValid("metadataUrl")),c.Cb(10),c.wc("text","Choose file")("accept","text/xml")("btnClasses","cl-btn cl-btn-outline-light cl-btn-primary cl-color-gray"),c.Cb(1),c.wc("ngIf",e.form.get("metadataUrl").value)}}function ll(e,t){1&e&&(c.Xb(0,"small",20),c.Yc(1," Enter a valid Login Url. "),c.Wb())}function bl(e,t){1&e&&(c.Xb(0,"small",20),c.Yc(1," Enter a valid Logout Url. "),c.Wb())}function ul(e,t){if(1&e&&(c.Xb(0,"div",1),c.Xb(1,"label",32),c.Yc(2,"Certificate"),c.Wb(),c.Xb(3,"textarea",33),c.Yc(4,"            "),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(3),c.Hb("cl-border-danger",e.isValid("certificates")),c.wc("readonly",e.isReadonly)}}function dl(e,t){1&e&&(c.Xb(0,"small",20),c.Yc(1," Enter a valid certificates. "),c.Wb())}function pl(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",30,41),c.jc("click",(function(){c.Oc(e);const t=c.Lc(1);return c.nc(3).onUploadedFile("","certificates"),t.blur()}))("keyup.enter",(function(){return c.Oc(e),c.nc(3).onUploadedFile("","certificates")}))("keyup.space",(function(){return c.Oc(e),c.nc(3).onUploadedFile("","certificates")})),c.Yc(2,"Remove"),c.Wb()}}const hl=function(){return["application/x-x509-ca-cert"]};function ml(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",23),c.Xb(1,"div",1),c.Xb(2,"label",32),c.Yc(3,"Certificate"),c.Wb(),c.Xb(4,"textarea",39),c.Yc(5,"                    "),c.Wb(),c.Wc(6,dl,2,0,"small",5),c.Wb(),c.Xb(7,"div",1),c.Xb(8,"div",24),c.Xb(9,"span"),c.Yc(10,"OR"),c.Wb(),c.Wb(),c.Wb(),c.Xb(11,"div",25),c.Xb(12,"label"),c.Yc(13,"Upload X.509 certificate"),c.Wb(),c.Xb(14,"div",26),c.Xb(15,"div",27),c.Xb(16,"btn-upload-file-content",40),c.jc("onUploaded",(function(t){return c.Oc(e),c.nc(2).onUploadedFile(t,"certificates")})),c.Wb(),c.Wb(),c.Wc(17,pl,3,0,"a",29),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(4),c.Hb("cl-border-danger",e.isValid("certificates")),c.wc("readonly",e.isReadonly),c.Cb(2),c.wc("ngIf",e.isValid("certificates")),c.Cb(10),c.wc("accept",c.Ac(7,hl))("acceptExtensions",".pem, .cer, .crt, .der"),c.Cb(1),c.wc("ngIf",e.form.get("certificates").value)}}function gl(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div"),c.Xb(1,"div",34),c.Xb(2,"a",35),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.isExpanded=!t.isExpanded})),c.Xb(3,"span",36),c.Sb(4,"img",37),c.Wb(),c.Wb(),c.Xb(5,"span",38),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.isExpanded=!t.isExpanded})),c.Yc(6,"Advanced"),c.Wb(),c.Wb(),c.Wc(7,ml,18,8,"div",7),c.Wb()}if(2&e){const e=c.nc();c.Cb(4),c.wc("src",e.isExpanded?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",c.Qc),c.Cb(3),c.wc("ngIf",e.isExpanded)}}function fl(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",42),c.Xb(1,"a",43),c.jc("click",(function(){return c.Oc(e),c.nc().onClose.emit()})),c.Yc(2,"Cancel"),c.Wb(),c.Xb(3,"button",44),c.Yc(4," Finish Configuration "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.wc("disabled",e.form.invalid||e.inProgress)}}let vl=(()=>{class e{constructor(e,t){this.formBuilder=e,this.copyService=t,this.isModal=!0,this.isReadonly=!1,this.onClose=new c.n,this.onSubmit=new c.n,this.unsubscribe$=new Ee.a}set configuration(e){e&&this.initConfig(e)}ngOnInit(){this.form||this.initConfig(new da)}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}onUploadedFile(e,t){this.form.patchValue({[t]:e})}initConfig(e){this.form=this.formBuilder.group({relyingPartyIdentifier:[e.relyingPartyIdentifier,[on.a.required]],assertionConsumerServiceUrl:[e.assertionConsumerServiceUrl||tr.a.environment.endpoint+"/auth/saml2",[on.a.required]],metadataUrl:[e.metadataUrl,[on.a.required]],logoutUrl:[e.logoutUrl,[]],loginUrl:[e.loginUrl,[on.a.required]],certificates:[e.certificates?e.certificates[0]:"",[]]})}submit(){if(this.inProgress)return;const e=Object.assign({},this.form.value);e.certificates=[e.certificates?e.certificates.trim():""],Object.keys(e).map(t=>e[t]="string"==typeof e[t]?e[t].trim():e[t]);const t=new da(e);this.onSubmit.emit(t)}isValid(e){const t=this.form.get(e);return!!t&&t.dirty&&t.touched&&!!t.errors}copyToClipboard(e){this.copyService.copyToClipboard(e)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(p.f),c.Rb(J.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["form-saml2"]],inputs:{configuration:"configuration",inProgress:"inProgress",isModal:"isModal",isReadonly:"isReadonly"},outputs:{onClose:"onClose",onSubmit:"onSubmit"},decls:34,vars:20,consts:[[3,"formGroup","ngSubmit"],[1,"cl-form-group"],["for","relyingPartyIdentifier"],[1,"cl-text-danger","cl-ml-1"],["type","text","ngbAutofocus","","id","relyingPartyIdentifier","formControlName","relyingPartyIdentifier","autocomplete","off",1,"cl-form-control",3,"readonly"],["class","cl-form-text cl-text-danger",4,"ngIf"],["class","cl-form-group",4,"ngIf"],["class","cl-rounded cl-form-group cl-p-3 cl-border",4,"ngIf"],["for","loginUrl"],["type","text","id","loginUrl","formControlName","loginUrl","autocomplete","off",1,"cl-form-control",3,"readonly"],["for","logoutUrl"],["type","text","id","logoutUrl","formControlName","logoutUrl","autocomplete","off",1,"cl-form-control",3,"readonly"],[1,"cl-input-group","cl-mb-3"],[1,"cl-w-100"],["type","text","readonly","","formControlName","assertionConsumerServiceUrl",1,"cl-form-control"],["redirectUrlInput",""],[1,"cl-input-group-append"],["type","button",1,"cl-btn","cl-btn-outline-light",3,"click"],[4,"ngIf"],["class","modal-footer",4,"ngIf"],[1,"cl-form-text","cl-text-danger"],["for","metadataUrl"],["type","text","id","metadataUrl","formControlName","metadataUrl","autocomplete","off",1,"cl-form-control",3,"readonly"],[1,"cl-rounded","cl-form-group","cl-p-3","cl-border"],[1,"cl-or-divider"],[1,"cl-form-group","cl-mb-0"],[1,"cl-upload-file-wrapper"],[1,"cl-upload-btn-wrapper","cl-mr-3"],[3,"text","accept","btnClasses","onUploaded"],["tabindex","0","class","cl-color-blue",3,"click","keyup.enter","keyup.space",4,"ngIf"],["tabindex","0",1,"cl-color-blue",3,"click","keyup.enter","keyup.space"],["metadataUrlBtn",""],["for","certificates"],["formControlName","certificates","autocomplete","off","id","certificates","rows","3",1,"cl-form-control",3,"readonly"],[1,"cl-h2","cl-mb-0","cl-d-flex","cl-align-items-center"],[1,"cl-mr-2",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"],[1,"pointer",3,"click"],["formControlName","certificates","autocomplete","off","id","certificates","rows","5",1,"cl-form-control",3,"readonly"],[3,"accept","acceptExtensions","onUploaded"],["certificatesBtn",""],[1,"modal-footer"],["tabindex","0",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"form",0),c.jc("ngSubmit",(function(){return t.submit()})),c.Xb(1,"div"),c.Xb(2,"div",1),c.Xb(3,"label",2),c.Yc(4,"Entity Id"),c.Xb(5,"span",3),c.Yc(6,"*"),c.Wb(),c.Wb(),c.Sb(7,"input",4),c.Wc(8,sl,2,0,"small",5),c.Wb(),c.Wc(9,cl,6,3,"div",6),c.Wc(10,al,19,8,"div",7),c.Xb(11,"div",1),c.Xb(12,"label",8),c.Yc(13,"Login Url"),c.Xb(14,"span",3),c.Yc(15,"*"),c.Wb(),c.Wb(),c.Sb(16,"input",9),c.Wc(17,ll,2,0,"small",5),c.Wb(),c.Xb(18,"div",1),c.Xb(19,"label",10),c.Yc(20,"Logout Url"),c.Wb(),c.Sb(21,"input",11),c.Wc(22,bl,2,0,"small",5),c.Wb(),c.Xb(23,"div",12),c.Xb(24,"label",13),c.Yc(25,"Reply URL (Assertion Consumer Service URL)"),c.Wb(),c.Sb(26,"input",14,15),c.Xb(28,"div",16),c.Xb(29,"button",17),c.jc("click",(function(){c.Oc(e);const i=c.Lc(27);return t.copyToClipboard(i)})),c.Yc(30,"Copy"),c.Wb(),c.Wb(),c.Wb(),c.Wc(31,ul,5,3,"div",6),c.Wc(32,gl,8,2,"div",18),c.Wb(),c.Wc(33,fl,5,1,"div",19),c.Wb()}2&e&&(c.wc("formGroup",t.form),c.Cb(1),c.Hb("modal-body",t.isModal),c.Cb(6),c.Hb("cl-border-danger",t.isValid("relyingPartyIdentifier")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("relyingPartyIdentifier")),c.Cb(1),c.wc("ngIf",!t.isModal),c.Cb(1),c.wc("ngIf",t.isModal),c.Cb(6),c.Hb("cl-border-danger",t.isValid("loginUrl")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("loginUrl")),c.Cb(4),c.Hb("cl-border-danger",t.isValid("logoutUrl")),c.wc("readonly",t.isReadonly),c.Cb(1),c.wc("ngIf",t.isValid("logoutUrl")),c.Cb(9),c.wc("ngIf",!t.isModal),c.Cb(1),c.wc("ngIf",t.isModal),c.Cb(1),c.wc("ngIf",t.isModal))},directives:[p.I,p.t,p.k,p.c,p.s,p.i,s.u,br,nl],encapsulation:2,changeDetection:0}),e})();var wl=i("AHy6"),yl=i("kojQ");function Wl(e,t){1&e&&(c.Xb(0,"span",14),c.Yc(1," Inactive "),c.Wb())}function Cl(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",15),c.Xb(1,"div",16),c.Xb(2,"a",17),c.jc("click",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(15);return t.openModal(i)})),c.Yc(3,"Edit configuration"),c.Wb(),c.Xb(4,"a",18),c.jc("click",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(17);return t.openModal(i)})),c.Yc(5,"Delete"),c.Wb(),c.Wb(),c.Wb()}}function kl(e,t){if(1&e&&c.Sb(0,"form-ldap",21),2&e){const e=c.nc(2);c.wc("isReadonly",!0)("isModal",!1)("configuration",e.configuration)}}function Sl(e,t){if(1&e&&c.Sb(0,"form-oauth",21),2&e){const e=c.nc(2);c.wc("isReadonly",!0)("isModal",!1)("configuration",e.configuration)}}function Il(e,t){if(1&e&&c.Sb(0,"form-saml2",21),2&e){const e=c.nc(2);c.wc("isReadonly",!0)("isModal",!1)("configuration",e.configuration)}}function Ol(e,t){if(1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",19),c.Wc(2,kl,1,3,"form-ldap",20),c.Wc(3,Sl,1,3,"form-oauth",20),c.Wc(4,Il,1,3,"form-saml2",20),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.wc("ngIf",e.type===e.authTypes.LDAP),c.Cb(1),c.wc("ngIf",e.type===e.authTypes.OAUTH2),c.Cb(1),c.wc("ngIf",e.type===e.authTypes.SAML2)}}function Xl(e,t){if(1&e){const e=c.Yb();c.Xb(0,"form-ldap",24),c.jc("onSubmit",(function(t){c.Oc(e);const i=c.nc().$implicit;return c.nc().editConfiguration(t,i)}))("onClose",(function(){return c.Oc(e),c.nc().$implicit.close()})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("configuration",e.configuration)("inProgress",e.inProgress)}}function El(e,t){if(1&e){const e=c.Yb();c.Xb(0,"form-oauth",24),c.jc("onSubmit",(function(t){c.Oc(e);const i=c.nc().$implicit;return c.nc().editConfiguration(t,i)}))("onClose",(function(){return c.Oc(e),c.nc().$implicit.close()})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("configuration",e.configuration)("inProgress",e.inProgress)}}function Tl(e,t){if(1&e){const e=c.Yb();c.Xb(0,"form-saml2",24),c.jc("onSubmit",(function(t){c.Oc(e);const i=c.nc().$implicit;return c.nc().editConfiguration(t,i)}))("onClose",(function(){return c.Oc(e),c.nc().$implicit.close()})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("configuration",e.configuration)("inProgress",e.inProgress)}}function Dl(e,t){if(1&e&&(c.Xb(0,"modal-header",22),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Wc(1,Xl,1,2,"form-ldap",23),c.Wc(2,El,1,2,"form-oauth",23),c.Wc(3,Tl,1,2,"form-saml2",23)),2&e){const e=c.nc();c.wc("title",e.label+" authentication"),c.Cb(1),c.wc("ngIf",e.type===e.authTypes.LDAP),c.Cb(1),c.wc("ngIf",e.type===e.authTypes.OAUTH2),c.Cb(1),c.wc("ngIf",e.type===e.authTypes.SAML2)}}function Rl(e,t){if(1&e){const e=c.Yb();c.Xb(0,"delete-confirm-modal",25),c.jc("onClose",(function(){return t.$implicit.close()}))("onDelete",(function(){c.Oc(e);const i=t.$implicit;return c.nc().deleteConfirmed(i)})),c.Xb(1,"p"),c.Yc(2),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("inProgress",e.inProgress)("title","Delete configuration"),c.Cb(2),c.ad("Are you sure you want to delete your ",e.label," configuration?")}}let Al=(()=>{class e{constructor(e,t,i){this.modalService=e,this.authSSOService=t,this.cd=i,this.onDelete=new c.n,this.unsubscribe$=new Ee.a,this.isExpanded=!0,this.authTypes=ba}ngOnInit(){try{this.label=ga.filter(e=>e.value===this.type)[0].label}catch(e){}}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}toggle(){this.isExpanded=!this.isExpanded}openModal(e){this.modalService.open(e,{centered:!0})}editConfiguration(e,t){this.inProgress=!0,this.authSSOService.patchConfiguration(e,this.type).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.configuration=e,this.inProgress=!1,t.close(),this.cd.detectChanges()},()=>{this.inProgress=!1,this.cd.detectChanges()})}deleteConfirmed(e){this.inProgress=!0,this.authSSOService.deleteConfiguration(this.type).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.onDelete.emit(this.type),this.inProgress=!1,e.close()},()=>{this.inProgress=!1,this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(g.q),c.Rb(ma),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["config-row"]],inputs:{configuration:"configuration",active:"active",type:"type"},outputs:{onDelete:"onDelete"},decls:18,vars:4,consts:[[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12","cl-relative"],[1,"cl-h2","cl-mb-0","cl-d-flex","cl-align-items-center"],[1,"cl-mr-2",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"],["class","cl-badge cl-badge-dark cl-ml-2 cl-text-uppercase",4,"ngIf"],["dropdownKey","",1,"cl-dropdown","cl-absolute","cl-t-0","cl-r-0"],["dropdownKeyButton","",1,"cl-btn","cl-btn-primary","cl-btn-fixed-40","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical-white.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right","openUpAtBottom","",4,"dropdownKeyContent"],["class","cl-form-row",4,"ngIf"],["editSSOModal",""],["deleteModal",""],[1,"cl-badge","cl-badge-dark","cl-ml-2","cl-text-uppercase"],["openUpAtBottom","",1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area"],[1,"cl-dropdown-item",3,"click"],[1,"cl-dropdown-item","cl-text-danger",3,"click"],[1,"cl-form-group","cl-col-md-12","cl-col-lg-10","cl-col-lg-custom-6"],[3,"isReadonly","isModal","configuration",4,"ngIf"],[3,"isReadonly","isModal","configuration"],[3,"title","onClose"],[3,"configuration","inProgress","onSubmit","onClose",4,"ngIf"],[3,"configuration","inProgress","onSubmit","onClose"],[3,"inProgress","title","onClose","onDelete"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"a",3),c.jc("click",(function(){return t.toggle()})),c.Xb(4,"span",4),c.Sb(5,"img",5),c.Wb(),c.Wb(),c.Xb(6,"span"),c.Yc(7),c.Wc(8,Wl,2,0,"span",6),c.Wb(),c.Wb(),c.Xb(9,"div",7),c.Xb(10,"a",8),c.Sb(11,"img",9),c.Wb(),c.Wc(12,Cl,6,0,"div",10),c.Wb(),c.Wb(),c.Wb(),c.Wc(13,Ol,5,3,"div",11),c.Wc(14,Dl,4,4,"ng-template",null,12,c.Xc),c.Wc(16,Rl,3,3,"ng-template",null,13,c.Xc)),2&e&&(c.Cb(5),c.wc("src",t.isExpanded?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",c.Qc),c.Cb(2),c.ad(" ",t.label," configuration "),c.Cb(1),c.wc("ngIf",!t.active),c.Cb(5),c.wc("ngIf",t.isExpanded))},directives:[s.u,Si.a,Ii.a,Oi.a,La,tl,vl,wl.a,yl.a],encapsulation:2,changeDetection:0}),e})();function jl(e,t){if(1&e){const e=c.Yb();c.Xb(0,"domain-input",6),c.jc("onEnter",(function(){return c.Oc(e),c.nc().rename()}))("onAvailableName",(function(t){return c.Oc(e),c.nc().availabilityChanged(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("autofocus",!0)("name",e.subdomain.domainName)}}function xl(e,t){1&e&&(c.Xb(0,"div",7),c.Yc(1," Are you sure? Once you change the subdomain, the current one will stop working and all your users will have to use Clockify from the new URL. "),c.Wb())}let Pl=(()=>{class e{constructor(e,t){this.authSSOService=e,this.subdomainService=t,this.onClose=new c.n,this.onRenamed=new c.n,this.unsubscribe$=new Ee.a,this.isConfirmed=!1}get btnLabel(){return this.isConfirmed&&this.isSubdomain?"Change and move":"Change"}get isDisabled(){return!this.availableName||this.inProgress}ngOnInit(){this.isSubdomain=this.subdomainService.isSubdomainNotSelfhosted()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}availabilityChanged(e){this.availableName=e}rename(){this.isDisabled||(this.isConfirmed?(this.inProgress=!0,this.authSSOService.editDomainData({domainName:this.availableName}).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.onRenamed.emit(e)},()=>{this.inProgress=!1})):this.isConfirmed=!0)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(ma),c.Rb(fa.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["rename-domain"]],inputs:{subdomain:"subdomain"},outputs:{onClose:"onClose",onRenamed:"onRenamed"},decls:9,vars:4,consts:[[1,"cl-modal-body"],[3,"autofocus","name","onEnter","onAvailableName",4,"ngIf","ngIfElse"],["confirmTemplate",""],[1,"cl-modal-footer"],[3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[3,"autofocus","name","onEnter","onAvailableName"],[1,"cl-form-group"]],template:function(e,t){if(1&e&&(c.Xb(0,"div",0),c.Wc(1,jl,1,2,"domain-input",1),c.Wc(2,xl,2,0,"ng-template",null,2,c.Xc),c.Wb(),c.Xb(4,"div",3),c.Xb(5,"a",4),c.jc("click",(function(){return t.onClose.emit()})),c.Yc(6,"Cancel"),c.Wb(),c.Xb(7,"button",5),c.jc("click",(function(){return t.rename()})),c.Yc(8),c.Wb(),c.Wb()),2&e){const e=c.Lc(3);c.Cb(1),c.wc("ngIf",!t.isConfirmed)("ngIfElse",e),c.Cb(6),c.wc("disabled",t.isDisabled),c.Cb(1),c.ad(" ",t.btnLabel," ")}},directives:[s.u,Ta],encapsulation:2}),e})();const Ml=["typesCheckbox"];function Yl(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",10),c.Xb(1,"input",11,12),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().authType=t})),c.Wb(),c.Xb(3,"label",13),c.Yc(4),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit,i=c.nc();c.Cb(1),c.xc("value",e.value),c.yc("id","authentication-",e.value,""),c.wc("ngModel",i.authType),c.Cb(2),c.yc("for","authentication-",e.value,""),c.Cb(1),c.ad(" ",e.label," ")}}let Ll=(()=>{class e{constructor(){this.onClose=new c.n,this.onChooseType=new c.n,this.unsubscribe$=new Ee.a}ngOnInit(){1===this.options.length&&(this.authType=this.options[0].value)}ngAfterViewInit(){this.typesCheckbox&&this.typesCheckbox.first&&this.typesCheckbox.first.nativeElement.focus()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}next(){this.onChooseType.emit(this.authType)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["configure-sso-type"]],viewQuery:function(e,t){var i;1&e&&c.ed(Ml,!0),2&e&&c.Kc(i=c.kc())&&(t.typesCheckbox=i)},inputs:{options:["availableTypes","options"]},outputs:{onClose:"onClose",onChooseType:"onChooseType"},decls:17,vars:2,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"modal-body"],[1,"cl-form-group","cl-mb-0"],["class","cl-custom-control cl-custom-radio",4,"ngFor","ngForOf"],[1,"modal-footer"],["tabindex","0",3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-custom-control","cl-custom-radio"],["type","radio","tabindex","0","name","authentication",1,"cl-custom-control-input",3,"ngModel","value","id","ngModelChange"],["typesCheckbox",""],[1,"cl-custom-control-label",3,"for"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2,"Authentication type"),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.onClose.emit()})),c.Xb(4,"span"),c.Sb(5,"img",3),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",4),c.Xb(7,"form"),c.Xb(8,"label"),c.Yc(9,"Select authentication type for SSO"),c.Wb(),c.Xb(10,"div",5),c.Wc(11,Yl,5,5,"div",6),c.Wb(),c.Wb(),c.Wb(),c.Xb(12,"div",7),c.Xb(13,"a",8),c.jc("click",(function(){return t.onClose.emit()})),c.Yc(14,"Cancel"),c.Wb(),c.Xb(15,"button",9),c.jc("click",(function(){return t.next()})),c.Yc(16,"Next"),c.Wb(),c.Wb()),2&e&&(c.Cb(11),c.wc("ngForOf",t.options),c.Cb(4),c.wc("disabled",!t.authType))},directives:[p.I,p.t,p.u,s.t,p.A,p.c,p.s,p.v],encapsulation:2,changeDetection:0}),e})();function Fl(e,t){if(1&e){const e=c.Yb();c.Xb(0,"configure-sso-type",2),c.jc("onChooseType",(function(t){return c.Oc(e),c.nc().onChooseType(t)}))("onClose",(function(){return c.Oc(e),c.nc().onClose.emit()})),c.Wb()}if(2&e){const e=c.nc();c.wc("availableTypes",e.availableTypes)}}function Nl(e,t){if(1&e){const e=c.Yb();c.Xb(0,"form-saml2",5),c.jc("onSubmit",(function(t){c.Oc(e);const i=c.nc(2);return i.onSubmit(t,i.authTypes.SAML2)}))("onClose",(function(){return c.Oc(e),c.nc(2).onClose.emit()})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("inProgress",e.inProgress)}}function Ul(e,t){if(1&e){const e=c.Yb();c.Xb(0,"form-oauth",5),c.jc("onSubmit",(function(t){c.Oc(e);const i=c.nc(2);return i.onSubmit(t,i.authTypes.OAUTH2)}))("onClose",(function(){return c.Oc(e),c.nc(2).onClose.emit()})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("inProgress",e.inProgress)}}function $l(e,t){if(1&e){const e=c.Yb();c.Xb(0,"form-ldap",5),c.jc("onSubmit",(function(t){c.Oc(e);const i=c.nc(2);return i.onSubmit(t,i.authTypes.LDAP)}))("onClose",(function(){return c.Oc(e),c.nc(2).onClose.emit()})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("inProgress",e.inProgress)}}function _l(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"modal-header",3),c.jc("onClose",(function(){return c.Oc(e),c.nc().onClose.emit()})),c.Wb(),c.Wc(2,Nl,1,1,"form-saml2",4),c.Wc(3,Ul,1,1,"form-oauth",4),c.Wc(4,$l,1,1,"form-ldap",4),c.Ub()}if(2&e){const e=c.nc();c.Cb(1),c.wc("title",e.label),c.Cb(1),c.wc("ngIf",e.authType===e.authTypes.SAML2),c.Cb(1),c.wc("ngIf",e.authType===e.authTypes.OAUTH2),c.Cb(1),c.wc("ngIf",e.authType===e.authTypes.LDAP)}}let Gl=(()=>{class e{constructor(e,t){this.authSSOService=e,this.cd=t,this.onClose=new c.n,this.onCreated=new c.n,this.unsubscribe$=new Ee.a,this.authTypes=ba}ngOnInit(){}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}onChooseType(e){this.authType=e;try{const t=this.availableTypes.filter(t=>t.value===e)[0].label;this.label=t+" authentication"}catch(t){this.label="Authentication"}}onSubmit(e,t){this.inProgress||(this.inProgress=!0,this.authSSOService.patchConfiguration(e,t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.onCreated.emit(e),this.inProgress=!1},()=>{this.inProgress=!1,this.cd.detectChanges()}))}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(ma),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["create-configuration-modal"]],inputs:{availableTypes:"availableTypes"},outputs:{onClose:"onClose",onCreated:"onCreated"},decls:2,vars:2,consts:[[3,"availableTypes","onChooseType","onClose",4,"ngIf"],[4,"ngIf"],[3,"availableTypes","onChooseType","onClose"],[3,"title","onClose"],[3,"inProgress","onSubmit","onClose",4,"ngIf"],[3,"inProgress","onSubmit","onClose"]],template:function(e,t){1&e&&(c.Wc(0,Fl,1,1,"configure-sso-type",0),c.Wc(1,_l,5,4,"ng-container",1)),2&e&&(c.wc("ngIf",!t.authType),c.Cb(1),c.wc("ngIf",t.authType))},directives:[s.u,Ll,wl.a,vl,tl,La],encapsulation:2,changeDetection:0}),e})();function Bl(e,t){if(1&e&&(c.Vb(0),c.Yc(1),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" Password must have at least ",e.minLength," characters. ")}}function Vl(e,t){if(1&e&&(c.Xb(0,"div",9),c.Wc(1,Bl,2,1,"ng-container",10),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.password.errors.required||e.password.errors.minlength)}}function Hl(e,t){1&e&&(c.Xb(0,"div",9),c.Yc(1," Passwords don't match. "),c.Wb())}let zl=(()=>{class e{constructor(e,t){this.formBuilder=e,this.authService=t,this.unsubscribe$=new Ee.a,this.onClose=new c.n,this.onSetPassword=new c.n}ngOnInit(){this.minLength=ei.s,this.maxLength=ei.r,this.setPasswordForm=this.formBuilder.group({password:["",[p.G.required,p.G.minLength(this.minLength),p.G.maxLength(this.maxLength)]],passwordRepeated:["",[p.G.required]]},{validator:Object(Pt.B)("password","passwordRepeated")})}get password(){return this.setPasswordForm.get("password")}get passwordRepeated(){return this.setPasswordForm.get("passwordRepeated")}get isPasswordInvalid(){return this.password.dirty&&this.password.touched&&!!this.password.errors}get isPasswordRepeatedInvalid(){return this.passwordRepeated.dirty&&this.passwordRepeated.touched&&!!this.passwordRepeated.errors}onSubmit(){this.setPasswordForm.invalid||(this.inProgress=!0,this.authService.setPassword(this.password.value,this.passwordRepeated.value).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>this.onSetPassword.emit(!0),()=>this.closeModal()))}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}closeModal(){this.onClose.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(p.f),c.Rb(Ce.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["set-password"]],outputs:{onClose:"onClose",onSetPassword:"onSetPassword"},decls:17,vars:8,consts:[["novalidate","",3,"formGroup","ngSubmit"],[1,"cl-modal-body"],[1,"cl-form-group"],["formControlName","password","type","password","ngbAutofocus","","autocomplete","new-password",1,"cl-form-control"],["class","cl-invalid-feedback",4,"ngIf"],["type","password","autocomplete","new-password","formControlName","passwordRepeated",1,"cl-form-control"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"click","keyup.enter"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-invalid-feedback"],[4,"ngIf"]],template:function(e,t){1&e&&(c.Xb(0,"form",0),c.jc("ngSubmit",(function(){return t.onSubmit()})),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"label"),c.Yc(4,"Password"),c.Wb(),c.Sb(5,"input",3),c.Wc(6,Vl,2,1,"div",4),c.Wb(),c.Xb(7,"div",2),c.Xb(8,"label"),c.Yc(9,"Retype password"),c.Wb(),c.Sb(10,"input",5),c.Wc(11,Hl,2,0,"div",4),c.Wb(),c.Wb(),c.Xb(12,"div",6),c.Xb(13,"a",7),c.jc("click",(function(){return t.closeModal()}))("keyup.enter",(function(){return t.closeModal()})),c.Yc(14," Cancel "),c.Wb(),c.Xb(15,"button",8),c.Yc(16,"Save"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.wc("formGroup",t.setPasswordForm),c.Cb(5),c.Hb("cl-is-invalid",t.isPasswordInvalid),c.Cb(1),c.wc("ngIf",t.isPasswordInvalid),c.Cb(4),c.Hb("cl-is-invalid",t.isPasswordRepeatedInvalid),c.Cb(1),c.wc("ngIf",t.isPasswordRepeatedInvalid),c.Cb(4),c.wc("disabled",t.inProgress||t.setPasswordForm.invalid))},directives:[p.I,p.t,p.k,p.c,p.s,p.i,s.u],encapsulation:2}),e})();function ql(e,t){1&e&&(c.Xb(0,"div",44),c.Xb(1,"info"),c.Yc(2," Only workspace owner can manage authentication settings. "),c.Wb(),c.Wb())}const Kl=function(){return["/upgrade"]};function Zl(e,t){1&e&&(c.Xb(0,"div",44),c.Xb(1,"info"),c.Yc(2," ENTERPRISE feature "),c.Xb(3,"a",45),c.Yc(4,"Upgrade"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(3),c.wc("routerLink",c.Ac(1,Kl)))}function Ql(e,t){1&e&&c.Sb(0,"div",46)}function Jl(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",44),c.Xb(1,"info"),c.Yc(2," You can't create subdomain if you don't have a password. "),c.Xb(3,"a",47),c.jc("click",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(80);return t.openModal(i)})),c.Yc(4,"Set password"),c.Wb(),c.Wb(),c.Wb()}}function eb(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",52),c.Xb(1,"div",53),c.Xb(2,"a",54,55),c.jc("keyup.enter",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(74);return t.openModal(i)}))("keyup.space",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(74);return t.openModal(i)}))("click",(function(){c.Oc(e);const t=c.Lc(3),i=c.nc(2),n=c.Lc(74);return t.blur(),i.openModal(n)})),c.Yc(4,"Change subdomain"),c.Wb(),c.Sb(5,"div",56),c.Xb(6,"a",57,58),c.jc("keyup.enter",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(76);return t.openModal(i)}))("keyup.space",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(76);return t.openModal(i)}))("click",(function(){c.Oc(e);const t=c.Lc(7),i=c.nc(2),n=c.Lc(76);return t.blur(),i.openModal(n)})),c.Yc(8,"Delete"),c.Wb(),c.Wb(),c.Wb()}}function tb(e,t){1&e&&(c.Xb(0,"div",48),c.Xb(1,"a",49),c.Sb(2,"img",50),c.Wb(),c.Wc(3,eb,9,0,"div",51),c.Wb())}function ib(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",59,60),c.jc("keyup.enter",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(72);return t.openModal(i)}))("keyup.space",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(72);return t.openModal(i)}))("click",(function(){c.Oc(e);const t=c.Lc(1),i=c.nc(),n=c.Lc(72);return t.blur(),i.openModal(n)})),c.Yc(2," Create subdomain "),c.Wb()}if(2&e){const e=c.nc();c.wc("disabled",e.isCreateDisabled)}}function nb(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",61),c.jc("keyup.enter",(function(){return c.Oc(e),c.nc().moveToSubdomain()}))("keyup.space",(function(){return c.Oc(e),c.nc().moveToSubdomain()}))("click",(function(){return c.Oc(e),c.nc().moveToSubdomain()})),c.Yc(1," Move to Subdomain "),c.Wb()}}function sb(e,t){if(1&e&&(c.Xb(0,"div",62),c.Sb(1,"img",63),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("src",e.subdomain.logoURL,c.Qc)}}function cb(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",64),c.jc("click",(function(){return c.Oc(e),c.nc().setLogo()}))("keyup.enter",(function(){return c.Oc(e),c.nc().setLogo()}))("keyup.space",(function(){return c.Oc(e),c.nc().setLogo()})),c.Yc(1," Remove image "),c.Wb()}}function rb(e,t){1&e&&(c.Xb(0,"div",5),c.Xb(1,"div",6),c.Xb(2,"div",67),c.Yc(3,"Configure SSO"),c.Wb(),c.Xb(4,"div",8),c.Yc(5," Supported SSO systems: LDAP, OAuth, and SAML2 (all identity providers covered: Google, Okta, OneLogin, Azure, Active Directory, etc). "),c.Wb(),c.Wb(),c.Wb())}function ob(e,t){if(1&e){const e=c.Yb();c.Xb(0,"config-row",68),c.jc("onDelete",(function(){c.Oc(e);const i=t.$implicit;return c.nc(2).onDeletedConfiguration(i)})),c.Wb()}if(2&e){const e=t.$implicit,i=c.nc(2);c.wc("type",e)("active",i.isConfigActive(e))("configuration",i.configurations[e])}}function ab(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",44),c.Xb(1,"button",69,70),c.jc("click",(function(){c.Oc(e);const t=c.Lc(2),i=c.nc(2),n=c.Lc(78);return t.blur(),i.openModal(n)}))("keyup.enter",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(78);return t.openModal(i)}))("keyup.space",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(78);return t.openModal(i)})),c.Yc(3," Add SSO Configuration "),c.Wb(),c.Wb()}}function lb(e,t){if(1&e&&(c.Vb(0),c.Sb(1,"hr",22),c.Wc(2,rb,6,0,"div",65),c.Wc(3,ob,1,3,"config-row",66),c.Wc(4,ab,4,0,"div",0),c.Ub()),2&e){const e=c.nc();c.Cb(2),c.wc("ngIf",!(null!=e.configurations&&e.configurations.length)),c.Cb(1),c.wc("ngForOf",e.objectKeys(e.configurations)),c.Cb(1),c.wc("ngIf",e.availableConfigurations.length)}}function bb(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",71),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().createSubdomain(i)}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Xb(1,"p"),c.Yc(2," Are you sure? Once you create the subdomain, you and your users will have to access Clockify from "),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Create subdomain")("btnText","Create")("inProgress",e.creatingInprogress),c.Cb(4),c.Zc(e.subdomainUrl)}}function ub(e,t){if(1&e){const e=c.Yb();c.Xb(0,"modal-header",72),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"rename-domain",73),c.jc("onRenamed",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().onRenamed(i),n.close()}))("onClose",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Change subdomain"),c.Cb(1),c.wc("subdomain",e.subdomain)}}function db(e,t){if(1&e){const e=c.Yb();c.Xb(0,"delete-confirm-modal",74),c.jc("onClose",(function(i){return c.Oc(e),t.$implicit.close(i)}))("onDelete",(function(){c.Oc(e);const i=t.$implicit;return c.nc().deleteSubdomainConfirmed(i)})),c.Xb(1,"p"),c.Yc(2," Once you delete the subdomain, you won't be able to use SSO for authentication and your workspace will be moved back to main Clockify domain. "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("inProgress",e.deletingInProgress)("title","Delete subdomain")}}function pb(e,t){if(1&e){const e=c.Yb();c.Xb(0,"create-configuration-modal",75),c.jc("onCreated",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().onCreateSSOConfig(i),n.close()}))("onClose",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("availableTypes",e.availableConfigurations)}}function hb(e,t){if(1&e){const e=c.Yb();c.Xb(0,"modal-header",72),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"set-password",76),c.jc("onClose",(function(){return t.$implicit.close()}))("onSetPassword",(function(){c.Oc(e);const i=t.$implicit;return c.nc().onSetPassword(),i.close()})),c.Wb()}2&e&&c.wc("title","Set password")}let mb=(()=>{class e{constructor(e,t,i,n,s,c,r){this.modalService=e,this.authSSOService=t,this.authService=i,this.subdomainService=n,this.subdomainNameService=s,this.loader=c,this.cd=r,this.unsubscribe$=new Ee.a,this.updateSettingsDebouncer$=new Ee.a,this._subdomain=new ua,this.authType=ba,this.logins={[this.authType.NATIVE_LOGIN]:!0},this.objectKeys=Object.keys,this.configurations={}}set isOwner(e){const t=this.isOwner;this._isOwner=e,!t&&this.isOwner&&this.isInitialized&&this.getAllData()}get isOwner(){return this._isOwner}set subdomain(e){this._subdomain=e,this.subdomainNameService.setSubdomainName(e),this.setLoginData()}get subdomain(){return this._subdomain}ngOnInit(){this.isSubdomain=this.subdomainService.isSubdomainNotSelfhosted(),this.getAllData(),this.isInitialized=!0}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getAllData(){this.isOwner&&this.hasCustomSubdomainFeature&&(this.checkUserHasPassword(),this.subscribeToSaveSettings(),this.authSSOService.getSubdomain().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.subdomain=e,this.getConfigurations()}))}get availableConfigurations(){return ga.filter(e=>!this.configurations[e.value])}get isCreateDisabled(){return!this.availableName||this.creatingInprogress||!this.userHasPassword}get hasImage(){return!!this.subdomain.logoURL}get subdomainUrl(){return`${window.location.protocol}//${this.availableName}.${tr.a.environment.frontendUrl}`}availabilityChanged(e){this.availableName=e}createSubdomain(e){this.creatingInprogress=!0,this.authSSOService.createSubdomain(this.availableName).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.subdomain=t,this.creatingInprogress=!1,this.availableName=null,this.moveToSubdomain(!0,{token:t.auth&&t.auth.token,refreshToken:t.auth&&t.auth.refreshToken}),e.close()},()=>{this.creatingInprogress=!1,this.cd.detectChanges()})}setLogo(e=""){this.subdomain.logoURL=e,this.updateSettings()}moveToSubdomain(e=!1,t){e&&this.loader.show("Redirecting to subdomain"),setTimeout(()=>{this.subdomainService.moveToSubdomain(this.subdomain.domainName,t)},e?3e3:0)}deleteSubdomainConfirmed(e){this.deletingInProgress=!0,this.authSSOService.deleteSubdomain().pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.isSubdomain&&this.subdomainService.moveBackToClockifyDomain({token:t.auth&&t.auth.token,refreshToken:t.auth&&t.auth.refreshToken}),this.deletingInProgress=!1,this.subdomain=new ua,this.configurations={},e.close()},()=>{this.deletingInProgress=!1,this.cd.detectChanges()})}updateLoginData(e,t){if(!e&&this.subdomain.loginPreferences.length<2)setTimeout(()=>{this.setLoginData(),this.cd.detectChanges()});else{if(e)this.subdomain.loginPreferences.indexOf(t)<0&&this.subdomain.loginPreferences.push(t);else{const e=this.subdomain.loginPreferences.indexOf(t);-1!==e&&this.subdomain.loginPreferences.splice(e,1)}setTimeout(()=>{this.setLoginData(),this.cd.detectChanges(),this.updateSettingsDebouncer$.next()})}}isConfigActive(e){return this.subdomain.loginPreferences.indexOf(e)>-1}updateSettingsDebounce(){this.updateSettingsDebouncer$.next()}onSetPassword(){this.userHasPassword=!0,this.cd.detectChanges()}onDeletedConfiguration(e){delete this.configurations[e],this.logins[e]=!1;const t=this.subdomain.loginPreferences.indexOf(e);t>-1&&this.subdomain.loginPreferences.splice(t,1),0===this.subdomain.loginPreferences.length&&this.subdomain.loginPreferences.push(ba.NATIVE_LOGIN),this.setLoginData()}onRenamed(e){if(this.subdomain=e,this.isSubdomain){const e={token:localStorage.getItem("token"),refreshToken:localStorage.getItem("refreshToken")};this.moveToSubdomain(!1,e)}}onCreateSSOConfig(e){const t=this.getConfigType(e);t?this.configurations[t]=e:this.getConfigurations()}subscribeToSaveSettings(){this.updateSettingsDebouncer$.pipe(Object(Te.a)(500),Object(De.a)(this.unsubscribe$)).subscribe(()=>this.updateSettings())}updateSettings(){this.subdomain.id&&this.authSSOService.editDomainData(this.subdomain).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.subdomain=e})}setLoginData(){this.logins={},this.subdomain.loginPreferences.forEach(e=>this.logins[e]=!0)}checkUserHasPassword(){this.authService.canChangePassword.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.userHasPassword=e,this.cd.detectChanges()}),this.authService.canChange()}getConfigurations(){this.authSSOService.getConfigurations().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.configurations=e,this.cd.detectChanges()})}openModal(e){this.isModalOpen||(this.isModalOpen=!0,this.modalService.open(e,{centered:!0}).result.then(()=>setTimeout(()=>this.isModalOpen=!1,150),()=>setTimeout(()=>this.isModalOpen=!1,150)))}getConfigType(e){return e instanceof ha?ba.LDAP:e instanceof pa?ba.OAUTH2:e instanceof da?ba.SAML2:null}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(g.q),c.Rb(ma),c.Rb(Ce.a),c.Rb(fa.a),c.Rb(va),c.Rb(wi.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["auth-tab"]],inputs:{isOwner:"isOwner",hasCustomSubdomainFeature:"hasCustomSubdomainFeature"},decls:81,vars:24,consts:[["class","cl-form-group",4,"ngIf"],[1,"cl-relative"],["class","cl-blocker",4,"ngIf"],[1,"cl-row"],[1,"cl-col-lg-custom-12"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12","cl-relative"],[1,"cl-h2","cl-mb-0"],[1,"cl-text-gray-9","cl-pr-4","cl-pr-lg-custom-0"],["class","cl-dropdown cl-absolute cl-t-0 cl-r-0","dropdownKey","",4,"ngIf"],[1,"cl-form-group","cl-col-md-12","cl-col-lg-10","cl-col-lg-custom-6"],[1,"cl-form-row","cl-align-items-start"],[1,"cl-form-group","cl-mb-3","cl-mb-md-0","cl-col-md-8"],[3,"disable","name","onEnter","onAvailableName"],[1,"cl-form-group","cl-mb-0","cl-col-md-4"],["tabindex","0","class","cl-btn cl-btn-primary cl-btn-block",3,"disabled","keyup.enter","keyup.space","click",4,"ngIf"],["tabindex","0","class","cl-btn cl-btn-primary cl-btn-block",3,"keyup.enter","keyup.space","click",4,"ngIf"],[1,"cl-form-group","cl-col-md-12"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","id","customSwitchJoin",1,"cl-custom-control-input",3,"disabled","ngModel","ngModelChange"],["for","customSwitchJoin",1,"cl-custom-control-label"],[1,"cl-text-gray-9"],[1,"cl-mt-0"],[1,"cl-custom-control","cl-custom-checkbox"],["type","checkbox","id","login-native",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange"],["for","login-native",1,"cl-custom-control-label"],["type","checkbox","id","login-ldap",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange"],["for","login-ldap",1,"cl-custom-control-label"],["type","checkbox","id","login-oauth",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange"],["for","login-oauth",1,"cl-custom-control-label"],["type","checkbox","id","login-saml2",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange"],["for","login-saml2",1,"cl-custom-control-label"],[1,"cl-d-flex","cl-align-items-center"],["class","cl-border cl-min-width-40 cl-min-height-40 cl-d-flex cl-align-items-center cl-justify-content-center cl-mr-2",4,"ngIf"],[1,"cl-upload-file-wrapper"],[1,"cl-upload-btn-wrapper","cl-mr-3"],[3,"disabled","btnClasses","onUploaded"],["tabindex","0",3,"click","keyup.enter","keyup.space",4,"ngIf"],[4,"ngIf"],["createSubdomainModal",""],["renameModal",""],["deleteModal",""],["configureSSOModal",""],["setPasswordModal",""],[1,"cl-form-group"],[1,"cl-btn",3,"routerLink"],[1,"cl-blocker"],[1,"cl-btn",3,"click"],["dropdownKey","",1,"cl-dropdown","cl-absolute","cl-t-0","cl-r-0"],["dropdownKeyButton","",1,"cl-btn","cl-btn-primary","cl-btn-fixed-40","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical-white.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area"],["tabindex","0","clickCloseDropdown","",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],["changeBtn",""],[1,"cl-dropdown-divider"],["tabindex","0","clickCloseDropdown","",1,"cl-dropdown-item","cl-text-danger",3,"keyup.enter","keyup.space","click"],["deleteBtn",""],["tabindex","0",1,"cl-btn","cl-btn-primary","cl-btn-block",3,"disabled","keyup.enter","keyup.space","click"],["createBtn",""],["tabindex","0",1,"cl-btn","cl-btn-primary","cl-btn-block",3,"keyup.enter","keyup.space","click"],[1,"cl-border","cl-min-width-40","cl-min-height-40","cl-d-flex","cl-align-items-center","cl-justify-content-center","cl-mr-2"],[1,"cl-signup-logo","cl-relative",3,"src"],["tabindex","0",3,"click","keyup.enter","keyup.space"],["class","cl-form-row",4,"ngIf"],["class","cl-mb-2 cl-d-block",3,"type","active","configuration","onDelete",4,"ngFor","ngForOf"],[1,"cl-h2","cl-mb-0","cl-d-flex","cl-align-items-center"],[1,"cl-mb-2","cl-d-block",3,"type","active","configuration","onDelete"],["tabindex","0",1,"cl-btn","cl-btn-primary",3,"click","keyup.enter","keyup.space"],["addSSOBtn",""],[3,"title","btnText","inProgress","confirmed","close"],[3,"title","onClose"],[3,"subdomain","onRenamed","onClose"],[3,"inProgress","title","onClose","onDelete"],[3,"availableTypes","onCreated","onClose"],[3,"onClose","onSetPassword"]],template:function(e,t){if(1&e){const e=c.Yb();c.Wc(0,ql,3,0,"div",0),c.Wc(1,Zl,5,2,"div",0),c.Xb(2,"div",1),c.Wc(3,Ql,1,0,"div",2),c.Xb(4,"div",3),c.Xb(5,"div",4),c.Xb(6,"div"),c.Wc(7,Jl,5,0,"div",0),c.Xb(8,"div",5),c.Xb(9,"div",6),c.Xb(10,"div",7),c.Yc(11,"Subdomain"),c.Wb(),c.Xb(12,"div",8),c.Yc(13," In order to use SSO, you need to have a subdomain from which your team will access this workspace. "),c.Wb(),c.Wc(14,tb,4,0,"div",9),c.Wb(),c.Xb(15,"div",10),c.Xb(16,"label"),c.Yc(17,"Your subdomain"),c.Wb(),c.Xb(18,"div",11),c.Xb(19,"div",12),c.Xb(20,"domain-input",13),c.jc("onEnter",(function(){c.Oc(e);const i=c.Lc(72);return!t.isCreateDisabled&&t.openModal(i)}))("onAvailableName",(function(e){return t.availabilityChanged(e)})),c.Wb(),c.Wb(),c.Xb(21,"div",14),c.Wc(22,ib,3,1,"button",15),c.Wc(23,nb,2,0,"button",16),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(24,"div",5),c.Xb(25,"div",17),c.Xb(26,"div",18),c.Xb(27,"input",19),c.jc("ngModelChange",(function(){return t.updateSettingsDebounce()}))("ngModelChange",(function(e){return t.subdomain.automaticJoinOnWorkspace=e})),c.Wb(),c.Xb(28,"label",20),c.Yc(29," Users can join without an invite "),c.Wb(),c.Wb(),c.Xb(30,"div",21),c.Yc(31," When enabled, anyone can join your workspace by signing up with email and password, SSO, or both. "),c.Wb(),c.Wb(),c.Wb(),c.Sb(32,"hr",22),c.Xb(33,"div",5),c.Xb(34,"div",17),c.Xb(35,"div",7),c.Yc(36,"Log-in setup"),c.Wb(),c.Xb(37,"div",21),c.Yc(38," Force everyone to log in with SSO credentials by disable loging in with email and password. "),c.Wb(),c.Wb(),c.Xb(39,"div",17),c.Xb(40,"div",23),c.Xb(41,"input",24),c.jc("ngModelChange",(function(e){return t.updateLoginData(e,t.authType.NATIVE_LOGIN)}))("ngModelChange",(function(e){return t.logins[t.authType.NATIVE_LOGIN]=e})),c.Wb(),c.Xb(42,"label",25),c.Yc(43,"Log in with email and password"),c.Wb(),c.Wb(),c.Xb(44,"div",23),c.Xb(45,"input",26),c.jc("ngModelChange",(function(e){return t.updateLoginData(e,t.authType.LDAP)}))("ngModelChange",(function(e){return t.logins[t.authType.LDAP]=e})),c.Wb(),c.Xb(46,"label",27),c.Yc(47,"Log in with LDAP"),c.Wb(),c.Wb(),c.Xb(48,"div",23),c.Xb(49,"input",28),c.jc("ngModelChange",(function(e){return t.updateLoginData(e,t.authType.OAUTH2)}))("ngModelChange",(function(e){return t.logins[t.authType.OAUTH2]=e})),c.Wb(),c.Xb(50,"label",29),c.Yc(51,"Log in with OAuth"),c.Wb(),c.Wb(),c.Xb(52,"div",23),c.Xb(53,"input",30),c.jc("ngModelChange",(function(e){return t.updateLoginData(e,t.authType.SAML2)}))("ngModelChange",(function(e){return t.logins[t.authType.SAML2]=e})),c.Wb(),c.Xb(54,"label",31),c.Yc(55,"Log in with SAML2"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(56,"hr",22),c.Xb(57,"div",5),c.Xb(58,"div",17),c.Xb(59,"div",7),c.Yc(60,"Logo"),c.Wb(),c.Xb(61,"div",21),c.Yc(62," Appears on \u201cLog in with SSO\u201d button. Formats: png, jpg, gif. Max size: 1 MB. "),c.Wb(),c.Wb(),c.Xb(63,"div",17),c.Xb(64,"div",32),c.Wc(65,sb,2,1,"div",33),c.Xb(66,"div",34),c.Xb(67,"form",35),c.Xb(68,"btn-upload-file",36),c.jc("onUploaded",(function(e){return t.setLogo(e)})),c.Wb(),c.Wb(),c.Wc(69,cb,2,0,"a",37),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(70,lb,5,3,"ng-container",38),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(71,bb,5,4,"ng-template",null,39,c.Xc),c.Wc(73,ub,2,2,"ng-template",null,40,c.Xc),c.Wc(75,db,3,2,"ng-template",null,41,c.Xc),c.Wc(77,pb,1,1,"ng-template",null,42,c.Xc),c.Wc(79,hb,2,1,"ng-template",null,43,c.Xc)}2&e&&(c.wc("ngIf",!1===t.isOwner),c.Cb(1),c.wc("ngIf",!t.hasCustomSubdomainFeature),c.Cb(2),c.wc("ngIf",!t.isOwner||!t.hasCustomSubdomainFeature),c.Cb(4),c.wc("ngIf",!1===t.userHasPassword),c.Cb(7),c.wc("ngIf",t.subdomain.id),c.Cb(6),c.wc("disable",t.creatingInprogress||(null==t.subdomain?null:t.subdomain.id)||!t.userHasPassword)("name",t.subdomain.domainName),c.Cb(2),c.wc("ngIf",!t.subdomain.id),c.Cb(1),c.wc("ngIf",t.subdomain.id&&!t.isSubdomain),c.Cb(4),c.wc("disabled",!t.subdomain.id||!t.isSubdomain)("ngModel",t.subdomain.automaticJoinOnWorkspace),c.Cb(14),c.wc("ngModel",t.logins[t.authType.NATIVE_LOGIN])("disabled",!t.subdomain.id||!t.isSubdomain),c.Cb(4),c.wc("ngModel",t.logins[t.authType.LDAP])("disabled",!t.configurations[t.authType.LDAP]||!t.isSubdomain),c.Cb(4),c.wc("ngModel",t.logins[t.authType.OAUTH2])("disabled",!t.configurations[t.authType.OAUTH2]||!t.isSubdomain),c.Cb(4),c.wc("ngModel",t.logins[t.authType.SAML2])("disabled",!t.configurations[t.authType.SAML2]||!t.isSubdomain),c.Cb(12),c.wc("ngIf",null==t.subdomain?null:t.subdomain.logoURL),c.Cb(3),c.wc("disabled",!t.subdomain.id||!t.isSubdomain)("btnClasses","cl-btn-outline-light cl-btn-primary cl-color-gray"),c.Cb(1),c.wc("ngIf",t.hasImage),c.Cb(1),c.wc("ngIf",t.subdomain.id&&t.isSubdomain))},directives:[s.u,Ta,p.a,p.s,p.v,p.I,p.t,p.u,br,fr.a,W.f,Si.a,Ii.a,Oi.a,s.t,Al,Ui.a,wl.a,Pl,yl.a,Gl,zl],encapsulation:2,changeDetection:0}),e})();var gb=i("wxL3");function fb(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"label",1),c.Yc(2),c.Wb(),c.Xb(3,"input",2,3),c.jc("change",(function(){return c.Oc(e),c.nc().uploadFile()})),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(1),c.xc("for",e.uid),c.wc("ngClass",e.btnClasses),c.Cb(1),c.ad(" ",e.text,"\n"),c.Cb(1),c.xc("id",e.uid),c.xc("name",e.uid),c.wc("disabled",e.inProgress||e.disabled)("accept",e.accept)}}let vb=(()=>{class e extends br{constructor(e,t,i){super(e,t,i),this.fileService=e,this.toaster=t,this.cd=i,this.text="Upload Csv file",this.accept=ar.CSV,this.onUploadedCsv=new c.n,this.FileType=ar}sendRequest(e,t,i){this.inProgress=!0,this.onUploadStart.emit(),this.fileService.uploadCsvFile(e,this.workspaceId,i).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.onUploadedCsv.emit(e),this.inProgress=!1},this.errorCallback.bind(this))}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(rt),c.Rb(M.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["btn-upload-csv"]],inputs:{workspaceId:"workspaceId",text:"text",accept:"accept"},outputs:{onUploadedCsv:"onUploadedCsv"},features:[c.zb],decls:1,vars:1,consts:[[4,"ngIf"],[1,"cl-btn","pointer","cl-mb-0",3,"ngClass","for"],["type","file","tabindex","0",1,"pointer",2,"width","0","overflow","hidden",3,"id","disabled","name","accept","change"],["fileInput",""]],template:function(e,t){1&e&&c.Wc(0,fb,5,7,"ng-container",0),2&e&&c.wc("ngIf",t.isVisible)},directives:[s.u,s.r],encapsulation:2}),e})();function wb(e,t){if(1&e&&(c.Xb(0,"div",2),c.Yc(1," Projects "),c.Xb(2,"h1"),c.Yc(3),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(3),c.Zc(e.uploadedCsv.importedProjects)}}function yb(e,t){if(1&e&&(c.Xb(0,"div",2),c.Yc(1," Tasks "),c.Xb(2,"h1"),c.Yc(3),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(3),c.Zc(e.uploadedCsv.importedTasks)}}function Wb(e,t){if(1&e&&(c.Xb(0,"div",2),c.Xb(1,"span",3),c.Yc(2),c.Wb(),c.Xb(3,"h1"),c.Yc(4),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.ad(" ",e.projectGroupingLabel||"Clients"," "),c.Cb(2),c.Zc(e.uploadedCsv.importedClients)}}function Cb(e,t){if(1&e&&(c.Xb(0,"div",2),c.Yc(1," Tags "),c.Xb(2,"h1"),c.Yc(3),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(3),c.Zc(e.uploadedCsv.importedTags)}}function kb(e,t){if(1&e&&(c.Xb(0,"div",2),c.Yc(1," Time entries "),c.Xb(2,"h1"),c.Yc(3),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Hb("cl-opacity-5",!e.hasImportFileFeature),c.Cb(3),c.Zc(e.uploadedCsv.importedTimeEntries)}}let Sb=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["csv-table"],["","csv-table",""]],inputs:{uploadedCsv:"uploadedCsv",projectGroupingLabel:"projectGroupingLabel",hasImportFileFeature:"hasImportFileFeature"},decls:5,vars:5,consts:[["class","cl-border cl-p-2 cl-pr-4 cl-d-flex cl-flex-column",4,"ngIf"],["class","cl-border cl-p-2 cl-pr-4 cl-d-flex cl-flex-column",3,"cl-opacity-5",4,"ngIf"],[1,"cl-border","cl-p-2","cl-pr-4","cl-d-flex","cl-flex-column"],[1,"cl-text-capitalize"]],template:function(e,t){1&e&&(c.Wc(0,wb,4,1,"div",0),c.Wc(1,yb,4,1,"div",0),c.Wc(2,Wb,5,2,"div",0),c.Wc(3,Cb,4,1,"div",0),c.Wc(4,kb,4,3,"div",1)),2&e&&(c.wc("ngIf",t.uploadedCsv.importedProjects||0==t.uploadedCsv.importedProjects),c.Cb(1),c.wc("ngIf",t.uploadedCsv.importedTasks||0==t.uploadedCsv.importedTasks),c.Cb(1),c.wc("ngIf",t.uploadedCsv.importedClients||0==t.uploadedCsv.importedClients),c.Cb(1),c.wc("ngIf",t.uploadedCsv.importedTags||0==t.uploadedCsv.importedTags),c.Cb(1),c.wc("ngIf",t.uploadedCsv.importedTimeEntries||0==t.uploadedCsv.importedTimeEntries))},directives:[s.u],encapsulation:2}),e})();function Ib(e,t){1&e&&(c.Xb(0,"span"),c.Yc(1,"and once they accept the invite, you can import time for them."),c.Wb())}function Ob(e,t){1&e&&(c.Xb(0,"span"),c.Yc(1,"and once he accept the invite, you can import time for him."),c.Wb())}function Xb(e,t){if(1&e&&(c.Xb(0,"div"),c.Yc(1),c.Wb()),2&e){const e=t.$implicit;c.Cb(1),c.Zc(e)}}function Eb(e,t){if(1&e&&(c.Xb(0,"div",12),c.Wc(1,Xb,2,1,"div",13),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngForOf",e.missingUsers)}}let Tb=(()=>{class e{constructor(e,t,i){this.router=e,this.modalService=t,this.teamsDataService=i,this.close=new c.n,this.confirmed=new c.n}ngOnInit(){this.missingUserLabel=this.missingUsers.length>1?"users":"user"}inviteUsers(){this.teamsDataService.missingUsers=this.missingUsers.splice(0),this.modalService.dismissAll(),this.router.navigate(["/teams"])}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.c),c.Rb(g.q),c.Rb(r))},e.\u0275cmp=c.Lb({type:e,selectors:[["missing-users-modal"]],inputs:{missingUsers:"missingUsers"},outputs:{close:"close",confirmed:"confirmed"},decls:25,vars:10,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-text-dark","cl-mb-2"],[3,"click"],[4,"ngIf"],[1,"cl-mb-2","cl-d-inline-block",3,"click"],["class","cl-scroll-area cl-ml-2","style","max-height: 100px; overflow-y: auto;",4,"ngIf"],[1,"cl-modal-footer"],["ngbAutofocus","","type","button",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-scroll-area","cl-ml-2",2,"max-height","100px","overflow-y","auto"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.close.emit()})),c.Xb(4,"span"),c.Sb(5,"img",3),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",4),c.Xb(7,"p",5),c.Yc(8," Time for "),c.Xb(9,"strong"),c.Yc(10),c.Wb(),c.Yc(11),c.Xb(12,"a",6),c.jc("click",(function(){return t.inviteUsers()})),c.Yc(13),c.Wb(),c.Yc(14,", "),c.Wc(15,Ib,2,0,"span",7),c.Wc(16,Ob,2,0,"span",7),c.Wb(),c.Xb(17,"a",8),c.jc("click",(function(){return t.expandedMissingUsers=!t.expandedMissingUsers})),c.Yc(18),c.Wb(),c.Wc(19,Eb,2,1,"div",9),c.Wb(),c.Xb(20,"div",10),c.Xb(21,"a",6),c.jc("click",(function(){return t.close.emit()})),c.Yc(22,"Cancel"),c.Wb(),c.Xb(23,"button",11),c.jc("click",(function(){return t.confirmed.emit()})),c.Yc(24," Import time only for existing users"),c.Wb(),c.Wb()),2&e&&(c.Cb(2),c.ad("Missing ",t.missingUserLabel,""),c.Cb(8),c.Zc(t.missingUsers.length),c.Cb(1),c.bd(" ",t.missingUserLabel," won't be imported because ",t.missingUsers.length>1?"they":"he"," don't exist in your workspace. "),c.Cb(2),c.ad("Invite missing ",t.missingUserLabel,""),c.Cb(2),c.wc("ngIf",t.missingUsers.length>1),c.Cb(1),c.wc("ngIf",t.missingUsers.length<=1),c.Cb(2),c.bd(" ",t.expandedMissingUsers?"Hide":"See"," missing ",t.missingUserLabel," "),c.Cb(1),c.wc("ngIf",t.expandedMissingUsers))},directives:[s.u,s.t],encapsulation:2}),e})();const Db=["missingUserModal"];function Rb(e,t){1&e&&(c.Xb(0,"div",20),c.Yc(1," Import finished successfully "),c.Wb())}function Ab(e,t){1&e&&c.Sb(0,"img",21)}function jb(e,t){if(1&e){const e=c.Yb();c.Xb(0,"btn-upload-csv",22),c.jc("onUploadedCsv",(function(t){return c.Oc(e),c.nc().onUploadCsv(t)}))("onUploadStart",(function(){return c.Oc(e),c.nc().onUploadStart()}))("onError",(function(t){return c.Oc(e),c.nc().onUploadError(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("maxMB",e.CsvMaxMbLimit)("workspaceId",e.workspaceId)}}function xb(e,t){if(1&e&&(c.Xb(0,"div",23),c.Xb(1,"span",24),c.Yc(2),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.Zc(e.errorMessage)}}function Pb(e,t){if(1&e&&(c.Xb(0,"div",32),c.Yc(1),c.Xb(2,"a",33),c.Yc(3,"Learn more"),c.Wb(),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(1),c.ad(" ",e.value," ")}}function Mb(e,t){if(1&e&&(c.Vb(0),c.Wc(1,Pb,4,1,"div",31),c.Ub()),2&e){const e=t.$implicit,i=c.nc(2);c.Cb(1),c.wc("ngIf",!("TIME_ENTRY_MISSING_FIELD"===e.key&&!i.hasImportFileFeature))}}function Yb(e,t){1&e&&(c.Xb(0,"div",34),c.Xb(1,"div",35),c.Xb(2,"a",36),c.Yc(3,"UPGRADE"),c.Wb(),c.Yc(4," to import time entries "),c.Wb(),c.Wb())}function Lb(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",1),c.Wc(2,Mb,2,1,"ng-container",25),c.oc(3,"keyvalue"),c.Xb(4,"div",26),c.Xb(5,"strong"),c.Yc(6),c.Wb(),c.Wb(),c.Sb(7,"div",27),c.Wc(8,Yb,5,0,"div",28),c.Xb(9,"button",29),c.jc("click",(function(){return c.Oc(e),c.nc().validateMissingUsersAndFinishImport()})),c.Yc(10," Start import "),c.Wb(),c.Xb(11,"a",30),c.jc("click",(function(){return c.Oc(e),c.nc().discardCsv()})),c.Yc(12,"Cancel"),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.wc("ngForOf",c.pc(3,7,e.uploadedCsv.importWarnings)),c.Cb(4),c.Zc(e.uploadedCsv.name),c.Cb(1),c.wc("uploadedCsv",e.uploadedCsv)("projectGroupingLabel",e.projectGroupingLabel)("hasImportFileFeature",e.hasImportFileFeature),c.Cb(1),c.wc("ngIf",!e.hasImportFileFeature&&e.uploadedCsv.importedTimeEntries),c.Cb(1),c.wc("disabled",e.inProgress||e.inProgressValidation)}}function Fb(e,t){if(1&e){const e=c.Yb();c.Xb(0,"missing-users-modal",37),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit,n=c.nc();return i.close(),n.finishImport()}))("close",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("missingUsers",e.missingUsers)}}let Nb=(()=>{class e{constructor(e,t,i,n){this.cd=e,this.loader=t,this.modalService=i,this.fileService=n,this.CsvMaxMbLimit=ei.a,this.unsubscribe$=new Ee.a}ngOnInit(){}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}onUploadStart(){this.loader.show(),this.setSuccessBannerVisibility(!1)}onUploadCsv(e){this.clearErrors(),this.uploadedCsv=e,this.loader.hide(),this.cd.markForCheck()}onUploadError(e){var t;this.errorMessage=null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message,this.loader.hide()}validateMissingUsersAndFinishImport(){this.hasImportFileFeature?(this.loader.show("Validating data..."),this.fileService.checkMissingUsers(this.uploadedCsv.id,this.workspaceId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.inProgressValidation=!1,this.loader.hide(),this.missingUsers=e,this.missingUsers.length?this.openModal(this.missingUserModal):this.finishImport()},e=>{this.inProgressValidation=!1,this.loader.hide(),this.cd.markForCheck()})):this.finishImport()}finishImport(){this.loader.show("Importing data..."),this.inProgress=!0,this.fileService.importCsv(this.uploadedCsv.id,this.workspaceId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.uploadedCsv=null,this.clearErrors(),this.inProgress=!1,this.loader.hide(),this.setSuccessBannerVisibility(!0),this.cd.markForCheck()},e=>{this.inProgress=!1,this.loader.hide(),this.cd.markForCheck()})}discardCsv(){this.uploadedCsv=null,this.clearErrors()}clearErrors(){this.errorMessage="",this.missingUsers=null}openModal(e){this.modalService.open(e,{centered:!0})}setSuccessBannerVisibility(e){this.isSuccessBannerVisible=e}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.h),c.Rb(wi.a),c.Rb(g.q),c.Rb(rt))},e.\u0275cmp=c.Lb({type:e,selectors:[["import-csv-tab"]],viewQuery:function(e,t){var i;1&e&&c.ed(Db,!0),2&e&&c.Kc(i=c.kc())&&(t.missingUserModal=i.first)},inputs:{workspaceId:"workspaceId",hasImportFileFeature:"hasImportFileFeature",projectGroupingLabel:"projectGroupingLabel"},decls:33,vars:9,consts:[[1,"cl-row"],[1,"cl-col-lg-custom-12"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12","cl-relative"],[1,"cl-h2","cl-mb-0"],[1,"cl-text-gray-9","cl-pr-4","cl-pr-lg-custom-0"],["href","https://clockify.me/help/projects/import-projects","target","_blank"],[1,"cl-mt-0"],["class","cl-col-lg-6 cl-alert cl-alert-success",4,"ngIf"],[1,"cl-col-lg-custom-3"],[1,"cl-nav","cl-nav-tabs","cl-custom-tabs-minimal","cl-mb-3"],[1,"cl-nav-item","cl-flex-grow-1"],[1,"cl-nav-link","cl-pl-0","cl-text-left"],[1,"cl-h5","cl-mb-0"],["src","/assets/images/ui-icons/checkmark-green.svg","class","cl-ml-2",4,"ngIf"],[1,"cl-lowercase"],["class","cl-mr-3",3,"maxMB","workspaceId","onUploadedCsv","onUploadStart","onError",4,"ngIf"],["class","cl-mt-1",4,"ngIf"],["class","cl-row",4,"ngIf"],["missingUserModal",""],[1,"cl-col-lg-6","cl-alert","cl-alert-success"],["src","/assets/images/ui-icons/checkmark-green.svg",1,"cl-ml-2"],[1,"cl-mr-3",3,"maxMB","workspaceId","onUploadedCsv","onUploadStart","onError"],[1,"cl-mt-1"],[1,"cl-invalid-feedback","cl-d-inline-block"],[4,"ngFor","ngForOf"],[1,"cl-mb-2"],["csv-table","",1,"cl-d-flex","cl-mb-3","cl-borders-table",3,"uploadedCsv","projectGroupingLabel","hasImportFileFeature"],["class","cl-col-lg-custom-12 cl-px-0",4,"ngIf"],[1,"cl-btn","cl-btn-primary","cl-mr-3",3,"disabled","click"],[3,"click"],["class","cl-col-lg-6 cl-alert cl-alert-warning",4,"ngIf"],[1,"cl-col-lg-6","cl-alert","cl-alert-warning"],["href","https://clockify.me/help/extra-features/import-timesheets","target","_blank",1,"cl-btn"],[1,"cl-col-lg-custom-12","cl-px-0"],[1,"cl-mb-3","cl-col-lg-6","cl-alert","cl-alert-warning"],["routerLink","/upgrade",1,"cl-btn","cl-ml-0"],[3,"missingUsers","confirmed","close"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Yc(5,"Import data"),c.Wb(),c.Xb(6,"div",5),c.Yc(7," Import multiple projects, clients, tasks, tags, and time entries from a file. Please prepare your CSV files in the "),c.Xb(8,"a",6),c.Yc(9,"correct format."),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(10,"hr",7),c.Wc(11,Rb,2,0,"div",8),c.Xb(12,"div",0),c.Xb(13,"div",9),c.Xb(14,"ul",10),c.Xb(15,"li",11),c.Xb(16,"span",12),c.Xb(17,"div",13),c.Yc(18,"step 1 "),c.Wc(19,Ab,1,0,"img",14),c.Wb(),c.Xb(20,"div",15),c.Yc(21,"Upload file for analysis"),c.Wb(),c.Wb(),c.Wb(),c.Xb(22,"li",11),c.Xb(23,"span",12),c.Xb(24,"div",13),c.Yc(25,"step 2"),c.Wb(),c.Xb(26,"div",15),c.Yc(27,"Review data and import"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(28,jb,1,2,"btn-upload-csv",16),c.Wc(29,xb,3,1,"div",17),c.Wc(30,Lb,13,9,"div",18),c.Wb(),c.Wb(),c.Wc(31,Fb,1,1,"ng-template",null,19,c.Xc)),2&e&&(c.Cb(11),c.wc("ngIf",t.isSuccessBannerVisible),c.Cb(5),c.Hb("cl-active",!t.uploadedCsv),c.Cb(3),c.wc("ngIf",t.uploadedCsv),c.Cb(4),c.Hb("cl-active",t.uploadedCsv),c.Cb(5),c.wc("ngIf",!t.uploadedCsv),c.Cb(1),c.wc("ngIf",t.errorMessage),c.Cb(1),c.wc("ngIf",t.uploadedCsv))},directives:[s.u,vb,s.t,Sb,W.f,Tb],pipes:[s.m],encapsulation:2,changeDetection:0}),e})();const Ub=["tabs"];function $b(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"li",8),c.Xb(2,"a",9),c.jc("click",(function(){return c.Oc(e),c.nc(2).activatePill("ACCOUNTS")})),c.Yc(3," Accounts "),c.Wb(),c.Wb(),c.Xb(4,"li",8),c.Xb(5,"a",9),c.jc("click",(function(){return c.Oc(e),c.nc(2).activatePill("AUTH")})),c.Yc(6," Authentication "),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=c.nc(2);c.Cb(2),c.Hb("cl-active",e.pills.ACCOUNTS),c.Cb(3),c.Hb("cl-active",e.pills.AUTH)}}function _b(e,t){if(1&e&&c.Sb(0,"settings-tab",19),2&e){const e=c.nc(2);c.wc("hasHistoricRateFeature",e.hasHistoricRateFeature)("workspace",e.workspace)}}function Gb(e,t){if(1&e&&c.Sb(0,"permissions-tab",20),2&e){const e=c.nc(2);c.wc("workspace",e.workspace)}}function Bb(e,t){if(1&e&&c.Sb(0,"alerts",21),2&e){const e=c.nc(2);c.wc("hasAlertsFeature",e.hasAlertsFeature)("workspaceId",e.workspaceId)}}function Vb(e,t){if(1&e&&c.Sb(0,"accounts-tab",24),2&e){const e=c.nc(3);c.wc("hasControlAccountFeature",e.hasControlAccountFeature)("isOwner",e.isOwner)}}function Hb(e,t){if(1&e&&c.Sb(0,"auth-tab",25),2&e){const e=c.nc(3);c.wc("hasCustomSubdomainFeature",e.hasCustomSubdomainFeature)("isOwner",e.isOwner)}}function zb(e,t){if(1&e&&(c.Vb(0),c.Wc(1,Vb,1,2,"accounts-tab",22),c.Wc(2,Hb,1,2,"auth-tab",23),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngIf",e.pills.ACCOUNTS),c.Cb(1),c.wc("ngIf",e.pills.AUTH)}}function qb(e,t){if(1&e&&c.Sb(0,"custom-field-card",26),2&e){const e=c.nc(2);c.wc("hasCustomFieldsFeature",e.hasCustomFieldsFeature)}}function Kb(e,t){if(1&e&&c.Sb(0,"import-csv-tab",27),2&e){const e=c.nc(2);c.wc("projectGroupingLabel",e.projectGroupingLabel)("workspaceId",e.workspaceId)("hasImportFileFeature",e.hasImportFileFeature)}}function Zb(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",5),c.Xb(2,"ul",6,7),c.Xb(4,"li",8),c.Xb(5,"a",9),c.jc("click",(function(){return c.Oc(e),c.nc().activatePill("SETTINGS")})),c.Yc(6," General "),c.Wb(),c.Wb(),c.Xb(7,"li",8),c.Xb(8,"a",9),c.jc("click",(function(){return c.Oc(e),c.nc().activatePill("PERMISSIONS")})),c.Yc(9," Permissions "),c.Wb(),c.Wb(),c.Xb(10,"li",8),c.Xb(11,"a",9),c.jc("click",(function(){return c.Oc(e),c.nc().activatePill("ALERTS")})),c.Yc(12," Alerts "),c.Wb(),c.Wb(),c.Wc(13,$b,7,4,"ng-container",4),c.Xb(14,"li",8),c.Xb(15,"a",9),c.jc("click",(function(){return c.Oc(e),c.nc().activatePill("CUSTOM_FIELDS")})),c.Yc(16," Custom fields "),c.Wb(),c.Wb(),c.Xb(17,"li",8),c.Xb(18,"a",9),c.jc("click",(function(){return c.Oc(e),c.nc().activatePill("IMPORT")})),c.Yc(19," Import "),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(20,"div",10),c.Xb(21,"div",11),c.Xb(22,"div",12),c.Xb(23,"div",13),c.Wc(24,_b,1,2,"settings-tab",14),c.Wc(25,Gb,1,1,"permissions-tab",15),c.Wc(26,Bb,1,2,"alerts",16),c.Wc(27,zb,3,2,"ng-container",4),c.Wc(28,qb,1,1,"custom-field-card",17),c.Wc(29,Kb,1,3,"import-csv-tab",18),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(5),c.Hb("cl-active",e.pills.SETTINGS),c.Cb(3),c.Hb("cl-active",e.pills.PERMISSIONS),c.Cb(3),c.Hb("cl-active",e.pills.ALERTS),c.Cb(2),c.wc("ngIf",!e.isSelfHosted),c.Cb(2),c.Hb("cl-active",e.pills.CUSTOM_FIELDS),c.Cb(3),c.Hb("cl-active",e.pills.IMPORT),c.Cb(6),c.wc("ngIf",e.pills.SETTINGS),c.Cb(1),c.wc("ngIf",e.pills.PERMISSIONS),c.Cb(1),c.wc("ngIf",e.pills.ALERTS),c.Cb(1),c.wc("ngIf",!e.isSelfHosted),c.Cb(1),c.wc("ngIf",e.pills.CUSTOM_FIELDS),c.Cb(1),c.wc("ngIf",e.pills.IMPORT)}}let Qb=(()=>{class e{constructor(e,t,i,n,s){this.workspaceService=e,this.userService=t,this.activatedRoute=i,this.router=n,this.authService=s,this.projectGroupingLabel="",this.isSelfHosted=tr.a.environment.selfHosted,this.unsubscribe$=new mi.a}ngOnInit(){this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(({isOwner:e})=>this.isOwner=e),this.activatedRoute.params.pipe(Object(Y.a)(e=>e.workspaceId)).subscribe(e=>{this.workspaceId=e,this.workspaceService.getDefaultWorkspaceId()===e?this.subscribeToDefaultWorkspace():this.getWorkspaceById(e)}),this.activatedRoute.fragment.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{const t=ir[(e||"").toUpperCase()];this.pills={[t||ir.SETTINGS]:!0},t||this.router.navigate([])})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}activatePill(e){this.pills={[e]:!0},e===ir.SETTINGS?this.router.navigate([]):this.router.navigate([],{fragment:e.toString().toLowerCase()})}getWorkspaceById(e){this.workspaceService.getWorkspaceById(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.setWorkspace(e)})}subscribeToDefaultWorkspace(){this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.setWorkspace(e)})}setWorkspace(e){this.workspace=e,this.projectGroupingLabel=Object(Pt.l)(e.projectGroupingLabel),this.hasImportFileFeature=e.hasFeature(nr.a.FILE_IMPORT),this.hasHistoricRateFeature=e.hasFeature(nr.a.HISTORIC_RATES),this.hasAlertsFeature=e.hasFeature(nr.a.ALERTS),this.hasControlAccountFeature=e.hasFeature(nr.a.ADMIN_PANEL),this.hasCustomSubdomainFeature=e.hasFeature(nr.a.CUSTOM_SUBDOMAIN),this.hasCustomFieldsFeature=e.hasFeature(nr.a.CUSTOM_FIELDS)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(ys.a),c.Rb(W.a),c.Rb(W.c),c.Rb(Ce.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["workspace-settings"]],viewQuery:function(e,t){var i;1&e&&c.ed(Ub,!0),2&e&&c.Kc(i=c.kc())&&(t.tabs=i.first)},decls:6,vars:1,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-h1"],[4,"ngIf"],[1,"cl-scroll-tabs-wrapper"],["tabs","",1,"cl-nav","cl-nav-tabs","cl-m-0","cl-scroll-tabs"],["tabs","tabs"],[1,"cl-nav-item"],[1,"cl-nav-link",3,"click"],[1,"cl-card"],[1,"cl-card-body"],[1,"cl-tab-content"],[1,"cl-tab-pane","cl-fade","cl-active","cl-show"],[3,"hasHistoricRateFeature","workspace",4,"ngIf"],[3,"workspace",4,"ngIf"],[3,"hasAlertsFeature","workspaceId",4,"ngIf"],[3,"hasCustomFieldsFeature",4,"ngIf"],[3,"projectGroupingLabel","workspaceId","hasImportFileFeature",4,"ngIf"],[3,"hasHistoricRateFeature","workspace"],[3,"workspace"],[3,"hasAlertsFeature","workspaceId"],[3,"hasControlAccountFeature","isOwner",4,"ngIf"],[3,"hasCustomSubdomainFeature","isOwner",4,"ngIf"],[3,"hasControlAccountFeature","isOwner"],[3,"hasCustomSubdomainFeature","isOwner"],[3,"hasCustomFieldsFeature"],[3,"projectGroupingLabel","workspaceId","hasImportFileFeature"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"h1",3),c.Yc(4,"Workspace settings"),c.Wb(),c.Wb(),c.Wc(5,Zb,30,17,"ng-container",4),c.Wb(),c.Wb()),2&e&&(c.Cb(5),c.wc("ngIf",t.workspace))},directives:[s.u,er.a,_r,wo,jo,aa,mb,gb.a,Nb],encapsulation:2}),e})();var Jb=i("LRne"),eu=i("JIr8"),tu=i("VRyK");function iu(...e){return t=>t.lift.call(Object(tu.a)(t,...e))}let nu=(()=>{class e{constructor(e,t){this.router=e,this.authService=t}canActivate(){return this.checkIsAdmin()}checkIsAdmin(){let e;const t=this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(Yt.a)(1));t.subscribe(()=>e=!0);const i=t.pipe(iu(this.authService.permissionFailed$),Object(Yt.a)(1));return e||this.authService.getPermissionsForUser(),i.pipe(Object(Y.a)(e=>{const t=null==e?void 0:e.isAdminOrOwner;return t||this.router.navigate(["/tracker"]),t}))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(W.c),c.fc(Ce.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})(),su=(()=>{class e{constructor(e,t,i,n){this.authService=e,this.router=t,this.adminGuard=i,this.workspaceService=n}canActivate(e){const t=this.workspaceService.getDefaultWorkspaceId()||this.authService.getUserDefaultWorkspaceId(),i=e.url[1].path;return t!==i?this.authService.isUserAdminOnWorkspace(i).pipe(Object(Y.a)(e=>{const t=null==e?void 0:e.isAdminOrOwner;return t||this.router.navigate(["/tracker"]),t}),Object(eu.a)(()=>(this.router.navigate(["/tracker"]),Object(Jb.a)(!1)))):this.adminGuard.checkIsAdmin()}}return e.\u0275fac=function(t){return new(t||e)(c.fc(Ce.a),c.fc(W.c),c.fc(nu),c.fc(U.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var cu=i("Jzhb");function ru(e,t){1&e&&(c.Xb(0,"label"),c.Yc(1,"Type your password to confirm"),c.Wb())}function ou(e,t){1&e&&(c.Xb(0,"label"),c.Yc(1,"Type DELETE to confirm"),c.Wb())}let au=(()=>{class e{constructor(e,t,i){this.authService=e,this.userService=t,this.formBuilder=i,this.unsubscribe$=new mi.a,this.onSuccess=new c.n,this.onUserConfirmed=new c.n}ngOnInit(){this.profile=this.authService.getUser(),this.authService.canChangePassword.subscribe(e=>{this.hasPassword=e}),this.authService.canChange(),this.form=this.formBuilder.group({password:["",[p.G.required,p.G.minLength(ei.s)]],inProgress:[!1,[on.a.requiredFalse]]})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}get password(){return this.form.get("password")}close(){this.onSuccess.emit(!0)}confirm(){this.setInProgress(!0),this.hasPassword?this.authService.confirmPassword(this.profile.email,this.password.value).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.setInProgress(!1),this.onUserConfirmed.emit(!0),this.close()},()=>{this.setInProgress(!1)}):"delete"===this.password.value.trim().toLowerCase()&&(this.setInProgress(!1),this.onUserConfirmed.emit(!0),this.close())}setInProgress(e){this.form.patchValue({inProgress:e})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Ce.a),c.Rb(ys.a),c.Rb(p.f))},e.\u0275cmp=c.Lb({type:e,selectors:[["delete-confirm"]],outputs:{onSuccess:"onSuccess",onUserConfirmed:"onUserConfirmed"},decls:22,vars:5,consts:[[3,"formGroup","ngSubmit"],[1,"cl-modal-body","cl-text-center","cl-pt-4","cl-pb-3"],[1,"cl-mb-3"],["src","assets/images/illustrations/delete-workspace.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-text-gray-6","cl-mb-2"],[1,"cl-text-gray-6","cl-mb-0"],[1,"cl-my-3"],[1,"cl-form-group","cl-text-left","cl-mb-0"],[4,"ngIf"],["formControlName","password","autofocus","",1,"cl-form-control",3,"type"],[1,"cl-modal-footer"],[3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"]],template:function(e,t){1&e&&(c.Xb(0,"form",0),c.jc("ngSubmit",(function(){return t.confirm()})),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Sb(3,"img",3),c.Wb(),c.Xb(4,"div",4),c.Yc(5,"Delete account"),c.Wb(),c.Xb(6,"p",5),c.Yc(7,"Your account and all your workspaces will be deleted forever."),c.Wb(),c.Xb(8,"p",5),c.Yc(9,"Time you've tracked in someone else's workspace won't be deleted."),c.Wb(),c.Xb(10,"p",6),c.Yc(11,"Back up your data by exporting CSV in Detailed report."),c.Wb(),c.Sb(12,"hr",7),c.Xb(13,"div",8),c.Wc(14,ru,2,0,"label",9),c.Wc(15,ou,2,0,"label",9),c.Sb(16,"input",10),c.Wb(),c.Wb(),c.Xb(17,"div",11),c.Xb(18,"a",12),c.jc("click",(function(){return t.close()})),c.Yc(19,"Cancel"),c.Wb(),c.Xb(20,"button",13),c.Yc(21,"Continue"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.wc("formGroup",t.form),c.Cb(14),c.wc("ngIf",t.hasPassword),c.Cb(1),c.wc("ngIf",!t.hasPassword),c.Cb(1),c.wc("type",t.hasPassword?"password":"text"),c.Cb(4),c.wc("disabled",t.form.invalid))},directives:[p.I,p.t,p.k,s.u,p.c,p.s,p.i],encapsulation:2}),e})();function lu(e,t){if(1&e&&(c.Xb(0,"button",15),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.Zc(e.reason)}}function bu(e,t){1&e&&(c.Xb(0,"button",15),c.Yc(1,"Select reason "),c.Wb())}function uu(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",19),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc(2).selectReason(i)})),c.Yc(1),c.Wb()}if(2&e){const e=t.$implicit;c.Cb(1),c.Zc(e.name)}}function du(e,t){if(1&e&&(c.Xb(0,"div",16),c.Xb(1,"div",17),c.Wc(2,uu,2,1,"a",18),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.wc("ngForOf",e.deleteReasons)}}function pu(e,t){if(1&e&&(c.Xb(0,"div",6),c.Xb(1,"div",20),c.Xb(2,"textarea",21),c.Yc(3,"        "),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.Hb("cl-is-invalid",e.isValid("reasonDescription")),c.wc("placeholder",e.placeholder)}}let hu=(()=>{class e{constructor(e,t,i,n){this.router=e,this.userService=t,this.authService=i,this.formBuilder=n,this.deleteReasons=[{name:"Didn't find what I need",placeholder:"I couldn't find how to..."},{name:"Too confusing to use",placeholder:"I just need..."},{name:"Too slow or buggy",placeholder:"I had trouble with..."},{name:"Using another tool",placeholder:"I've decided to use..."},{name:"Other",placeholder:"I'm deleting because..."}],this.unsubscribe$=new mi.a,this.onSuccess=new c.n}ngOnInit(){this.message="",this.profile=this.authService.getUser(),this.form=this.formBuilder.group({reasonDescription:["",[p.G.required,p.G.minLength(2)]]})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}selectReason(e){this.reason=e.name,this.placeholder=e.placeholder}get reasonDescription(){return this.form.get("reasonDescription")}deleteAccount(){this.message=this.reason+" , "+this.reasonDescription.value,this.inProgress=!0,this.userService.deleteUser(this.profile.id,this.message).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.onSuccess.emit(!0),this.close()},()=>{this.inProgress=!1})}isValid(e){const t=this.form.get(e);return!!t&&t.dirty&&t.touched&&!!t.errors}close(){this.onSuccess.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.c),c.Rb(ys.a),c.Rb(Ce.a),c.Rb(p.f))},e.\u0275cmp=c.Lb({type:e,selectors:[["delete-form"]],outputs:{onSuccess:"onSuccess"},decls:21,vars:5,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[3,"formGroup","ngSubmit"],[1,"cl-modal-body"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-lg-custom-12"],[1,"cl-text-gray-6"],["dropdownKey","",1,"cl-dropdown"],["class","cl-btn cl-w-100 cl-text-left cl-btn-outline-light cl-dropdown-toggle","dropdownKeyButton","","type","button",4,"ngIf"],["class","cl-dropdown-menu",4,"dropdownKeyContent"],["class","cl-form-row",4,"ngIf"],[1,"cl-modal-footer"],["type","submit",1,"cl-btn","cl-btn-danger",3,"disabled"],["dropdownKeyButton","","type","button",1,"cl-btn","cl-w-100","cl-text-left","cl-btn-outline-light","cl-dropdown-toggle"],[1,"cl-dropdown-menu"],[1,"cl-scroll-area"],["clickCloseDropdown","","class","cl-dropdown-item",3,"click",4,"ngFor","ngForOf"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],[1,"cl-form-group","cl-mb-0","cl-col-lg-custom-12"],["rows","4","name","reason","formControlName","reasonDescription",1,"cl-form-control",3,"placeholder"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2,"Delete account"),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.close()})),c.Xb(4,"span"),c.Sb(5,"img",3),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"form",4),c.jc("ngSubmit",(function(){return t.deleteAccount()})),c.Xb(7,"div",5),c.Xb(8,"div"),c.Xb(9,"div",6),c.Xb(10,"div",7),c.Xb(11,"label",8),c.Yc(12,"I'm deleting my account because:"),c.Wb(),c.Xb(13,"div",9),c.Wc(14,lu,2,1,"button",10),c.Wc(15,bu,2,0,"button",10),c.Wc(16,du,3,1,"div",11),c.Wb(),c.Wb(),c.Wb(),c.Wc(17,pu,4,3,"div",12),c.Wb(),c.Wb(),c.Xb(18,"div",13),c.Xb(19,"button",14),c.Yc(20,"Delete my account"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(6),c.wc("formGroup",t.form),c.Cb(8),c.wc("ngIf",t.reason),c.Cb(1),c.wc("ngIf",!t.reason),c.Cb(2),c.wc("ngIf",t.reason),c.Cb(2),c.wc("disabled",t.form.invalid||t.inProgress))},directives:[p.I,p.t,p.k,Si.a,s.u,Oi.a,Ii.a,s.t,p.c,p.s,p.i],encapsulation:2}),e})();function mu(e,t){1&e&&(c.Xb(0,"div",15),c.Xb(1,"span"),c.Yc(2,"Need help? "),c.Wb(),c.Xb(3,"a",16),c.Yc(4,"Call support "),c.Wb(),c.Xb(5,"span"),c.Yc(6,"or "),c.Wb(),c.Xb(7,"a",17),c.Yc(8,"schedule demo"),c.Wb(),c.Wb())}function gu(e,t){if(1&e&&(c.Xb(0,"div",18),c.Xb(1,"div",19),c.Yc(2,"There are people who rely on your workspaces: "),c.Xb(3,"span",20),c.Yc(4),c.Wb(),c.Yc(5,"."),c.Wb(),c.Xb(6,"div",21),c.Xb(7,"div",22),c.Yc(8,"Before you can delete your account, you have to either:"),c.Wb(),c.Xb(9,"ul",23),c.Xb(10,"li",24),c.Yc(11,"transfer your ownership role to someone else"),c.Wb(),c.Xb(12,"li",24),c.Yc(13,"or delete all team members from workspaces"),c.Wb(),c.Wb(),c.Sb(14,"hr",18),c.Xb(15,"div",25),c.Yc(16,"Once you're done, you can safely delete your account."),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(4),c.Zc(e.workspaces)}}function fu(e,t){if(1&e&&(c.Xb(0,"li"),c.Yc(1),c.Wb()),2&e){const e=t.$implicit;c.Cb(1),c.ad(" ",e," ")}}function vu(e,t){if(1&e&&(c.Xb(0,"div",26),c.Xb(1,"span"),c.Yc(2,"Your account will be deleted from all these workspaces: "),c.Xb(3,"ul",27),c.Wc(4,fu,2,1,"li",28),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(4),c.wc("ngForOf",e.allWorkspaces)}}function wu(e,t){if(1&e){const e=c.Yb();c.Xb(0,"delete-confirm",29),c.jc("onSuccess",(function(){return t.$implicit.close()}))("onUserConfirmed",(function(t){c.Oc(e);const i=c.nc(),n=c.Lc(19);return i.openSecondModal(t,n)})),c.Wb()}}function yu(e,t){1&e&&(c.Xb(0,"delete-form",30),c.jc("onSuccess",(function(){return t.$implicit.close()})),c.Wb())}let Wu=(()=>{class e{constructor(e,t,i,n,s){this.workspaceService=e,this.router=t,this.userService=i,this.authService=n,this.modalService=s,this.workspaces=[],this.allWorkspaces=[],this.workspaceIdsWhereOwner=[],this.unsubscribe$=new mi.a}ngOnInit(){this.isForbiddenZone=ei.g.includes(Se.tz.guess()),this.subscribeToWorkspaces(),this.workspaceService.getAllWorkspaces()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}isOnlyOneMemberIn(e){return 1==e.memberships.filter(e=>"ACTIVE"===e.membershipStatus).length}modalOne(e){this.modalService.open(e,{centered:!0})}openSecondModal(e,t){e&&this.modalOne(t)}subscribeToWorkspaces(){this.workspaceService.workspaces$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspaceService.getPermissionsForUserOnWorkspaces(e.map(e=>e.id)),this.workspaceService.workspacesPermissionsForUser.pipe(Object(Yt.a)(1)).subscribe(t=>{this.workspaceIdsWhereOwner=t.filter(e=>e.name===cu.a.OWNER).map(e=>e.objectId),this.allWorkspaces=e.map(e=>e.name),this.workspaces=e.filter(e=>!this.isOnlyOneMemberIn(e)&&this.workspaceIdsWhereOwner.indexOf(e.id)>-1).map(e=>e.name)})})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(W.c),c.Rb(ys.a),c.Rb(Ce.a),c.Rb(g.q))},e.\u0275cmp=c.Lb({type:e,selectors:[["delete-account"]],decls:20,vars:4,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-h1"],[1,"cl-card"],[1,"cl-card-body","cl-m-2"],[1,"cl-row","cl-align-items-center"],[1,"cl-col-lg-custom-6"],[1,"cl-display-1","cl-mb-3"],["class","cl-d-block cl-alert cl-alert-primary cl-fade cl-show cl-mb-3 cl-text-left",4,"ngIf"],["class","cl-mb-3",4,"ngIf"],["class","cl-alert cl-d-block cl-alert-danger cl-rounded-0 cl-mb-3","role","alert",4,"ngIf"],[1,"cl-btn","cl-btn-danger","cl-mr-3",3,"disabled","click"],["confirmModal",""],["formModal",""],[1,"cl-d-block","cl-alert","cl-alert-primary","cl-fade","cl-show","cl-mb-3","cl-text-left"],["href","https://calendly.com/clockify-support/call","target","_blank",1,"cl-font-weight-bold"],["href","https://clockify.me/help/contact/sales","target","_blank",1,"cl-font-weight-bold"],[1,"cl-mb-3"],[1,"cl-alert","cl-d-block","cl-alert-danger","cl-rounded-0","cl-mb-0"],[1,"cl-add-comma"],[1,"cl-border","cl-border-top-0","cl-p-3"],[1,"cl-h2"],[1,"cl-d-inline-block"],[1,"cl-delete-account-list-elements"],[1,"cl-small"],["role","alert",1,"cl-alert","cl-d-block","cl-alert-danger","cl-rounded-0","cl-mb-3"],[1,"cl-ml-3"],[4,"ngFor","ngForOf"],[3,"onSuccess","onUserConfirmed"],[3,"onSuccess"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"h1",3),c.Yc(4,"Delete Account"),c.Wb(),c.Wb(),c.Xb(5,"div",4),c.Xb(6,"div",5),c.Xb(7,"div",6),c.Xb(8,"div",7),c.Xb(9,"div",8),c.Yc(10,"We're sorry to see you leave Clockify"),c.Wb(),c.Wc(11,mu,9,0,"div",9),c.Wc(12,gu,17,1,"div",10),c.Wc(13,vu,5,1,"div",11),c.Xb(14,"button",12),c.jc("click",(function(){c.Oc(e);const i=c.Lc(17);return t.modalOne(i)})),c.Yc(15,"Delete my account"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(16,wu,1,0,"ng-template",null,13,c.Xc),c.Wc(18,yu,1,0,"ng-template",null,14,c.Xc)}2&e&&(c.Cb(11),c.wc("ngIf",!t.isForbiddenZone),c.Cb(1),c.wc("ngIf",t.workspaces.length>0),c.Cb(1),c.wc("ngIf",t.allWorkspaces.length>0),c.Cb(1),c.wc("disabled",t.workspaces.length>0))},directives:[s.u,s.t,au,hu],encapsulation:2}),e})();var Cu=i("s5zK"),ku=i("aQ9k"),Su=i("itXk");const Iu={type:"user-seats",title:"User seats",text:"User seats represent the number of active users you can have in your workspace. <br><br>Every time someone joins your workspace, they take up one user seat. If you don't have an available seat, they won\u2019t be able to join and track time in your workspace. <br>If you plan on adding a lot of users in the future, you can prepay additional seats so you don\u2019t get billed separately for each user. <br><br>You can buy additional seats or remove unused ones at any time in your Subscription page.",img:"/assets/images/features-info/user_seats.svg",link:"https://clockify.me/help/extra-features/subscription#user-seats-enterprise"},Ou=[{type:nr.a.ADD_TIME_FOR_OTHERS,title:"Add time for others",text:"See your team members timesheets and add/edit time for them. Or, manually add time entries for others right from the report. No need to chase your team anymore and wait for them to add the missing time.",img:"/assets/images/features-info/add_time_for_others.svg",link:"https://clockify.me/help/extra-features/add-time-for-others"},{type:"hide-and-time-and-page",title:"Hide time and pages",text:"\n    By default, all your team members can see time entries from everyone in your workspace.\n    You can choose to disable this so they can see only their own time entries.\n    <br>\n    You can also completely hide Team, Reports, and Projects pages from the sidebar\n    so only admins can access them.\n  ",img:"/assets/images/features-info/hide_pages.svg",link:"https://clockify.me/help/extra-features/hide-pages"},{type:nr.a.AUTOMATIC_LOCK,title:"Automatic lock",text:"Set automatic lock and the lock date will get auto-updated each day,\n      week, or month so you don't have to do it manually any more.",img:"/assets/images/features-info/automatic_lock.svg",link:"https://clockify.me/help/extra-features/automatic-lock"},{type:nr.a.WORKSPACE_TIME_AUDIT,title:"Time audit",text:"With one click, find all the entries in your workspace that are too short/long or are missing a project/task so you can clean them up.",img:"/assets/images/features-info/time_audit.svg",link:"https://clockify.me/help/extra-features/time-audit"},{type:nr.a.REQUIRED_FIELDS,title:"Required fields",text:"Make some fields mandatory when tracking time so no one can create a time entry that's missing a project, task, tag, or description.",img:"/assets/images/features-info/required_fields.svg",link:"https://clockify.me/help/extra-features/required-fields"},{type:nr.a.PROJECT_TEMPLATES,title:"Project templates",text:"Quickly create similar projects with the same task structure so you don't have to manually recreate the same projects for different clients over and over.",img:"/assets/images/features-info/project_template.svg",link:"https://clockify.me/help/extra-features/project-templates"},{type:nr.a.BULK_EDIT,title:"Bulk edit",text:"Select and update multiple time entries or projects at once with just a few clicks.",img:"/assets/images/features-info/bulk_edit.svg",link:"https://clockify.me/help/extra-features/bulk-edit"},{type:nr.a.CUSTOM_REPORTING,title:"Customize exports",text:"When you export a report, you can choose which columns you wish to get in CSV and Excel, plus control what data you wish to be visible in PDF exports, including report name.",img:"/assets/images/features-info/custom-exports.svg",link:"https://clockify.me/help/extra-features/customize-exports"},{type:nr.a.HIDE_PAGES,title:"Hide pages",text:"Hide Team, Reports, and Projects pages so only admins can see them.",img:"/assets/images/features-info/hide_pages.svg",link:"https://clockify.me/help/extra-features/hide-pages"},{type:nr.a.HISTORIC_RATES,title:"Historic rates",text:"\n      By default, when you change an hourly rate, the new rate is applied only to\n      new time entries going forward. Upgraded accounts can apply new rates\n      retroactively to previous time entries in bulk when updating the hourly rate.\n    ",img:"/assets/images/features-info/historic_rates.svg",link:"https://clockify.me/help/reports/hourly-rates#historic-rates"},{type:nr.a.WORKSPACE_LOCK_TIMEENTRIES,title:"Lock time",text:"Prevent your team from adding or editing past time entries.\n      Once time entries are locked, only admins can add or edit entries for past dates.",img:"/assets/images/features-info/lock_entries.svg",link:"https://clockify.me/help/extra-features/lock-timesheets"},{type:"automatic-and-manual-lock",title:"Lock time",text:"Prevent your team from adding or editing past time entries.\n      Once timesheets are locked, only admins can add or edit entries for past dates.\n      You can also auto-lock timesheets at the end of each day, week, or month.",img:"/assets/images/features-info/automatic-and-manual-lock.svg",link:"https://clockify.me/help/extra-features/lock-timesheets"},{type:nr.a.APPROVAL,title:"Time approval",text:"Your team can submit their weekly timesheets for review, which you can approve or reject.\n      Once approved, the time can no longer be changed without a permanent written trail.",img:"/assets/images/features-info/time-approval-info.svg",link:"https://clockify.me/help/extra-features/time-approval"},{type:nr.a.MANAGER_ROLE,title:"Manager role",text:"Instead of making someone an admin, make someone a <b>team manager</b> so they can see\n    all the time their team members have tracked, and approve their timesheets. <br><br>\n    Or, give someone a <b>project manager</b> role on multiple projects so they can see all the\n    tracked time on the projects they manage and edit the said projects (eg. create tasks, add\n    members to project, set estimates, etc).",img:"/assets/images/features-info/manager-role-info.svg",link:"https://clockify.me/help/extra-features/manager-role"},{type:nr.a.TARGETS_AND_REMINDERS,title:"Timesheet reminders",text:"Set time tracking reminders for your team, and Clockify will automatically send them an email if they haven't logged enough hours that day or week.",img:"/assets/images/features-info/reminders.svg",link:"https://clockify.me/help/extra-features/targets-reminders"},{type:nr.a.FILE_IMPORT,title:"Import timesheets",text:"If you have historical timesheets data in Excel, you can import everything in Clockify\n      so your reports can include all your past and future data.\n      <br>\n      Import will create all the necessary projects, tasks, clients, users, and time entries.\n      All you need to do is provide the file.",img:"/assets/images/features-info/import_csv.png",link:"https://clockify.me/help/extra-features/import-timesheets"},{type:nr.a.WORKSPACE_TIME_ROUNDING,title:"Time rounding",text:"Turn rounding on and off so duration numbers in reports look cleaner. You can round up, down, or to the nearest minute.",img:"/assets/images/features-info/time_rounding.svg",link:"https://clockify.me/help/extra-features/time-rounding"},{type:nr.a.TASK_RATES,title:"Task rates",text:"If you charge a different rate depending on the task you do, you can set a different rate for each task on a project. You can also control whether tasks are billable or non-billable by default.",img:"/assets/images/features-info/task-rates.svg",link:"https://clockify.me/help/extra-features/task-rates"},{type:nr.a.INVOICING,title:"Invoicing",text:"Create professional invoices for clients based on tracked time,\n      download them in PDF, and track their status.",img:"/assets/images/features-info/invoicing.svg",link:"https://clockify.me/help/extra-features/invoicing"},{type:nr.a.LABOR_COST,title:"Labor cost & profit",text:"Define labor costs so you can see what you charge clients vs what you pay your team. Plus, when you set or change rates, you can apply them retroactively to all previous time entries or only to entries from certain date onwards.",img:"/assets/images/features-info/labor_cost_upgrade.svg",link:"https://clockify.me/help/extra-features/labor-cost"},{type:nr.a.SCHEDULED_REPORTS,title:"Scheduled reports",text:"Receive custom reports by email each day, week, or month. When you filter and share\n    some report, you can also specify for it to be sent by email to you or anyone else in your\n    account so they always receive the latest tracked information for that or previous day, week,\n    or month.",img:"/assets/images/features-info/scheduled-info.png",link:"https://clockify.me/help/extra-features/scheduled-reports"},{type:nr.a.PROJECT_BUDGET,title:"Budget & estimates",text:"Set estimates in monetary terms for fixed fee projects.\n      Then you can track progress based on how much money was spent and get alerts when\n      the budget gets to a certain completion percentage.\n      <br>\n      You can also set recurring estimates so time and budget progress resets each month,\n      plus see estimates directly in reports and export them alongside your tracked time.\n    ",img:"/assets/images/features-info/project-budget.svg",link:"https://clockify.me/help/extra-features/project-budget"},{type:nr.a.ALERTS,title:"Alerts",text:"Get email notification when a project has reached a certain percent of its estimated time.",img:"/assets/images/features-info/alerts.svg",link:"https://clockify.me/help/extra-features/alerts"},{type:nr.a.DISABLE_MANUAL_MODE,title:"Force timer",text:"Disable the manual mode so users can't add time manually.\n      Instead, they will be able to create time entries only by using the timer.\n      <br><br>\n      This will also prevent regular users from editing start or\n      end times in their existing time entries.",img:"/assets/images/features-info/force-timer-info.svg",link:"https://clockify.me/help/extra-features/force-timer"},{type:nr.a.LOCATIONS,title:"GPS tracking",text:"Your remote field workers can clock-in via their mobile app\n      when they visit a client so you can later see all the visited job sites that day.\n    ",img:"/assets/images/features-info/locations-feature.svg",link:"https://clockify.me/help/extra-features/gps-tracking"},{type:nr.a.SCREENSHOTS,title:"Screenshots",text:"Desktop app can take screenshots every 5 minutes while your timer is\n      running so you can recall what you were working on.",img:"/assets/images/features-info/screenshots.svg",link:"https://clockify.me/help/extra-features/screenshots"},{type:nr.a.CUSTOM_FIELDS,title:"Custom fields",text:"Custom fields allow you to add additional information to time entries, allowing you to track anything: from user data like mileage and expenses, to metadata like project ID and location.",img:"/assets/images/features-info/custom_fields_upgrade.svg",link:"https://clockify.me/help/extra-features/custom-fields"},{type:nr.a.WHO_CAN_SEE_ALL_TIME_ENTRIES,title:"Hide time from users",text:"\n      By default, everyone can see all time entries.\n      But, you can easily control who can see what entries and hide them so\n      only admins can see all tracked time.\n    ",img:"/assets/images/features-info/private_entries.svg",link:"https://clockify.me/help/extra-features/private-time-entries"},{type:nr.a.BRANDED_REPORTS,title:"Branded reports",text:"Upload your company logo and all exported PDF reports will have your logo in the corner.",img:"/assets/images/features-info/branded_reports.svg",link:"https://clockify.me/help/extra-features/branded-reports"},{type:nr.a.SSO,title:"Single sign-on (SSO)",text:"Manage access and login using your organization's network. Force everyone to log in with your SSO credentials by disabling password login. Supported SSO systems: LDAP, OAuth, and SAML2 (all identity providers covered: Google, Okta, OneLogin, Azure, etc.).",img:"/assets/images/features-info/sso-info.svg",link:"https://clockify.me/help/extra-features/single-sign-on"},{type:nr.a.CUSTOM_SUBDOMAIN,title:"Custom subdomain",text:"Choose the subdomain through which your users will use Clockify and remove the ability to have multiple workspaces.",img:"/assets/images/features-info/subdomain-info.svg",link:""},{type:nr.a.ADMIN_PANEL,title:"Control accounts",text:"Have complete admin control over user accounts on your workspace: log in into your users' accounts, edit their names, see API keys, and more.",img:"/assets/images/features-info/accounts-info.svg",link:"https://clockify.me/help/extra-features/manage-accounts"}],Xu=[nr.a.ADD_TIME_FOR_OTHERS,"hide-and-time-and-page",nr.a.WORKSPACE_TIME_AUDIT,nr.a.REQUIRED_FIELDS,nr.a.PROJECT_TEMPLATES,nr.a.BULK_EDIT,nr.a.HISTORIC_RATES,nr.a.WHO_CAN_SEE_PROJECT_STATUS,nr.a.CUSTOM_REPORTING],Eu=Ou.filter(e=>Xu.includes(e.type)),Tu=["automatic-and-manual-lock",nr.a.APPROVAL,nr.a.MANAGER_ROLE,nr.a.TARGETS_AND_REMINDERS,nr.a.FILE_IMPORT,nr.a.WORKSPACE_TIME_ROUNDING,nr.a.TASK_RATES,nr.a.INVOICING],Du=Ou.filter(e=>Tu.includes(e.type)),Ru=[nr.a.LABOR_COST,nr.a.SCHEDULED_REPORTS,nr.a.PROJECT_BUDGET,nr.a.ALERTS,nr.a.DISABLE_MANUAL_MODE,nr.a.LOCATIONS,nr.a.SCREENSHOTS,nr.a.CUSTOM_FIELDS,nr.a.SUMMARY_ESTIMATE],Au=Ou.filter(e=>Ru.includes(e.type)),ju=[nr.a.SSO,nr.a.CUSTOM_SUBDOMAIN,nr.a.ADMIN_PANEL],xu=Ou.filter(e=>ju.includes(e.type)),Pu=[nr.a.WHO_CAN_SEE_ALL_TIME_ENTRIES,nr.a.WORKSPACE_LOCK_TIMEENTRIES,nr.a.REQUIRED_FIELDS,nr.a.WORKSPACE_TIME_ROUNDING,nr.a.WORKSPACE_TIME_AUDIT,nr.a.BRANDED_REPORTS,nr.a.TARGETS_AND_REMINDERS,nr.a.WHO_CAN_SEE_PROJECT_STATUS],Mu=Ou.filter(e=>Pu.includes(e.type)),Yu=[nr.a.ADD_TIME_FOR_OTHERS,nr.a.PROJECT_TEMPLATES,nr.a.ALERTS,nr.a.BULK_EDIT,nr.a.HIDE_PAGES,nr.a.AUTOMATIC_LOCK,nr.a.CUSTOM_REPORTING],Lu=Ou.filter(e=>Yu.includes(e.type)),Fu=[nr.a.SSO,nr.a.ADMIN_PANEL,nr.a.CUSTOM_SUBDOMAIN,nr.a.CUSTOM_FIELDS,nr.a.LABOR_COST,nr.a.APPROVAL,nr.a.MANAGER_ROLE,nr.a.SCHEDULED_REPORTS,nr.a.FILE_IMPORT,nr.a.DISABLE_MANUAL_MODE,nr.a.PROJECT_BUDGET,nr.a.TASK_RATES,nr.a.HISTORIC_RATES,nr.a.INVOICING,nr.a.SCREENSHOTS,nr.a.LOCATIONS,nr.a.SUMMARY_ESTIMATE],Nu=Ou.filter(e=>Fu.includes(e.type));let Uu=(()=>{class e{constructor(){this.close=new c.n}closeDialog(){this.close.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["subscription-incomplete-modal"]],outputs:{close:"close"},decls:8,vars:0,consts:[[1,"cl-modal-header"],[1,"cl-modal-body","cl-py-4"],[1,"cl-modal-footer"],["data-dismiss","modal",1,"cl-color-blue",3,"click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Yc(1," Upgrade failed\n"),c.Wb(),c.Xb(2,"div",1),c.Xb(3,"p"),c.Yc(4,"There's a pending payment on your current upgrade. Please verify it from the email or wait 24h, then try again."),c.Wb(),c.Wb(),c.Xb(5,"div",2),c.Xb(6,"a",3),c.jc("click",(function(){return t.closeDialog()})),c.Yc(7,"OK"),c.Wb(),c.Wb())},encapsulation:2}),e})();function $u(e,t){1&e&&(c.Xb(0,"div",12),c.Xb(1,"span"),c.Yc(2,"Once you switch plans, you can\u2019t go back to your old pricing plan."),c.Wb(),c.Wb())}function _u(e,t){1&e&&(c.Xb(0,"span"),c.Yc(1,"There are no refunds."),c.Wb())}i("nslC");const Gu=function(){return{standalone:!0}};function Bu(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",13),c.Xb(1,"div",14),c.Xb(2,"input",15),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().agreement=t})),c.Wb(),c.Xb(3,"label",16),c.Xb(4,"span",17),c.Yc(5,"I have read and agree to the "),c.Xb(6,"a",18),c.Yc(7,"Terms of Use"),c.Wb(),c.Wb(),c.Xb(8,"span",19),c.Yc(9,"There are no refunds. Your subscription will renew automatically, and you will be charged in advance. You may cancel at any time. The cancellation goes into effect at the start of your following billing cycle."),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.wc("ngModel",e.agreement)("ngModelOptions",c.Ac(2,Gu))}}let Vu=(()=>{class e{constructor(){this.closeModal=new c.n,this.pay=new c.n,this.isEnterprise=ku.f,this.isMonthly=ku.i,this.expandForSeats=!1,this.agreement=!1}ngOnInit(){this.type.quantity=0,this.currentType=ku.a[this.workspace.featureSubscriptionType.replace("SPECIAL","PLUS")],this.title="Switch to "+this.type.title,this.type.title===this.currentType.title?(this.buttonText=this.type.weight<this.currentType.weight?"Pay monthly":"Pay annually",this.text=this.type.weight<this.currentType.weight?"Once your current annual subscription ends, you'll be switched to monthly billing cycle.":"You'll be charged an estimated prorated price of $"+this.price+(this.type.weight<this.currentType.weight?" ":" (save 20%).")):this.currentType.weight<this.type.weight?(this.buttonText="Upgrade",this.text="You'll be charged an estimated prorated price of $"+this.price+" and immediately get access to "+this.type.title.toUpperCase()+" features."):(this.buttonText="Downgrade",this.text="Once the current subscription ends, you'll be downgraded to the new plan "+(Object(ku.i)(this.currentType.value)&&!Object(ku.i)(this.type.value)?"(2 months free).":"")),this.type===this.currentType&&(this.buttonText="Reactivate",this.text="Reactivate your current subscription.")}close(){this.closeModal.emit(!0)}continue(){this.pay.emit(this.type)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["switching-plan"]],inputs:{type:"type",workspace:"workspace",disableButton:"disableButton",price:"price"},outputs:{closeModal:"closeModal",pay:"pay"},decls:20,vars:8,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],[1,"cl-text-gray-9"],["type","button",1,"cl-close",3,"click"],["src","assets/ui-icons/close.svg"],[1,"cl-modal-body"],["class","cl-alert cl-alert-warning cl-alert-reset-main cl-alert-dismissible cl-fade cl-show cl-my-3 cl-p-2 cl-mx-0",4,"ngIf"],[4,"ngIf"],["class","cl-mt-3",4,"ngIf"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-alert","cl-alert-warning","cl-alert-reset-main","cl-alert-dismissible","cl-fade","cl-show","cl-my-3","cl-p-2","cl-mx-0"],[1,"cl-mt-3"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox","id","agreementCheckbox",1,"cl-custom-control-input",3,"ngModel","ngModelOptions","ngModelChange"],["for","agreementCheckbox",1,"cl-custom-control-label"],[1,"cl-font-weight-bold"],["href","https://clockify.me/terms","target","_blank","tabindex","0",1,"cl-color-blue"],[1,"cl-color-grey","cl-d-block"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2),c.Xb(3,"span",2),c.Yc(4),c.Wb(),c.Wb(),c.Xb(5,"button",3),c.jc("click",(function(){return t.close()})),c.Xb(6,"span"),c.Sb(7,"img",4),c.Wb(),c.Wb(),c.Wb(),c.Xb(8,"div",5),c.Wc(9,$u,3,0,"div",6),c.Xb(10,"div"),c.Xb(11,"p"),c.Yc(12),c.Wc(13,_u,2,0,"span",7),c.Wb(),c.Wb(),c.Wc(14,Bu,10,3,"div",8),c.Wb(),c.Xb(15,"div",9),c.Xb(16,"a",10),c.jc("click",(function(){return t.close()})),c.Yc(17,"Nevermind"),c.Wb(),c.Xb(18,"button",11),c.jc("click",(function(){return t.continue()})),c.Yc(19),c.Wb(),c.Wb()),2&e&&(c.Cb(2),c.ad("",t.title," "),c.Cb(2),c.Zc(t.type.label.includes("YEAR")?" (yearly)":" (monthly)"),c.Cb(5),c.wc("ngIf",t.currentType&&t.currentType.legacy),c.Cb(3),c.ad("",t.text," "),c.Cb(1),c.wc("ngIf",t.type.weight<t.currentType.weight),c.Cb(1),c.wc("ngIf",t.type.weight>=t.currentType.weight),c.Cb(4),c.wc("disabled",t.disableButton||!t.agreement&&t.type.weight>=t.currentType.weight),c.Cb(1),c.ad("",t.buttonText," "))},directives:[s.u,p.a,p.s,p.v],encapsulation:2}),e})();function Hu(e,t){if(1&e&&(c.Xb(0,"div",10),c.Sb(1,"img",11),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.xc("src",e.typeObject.img,c.Qc)}}function zu(e,t){if(1&e&&(c.Xb(0,"a",12),c.Yc(1," Learn more"),c.Wb()),2&e){const e=c.nc();c.xc("href",e.typeObject.link,c.Qc)}}let qu=(()=>{class e{constructor(){this.close=new c.n}closeDialog(){this.close.emit(!0)}ngOnInit(){const e=Ou.find(e=>e.type===this.type)||[Iu].find(e=>e.type===this.type);e?this.typeObject=e:this.closeDialog()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["features-info"]],inputs:{type:"type"},outputs:{close:"close"},decls:12,vars:4,consts:[[1,"cl-modal-body","cl-py-4"],[1,"cl-row","cl-align-items-center","cl-justify-content-between"],[1,"cl-col","cl-mb-3","cl-mb-lg-0"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-text-gray-3","cl-mb-0",3,"innerHTML"],[1,"cl-col-lg-4"],["class","cl-rounded-circle cl-p-2 cl-border",4,"ngIf"],[1,"cl-modal-footer"],["data-dismiss","modal",1,"cl-color-blue",3,"click"],["class","cl-btn cl-btn-primary","ngbAutofocus","","target","_blank",3,"href",4,"ngIf"],[1,"cl-rounded-circle","cl-p-2","cl-border"],[1,"cl-w-100","cl-rounded-circle",3,"src"],["ngbAutofocus","","target","_blank",1,"cl-btn","cl-btn-primary",3,"href"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Yc(4),c.Wb(),c.Sb(5,"p",4),c.Wb(),c.Xb(6,"div",5),c.Wc(7,Hu,2,1,"div",6),c.Wb(),c.Wb(),c.Wb(),c.Xb(8,"div",7),c.Xb(9,"a",8),c.jc("click",(function(){return t.closeDialog()})),c.Yc(10,"Close"),c.Wb(),c.Wc(11,zu,2,1,"a",9),c.Wb()),2&e&&(c.Cb(4),c.Zc(t.typeObject.title),c.Cb(1),c.wc("innerHTML",t.typeObject.text,c.Pc),c.Cb(2),c.wc("ngIf",t.typeObject.img),c.Cb(4),c.wc("ngIf",t.typeObject.link))},directives:[s.u],encapsulation:2}),e})();const Ku=["featuresInfoModal"],Zu=["upgradeModal"],Qu=["confirmUpgradeModal"],Ju=["subscriptionFailedModal"];function ed(e,t){1&e&&(c.Xb(0,"div"),c.Yc(1," Choose one of our monthly or yearly plans to boost your productivity with extra features and add-ons. "),c.Wb())}function td(e,t){if(1&e&&(c.Vb(0),c.Yc(1," You already use a "),c.Xb(2,"span",41),c.Yc(3),c.Wb(),c.Yc(4," plan. "),c.Wc(5,ed,2,0,"div",42),c.Ub()),2&e){const e=c.nc();c.Cb(2),c.wc("ngClass",e.currentPaymentType.colorText),c.Cb(1),c.Zc(e.currentPaymentType.title),c.Cb(2),c.wc("ngIf","ENTERPRISE"!==e.currentPaymentType.value)}}function id(e,t){if(1&e&&c.Yc(0),2&e){const e=c.nc();c.ad(" Upgrade ",e.workspace.name," workspace and get even more features. ")}}function nd(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",43),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.goToPayment(t.isMonthly?t.paymentType.BASIC_2021.label:t.paymentType.BASIC_YEAR_2021.label)})),c.Yc(1),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.isMonthly?e.paymentType.BASIC_2021.button:e.paymentType.BASIC_YEAR_2021.button," ")}}function sd(e,t){1&e&&(c.Xb(0,"span",44),c.Yc(1," Subscribed"),c.Wb())}function cd(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",46),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc().openFeaturesInfo(t.type)})),c.Sb(1,"img",35),c.Wb()}}function rd(e,t){if(1&e&&(c.Xb(0,"li"),c.Xb(1,"span",29),c.Yc(2),c.Wb(),c.Wc(3,cd,2,0,"a",45),c.Wb()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function od(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",43),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.goToPayment(t.isMonthly?t.paymentType.STANDARD_2021.label:t.paymentType.STANDARD_YEAR_2021.label)})),c.Yc(1),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.isMonthly?e.paymentType.STANDARD_2021.button:e.paymentType.STANDARD_YEAR_2021.button," ")}}function ad(e,t){1&e&&(c.Xb(0,"span",44),c.Yc(1," Subscribed"),c.Wb())}function ld(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",46),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc().openFeaturesInfo(t.type)})),c.Sb(1,"img",35),c.Wb()}}function bd(e,t){if(1&e&&(c.Xb(0,"li"),c.Xb(1,"span",29),c.Yc(2),c.Wb(),c.Wc(3,ld,2,0,"a",45),c.Wb()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function ud(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",43),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.goToPayment(t.isMonthly?t.paymentType.PRO_2021.label:t.paymentType.PRO_YEAR_2021.label)})),c.Yc(1),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.isMonthly?e.paymentType.PRO_2021.button:e.paymentType.PRO_YEAR_2021.button," ")}}function dd(e,t){1&e&&(c.Xb(0,"span",44),c.Yc(1," Subscribed"),c.Wb())}function pd(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",46),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc().openFeaturesInfo(t.type)})),c.Sb(1,"img",35),c.Wb()}}function hd(e,t){if(1&e&&(c.Xb(0,"li"),c.Xb(1,"span",29),c.Yc(2),c.Wb(),c.Wc(3,pd,2,0,"a",45),c.Wb()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function md(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",43),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.goToPayment(t.isMonthly?t.paymentType.ENTERPRISE_2021.label:t.paymentType.ENTERPRISE_YEAR_2021.label)})),c.Yc(1),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.isMonthly?e.paymentType.ENTERPRISE_2021.button:e.paymentType.ENTERPRISE_YEAR_2021.button," ")}}function gd(e,t){1&e&&(c.Xb(0,"span",44),c.Yc(1," Subscribed"),c.Wb())}function fd(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",46),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc().openFeaturesInfo(t.type)})),c.Sb(1,"img",35),c.Wb()}}function vd(e,t){if(1&e&&(c.Xb(0,"li"),c.Xb(1,"span",29),c.Yc(2),c.Wb(),c.Wc(3,fd,2,0,"a",45),c.Wb()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function wd(e,t){if(1&e&&(c.Xb(0,"simple-modal",47),c.jc("confirmed",(function(){return t.$implicit.close(!0)}))("close",(function(){return t.$implicit.close(!1)})),c.Xb(1,"p",48),c.Yc(2," Upgrade "),c.Xb(3,"strong"),c.Yc(4),c.Wb(),c.Yc(5," workspace? "),c.Wb(),c.Wb()),2&e){const e=c.nc();c.wc("title","Upgrade")("btnText","Upgrade")("btnCancel","Nevermind"),c.Cb(4),c.Zc(e.workspace.name)}}function yd(e,t){1&e&&(c.Xb(0,"subscription-incomplete-modal",49),c.jc("close",(function(){return t.$implicit.close()})),c.Wb())}function Wd(e,t){if(1&e){const e=c.Yb();c.Xb(0,"switching-plan",50),c.jc("pay",(function(t){return c.Oc(e),c.nc().pay(t)}))("closeModal",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("disableButton",e.upgradeInProgress)("workspace",e.workspace)("type",e.plan)("price",e.price)}}function Cd(e,t){if(1&e&&(c.Xb(0,"features-info",51),c.jc("close",(function(){return t.$implicit.close()})),c.Wb()),2&e){const e=c.nc();c.wc("type",e.featuresInfoType)}}let kd=(()=>{class e{constructor(e,t,i,n,s,r){this.workspaceService=e,this.paymentService=t,this.toaster=i,this.loader=n,this.router=s,this.modalService=r,this.onDestroy=new c.n,this.unsubscribe$=new mi.a,this.BASIC_2021_FEATURE_TYPES=Eu,this.STANDARD_2021_FEATURE_TYPES=Du,this.PRO_2021_FEATURE_TYPES=Au,this.ENTERPRISE_2021_FEATURE_TYPES=xu,this.paymentType=ku.a,this.hasPaymentInfo$=new je.a(null)}ngOnInit(){this.subscribeToAllWorkspaces(),this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,Object(ku.n)(this.workspace.featureSubscriptionType),this.isMonthly=Object(ku.i)(this.workspace.featureSubscriptionType),this.currentPaymentType=Object(ku.c)(this.workspace.featureSubscriptionType)}),this.paymentService.everHadSubscription.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{e?this.getPaymentInformation():this.hasPaymentInfo$.next(!0)}),this.paymentService.everHadPaidSubscription.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>this.everHadPaidSubscription=e),this.paymentService.getEverHadSubscription()}ngOnDestroy(){this.loader.hideBar(),this.onDestroy.emit(),this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getPaymentInformation(){this.paymentService.getPaymentInformation(this.workspace.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.paymentInformation=e,this.hasPaymentInfo$.next(!0)},()=>this.loader.hideBar())}openFeaturesInfo(e){this.featuresInfoType=e,this.modalService.open(this.featuresInfoModal,{size:"lg",centered:!0})}goToPayment(e){this.paymentInformation||this.loader.showBar();const t=new Ee.a;Object(Su.a)(t,this.hasPaymentInfo$.pipe(Object(It.a)(e=>e))).pipe(Object(Yt.a)(1),Object(Y.a)(e=>e[0]),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.loader.hideBar(),this.handleUpgradePlan(e)}),t.next(e)}handleUpgradePlan(e){if(this.workspace.featureSubscriptionType&&this.workspace.featureSubscriptionType!==ku.b.TRIAL&&this.paymentInformation.cardHolder)this.plan=this.paymentType[e],this.loader.show(),this.paymentService.previewPrice(this.plan.value,this.workspace.memberships.filter(e=>e.isActiveOrPending).length).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.price=e.price,this.loader.hide(),this.modalService.open(this.upgradeModal,{centered:!0})});else{if(!(this.numberOfWorkspaces>1)||this.everHadPaidSubscription)return void this.navigateToUpgrade(e);this.modalService.open(this.confirmUpgradeModal,{centered:!0}).result.then(t=>{t&&this.navigateToUpgrade(e)}).catch(e=>{})}}navigateToUpgrade(e){this.router.navigate(["upgrade",this.workspace.id],{queryParams:{plan:e}})}changeToMonthly(e){this.isMonthly=e}pay(e){this.upgradeInProgress||(this.upgradeInProgress=!0,this.loader.show("Processing payment"),this.paymentService.chargeCard(this.paymentInformation,e.quantity+this.workspace.memberships.filter(e=>e.isActiveOrPending).length,e.value).subscribe(()=>{this.loader.hide(),this.upgradeInProgress=!1,this.modalService.dismissAll(),this.toaster.pop("success","Successfully upgraded to "+e.title+" plan"),this.onPaymentSuccess()},e=>{e.error&&e.error.message&&e.error.message.includes("incomplete")?this.modalService.open(this.subscriptionFailedModal):this.toaster.pop("error",e.error&&e.error.message||"Processing failed"),this.loader.hide(),this.upgradeInProgress=!1}))}onPaymentSuccess(){this.loader.showBar();const e=this.workspaceService.getPaymentDate(),t=this.workspaceService.getDefaultWorkspace();Object(la.a)(e,t).pipe(Object(Yt.a)(1)).subscribe(()=>{this.loader.hideBar(),this.router.navigate(["subscription"],{fragment:"payment"})},()=>this.loader.hideBar())}subscribeToAllWorkspaces(){this.workspaceService.workspaces$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(e=>this.numberOfWorkspaces=e.length)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(Cu.a),c.Rb(M.a),c.Rb(wi.a),c.Rb(W.c),c.Rb(g.q))},e.\u0275cmp=c.Lb({type:e,selectors:[["upgrade-plans"]],viewQuery:function(e,t){var i;1&e&&(c.ed(Ku,!0),c.ed(Zu,!0),c.ed(Qu,!0),c.ed(Ju,!0)),2&e&&(c.Kc(i=c.kc())&&(t.featuresInfoModal=i.first),c.Kc(i=c.kc())&&(t.upgradeModal=i.first),c.Kc(i=c.kc())&&(t.confirmUpgradeModal=i.first),c.Kc(i=c.kc())&&(t.subscriptionFailedModal=i.first))},outputs:{onDestroy:"onDestroy"},decls:149,vars:26,consts:[[1,"cl-text-center","cl-mt-4"],[1,"cl-display-1"],[1,"cl-lead","cl-text-gray-6","cl-w-75","cl-mx-auto"],[4,"ngIf","ngIfElse"],["noPlanHeaderTemplate",""],[1,"cl-my-5"],[1,"cl-btn-group","cl-btn-group-toggle","cl-upgrade-switchers"],[1,"cl-btn","cl-btn-outline-light","cl-hover-pointer",3,"click"],["type","radio"],[1,"cl-badge","cl-badge-success","cl-ml-2"],[1,"cl-row","cl-row-cards","cl-justify-content-center"],[1,"cl-col-lg-6","cl-col-lg-custom-3","cl-p-0","cl-parent-grey"],[1,"cl-card","cl-border-top","cl-w-100","cl-border-bottom-grey"],[1,"cl-border-0","cl-bg-transparent","cl-pt-3","cl-text-center"],[1,"cl-h1","cl-font-weight-bold","cl-mb-0","cl-text-color"],[1,"cl-h3","cl-mb-0","cl-text-color"],[1,"cl-card-body","cl-px-3","cl-pt-0"],[1,"cl-d-flex","cl-text-center","cl-justify-content-center","cl-my-3"],[1,"cl-d-flex","cl-text-center","cl-mr-2","cl-text-color"],[1,"cl-mr-1","cl-text-color"],[1,"cl-display-1","cl-lh-1","cl-mb-0","cl-text-gray-3","cl-text-color"],[1,"cl-d-flex","cl-justify-content-center","cl-text-color"],[1,"cl-h3","cl-text-color"],[1,"cl-px-2","cl-py-3","cl-bg-transparent"],["class","cl-btn cl-btn cl-btn-block cl-btn-color",3,"click",4,"ngIf"],["class","cl-btn cl-btn-block cl-text-uppercase cl-text-color",4,"ngIf"],[1,"cl-list-unstyled","cl-add-lh","cl-padding"],[4,"ngFor","ngForOf"],[1,"cl-col-lg-6","cl-col-lg-custom-3","cl-p-0","cl-parent-blue","cl-scale"],[1,"cl-color-grey"],[1,"cl-col-lg-6","cl-col-lg-custom-3","cl-p-0","cl-parent-red"],[1,"cl-col-lg-6","cl-col-lg-custom-3","cl-p-0","cl-parent-purple"],[1,"cl-card-body","cl-px-3","cl-pt-0","cl-position-relative"],[1,"cl-text-center","cl-card-last"],["href","https://clockify.me/self-hosted-time-tracking-software","target","_blank",1,"cl-ml-1","cl-d-inline-flex"],["src","assets/images/ui-icons/info-9.svg"],["href","https://clockify.me/help/contact/sales","target","_blank",1,"cl-text-color"],["confirmUpgradeModal",""],["subscriptionFailedModal",""],["upgradeModal",""],["featuresInfoModal",""],[3,"ngClass"],[4,"ngIf"],[1,"cl-btn","cl-btn","cl-btn-block","cl-btn-color",3,"click"],[1,"cl-btn","cl-btn-block","cl-text-uppercase","cl-text-color"],["class","cl-ml-1 cl-d-inline-flex",3,"click",4,"ngIf"],[1,"cl-ml-1","cl-d-inline-flex",3,"click"],[3,"title","btnText","btnCancel","confirmed","close"],[1,"cl-text-dark","cl-mb-0"],[3,"close"],[3,"disableButton","workspace","type","price","pay","closeModal"],[3,"type","close"]],template:function(e,t){if(1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Yc(2,"Get more from Clockify!"),c.Wb(),c.Xb(3,"p",2),c.Wc(4,td,6,3,"ng-container",3),c.Wc(5,id,1,1,"ng-template",null,4,c.Xc),c.Wb(),c.Xb(7,"div",5),c.Xb(8,"div",6),c.Xb(9,"label",7),c.jc("click",(function(){return t.changeToMonthly(!0)})),c.Sb(10,"input",8),c.Yc(11,"Monthly Billing "),c.Wb(),c.Xb(12,"label",7),c.jc("click",(function(){return t.changeToMonthly(!1)})),c.Sb(13,"input",8),c.Yc(14,"Annual Billing"),c.Xb(15,"span",9),c.Yc(16,"SAVE 20%"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(17,"div",10),c.Xb(18,"div",11),c.Xb(19,"div",12),c.Xb(20,"div",13),c.Xb(21,"span",14),c.Yc(22,"BASIC"),c.Wb(),c.Wb(),c.Xb(23,"div",13),c.Xb(24,"span",15),c.Yc(25,"Administration"),c.Wb(),c.Wb(),c.Xb(26,"div",16),c.Xb(27,"div",17),c.Xb(28,"div",18),c.Xb(29,"span",19),c.Yc(30,"$"),c.Wb(),c.Xb(31,"span",20),c.Yc(32),c.Wb(),c.Xb(33,"span"),c.Yc(34),c.Wb(),c.Wb(),c.Wb(),c.Xb(35,"div",21),c.Xb(36,"div"),c.Xb(37,"div",22),c.Yc(38," per seat / month"),c.Wb(),c.Wb(),c.Wb(),c.Xb(39,"div",23),c.Wc(40,nd,2,1,"a",24),c.Wc(41,sd,2,0,"span",25),c.Wb(),c.Xb(42,"ul",26),c.Wc(43,rd,4,2,"li",27),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(44,"div",28),c.Xb(45,"div",12),c.Xb(46,"div",13),c.Xb(47,"span",14),c.Yc(48,"STANDARD"),c.Wb(),c.Wb(),c.Xb(49,"div",13),c.Xb(50,"span",15),c.Yc(51,"Timesheeting & Billing"),c.Wb(),c.Wb(),c.Xb(52,"div",16),c.Xb(53,"div",17),c.Xb(54,"div",18),c.Xb(55,"span",19),c.Yc(56,"$"),c.Wb(),c.Xb(57,"span",20),c.Yc(58),c.Wb(),c.Xb(59,"span"),c.Yc(60),c.Wb(),c.Wb(),c.Wb(),c.Xb(61,"div",21),c.Xb(62,"div"),c.Xb(63,"div",22),c.Yc(64," per seat / month"),c.Wb(),c.Wb(),c.Wb(),c.Xb(65,"div",23),c.Wc(66,od,2,1,"a",24),c.Wc(67,ad,2,0,"span",25),c.Wb(),c.Xb(68,"ul",26),c.Xb(69,"li"),c.Xb(70,"span",29),c.Yc(71,"All BASIC features"),c.Wb(),c.Wb(),c.Wc(72,bd,4,2,"li",27),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(73,"div",30),c.Xb(74,"div",12),c.Xb(75,"div",13),c.Xb(76,"span",14),c.Yc(77,"PRO"),c.Wb(),c.Wb(),c.Xb(78,"div",13),c.Xb(79,"span",15),c.Yc(80,"Profit & Productivity"),c.Wb(),c.Wb(),c.Xb(81,"div",16),c.Xb(82,"div",17),c.Xb(83,"div",18),c.Xb(84,"span",19),c.Yc(85,"$"),c.Wb(),c.Xb(86,"span",20),c.Yc(87),c.Wb(),c.Xb(88,"span"),c.Yc(89),c.Wb(),c.Wb(),c.Wb(),c.Xb(90,"div",21),c.Xb(91,"div"),c.Xb(92,"div",22),c.Yc(93," per seat / month"),c.Wb(),c.Wb(),c.Wb(),c.Xb(94,"div",23),c.Wc(95,ud,2,1,"a",24),c.Wc(96,dd,2,0,"span",25),c.Wb(),c.Xb(97,"ul",26),c.Xb(98,"li"),c.Xb(99,"span",29),c.Yc(100,"All STANDARD features"),c.Wb(),c.Wb(),c.Wc(101,hd,4,2,"li",27),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(102,"div",31),c.Xb(103,"div",12),c.Xb(104,"div",13),c.Xb(105,"span",14),c.Yc(106,"ENTERPRISE"),c.Wb(),c.Wb(),c.Xb(107,"div",13),c.Xb(108,"span",15),c.Yc(109,"Control & Security"),c.Wb(),c.Wb(),c.Xb(110,"div",32),c.Xb(111,"div",17),c.Xb(112,"div",18),c.Xb(113,"span",19),c.Yc(114,"$"),c.Wb(),c.Xb(115,"span",20),c.Yc(116),c.Wb(),c.Xb(117,"span"),c.Yc(118),c.Wb(),c.Wb(),c.Wb(),c.Xb(119,"div",21),c.Xb(120,"div"),c.Xb(121,"div",22),c.Yc(122," per seat / month"),c.Wb(),c.Wb(),c.Wb(),c.Xb(123,"div",23),c.Wc(124,md,2,1,"a",24),c.Wc(125,gd,2,0,"span",25),c.Wb(),c.Xb(126,"ul",26),c.Xb(127,"li"),c.Xb(128,"span",29),c.Yc(129,"All PRO features"),c.Wb(),c.Wb(),c.Wc(130,vd,4,2,"li",27),c.Wb(),c.Xb(131,"div",33),c.Sb(132,"hr"),c.Xb(133,"div"),c.Xb(134,"span"),c.Yc(135,"Want to keep on private server? "),c.Wb(),c.Xb(136,"a",34),c.Sb(137,"img",35),c.Wb(),c.Wb(),c.Xb(138,"div"),c.Xb(139,"a",36),c.Yc(140,"Contact sales"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(141,wd,6,4,"ng-template",null,37,c.Xc),c.Wc(143,yd,1,0,"ng-template",null,38,c.Xc),c.Wc(145,Wd,1,4,"ng-template",null,39,c.Xc),c.Wc(147,Cd,1,1,"ng-template",null,40,c.Xc)),2&e){const e=c.Lc(6);c.Cb(4),c.wc("ngIf","FREE"!==t.currentPaymentType.value&&"TRIAL"!==t.currentPaymentType.value)("ngIfElse",e),c.Cb(5),c.Hb("cl-active",t.isMonthly),c.Cb(3),c.Hb("cl-active",!t.isMonthly),c.Cb(20),c.ad(" ",t.isMonthly?t.paymentType.BASIC_2021.price:t.paymentType.BASIC_YEAR_2021.price," "),c.Cb(2),c.Zc(t.isMonthly?t.paymentType.BASIC_2021.fullPrice.toString().split(".")[1]:t.paymentType.BASIC_YEAR_2021.fullPrice.toString().split(".")[1]),c.Cb(6),c.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.BASIC_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.BASIC_YEAR_2021.value),c.Cb(1),c.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.BASIC_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.BASIC_YEAR_2021.value),c.Cb(2),c.wc("ngForOf",t.BASIC_2021_FEATURE_TYPES),c.Cb(15),c.ad(" ",t.isMonthly?t.paymentType.STANDARD_2021.price:t.paymentType.STANDARD_YEAR_2021.price," "),c.Cb(2),c.Zc(t.isMonthly?t.paymentType.STANDARD_2021.fullPrice.toString().split(".")[1]:t.paymentType.STANDARD_YEAR_2021.fullPrice.toString().split(".")[1]),c.Cb(6),c.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.STANDARD_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.STANDARD_YEAR_2021.value),c.Cb(1),c.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.STANDARD_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.STANDARD_YEAR_2021.value),c.Cb(5),c.wc("ngForOf",t.STANDARD_2021_FEATURE_TYPES),c.Cb(15),c.ad(" ",t.isMonthly?t.paymentType.PRO_2021.price:t.paymentType.PRO_YEAR_2021.price," "),c.Cb(2),c.Zc(t.isMonthly?t.paymentType.PRO_2021.fullPrice.toString().split(".")[1]:t.paymentType.PRO_YEAR_2021.fullPrice.toString().split(".")[1]),c.Cb(6),c.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.PRO_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.PRO_YEAR_2021.value),c.Cb(1),c.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.PRO_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.PRO_YEAR_2021.value),c.Cb(5),c.wc("ngForOf",t.PRO_2021_FEATURE_TYPES),c.Cb(15),c.ad(" ",t.isMonthly?t.paymentType.ENTERPRISE_2021.price:t.paymentType.ENTERPRISE_YEAR_2021.price," "),c.Cb(2),c.Zc(t.isMonthly?t.paymentType.ENTERPRISE_2021.fullPrice.toString().split(".")[1]:t.paymentType.ENTERPRISE_YEAR_2021.fullPrice.toString().split(".")[1]),c.Cb(6),c.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.ENTERPRISE_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.ENTERPRISE_YEAR_2021.value),c.Cb(1),c.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.ENTERPRISE_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.ENTERPRISE_YEAR_2021.value),c.Cb(5),c.wc("ngForOf",t.ENTERPRISE_2021_FEATURE_TYPES)}},directives:[s.u,s.t,s.r,Ui.a,Uu,Vu,qu],encapsulation:2}),e})();const Sd=["successModal"],Id=["freeTrialModal"],Od=["trialExpiredModal"];function Xd(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",38),c.Xb(1,"span"),c.Yc(2," You're currently using the free version. "),c.Wb(),c.Xb(3,"a",39),c.jc("click",(function(){return c.Oc(e),c.nc().closeAlarm()})),c.Xb(4,"span"),c.Yc(5,"\xd7"),c.Wb(),c.Wb(),c.Wb()}}function Ed(e,t){1&e&&(c.Xb(0,"div",40),c.Xb(1,"span"),c.Yc(2,"You are currently using legacy pricing plan. Once you switch plans, it's impossible to go back to your old pricing plan."),c.Wb(),c.Wb())}function Td(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",41,42),c.jc("click",(function(){return c.Oc(e),c.Lc(1).blur()})),c.Yc(2," Schedule live demo "),c.Wb()}}function Dd(e,t){1&e&&(c.Xb(0,"a",43),c.Yc(1," Schedule live demo "),c.Wb())}function Rd(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",44),c.jc("click",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(79);return t.openFreeTrialDialog(i)})),c.Yc(1," Activate free trial now "),c.Wb()}}function Ad(e,t){if(1&e){const e=c.Yb();c.Xb(0,"p"),c.Yc(1," You can try out all the extra features (except for SSO, Custom subdomain, Control user account, and Import timesheets) for free for one whole week, no credit card required. "),c.Xb(2,"a",45),c.jc("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(79);return t.openFreeTrialDialog(i)})),c.Yc(3," Activate free trial now"),c.Wb(),c.Yc(4,"."),c.Wb()}}function jd(e,t){1&e&&(c.Xb(0,"p"),c.Yc(1," The free trial was already activated on this workspace. But, if you need more time to test things out, feel free to activate another trial in a new workspace. "),c.Wb())}function xd(e,t){if(1&e&&(c.Xb(0,"div",29),c.Xb(1,"div",30),c.Yc(2,"Can I try it out first?"),c.Wb(),c.Wc(3,Ad,5,0,"p",32),c.Wc(4,jd,2,0,"p",32),c.Wb()),2&e){const e=c.nc();c.Cb(3),c.wc("ngIf",!e.everHadSubscription),c.Cb(1),c.wc("ngIf",e.everHadSubscription)}}function Pd(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",46),c.jc("click",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(79);return t.openFreeTrialDialog(i)})),c.Yc(1,"free trial"),c.Wb()}}function Md(e,t){1&e&&(c.Xb(0,"span"),c.Yc(1,"free trial"),c.Wb())}function Yd(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",47),c.Xb(1,"div",48),c.Sb(2,"img",49),c.Wb(),c.Xb(3,"div",50),c.Yc(4,"Start free trial"),c.Wb(),c.Xb(5,"p",51),c.Yc(6," Try out all the additional features for one week, no credit card required! "),c.Wb(),c.Wb(),c.Xb(7,"div",52),c.Xb(8,"a",46),c.jc("click",(function(){return t.$implicit.close()})),c.Yc(9,"Nevermind"),c.Wb(),c.Xb(10,"button",53),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc().startFreeTrial(i)})),c.Yc(11," Start free trial "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(10),c.wc("disabled",e.inProgress)}}function Ld(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",47),c.Xb(1,"div",48),c.Sb(2,"img",54),c.Wb(),c.Xb(3,"div",50),c.Yc(4,"Success!"),c.Wb(),c.Xb(5,"p",51),c.Yc(6,"Your free 7-day trial has been activated. Go to workspace settings to enable all the extra features so you can try them out."),c.Wb(),c.Wb(),c.Xb(7,"div",52),c.Xb(8,"a",46),c.jc("click",(function(){return t.$implicit.close()})),c.Yc(9,"Close"),c.Wb(),c.Xb(10,"a",55),c.jc("click",(function(){c.Oc(e);const i=t.$implicit,n=c.nc();return i.close(),n.goToSettings()})),c.Yc(11,"Go to settings"),c.Wb(),c.Wb()}}function Fd(e,t){1&e&&(c.Xb(0,"div",47),c.Xb(1,"div",48),c.Sb(2,"img",49),c.Wb(),c.Xb(3,"div",50),c.Yc(4,"Trial expired"),c.Wb(),c.Xb(5,"p",51),c.Yc(6," The free trial was already activated on this workspace. If you need more time, activate trial in a new workspace."),c.Wb(),c.Wb(),c.Xb(7,"div",52),c.Xb(8,"a",46),c.jc("click",(function(){return t.$implicit.close()})),c.Yc(9,"Close"),c.Wb(),c.Wb())}let Nd=(()=>{class e{constructor(e,t,i,n,s,c){this.workspaceService=e,this.paymentService=t,this.activatedRoute=i,this.router=n,this.cd=s,this.modalService=c,this.everHadSubscription=!1,this.unsubscribe$=new mi.a}ngOnInit(){this.isForbiddenZone=ei.g.includes(Se.tz.guess()),this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,this.isAlarmOpen=!this.workspace.featureSubscriptionType||this.workspace.featureSubscriptionType===ku.b.TRIAL,this.currentPlan=this.workspace.featureSubscriptionType&&ku.a[this.workspace.featureSubscriptionType.replace("SPECIAL","PLUS")],this.isAlarmOpen=!this.workspace.featureSubscriptionType}),this.paymentService.everHadSubscription.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.everHadSubscription=e,this.hasSubscriptionResponse=!0,this.cd.markForCheck()}),this.paymentService.everHadSubscription.pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>this.checkTrialModal(e))}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}openFreeTrialDialog(e){this.modalService.open(e,{centered:!0})}startFreeTrial(e){this.inProgress||(this.inProgress=!0,this.paymentService.startFreeTrial().subscribe(()=>{this.workspaceService.getDefaultWorkspace(),this.inProgress=!1,e.close(),this.modalService.open(this.successModal,{centered:!0})},e=>{this.inProgress=!1}))}closeAlarm(){this.isAlarmOpen=!1}goToSettings(){this.router.navigate(["workspaces",this.workspace.id,"settings"])}checkTrialModal(e){if(this.workspace.featureSubscriptionType===ku.b.TRIAL)return;const t=this.activatedRoute.snapshot.queryParams.freeTrial;t&&"true"===t&&this.openFreeTrialDialog(e?this.trialExpiredModal:this.freeTrialModal)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(Cu.a),c.Rb(W.a),c.Rb(W.c),c.Rb(c.h),c.Rb(g.q))},e.\u0275cmp=c.Lb({type:e,selectors:[["upgrade"]],viewQuery:function(e,t){var i;1&e&&(c.ed(Sd,!0),c.ed(Id,!0),c.ed(Od,!0)),2&e&&(c.Kc(i=c.kc())&&(t.successModal=i.first),c.Kc(i=c.kc())&&(t.freeTrialModal=i.first),c.Kc(i=c.kc())&&(t.trialExpiredModal=i.first))},decls:84,vars:8,consts:[[1,"cl-page-wrapper"],["class","cl-mb-3 cl-alert cl-alert-info cl-alert-reset-main cl-alert-dismissible cl-fade cl-show",4,"ngIf"],["class","cl-alert cl-alert-warning cl-alert-reset-main cl-alert-dismissible cl-fade cl-show cl-mb-2",4,"ngIf"],[1,"cl-container-fluid","cl-d-print-none"],[1,"cl-row","cl-align-items-center"],[1,"cl-col"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end"],["href","https://clockify.me/help/getting-started/demo#paid-features-tour","target","_blank","class","cl-mr-3 cl-btn cl-btn-outline-primary",3,"click",4,"ngIf"],["href","https://clockify.me/help/contact/sales","target","_blank","class","cl-mr-3 cl-btn cl-btn-outline-primary",4,"ngIf"],["class","cl-btn cl-btn-primary",3,"click",4,"ngIf"],[1,"cl-container","cl-w-max-1200"],[1,"cl-upgrade-companies"],[1,"cl-h4","cl-mb-4"],[1,"cl-clients-logos-container"],["src","assets/clients-logos/Group1.svg"],["src","assets/clients-logos/Group2.svg"],["src","assets/clients-logos/Group3.svg"],["src","assets/clients-logos/Group4.svg"],["src","assets/clients-logos/Group5.svg"],["src","assets/clients-logos/Group6.svg"],["src","assets/clients-logos/Group7.svg"],["src","assets/clients-logos/Group8.svg"],["src","assets/clients-logos/Group9.svg"],["src","assets/clients-logos/Group10.svg"],[1,"cl-row","cl-mt-4"],[1,"cl-col-12"],[1,"cl-h1","cl-text-center","cl-mb-4"],[1,"cl-col-lg-6"],["class","cl-mb-4",4,"ngIf"],[1,"cl-mb-4"],[1,"cl-h2"],["class","cl-color-blue",3,"click",4,"ngIf"],[4,"ngIf"],["href","https://clockify.me/extra-features",1,"cl-color-blue"],["href","https://clockify.me/self-hosted-time-tracking-software",1,"cl-color-blue"],["freeTrialModal",""],["successModal",""],["trialExpiredModal",""],[1,"cl-mb-3","cl-alert","cl-alert-info","cl-alert-reset-main","cl-alert-dismissible","cl-fade","cl-show"],[1,"cl-close",3,"click"],[1,"cl-alert","cl-alert-warning","cl-alert-reset-main","cl-alert-dismissible","cl-fade","cl-show","cl-mb-2"],["href","https://clockify.me/help/getting-started/demo#paid-features-tour","target","_blank",1,"cl-mr-3","cl-btn","cl-btn-outline-primary",3,"click"],["demo",""],["href","https://clockify.me/help/contact/sales","target","_blank",1,"cl-mr-3","cl-btn","cl-btn-outline-primary"],[1,"cl-btn","cl-btn-primary",3,"click"],["data-toggle","modal","data-target","#modal-free-trial",1,"cl-color-blue",3,"click"],[1,"cl-color-blue",3,"click"],[1,"cl-modal-body","cl-text-center","cl-py-4"],[1,"cl-mb-3"],["src","assets/images/illustrations/start-free-trial.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-mb-0","cl-text-gray-6"],[1,"cl-modal-footer"],[1,"cl-btn","cl-btn-primary",3,"disabled","click"],["src","assets/images/illustrations/success.svg",1,"cl-img-fluid"],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Wc(1,Xd,6,0,"div",1),c.Wc(2,Ed,3,0,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"div",5),c.Xb(6,"div",6),c.Wc(7,Td,3,0,"a",7),c.Wc(8,Dd,2,0,"a",8),c.Wc(9,Rd,2,0,"a",9),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(10,"div",10),c.Sb(11,"upgrade-plans"),c.Xb(12,"div",11),c.Xb(13,"div",12),c.Yc(14,"Trusted by thousands of companies"),c.Wb(),c.Xb(15,"div"),c.Xb(16,"div",13),c.Sb(17,"img",14),c.Wb(),c.Xb(18,"div",13),c.Sb(19,"img",15),c.Wb(),c.Xb(20,"div",13),c.Sb(21,"img",16),c.Wb(),c.Xb(22,"div",13),c.Sb(23,"img",17),c.Wb(),c.Xb(24,"div",13),c.Sb(25,"img",18),c.Wb(),c.Xb(26,"div",13),c.Sb(27,"img",19),c.Wb(),c.Xb(28,"div",13),c.Sb(29,"img",20),c.Wb(),c.Xb(30,"div",13),c.Sb(31,"img",21),c.Wb(),c.Xb(32,"div",13),c.Sb(33,"img",22),c.Wb(),c.Xb(34,"div",13),c.Sb(35,"img",23),c.Wb(),c.Wb(),c.Wb(),c.Sb(36,"hr"),c.Xb(37,"div",24),c.Xb(38,"div",25),c.Xb(39,"div",26),c.Yc(40,"Frequently asked questions"),c.Wb(),c.Wb(),c.Xb(41,"div",27),c.Wc(42,xd,5,2,"div",28),c.Xb(43,"div",29),c.Xb(44,"div",30),c.Yc(45,"What is a seat?"),c.Wb(),c.Xb(46,"p"),c.Yc(47,"Each active user in your paid workspace requires one user seat. If you don't have an available seat, you won't be able to invite a new user. If you plan on adding more users, you can pay additional seats in advance."),c.Wb(),c.Wb(),c.Xb(48,"div",29),c.Xb(49,"div",30),c.Yc(50,"Can I switch between plans?"),c.Wb(),c.Xb(51,"p"),c.Yc(52,"Yes. When you switch to a higher plan, you'll immediately get new features and be charged a prorated price for that month. When you downgrade, you'll be switched to the downgraded plan once your current (higher) plan ends."),c.Wb(),c.Wb(),c.Wb(),c.Xb(53,"div",27),c.Xb(54,"div",29),c.Xb(55,"div",30),c.Yc(56,"Do you offer refunds?"),c.Wb(),c.Xb(57,"p"),c.Yc(58,"We don't offer refunds. But, if you were mistakenly charged due to system error, contact us and we'll immediately issue you a refund. If you wish to test extra features, we recommend activating the "),c.Wc(59,Pd,2,0,"a",31),c.Wc(60,Md,2,0,"span",32),c.Yc(61," first, before making any payment."),c.Wb(),c.Wb(),c.Xb(62,"div",29),c.Xb(63,"div",30),c.Yc(64,"What types of payment are supported?"),c.Wb(),c.Xb(65,"p"),c.Yc(66,"We support payments by credit card for all plans. We support wire transfers and purchase orders for "),c.Xb(67,"a",33),c.Yc(68,"ENTERPRISE "),c.Wb(),c.Yc(69," plan (annual billing, over 50 seats) and "),c.Xb(70,"a",34),c.Yc(71,"SERVER "),c.Wb(),c.Yc(72," plan."),c.Wb(),c.Wb(),c.Xb(73,"div",29),c.Xb(74,"div",30),c.Yc(75,"Are there any additional taxes?"),c.Wb(),c.Xb(76,"p"),c.Yc(77,"No, we take care of all the taxes. The price you see is what you'll get charged. You can enter your Tax ID, but it will only be used as an additional piece of information on your invoices."),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(78,Yd,12,1,"ng-template",null,35,c.Xc),c.Wc(80,Ld,12,0,"ng-template",null,36,c.Xc),c.Wc(82,Fd,10,0,"ng-template",null,37,c.Xc)),2&e&&(c.Cb(1),c.wc("ngIf",t.isAlarmOpen&&!t.workspace.featureSubscriptionType),c.Cb(1),c.wc("ngIf",t.currentPlan&&t.currentPlan.legacy),c.Cb(5),c.wc("ngIf",t.isForbiddenZone),c.Cb(1),c.wc("ngIf",!t.isForbiddenZone),c.Cb(1),c.wc("ngIf",t.hasSubscriptionResponse&&!t.everHadSubscription),c.Cb(33),c.wc("ngIf",t.hasSubscriptionResponse),c.Cb(17),c.wc("ngIf",!t.everHadSubscription),c.Cb(1),c.wc("ngIf",t.everHadSubscription))},directives:[s.u,kd],encapsulation:2}),e})(),Ud=(()=>{class e{constructor(e,t,i){this.workspaceService=e,this.router=t,this.authService=i}canActivate(e){const t=this.workspaceService.getLocalDefaultWorkspace();let i,n;i=t?Object(Jb.a)(t):this.workspaceService.getDefaultWorkspace();const s=this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(Yt.a)(1));let c;return s.subscribe(()=>n=!0),c=n?s:this.authService.getPermissionsForUser(),Object(la.a)(i,c).pipe(Object(Yt.a)(1),Object(Y.a)(t=>this.allowVisitPage(t[0],t[1],e)))}allowVisitPage(e,t,i){return e&&t?!(-1!==e.adminOnlyPages.indexOf(i.data.page)&&("TEAM"!==i.data.page||!this.authService.isAdminOrOwner())&&("PROJECT"!==i.data.page||!this.authService.isAdminOrOwner()&&!t.isProjectManager)&&("REPORTS"!==i.data.page||!(this.authService.isAdminOrOwner()||t.isProjectManager||t.isTeamManager))&&(this.router.navigate(["/tracker"]),1)):(this.router.navigate(["/tracker"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(c.fc(U.a),c.fc(W.c),c.fc(Ce.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var $d=i("avDW"),_d=i("UnIm"),Gd=i("9a6x"),Bd=i("Hf8F"),Vd=i("zDGq"),Hd=i("Ypq1"),zd=i("iO9P"),qd=i("lp//"),Kd=function(e){return e.TOP="TOP",e.BOTTOM="BOTTOM",e.ABSOLUTE="ABSOLUTE",e}({});let Zd=(()=>{class e{constructor(e){this.browserService=e,this.scrollStatus=Kd.TOP,this.unsubscribe$=new Ee.a,this.onScroll=()=>{const e=window.scrollY;if(this.isDesktop)try{this.asideElement||(this.asideElement=document.getElementById("sidebar-menu"));const t=window.innerHeight,i=this.asideElement.getBoundingClientRect(),n=i.height,s=i.top,c=e<this.lastScrollPosition||0;if(this.lastScrollPosition=e,0===e||t>=n)return void this.setSidebarToTop();if(c&&this.scrollStatus===Kd.TOP)return;if(!c&&this.scrollStatus===Kd.BOTTOM)return;if(s>=0){if(this.scrollStatus!==Kd.TOP)return void this.setSidebarToTop()}else if(t-s>=n&&this.scrollStatus!==Kd.BOTTOM)return this.asideElement.style.position="fixed",this.asideElement.style.bottom="0",this.asideElement.style.top="auto",void(this.scrollStatus=Kd.BOTTOM);if(this.scrollStatus!==Kd.ABSOLUTE)return this.asideElement.style.top=e+s+"px",this.asideElement.style.bottom="auto",this.asideElement.style.position="absolute",void(this.scrollStatus=Kd.ABSOLUTE)}catch(t){}},this.browserService.onHeightResize$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop&&this.onScroll()}),this.isDesktop=window.innerHeight>=ei.h,this.browserService.isBreakpointLg$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>this.isDesktop=e)}ngOnDestroy(){this.removeScrollListener(),this.unsubscribe$.next(!0),this.unsubscribe$.complete()}addScrollListener(){this.isListening||(this.isListening=!0,this.asideElement=document.getElementById("sidebar-menu"),window.addEventListener("scroll",this.onScroll),this.onScroll())}removeScrollListener(){this.isListening=!1,window.removeEventListener("scroll",this.onScroll),this.onScroll()}setSidebarToTop(){this.asideElement.style.position="fixed",this.asideElement.style.bottom="auto",this.asideElement.style.top="0",this.scrollStatus=Kd.TOP}disableBodyScroll(){try{const e=document.body;e&&e.classList.add("cl-scroll-0")}catch(e){}}enableBodyScroll(){try{const e=document.body;e&&e.classList.remove("cl-scroll-0")}catch(e){}}}return e.\u0275fac=function(t){return new(t||e)(c.fc(pi.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})(),Qd=(()=>{class e{constructor(e,t){this.browserService=e,this.uiSettingsService=t,this.unsubscribe$=new Ee.a,this.sidebarState$=new je.a(null),this.initState(),this.browserService.isBreakpointLg$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>this.isDesktop=e)}get isSidebarOpen(){return this._isSidebarOpen}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initState(){let e;if(this.isDesktop=window.innerWidth>=ei.h,this.isDesktop){e=this.uiSettingsService.getSettings(hi.b.IS_SIDEBAR_OPEN);const t=!0;e=void 0===e?t:e}else e=!1;this.setSidebar(e)}setSidebar(e){this._isSidebarOpen=e,this.sidebarState$.next(e),this.isDesktop&&this.uiSettingsService.setSettings(hi.b.IS_SIDEBAR_OPEN,e)}}return e.\u0275fac=function(t){return new(t||e)(c.fc(pi.a),c.fc(hi.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var Jd=i("4olG"),ep=i("yK97");let tp=(()=>{class e{transform(e){return Object(ws.b)(e/10)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=c.Qb({name:"stopwatchTime",type:e,pure:!0}),e})(),ip=(()=>{class e{constructor(e,t){this.stopWatchService=e,this.cd=t,this.offset=0,this.unsubscribe$=new Ee.a}ngOnInit(){this.subscribeToUpdateTime()}subscribeToUpdateTime(){this.time=this.stopWatchService.time(),this.stopWatchService.time$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.time=e+this.offset,this.cd.detectChanges()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(mc.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["stopwatch-seconds"],["","stopwatch-seconds",""]],inputs:{offset:"offset"},decls:2,vars:3,template:function(e,t){1&e&&(c.Yc(0),c.oc(1,"stopwatchTime")),2&e&&c.Zc(c.pc(1,1,t.time))},pipes:[tp],encapsulation:2,changeDetection:0}),e})();var np=i("enr5"),sp=i("3eYs"),cp=i("RZdV");const rp=["tooltipStopwatch"];function op(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",13),c.Xb(1,"div",14),c.Xb(2,"div",15),c.Yc(3,"Start time"),c.Wb(),c.Xb(4,"div",16),c.Xb(5,"input-time-ampm",17),c.jc("timeChanged",(function(t){return c.Oc(e),c.nc(3).startTimeChanged(t)})),c.Wb(),c.Wb(),c.Xb(6,"div",18),c.Yc(7),c.oc(8,"formatDateToday"),c.oc(9,"formatDate"),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc(3);c.Cb(5),c.wc("focusOnInput",!0)("dateTime",null==e.timeEntry||null==e.timeEntry.timeInterval?null:e.timeEntry.timeInterval.start),c.Cb(2),c.ad(" ",c.qc(8,3,c.pc(9,6,null==e.timeEntry||null==e.timeEntry.timeInterval?null:e.timeEntry.timeInterval.start),!1)," ")}}function ap(e,t){1&e&&(c.Vb(0),c.Wc(1,op,10,8,"div",12),c.Ub())}function lp(e,t){if(1&e&&(c.Xb(0,"div",9),c.Sb(1,"span",10),c.Wc(2,ap,2,0,"ng-container",11),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.Vc("cursor",e.disableManualMode?"default":"pointer"),c.Cb(1),c.wc("ngIf",!e.disableManualMode)}}function bp(e,t){1&e&&(c.Xb(0,"span",19),c.Yc(1,"00:00:00"),c.Wb())}function up(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"button",20),c.Yc(2,"Stop"),c.Wb(),c.Xb(3,"button",21),c.Yc(4,"Stop"),c.Wb(),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.wc("disabled",e.isDisabled||!e.isEntryInitialized),c.Cb(2),c.wc("disabled",e.isDisabled||!e.isEntryInitialized)}}function dp(e,t){if(1&e&&(c.Xb(0,"button",22),c.Yc(1,"Start"),c.Wb(),c.Xb(2,"button",23),c.Yc(3,"Start"),c.Wb()),2&e){const e=c.nc();c.wc("disabled",e.isDisabled||!e.isEntryInitialized),c.Cb(2),c.wc("disabled",e.isDisabled||!e.isEntryInitialized)}}function pp(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",31),c.Xb(1,"div",32),c.Xb(2,"div",33),c.Yc(3,"Are you sure?"),c.Wb(),c.Xb(4,"button",34),c.jc("keyup.space",(function(){return c.Oc(e),c.nc(2).cancelConfirmed()}))("keyup.enter",(function(){return c.Oc(e),c.nc(2).cancelConfirmed()}))("click",(function(){return c.Oc(e),c.nc(2).cancelConfirmed()})),c.Yc(5,"Discard"),c.Wb(),c.Sb(6,"span",35),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(4),c.wc("disabled",e.isDisabled||!(null!=e.timeEntry&&e.timeEntry.id))}}function hp(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",24),c.Xb(1,"div",25),c.Xb(2,"div",26),c.jc("click",(function(){return c.Oc(e),c.nc().onDropdownOpen()})),c.Xb(3,"a",27),c.Sb(4,"img",28),c.Wb(),c.Wb(),c.Xb(5,"div",29),c.jc("click",(function(){return c.Oc(e),c.nc().onDropdownOpen()})),c.Xb(6,"a",27),c.Sb(7,"img",28),c.Wb(),c.Wb(),c.Wc(8,pp,7,1,"div",30),c.Wb(),c.Wb()}}let mp=(()=>{class e{constructor(e,t,i,n,s,r,o,a){this.stopwatchService=e,this.entryHelper=t,this.cd=i,this.toaster=n,this.keyboardService=s,this.debouncerService=r,this.entryGroupService=o,this.trackerService=a,this.setEntry=new c.n,this.stopped=new c.n,this.canceled=new c.n,this.canceledFailed=new c.n,this.setInProgress=new c.n,this.unsubscribe$=new Ee.a}ngOnInit(){this.stopwatchService.stateChanged.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{e==mc.b.STARTED?(this.inProgress=!0,this.cd.detectChanges()):e==mc.b.STOPPED&&(this.inProgress=!1,this.cd.detectChanges())}),this.subscribeToKeyboard()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}startTimeChanged(e){const t=Se().utc(),i=Se.utc(e);for(Se.duration(t.diff(i)).asMilliseconds()>864e4&&(e=i.add(1,"days").toISOString());Se(e).isAfter(Se(t));)e=i.subtract(1,"days").toISOString();const n=this.timeEntry.timeInterval.start;this.timeEntry.timeInterval.start=e,this.setStart(e),this.debouncerService.debouncer$.pipe(Object(Yt.a)(1),Object(It.a)(e=>e),Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.trackerService.editStartTime(this.timeEntry.id,e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{},e=>{this.timeEntry.timeInterval.start=n,this.setStart(n)})}),this.debouncerService.next(!0)}start(e){this.inProgress||this.isDisabled||setTimeout(()=>{this.stopwatchService.start(),this.timeEntry.timeInterval=new ep.a({start:Se().toISOString()}),this.isDisabled=!0,this.cd.detectChanges(),this.trackerService.addStartedTimeEntry(e||this.timeEntry).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isDisabled=!1,this.cd.detectChanges(),this.setEntry.emit(e)},e=>{this.isDisabled=!1,this.cd.detectChanges(),this.stopwatchService.stop()})},2)}onDropdownOpen(){this.debouncerService.reset()}stop(e,t=!1){this.isDisabled||setTimeout(()=>{this.entryHelper.isValid(this.timeEntry)&&(this.debouncerService.next(!1),this.stopwatchService.stop(),this.isDisabled=!0,this.cd.detectChanges(),this.trackerService.stopwatchStopped(this.timeEntry).pipe(Object(De.a)(this.unsubscribe$)).subscribe(i=>{if(this.isDisabled=!1,this.cd.detectChanges(),!i.timeInterval.end)return this.setStart(this.timeEntry.timeInterval.start),void this.toaster.pop("error","Stop time entry failed. Please try again.");e?this.start(e):t?this.start():this.stopped.emit({billable:this.timeEntry.billable}),this.entryGroupService.setNewEntryCreated(i)},e=>{this.isDisabled=!1,this.cd.detectChanges(),this.setStart(this.timeEntry.timeInterval.start)}))},2)}toggleStartStop(){this.isDisabled||(this.inProgress?this.stop():this.start())}cancelConfirmed(){this.stopwatchService.stop();const e=At.a.clone(this.timeEntry);this.canceled.emit(),this.isDisabled=!0,this.cd.detectChanges(),this.trackerService.deleteTimeEntry(e,{success:"Timer cancelled.",error:"Failed to cancel the running timer, please try again."}).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.isDisabled=!1,this.cd.detectChanges()},t=>{this.isDisabled=!1,this.cd.detectChanges(),this.canceledFailed.emit(e),this.setStart(e.timeInterval.start)})}setStart(e){const t=new Date(e).getTime()/100;this.stopwatchService.setStart(t)}subscribeToKeyboard(){this.keyboardService.keyboardRecorder$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{e===ya.g&&this.inProgress&&this.stop()})}showTooltip(){this.tooltipStopwatch&&this.tooltipStopwatch.open()}closeTooltip(){this.tooltipStopwatch&&this.tooltipStopwatch.close()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(mc.a),c.Rb(Gd.a),c.Rb(c.h),c.Rb(M.a),c.Rb(Vd.a),c.Rb(Re),c.Rb(_d.a),c.Rb($d.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["stopwatch"],["","stopwatch",""]],viewQuery:function(e,t){var i;1&e&&c.ed(rp,!0),2&e&&c.Kc(i=c.kc())&&(t.tooltipStopwatch=i.first)},inputs:{isEntryInitialized:"isEntryInitialized",timeEntryDate:"timeEntryDate",disableManualMode:"disableManualMode",timeEntry:"timeEntry"},outputs:{setEntry:"setEntry",stopped:"stopped",canceled:"canceled",canceledFailed:"canceledFailed",setInProgress:"setInProgress"},decls:11,vars:6,consts:[[1,"cl-component-divided-left","cl-d-md-inline-flex","cl-cursor-default"],["dropdown","","class","cl-relative",4,"ngIf","ngIfElse"],["stopwatchTime",""],[1,"cl-d-flex","cl-align-items-center","cl-relative"],["triggers","manual","ngbTooltip","Start timer","placement","bottom","tabindex","0",3,"autoClose","keyup.space","keyup.enter","click"],["tooltipStopwatch","ngbTooltip"],[4,"ngIf","ngIfElse"],["start",""],["class","cl-stopwatch-discard-wrapper",4,"ngIf"],["dropdown","",1,"cl-relative"],["stopwatch-seconds","",1,"cl-form-control","cl-input-time-picker-sum"],[4,"ngIf"],["class","cl-dropdown-menu cl-dropdown-menu-right cl-p-3",4,"dropdownContent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right","cl-p-3"],[1,"cl-d-flex","cl-align-items-center","cl-stopwatch-dropdown-wrapper"],[1,"cl-h5","cl-mb-0","cl-stopwatch-dropdown-label"],[1,"cl-ml-2","cl-mr-3","cl-stopwatch-dropdown-input"],[3,"focusOnInput","dateTime","timeChanged"],[1,"cl-stopwatch-dropdown-day","cl-cursor-default"],[1,"cl-form-control","cl-input-time-picker-sum"],["tabIndex","-1","title","Stop (s)",1,"cl-btn","cl-btn-danger","cl-d-none","cl-d-lg-custom-block",3,"disabled"],["tabIndex","-1","title","Stop (s)",1,"cl-btn","cl-btn-danger","cl-btn-sm","cl-d-block","cl-d-lg-custom-none",3,"disabled"],["tabIndex","-1",1,"cl-btn","cl-btn-primary","cl-d-none","cl-d-lg-custom-block",3,"disabled"],["tabIndex","-1",1,"cl-btn","cl-btn-primary","cl-btn-sm","cl-d-block","cl-d-lg-custom-none",3,"disabled"],[1,"cl-stopwatch-discard-wrapper"],["dropdownKey","",1,"cl-stopwatch-discard"],["dropdownKeyButton","","tabindex","0",1,"cl-d-block","cl-d-lg-custom-none",3,"click"],[1,"cl-timetracker-switch"],["src","assets/images/ui-icons/close.svg"],["dropdownKeyButton","","tabindex","0",1,"cl-d-none","cl-d-lg-custom-flex","cl-align-items-center","cl-h-100",3,"click"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-d-flex","cl-align-items-center","cl-px-3","cl-py-2"],[1,"cl-cut-text","cl-mr-3"],["tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled","keyup.space","keyup.enter","click"],["dropdownClose","","tabindex","0"]],template:function(e,t){if(1&e&&(c.Xb(0,"div",0),c.Wc(1,lp,3,3,"div",1),c.Wc(2,bp,2,0,"ng-template",null,2,c.Xc),c.Wb(),c.Xb(4,"div",3),c.Xb(5,"div",4,5),c.jc("keyup.space",(function(){return t.toggleStartStop()}))("keyup.enter",(function(){return t.toggleStartStop()}))("click",(function(){return t.toggleStartStop()})),c.Wc(7,up,5,2,"ng-container",6),c.Wc(8,dp,4,2,"ng-template",null,7,c.Xc),c.Wb(),c.Wb(),c.Wc(10,hp,9,0,"div",8)),2&e){const e=c.Lc(3),i=c.Lc(9);c.Cb(1),c.wc("ngIf",t.inProgress)("ngIfElse",e),c.Cb(4),c.wc("autoClose","inside"),c.Cb(2),c.wc("ngIf",t.inProgress)("ngIfElse",i),c.Cb(3),c.wc("ngIf",t.inProgress)}},directives:[s.u,g.Z,Es.a,ip,Ts.a,np.a,Si.a,Ii.a,Oi.a],pipes:[sp.a,cp.a],styles:["[_nghost-%COMP%]     input-time-ampm{display:block}[_nghost-%COMP%]     input-time-ampm input{width:100%;text-align:center!important}"],changeDetection:0}),e})();var gp=i("VYrk"),fp=i("PqYM"),vp=i("l7GE"),wp=i("ZUHj");class yp{constructor(e){this.durationSelector=e}call(e,t){return t.subscribe(new Wp(e,this.durationSelector))}}class Wp extends vp.a{constructor(e,t){super(e),this.durationSelector=t,this.hasValue=!1,this.durationSubscription=null}_next(e){try{const t=this.durationSelector.call(this,e);t&&this._tryNext(e,t)}catch(t){this.destination.error(t)}}_complete(){this.emitValue(),this.destination.complete()}_tryNext(e,t){let i=this.durationSubscription;this.value=e,this.hasValue=!0,i&&(i.unsubscribe(),this.remove(i)),i=Object(wp.a)(this,t),i&&!i.closed&&this.add(this.durationSubscription=i)}notifyNext(e,t,i,n,s){this.emitValue()}notifyComplete(){this.emitValue()}emitValue(){if(this.hasValue){const e=this.value,t=this.durationSubscription;t&&(this.durationSubscription=null,t.unsubscribe(),this.remove(t)),this.value=null,this.hasValue=!1,super._next(e)}}}var Cp=i("/uUt"),kp=i("GidR"),Sp=i("V3bs"),Ip=i("Nu56");const Op=["autocompleteInput"],Xp=["dropdownKeyRef"];function Ep(e,t){if(1&e&&(c.Xb(0,"div",16),c.Yc(1),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(1),c.ad(" ",e.description," ")}}function Tp(e,t){1&e&&c.Sb(0,"span",21)}function Dp(e,t){if(1&e&&(c.Xb(0,"div",17),c.Xb(1,"span"),c.Sb(2,"i",18),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wb(),c.Wc(5,Tp,1,0,"span",19),c.Xb(6,"span",20),c.Yc(7),c.Wb(),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(1),c.Vc("color",e.project.color),c.Cb(1),c.Vc("background-color",e.project.color),c.Cb(2),c.bd("",e.project.name,"",e.task?": "+e.task.name:"",""),c.Cb(1),c.wc("ngIf",e.project.clientName),c.Cb(2),c.Zc(e.project.clientName)}}function Rp(e,t){if(1&e&&c.Sb(0,"tag-names-text-only",22),2&e){const e=c.nc().$implicit;c.wc("tags",e.tags)("hideAddingTags",!0)}}function Ap(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",11),c.jc("keyup.enter",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).selectEntry(i)}))("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).selectEntry(i)})),c.Xb(1,"div",12),c.Wc(2,Ep,2,1,"div",13),c.Wc(3,Dp,8,8,"div",14),c.Wc(4,Rp,1,2,"tag-names-text-only",15),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit;c.Hb("angular-autocomplete-last",t.last),c.Cb(2),c.wc("ngIf",e.description),c.Cb(1),c.wc("ngIf",e.project),c.Cb(1),c.wc("ngIf",e.tags)}}function jp(e,t){if(1&e&&(c.Xb(0,"div",6),c.Xb(1,"div",7),c.Xb(2,"div",8),c.Wc(3,Ap,5,5,"div",9),c.oc(4,"slice"),c.Sb(5,"span",10),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(3),c.wc("ngForOf",c.rc(4,1,e.timeEntries,0,8))}}function xp(e,t){1&e&&(c.Vb(0),c.Wc(1,jp,6,5,"div",5),c.Ub())}let Pp=(()=>{class e{constructor(e,t){this.trackerService=e,this.cd=t,this.description="",this.descriptionBackup="",this.placeholder="",this.clearCacheOnEntryChange=!0,this.onFocus=new c.n,this.onEnter=new c.n,this.onChange=new c.n,this.onSelect=new c.n,this.descriptionDebouncer$=new Ee.a,this.unsubscribe$=new Ee.a,this.ignoreKeys=[ya.a,ya.b,ya.d,ya.i],this.latestSearch={},this.isCacheClear=!1,this.hasNoResults=[]}set descriptionSetter(e){this.description=e||"",this.descriptionBackup=e||""}ngOnInit(){this.trackerService.clearLastesEntriesCache(),this.subscribeToDebouncer(),this.subscribeToEntryChange(),this.autofocus&&this.focusToInput()}ngOnDestroy(){this.unsubscribeSub(),this.unsubscribe$.next(!0),this.unsubscribe$.complete()}keydown(e){this.ignoreKeys.includes(e.keyCode||e.which)||this.isInputElementInFocus()||this.focusToInput()}unsubscribeSub(){this.descriptionSub&&this.descriptionSub.unsubscribe()}subscribeToEntryChange(){this.clearCacheOnEntryChange&&this.trackerService.clearAutocompleteCache$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.isCacheClear=!0,this.trackerService.clearLastesEntriesCache(),this.hasNoResults=[]})}onDropdownClose(){this.isAutocompleteSelected?this.isAutocompleteSelected=!1:setTimeout(()=>{this.isInputElementInFocus()||this.emit()})}blur(){setTimeout(()=>{this.isDropdownInFocus()||this.emit()})}emit(){const e=this.description.trim();e!==this.descriptionBackup&&this.onChange.emit(e)}focusToInput(){this.autocompleteInput.nativeElement.focus()}onModelChange(){this.descriptionDebouncer$.next({description:this.description,event:"onModelChange"})}subscribeToDebouncer(){var e;this.descriptionSub=this.descriptionDebouncer$.pipe((e=e=>Object(fp.a)("onModelChange"===e.event?400:0),t=>t.lift(new yp(e))),Object(Cp.a)((e,t)=>e.description===t.description&&!this.isCacheClear&&"onModelChange"===t.event),Object(wa.a)(({description:e,event:t})=>(this.latestSearch={description:e,event:t},this.isCacheClear=!1,1===e.length?(this.skipRequest=!0,Object(Jb.a)([])):(this.skipRequest=this.hasNoResults.some(t=>e.startsWith(t)),this.skipRequest?Object(Jb.a)([]):e?this.trackerService.getAutocomplete(e):this.trackerService.getLatestEntries(!0)))),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.timeEntries=e.filter(e=>e.id!==this.id);const t=!this.timeEntries.length;t&&!this.skipRequest&&1!==this.latestSearch.description.length&&(this.hasNoResults=this.hasNoResults.slice(0,100),this.hasNoResults.push(this.latestSearch.description)),t?this.dropdownKeyRef.closeDropdown():(this.showDropdown(),this.cd.detectChanges())},()=>{this.unsubscribeSub(),this.subscribeToDebouncer()})}shouldHideDropdown(e,t){return"onModelChange"===e&&!t}showDropdown(){var e;this.isComponentInFocus()&&(null===(e=this.timeEntries)||void 0===e?void 0:e.length)&&(this.dropdownKeyRef.showDropdown(),this.cd.detectChanges())}isInputElementInFocus(){return document.activeElement===this.autocompleteInput.nativeElement}isDropdownInFocus(){return document.activeElement.hasAttribute("autocompleteSuggestionElement")}isComponentInFocus(){return this.dropdownKeyRef.isElementInside(document.activeElement)}selectEntry(e){this.isAutocompleteSelected=!0;const t=kp.a.clone(e);this.onSelect.emit(t),this.dropdownKeyRef.closeDropdown()}focus(){this.onFocus.emit()}click(){this.checkAutocompleteDropdown("focus")}enter(){this.onEnter.emit(this.description.trim())}checkAutocompleteDropdown(e){setTimeout(()=>{this.latestSearch.description!==this.description||this.isCacheClear?this.descriptionDebouncer$.next({description:this.description,event:e}):this.showDropdown()})}onArrowUp(){try{document.getElementsByClassName("angular-autocomplete-last")[0].focus()}catch(e){}}onArrowDown(){this.checkAutocompleteDropdown("arrowDown")}}return e.\u0275fac=function(t){return new(t||e)(c.Rb($d.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["autocomplete-input"]],viewQuery:function(e,t){var i;1&e&&(c.Uc(Op,!0),c.ed(Xp,!0)),2&e&&(c.Kc(i=c.kc())&&(t.autocompleteInput=i.first),c.Kc(i=c.kc())&&(t.dropdownKeyRef=i.first))},hostBindings:function(e,t){1&e&&c.jc("keydown",(function(e){return t.keydown(e)}))},inputs:{id:"id",descriptionSetter:["description","descriptionSetter"],placeholder:"placeholder",autofocus:"autofocus",clearCacheOnEntryChange:"clearCacheOnEntryChange"},outputs:{onFocus:"onFocus",onEnter:"onEnter",onChange:"onChange",onSelect:"onSelect"},decls:5,vars:4,consts:[["tabCell","","dropdownKey","",1,"cl-position-relative",3,"onClose"],["dropdownKeyRef","dropdownKey"],["type","text","tabindex","0","name","autocomplete-input","spellcheck","true","autocomplete","off",1,"cl-form-control","cl-input-timetracker-main","cl-cut-text",3,"ngModel","placeholder","ngModelChange","click","focus","blur","keyup.enter","keyup.arrowup","keyup.arrowdown"],["autocompleteInput",""],[4,"ngIf"],["arrowNavigation","","class","cl-dropdown cl-dropdown-large",4,"dropdownKeyContent"],["arrowNavigation","",1,"cl-dropdown","cl-dropdown-large"],[1,"cl-dropdown-menu","cl-w-100","cl-overflow-hidden","cl-autocomplete-dropdown"],["tabindex","0","autocompleteSuggestionElement","",1,"cl-no-focus-tabindex"],["class","cl-dropdown-item pointer cl-no-focus-tabindex","tabindex","-1","autocompleteSuggestionElement","",3,"angular-autocomplete-last","keyup.enter","click",4,"ngFor","ngForOf"],["dropdownClose","","tabindex","0"],["tabindex","-1","autocompleteSuggestionElement","",1,"cl-dropdown-item","pointer","cl-no-focus-tabindex",3,"keyup.enter","click"],[1,"cl-d-flex"],["class","cl-mr-2 cl-cut-text",4,"ngIf"],["class","cl-project-name cl-project-name-colored cl-mr-2 cl-cut-text",4,"ngIf"],["class","cl-d-flex","style","height: 21px;",3,"tags","hideAddingTags",4,"ngIf"],[1,"cl-mr-2","cl-cut-text"],[1,"cl-project-name","cl-project-name-colored","cl-mr-2","cl-cut-text"],[1,"cl-entry__project__dot"],["class","cl-h-line-divider",4,"ngIf"],[1,"cl-listing-client"],[1,"cl-h-line-divider"],[1,"cl-d-flex",2,"height","21px",3,"tags","hideAddingTags"]],template:function(e,t){1&e&&(c.Xb(0,"div",0,1),c.jc("onClose",(function(){return t.onDropdownClose()})),c.Xb(2,"input",2,3),c.jc("ngModelChange",(function(e){return t.description=e}))("click",(function(){return t.click()}))("focus",(function(){return t.focus()}))("blur",(function(){return t.blur()}))("ngModelChange",(function(){return t.onModelChange()}))("keyup.enter",(function(){return t.enter()}))("keyup.arrowup",(function(){return t.onArrowUp()}))("keyup.arrowdown",(function(){return t.onArrowDown()})),c.Wb(),c.Wc(4,xp,2,0,"ng-container",4),c.Wb()),2&e&&(c.Cb(2),c.wc("ngModel",t.description)("placeholder",t.placeholder),c.Db("title",t.description),c.Cb(2),c.wc("ngIf",null==t.timeEntries?null:t.timeEntries.length))},directives:[Si.a,p.c,p.s,p.v,s.u,Oi.a,Sp.a,s.t,Ip.a],pipes:[s.F],encapsulation:2,changeDetection:0}),e})();var Mp=i("nss9"),Yp=i("pCWH"),Lp=i("okBH");function Fp(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=t.$implicit,i=t.last;c.Cb(1),c.bd(" ",e.name,"",i?"":", "," ")}}function Np(e,t){if(1&e&&(c.Xb(0,"div",5),c.Xb(1,"span",6),c.Wc(2,Fp,2,2,"span",7),c.oc(3,"sortBy"),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.Db("title",e.attributeTitle),c.Cb(1),c.wc("ngForOf",c.qc(3,3,e.tags,e.sortByNameMapper))("ngForTrackBy",e.trackByFn)}}function Up(e,t){1&e&&(c.Xb(0,"div",8),c.Sb(1,"img",9),c.Xb(2,"div",10),c.Xb(3,"a",11),c.Yc(4,"Add tags"),c.Wb(),c.Wb(),c.Wb())}function $p(e,t){1&e&&c.Sb(0,"img",12)}function _p(e,t){1&e&&c.Sb(0,"img",13)}let Gp=(()=>{class e{constructor(){this.sortByNameMapper=e=>e.name}set tags(e){this._tags=e,this.attributeTitle="",e&&e.forEach(e=>{this.attributeTitle+=e.name+"\n"})}get tags(){return this._tags}ngOnInit(){}trackByFn(e,t){return t.id}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["tag-names"]],inputs:{tags:"tags"},decls:7,vars:4,consts:[["class","cl-component-divided-left cl-dropdown-toggle cl-no-arrow cl-w-100\n            cl-no-divider-border cl-cut-text-wrapper cl-d-none cl-d-lg-custom-flex tt-entry-show-mob",4,"ngIf","ngIfElse"],["tagIcon",""],[1,"cl-component-divided-left","cl-dropdown-toggle","cl-no-arrow","cl-remove-divider-mob","cl-d-flex","cl-d-lg-custom-none","tt-entry-hide-mob"],["src","assets/images/ui-icons/tag-blue.svg",4,"ngIf","ngIfElse"],["tagIconMobile",""],[1,"cl-component-divided-left","cl-dropdown-toggle","cl-no-arrow","cl-w-100","cl-no-divider-border","cl-cut-text-wrapper","cl-d-none","cl-d-lg-custom-flex","tt-entry-show-mob"],[1,"cl-badge","cl-badge-tag","cl-badge-tag-timetracker-entry"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"cl-component-divided-left","cl-dropdown-toggle","cl-no-arrow","cl-d-none","cl-d-lg-custom-flex","tt-entry-show-mob"],["src","assets/images/ui-icons/tag-gray.svg",1,"tag-icon"],[1,"tag-text"],[1,"cl-btn","cl-btn-sm","cl-btn-outline-light"],["src","assets/images/ui-icons/tag-blue.svg"],["src","assets/images/ui-icons/tag-gray.svg"]],template:function(e,t){if(1&e&&(c.Wc(0,Np,4,6,"div",0),c.Wc(1,Up,5,0,"ng-template",null,1,c.Xc),c.Xb(3,"div",2),c.Wc(4,$p,1,0,"img",3),c.Wc(5,_p,1,0,"ng-template",null,4,c.Xc),c.Wb()),2&e){const e=c.Lc(2),i=c.Lc(6);c.wc("ngIf",(null==t.tags?null:t.tags.length)>0)("ngIfElse",e),c.Cb(4),c.wc("ngIf",(null==t.tags?null:t.tags.length)>0)("ngIfElse",i)}},directives:[s.u,s.t],pipes:[Lp.a],styles:[""],changeDetection:0}),e})();var Bp=i("FfKB"),Vp=i("GAki"),Hp=i("1YN2"),zp=i("MPSC"),qp=i("4Seb");function Kp(e,t){if(1&e&&(c.Xb(0,"a",18),c.Sb(1,"img",19),c.Yc(2," Manual "),c.Wb()),2&e){const e=c.nc(3);c.Hb("cl-active",e.isManual)}}function Zp(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",20),c.jc("click",(function(){return c.Oc(e),c.nc(3).setManualState(!0)}))("keyup.enter",(function(){return c.Oc(e),c.nc(3).setManualState(!0)}))("keyup.space",(function(){return c.Oc(e),c.nc(3).setManualState(!0)})),c.Sb(1,"img",17),c.Yc(2," Manual "),c.Wb()}if(2&e){const e=c.nc(3);c.Hb("cl-active",e.isManual),c.Cb(1),c.wc("src",e.isManual?"assets/images/ui-icons/list-blue.svg":"assets/images/ui-icons/list-gray.svg",c.Qc)}}function Qp(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",13),c.Xb(1,"list-items"),c.Wc(2,Kp,3,2,"a",14),c.Wc(3,Zp,3,3,"a",15),c.Xb(4,"a",16),c.jc("click",(function(){return c.Oc(e),c.nc(2).setManualState(!1)}))("keyup.enter",(function(){return c.Oc(e),c.nc(2).setManualState(!1)}))("keyup.space",(function(){return c.Oc(e),c.nc(2).setManualState(!1)})),c.Sb(5,"img",17),c.Yc(6," Timer "),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(2),c.wc("ngIf",e.disableManualMode),c.Cb(1),c.wc("ngIf",!e.disableManualMode),c.Cb(1),c.Hb("cl-active",!e.isManual),c.Cb(1),c.wc("src",e.isManual?"assets/images/ui-icons/clock-gray.svg":"assets/images/ui-icons/clock-blue.svg",c.Qc)}}function Jp(e,t){1&e&&(c.Xb(0,"div",7),c.Xb(1,"div",8),c.Xb(2,"a",9),c.Sb(3,"img",10),c.Wb(),c.Wc(4,Qp,7,5,"div",11),c.Sb(5,"span",12),c.Wb(),c.Wb())}function eh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",21),c.jc("click",(function(){return c.Oc(e),c.nc().setIsManual.emit(!0)}))("keyup.enter",(function(){return c.Oc(e),c.nc().setIsManual.emit(!0)}))("keyup.space",(function(){return c.Oc(e),c.nc().setIsManual.emit(!0)})),c.Sb(1,"img",22),c.Wb()}if(2&e){const e=c.nc();c.Hb("grayscale",!e.isManual)}}function th(e,t){1&e&&(c.Xb(0,"a",23),c.Sb(1,"img",22),c.Wb())}let ih=(()=>{class e{constructor(){this.setIsManual=new c.n}ngOnInit(){}setManualState(e){e&&this.disableManualMode||this.setIsManual.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["modes-btns"]],inputs:{isManual:"isManual",disableManualMode:"disableManualMode"},outputs:{setIsManual:"setIsManual"},decls:7,vars:7,consts:[[1,"cl-px-lg-custom-2"],["class","cl-d-block cl-d-lg-custom-none","dropdownKey","","tabCell","",4,"ngIf"],[1,"cl-d-none","cl-d-lg-custom-block"],["tabindex","0","title","Timer (n)",1,"cl-timetracker-switch",3,"click","keyup.enter","keyup.space"],["src","assets/images/ui-icons/clock-blue.svg"],["tabindex","0","class","cl-timetracker-switch","title","Manual (m)",3,"grayscale","click","keyup.enter","keyup.space",4,"ngIf"],["class","cl-timetracker-switch cl-cursor-default grayscale","ngbTooltip","Manual mode disabled",4,"ngIf"],["dropdownKey","","tabCell","",1,"cl-d-block","cl-d-lg-custom-none"],[1,"cl-dropdown","cl-px-0"],["dropdownKeyButton","","tabindex","0",1,"cl-d-flex","cl-px-3","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["tabFocus","","tabindex","0"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],["class","cl-dropdown-item cl-d-flex cl-align-items-center cl-cursor-default","ngbTooltip","Manual mode disabled",3,"cl-active",4,"ngIf"],["class","cl-dropdown-item cl-d-flex cl-align-items-center","title","Manual (m)","tabindex","-1","clickCloseDropdown","",3,"cl-active","click","keyup.enter","keyup.space",4,"ngIf"],["title","Timer (n)","tabindex","-1","clickCloseDropdown","",1,"cl-dropdown-item","cl-d-flex","cl-align-items-center",3,"click","keyup.enter","keyup.space"],["clickCloseDropdown","",1,"cl-mr-2",3,"src"],["ngbTooltip","Manual mode disabled",1,"cl-dropdown-item","cl-d-flex","cl-align-items-center","cl-cursor-default"],["src","assets/images/ui-icons/list-gray.svg",1,"cl-mr-2"],["title","Manual (m)","tabindex","-1","clickCloseDropdown","",1,"cl-dropdown-item","cl-d-flex","cl-align-items-center",3,"click","keyup.enter","keyup.space"],["tabindex","0","title","Manual (m)",1,"cl-timetracker-switch",3,"click","keyup.enter","keyup.space"],["src","assets/images/ui-icons/list-blue.svg"],["ngbTooltip","Manual mode disabled",1,"cl-timetracker-switch","cl-cursor-default","grayscale"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Wc(1,Jp,6,0,"div",1),c.Xb(2,"div",2),c.Xb(3,"a",3),c.jc("click",(function(){return t.setManualState(!1)}))("keyup.enter",(function(){return t.setManualState(!1)}))("keyup.space",(function(){return t.setManualState(!1)})),c.Sb(4,"img",4),c.Wb(),c.Wc(5,eh,2,2,"a",5),c.Wc(6,th,2,0,"a",6),c.Wb(),c.Wb()),2&e&&(c.Hb("cl-mr-1",t.disableManualMode&&!t.isManual),c.Cb(1),c.wc("ngIf",!t.disableManualMode||t.isManual),c.Cb(2),c.Hb("grayscale",t.isManual),c.Cb(2),c.wc("ngIf",!t.disableManualMode),c.Cb(1),c.wc("ngIf",t.disableManualMode))},directives:[s.u,Si.a,Ii.a,Oi.a,Ni.a,g.Z],encapsulation:2,changeDetection:0}),e})();var nh=i("pOhx");const sh=["stopwatch"],ch=["tooltipDescription"],rh=["tooltipProject"],oh=["tooltipManual"];function ah(e,t){if(1&e){const e=c.Yb();c.Xb(0,"project-picker",27,28),c.jc("selectedProjectAndTask",(function(t){c.Oc(e);const i=c.nc(),n=c.Lc(16);return i.selectProjectAndTask(t,n)}))("onResize",(function(t){return c.Oc(e),c.Lc(1).onResizeChange(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("resizeableName","projectPicker")("selectedProject",e.timeEntry.project)("selectedTask",e.timeEntry.task)("hideWorkspaces",!0)}}const lh=function(e){return{"cl-entry-tag-dropdown":e}};function bh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"tag-dropdown",29),c.jc("close",(function(t){return c.Oc(e),c.nc().selectTags(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("ngClass",c.Bc(4,lh,!e.isManual))("resizeableName","tagPicker")("resizeToLeft",!e.isManual)("entryTags",e.timeEntry.tags)}}function uh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"stopwatch",30,31),c.jc("setEntry",(function(t){return c.Oc(e),c.nc().setEntry(t)}))("stopped",(function(t){return c.Oc(e),c.nc().onStopped(t)}))("canceled",(function(){return c.Oc(e),c.nc().onCancel()}))("canceledFailed",(function(t){return c.Oc(e),c.nc().onCancelFailed(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("timeEntry",e.timeEntry)("disableManualMode",e.disableManualMode)("isEntryInitialized",e.isEntryInitialized)}}function dh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"single-date-picker2",38),c.jc("pickedDate",(function(t){return c.Oc(e),c.nc(2).dateTimeManualChanged(t)})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("textualDate",!0)("focusOnInput",!0)("debounce",!1)("dateTime",e.timeEntry.timeInterval)("canTriggerNextDay",!0)}}function ph(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Wc(1,dh,1,5,"single-date-picker2",32),c.Xb(2,"div",33),c.Xb(3,"input-duration",34),c.jc("onFocus",(function(){return c.Oc(e),c.nc().closeDatepicker()}))("timeChanged",(function(t){return c.Oc(e),c.nc().dateTimeManualChanged(t)})),c.Wb(),c.Wb(),c.Xb(4,"div",35),c.jc("click",(function(){return c.Oc(e),c.nc().createTimeEntryManually()}))("keyup.space",(function(){return c.Oc(e),c.nc().createTimeEntryManually()}))("keyup.enter",(function(){return c.Oc(e),c.nc().createTimeEntryManually()})),c.Xb(5,"a",36),c.Yc(6,"Add"),c.Wb(),c.Xb(7,"a",37),c.Yc(8,"Add"),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.timeEntry.timeInterval),c.Cb(2),c.wc("format",e.format)("focusOnInput",!0)("timeInterval",e.timeEntry.timeInterval)}}function hh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"modes-btns",39,40),c.jc("setIsManual",(function(t){return c.Oc(e),c.nc().setIsManual(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("autoClose","inside")("disableManualMode",e.disableManualMode)("isManual",e.isManual)}}function mh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"custom-fields-values",41),c.jc("entryChanged",(function(t){return c.Oc(e),c.nc().customFieldValueChanged(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("timeEntryId",e.timeEntry.id)("projectId",null==e.timeEntry.project?null:e.timeEntry.project.id)("customFields",e.customFields)("customFieldValues",e.timeEntry.id?e.timeEntry.customFieldValues:e.defaultForProjectValues)}}var gh=function(e){return e.MANUAL="tooltipManual",e.PROJECT="tooltipProject",e.DESCRIPTION="tooltipDescription",e}({});let fh=(()=>{class e{constructor(e,t,i,n,s,c,r,o,a,l,b,u,d,p){this.entryHelper=e,this.entryGroupService=t,this.activatedRoute=i,this.authService=n,this.userService=s,this.stopwatchService=c,this.debouncerService=r,this.trackerService=o,this.modalService=a,this.toaster=l,this.keyboardService=b,this.browserService=u,this.workspaceService=d,this.cd=p,this.inProgress=!1,this.billableBackup=!1,this.unsubscribe$=new Ee.a,this.sortByTagNameMapper=e=>e.name}set setCustomFields(e){e&&(this.customFields=e)}set entryInProgress(e){if(e){if(e.id){this.setIsManual(!1);const t=new Date(e.timeInterval.start).getTime()/100;this.stopwatchService.setStart(t),this.timeEntry=e,this.projectAttributeTitle=Object(Pt.o)(e)}else this.stopwatchService.stop();this.isEntryInitialized=!0,this.cd.detectChanges()}}set disableManualMode(e){this._disableManualMode=e,e&&this.isManual&&this.setIsManual(!1)}get disableManualMode(){return this._disableManualMode}ngOnInit(){this.isDesktop=window.innerWidth>=ei.h,this.isNew="true"===localStorage.getItem("isNew"),this.profile=this.authService.getUser(),this.isManual=this.profile.settings.timeTrackingManual&&!this.disableManualMode,this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.resetTimeEntry(),this.subscribeToPlay(),this.subscribeToKeyboard(),this.stopwatchService.stateChanged.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{e==mc.b.STARTED?(this.inProgress=!0,this.isNew&&(this.openTooltip(gh.PROJECT),this.stopwatch&&this.stopwatch.closeTooltip()),this.cd.detectChanges()):e==mc.b.STOPPED&&(this.inProgress=!1,this.cd.detectChanges())}),this.stopwatchService.timeEntryStoppedSocket$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.resetTimeEntry()}),this.authService.user.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.profile=e,this.inProgress||this.setIsManual(this.profile.settings.timeTrackingManual,!1),this.cd.detectChanges()}),this.activatedRoute.queryParams.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{const t=e&&"manual"===e.mode;t&&(this.setIsManual(t,!1),this.cd.detectChanges())})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}ngAfterViewInit(){this.isNew&&(this.openTooltip(gh.DESCRIPTION),this.stopwatch&&this.stopwatch.showTooltip())}autocompleteSelect(e){this.timeEntry.description=e.description,this.timeEntry.billable=e.project?e.project.billable:this.timeEntry.billable,this.timeEntry.project=e.project,this.timeEntry.task=e.task,this.timeEntry.tags=e.tags,this.isManual?this.datePicker.setFocusToStartTime():this.inProgress?this.trackerService.updateEntryWithBulk(this.timeEntry,[Mp.a.DESCRIPTION,Mp.a.BILLABLE,Mp.a.PROJECT,Mp.a.TASK,Mp.a.TAG]).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.timeEntry.customFieldValues=e.customFieldValues,this.timeEntry.billable=e.billable,this.setFocusToDescription(),this.cd.detectChanges()}):(this.stopwatch.start(),this.setFocusToDescription())}subscribeToPlay(){this.entryGroupService.entryToPlay$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.setIsManual(!1),this.projectAttributeTitle=Object(Pt.o)(e),this.inProgress?this.stopwatch.stop(e):this.stopwatch.start(e),this.browserService.scrollToTop()})}setIsManual(e,t=!0){e!=this.isManual&&(this.disableManualMode?this.isManual=!1:(this.isManual=e,t&&this.userService.updateTimeTrackingSettings(this.profile,this.isManual),this.isManual?(this.closeTooltip(gh.MANUAL),this.manualAlreadyVisited=!0):(this.cd.detectChanges(),this.isNew&&this.stopwatch&&this.stopwatch.showTooltip())))}setEntry(e){this.timeEntry=e,this.timeEntry.description=Object(Pt.G)(this.timeEntry.description,this.toaster),this.cd.detectChanges()}onStopped(e){this.setNotNew(),this.billableBackup=e.billable,this.setFocusToDescription(),this.resetTimeEntry()}onCancel(){this.resetTimeEntry()}onCancelFailed(e){this.timeEntry=e,this.cd.detectChanges()}setNotNew(){this.isNew?(this.closeTooltip(gh.PROJECT),this.isNew=!1,this.closeTooltip(gh.DESCRIPTION),localStorage.setItem("isNew","false"),this.isManual||this.manualAlreadyVisited||this.disableManualMode||this.openTooltip(gh.MANUAL)):this.isManual&&this.closeTooltip(gh.MANUAL)}resetTimeEntry(e=null){const t=this.setInterval(e);this.timeEntry=new At.a({billable:this.billableBackup,timeInterval:t}),this.setDefaultCustomField(),this.cd.detectChanges()}setDefaultCustomField(e){const t=[];this.customFields.forEach(i=>{const n=new gp.a({customFieldId:i.id,customField:i,value:e&&i.getProjectValue(e.project.id)?i.getProjectValue(e.project.id).value:i.workspaceDefaultValue});t.push(n)}),this.defaultForProjectValues=t}setInterval(e=null){let t;if(e){const i=Se(e.start),n=Se(e.end),s=Se.duration(n.diff(i)),c=Se(n).clone().add(s,"s");t=new ep.a({start:n.toISOString(),end:c.toISOString(),duration:s})}else{const e=Se().set({second:0,millisecond:0}),i=Se.duration(e.diff(e)).toISOString();t=new ep.a({start:e.toISOString(),end:e.toISOString(),duration:i})}return t}dateTimeManualChanged(e){if(this.timeEntry.timeInterval=new ep.a(e),!this.timeEntry.id)return;const t=new ep.a(this.timeEntry.timeInterval);this.trackerService.editTimeInterval(this.timeEntry.id,this.timeEntry.timeInterval).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{},e=>{this.timeEntry.timeInterval=t,this.cd.detectChanges()})}changeBillable(e){if(!this.timeEntry.id)return void(this.timeEntry.billable=e);const t=this.timeEntry.billable;t!==e&&(this.timeEntry.billable=e,this.trackerService.updateBillable(this.timeEntry.id,e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.billableBackup=e,this.timeEntry.billable=t.billable,this.cd.detectChanges()},()=>{this.timeEntry.billable=t,this.cd.detectChanges()}))}saveCurrentEntry(e){if(this.isManual)return this.timeEntry.description=e,void this.createTimeEntryManually();this.stopwatch||this.cd.detectChanges(),this.inProgress?e!==this.timeEntry.description&&(this.timeEntry.description=e,this.updateDescription()):(this.timeEntry.description=e,this.stopwatch.start())}createTimeEntryManually(){setTimeout(()=>{if(this.setNotNew(),!this.entryHelper.isValid(this.timeEntry))return;this.timeEntry.description=Object(Pt.G)(this.timeEntry.description,this.toaster),this.billableBackup=this.timeEntry.billable;const e=new ep.a(this.timeEntry.timeInterval);this.trackerService.createTimeEntry(this.timeEntry).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.entryGroupService.setNewEntryCreated(t),this.setFocusToDescription(),this.resetTimeEntry(e)})},2)}updateDescription(){this.closeTooltip(gh.DESCRIPTION),this.timeEntry.description=Object(Pt.G)(this.timeEntry.description,this.toaster),this.timeEntry.id&&(this.entryHelper.validateDescription(this.timeEntry.description)?(this.debouncerService.debouncer$.pipe(Object(Yt.a)(1),Object(It.a)(e=>e),Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.trackerService.updateDescription(this.timeEntry.id,this.timeEntry.description).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{})}),this.debouncerService.next(!0)):this.timeEntry.description=this.backupDescription)}selectTags(e){if(!e)return;if(!this.timeEntry.id)return this.timeEntry.tags=e,void this.cd.markForCheck();if(!this.entryHelper.validateTag(e))return;const t=Object(Pt.e)(this.timeEntry.tags);this.timeEntry.tags=e,this.cd.markForCheck(),this.debouncerService.debouncer$.pipe(Object(Yt.a)(1),Object(It.a)(e=>e),Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.trackerService.updateTags(this.timeEntry.id,e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{},e=>{this.timeEntry.tags=t,this.cd.detectChanges()})}),this.debouncerService.next(!0)}selectProjectAndTask(e,t){if(t&&t.focus(),!this.timeEntry.id)return this.setProjectAndTask(e),void(e&&e.project&&(this.timeEntry.billable=this.workspace.taskBillableEnabled&&e.task?e.task.billable:e.project.billable));if(!this.entryHelper.validateProjectAndTask(e))return;const i=Object(Pt.e)(this.timeEntry.project),n=Object(Pt.e)(this.timeEntry.task);this.setProjectAndTask(e),this.debouncerService.debouncer$.pipe(Object(Yt.a)(1),Object(It.a)(e=>e),Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.trackerService.updateProjectAndTask(this.timeEntry).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.timeEntry.billable!=e.billable&&(this.timeEntry.billable=e.billable,this.cd.detectChanges()),this.timeEntry.customFieldValues=e.customFieldValues,this.cd.detectChanges()},e=>{this.setProjectAndTask({project:i,task:n})})}),this.debouncerService.next(!0)}setProjectAndTask(e){this.timeEntry.project=e.project,this.timeEntry.project&&(this.timeEntry.project.clientName=this.timeEntry.project&&this.timeEntry.project.client&&this.timeEntry.project.client.name||this.timeEntry.project.clientName),this.timeEntry.task=e.task,this.projectAttributeTitle=Object(Pt.o)(e),this.timeEntry=At.a.clone(this.timeEntry),this.setDefaultCustomField(e),this.cd.detectChanges()}setFocusToDescription(){this.autocompleteComponent&&window.innerWidth>=ei.h&&this.autocompleteComponent.focusToInput()}closeDatepicker(){this.datePicker&&this.datePicker.closeDatepicker(!0)}closeTooltip(e){this[e]&&this[e].close()}openTooltip(e){this[e]&&this[e].open()}subscribeToKeyboard(){this.keyboardService.keyboardRecorder$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{if(!this.modalService.hasOpenModals()){if(e===ya.e){if(this.inProgress||this.disableManualMode)return;return this.setIsManual(!0),this.setFocusToDescription(),void this.cd.detectChanges()}if(e===ya.f&&(this.setIsManual(!1),this.setFocusToDescription(),this.inProgress?this.stopwatch.stop(null,!0):this.stopwatch.start()),e===ya.c){let e;this.setIsManual(!1),this.setFocusToDescription(),this.entryGroups[0]&&this.entryGroups[0].timeEntries[0]&&(e=At.a.clone(this.entryGroups[0].timeEntries[0])),this.inProgress?this.stopwatch.stop(e):(this.browserService.scrollToTop(),this.stopwatch.start(e))}}})}customFieldValueChanged(e){this.timeEntry.customFieldValues=e}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Gd.a),c.Rb(_d.a),c.Rb(W.a),c.Rb(Ce.a),c.Rb(ys.a),c.Rb(mc.a),c.Rb(Re),c.Rb($d.a),c.Rb(g.q),c.Rb(M.a),c.Rb(Vd.a),c.Rb(pi.a),c.Rb(U.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["time-tracker-recorder"]],viewQuery:function(e,t){var i;1&e&&(c.ed(sh,!0),c.ed(Pp,!0),c.ed(so.a,!0),c.ed(ch,!0),c.ed(rh,!0),c.ed(oh,!0)),2&e&&(c.Kc(i=c.kc())&&(t.stopwatch=i.first),c.Kc(i=c.kc())&&(t.autocompleteComponent=i.first),c.Kc(i=c.kc())&&(t.datePicker=i.first),c.Kc(i=c.kc())&&(t.tooltipDescription=i.first),c.Kc(i=c.kc())&&(t.tooltipProject=i.first),c.Kc(i=c.kc())&&(t.tooltipManual=i.first))},inputs:{entryGroups:"entryGroups",format:"format",setCustomFields:"setCustomFields",entryInProgress:"entryInProgress",projectData:"projectData",disableManualMode:"disableManualMode"},decls:27,vars:18,consts:[["tabRow","",1,"cl-card","cl-border-bottom","cl-mb-0"],[1,"cl-component-row","cl-p-0","cl-border-0"],[1,"cl-row","cl-no-gutters","cl-w-100"],[1,"cl-col"],[1,"cl-row","cl-align-items-center","cl-pl-lg-2","cl-py-2","cl-py-lg-custom-0","cl-w-100"],[1,"cl-col","cl-ml-2","cl-ml-lg-0"],["triggers","manual","ngbTooltip","Type what you're working on","placement","bottom",3,"autoClose","id","autofocus","placeholder","description","onEnter","onChange","onSelect","onFocus"],["tooltipDescription","ngbTooltip"],[1,"cl-col-auto","cl-pl-0","cl-pr-3"],[1,"recorder-project-wrapper"],["dropdownKey","","tabCell","",1,"cl-dropdown","cl-dropdown-large","cl-d-flex",3,"click"],["triggers","manual","ngbTooltip","Categorize your time","placement","bottom",1,"cl-cut-text","cl-w-100-hidden",3,"autoClose"],["tooltipProject","ngbTooltip"],[3,"isDisabled","project","projectData","task"],["class","cl-dropdown-menu recorder-project-picker","resizeable","",3,"resizeableName","selectedProject","selectedTask","hideWorkspaces","selectedProjectAndTask","onResize",4,"dropdownKeyContent"],["tabFocus","","tabindex","0"],["projectTabFocus",""],[1,"cl-col-lg-custom-auto"],[1,"cl-timetracker-entry-actions","cl-d-flex","cl-justify-content-between","cl-justify-content-lg-custom-end",2,"position","relative"],["dropdownKey","","tabCell","",1,"cl-dropdown"],["dropdownKeyButton","","tabindex","0",1,"pointer",3,"tags"],["class","cl-dropdown-menu","resizeable","",3,"ngClass","resizeableName","resizeToLeft","entryTags","close",4,"dropdownKeyContent"],[1,"cl-component-divided-left",3,"billable","changed"],["style","display: flex;",3,"timeEntry","disableManualMode","isEntryInitialized","setEntry","stopped","canceled","canceledFailed",4,"ngIf"],[4,"ngIf"],["style","position: relative;","triggers","manual","ngbTooltip","Add time manually here","placement","left",3,"autoClose","disableManualMode","isManual","setIsManual",4,"ngIf"],[3,"timeEntryId","projectId","customFields","customFieldValues","entryChanged",4,"ngIf"],["resizeable","",1,"cl-dropdown-menu","recorder-project-picker",3,"resizeableName","selectedProject","selectedTask","hideWorkspaces","selectedProjectAndTask","onResize"],["projectPickerEl",""],["resizeable","",1,"cl-dropdown-menu",3,"ngClass","resizeableName","resizeToLeft","entryTags","close"],[2,"display","flex",3,"timeEntry","disableManualMode","isEntryInitialized","setEntry","stopped","canceled","canceledFailed"],["stopwatch",""],["class","cl-d-flex cl-w-100 cl-mobile-hide-input-date-picker",3,"textualDate","focusOnInput","debounce","dateTime","canTriggerNextDay","pickedDate",4,"ngIf"],[1,"cl-component-divided-left","cl-d-sm-inline-flex","cl-input-time-wrapper","cl-d-none"],[3,"format","focusOnInput","timeInterval","onFocus","timeChanged"],["tabindex","0",3,"click","keyup.space","keyup.enter"],[1,"cl-btn","cl-btn-primary","cl-d-none","cl-d-lg-custom-block"],[1,"cl-btn","cl-btn-primary","cl-btn-sm","cl-d-block","cl-d-lg-custom-none"],[1,"cl-d-flex","cl-w-100","cl-mobile-hide-input-date-picker",3,"textualDate","focusOnInput","debounce","dateTime","canTriggerNextDay","pickedDate"],["triggers","manual","ngbTooltip","Add time manually here","placement","left",2,"position","relative",3,"autoClose","disableManualMode","isManual","setIsManual"],["tooltipManual","ngbTooltip"],[3,"timeEntryId","projectId","customFields","customFieldValues","entryChanged"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"form",5),c.Xb(6,"autocomplete-input",6,7),c.jc("onEnter",(function(e){return t.saveCurrentEntry(e)}))("onChange",(function(e){return t.timeEntry.description=e,t.updateDescription()}))("onSelect",(function(e){return t.autocompleteSelect(e)}))("onFocus",(function(){return t.backupDescription=t.timeEntry.description})),c.Wb(),c.Wb(),c.Xb(8,"div",8),c.Xb(9,"div",9),c.Xb(10,"div",10),c.jc("click",(function(){c.Oc(e);const t=c.Lc(12);return t&&t.close()})),c.Xb(11,"div",11,12),c.Sb(13,"project-picker-label",13),c.Wb(),c.Wc(14,ah,2,4,"project-picker",14),c.Sb(15,"span",15,16),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(17,"div",17),c.Xb(18,"div",18),c.Xb(19,"div",19),c.Sb(20,"tag-names",20),c.Wc(21,bh,1,6,"tag-dropdown",21),c.Wb(),c.Xb(22,"billable-icon",22),c.jc("changed",(function(e){return t.changeBillable(e)})),c.Wb(),c.Wc(23,uh,2,3,"stopwatch",23),c.Wc(24,ph,9,4,"ng-container",24),c.Wc(25,hh,2,3,"modes-btns",25),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(26,mh,1,4,"custom-fields-values",26),c.Wb()}2&e&&(c.Cb(6),c.wc("autoClose","inside")("id",t.timeEntry.id)("autofocus",t.isDesktop)("placeholder",t.isManual?"What have you worked on?":"What are you working on?")("description",t.timeEntry.description),c.Cb(3),c.Hb("cl-recorder-has-tags",t.timeEntry.tags&&t.timeEntry.tags.length>0),c.Cb(2),c.wc("autoClose","inside"),c.Cb(2),c.wc("isDisabled",!1)("project",t.timeEntry.project)("projectData",t.projectData)("task",t.timeEntry.task),c.Cb(7),c.wc("tags",t.timeEntry.tags),c.Cb(2),c.wc("billable",t.timeEntry.billable),c.Cb(1),c.wc("ngIf",!t.isManual),c.Cb(1),c.wc("ngIf",t.isManual),c.Cb(1),c.wc("ngIf",!t.inProgress),c.Cb(1),c.wc("ngIf",(null==t.customFields?null:t.customFields.length)>0))},directives:[p.I,p.t,p.u,Pp,g.Z,Si.a,Yp.a,Oi.a,Gp,Ii.a,Bp.a,s.u,Vp.a,Hp.a,zp.a,s.r,mp,qp.a,so.a,ih,nh.a],encapsulation:2,changeDetection:0}),e})();var vh=i("1k8b"),wh=i("eBys"),yh=i("znhS");function Wh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",8),c.Xb(1,"input",9),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().toggleSelectAll(t)})),c.Wb(),c.Sb(2,"label",10),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.xc("id",e.date),c.wc("indeterminate",e.numberOfSelected>0&&e.numberOfSelected<e.numberOfEntries)("ngModel",e.numberOfSelected===e.numberOfEntries&&e.numberOfSelected>0),c.Cb(1),c.xc("for",e.date)}}function Ch(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"span",11),c.jc("click",(function(){return c.Oc(e),c.nc().bulkEdit.emit()})),c.Xb(2,"a",12),c.Xb(3,"span",13),c.Yc(4,"Bulk"),c.Wb(),c.Yc(5," Edit"),c.Wb(),c.Wb(),c.Xb(6,"span",11),c.jc("click",(function(){return c.Oc(e),c.nc().bulkDelete.emit()})),c.Xb(7,"a",12),c.Yc(8,"Delete"),c.Wb(),c.Wb(),c.Ub()}}function kh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",14,15),c.jc("keyup.enter",(function(){return c.Oc(e),c.nc().toggleEditMode()}))("keyup.space",(function(){return c.Oc(e),c.nc().toggleEditMode()}))("click",(function(){c.Oc(e);const t=c.Lc(1);return c.nc().toggleEditMode(),t.blur()})),c.Sb(2,"img",16),c.Wb()}}let Sh=(()=>{class e{constructor(e,t,i){this.entryBulk=e,this.cd=t,this.changedDayService=i,this.setSelectAll=new c.n,this.bulkEdit=new c.n,this.bulkDelete=new c.n,this.changeEditMode=new c.n,this.unsubscribe$=new Ee.a,this.triggerPipe=!1}toggleEditMode(){this.changeEditMode.emit(!this.editMode),this.editMode=!this.editMode}toggleSelectAll(e){this.entryBulk.setSelectAll(e)}ngOnInit(){this.entryBulk.numberOfEntries$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.numberOfEntries=e,this.cd.detectChanges()}),this.entryBulk.numberOfSelected$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.numberOfSelected=e,this.cd.detectChanges()}),this.changedDayService.changeDayTrigger$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{const e=Se().startOf("day").diff(Se(this.date),"days");e<3&&e>=0&&(this.triggerPipe=!this.triggerPipe,this.cd.detectChanges())})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(xe),c.Rb(c.h),c.Rb(vh.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["entry-group-header"]],inputs:{date:"date",time:"time",format:"format",disableEdit:"disableEdit",editMode:"editMode"},outputs:{setSelectAll:"setSelectAll",bulkEdit:"bulkEdit",bulkDelete:"bulkDelete",changeEditMode:"changeEditMode"},decls:14,vars:12,consts:[[1,"cl-card-header","cl-px-2","cl-px-lg-3"],[1,"cl-h6","cl-mb-0","cl-pl-2","cl-pl-lg-0","cl-d-flex","cl-align-items-center"],["class","cl-custom-control cl-custom-checkbox",4,"ngIf"],[4,"ngIf"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-h6","cl-lh-1","cl-align-self-end","cl-entry-total-label"],[1,"cl-h2","cl-mb-0","cl-ml-2","cl-lh-1"],["tabindex","0","title","Bulk edit","class","cl-ml-2 cl-mr-1 cl-mr-lg-n1 cl-align-self-center cl-non-selectable",3,"keyup.enter","keyup.space","click",4,"ngIf"],[1,"cl-custom-control","cl-custom-checkbox"],["type","checkbox",1,"cl-custom-control-input",3,"id","indeterminate","ngModel","ngModelChange"],[1,"cl-custom-control-label",3,"for"],[1,"cl-bulk-edit-link",3,"click"],[1,"cl-color-blue"],[1,"remove-320-minus"],["tabindex","0","title","Bulk edit",1,"cl-ml-2","cl-mr-1","cl-mr-lg-n1","cl-align-self-center","cl-non-selectable",3,"keyup.enter","keyup.space","click"],["bulkEdit",""],["src","assets/images/ui-icons/bulk-edit.svg"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Wc(2,Wh,3,4,"div",2),c.Xb(3,"span"),c.Yc(4),c.oc(5,"dateFormat"),c.Wb(),c.Wc(6,Ch,9,0,"ng-container",3),c.Wb(),c.Xb(7,"div",4),c.Xb(8,"div",5),c.Yc(9,"Total:"),c.Wb(),c.Xb(10,"div",6),c.Yc(11),c.oc(12,"timeFormat"),c.Wb(),c.Wc(13,kh,3,0,"a",7),c.Wb(),c.Wb()),2&e&&(c.Cb(2),c.wc("ngIf",t.editMode),c.Cb(2),c.Zc(c.rc(5,5,t.date,null,t.triggerPipe)),c.Cb(2),c.wc("ngIf",t.editMode&&t.numberOfSelected>0),c.Cb(5),c.Zc(c.qc(12,9,t.time,t.format)),c.Cb(2),c.wc("ngIf",!t.disableEdit&&t.numberOfEntries))},directives:[s.u,p.a,p.s,p.v],pipes:[wh.a,yh.a],encapsulation:2,changeDetection:0}),e})();var Ih=i("9Eqt");function Oh(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.Zc(e.weekLabel)}}function Xh(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.oc(2,"momentUtcFormat"),c.Wb(),c.Xb(3,"span",10),c.Yc(4,"-"),c.Wb(),c.Xb(5,"span"),c.Yc(6),c.oc(7,"momentUtcFormat"),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.Zc(c.qc(2,2,e.weekStatus.dateRange.start,"MMM D")),c.Cb(5),c.Zc(c.qc(7,5,e.weekStatus.dateRange.end,"MMM D"))}}function Eh(e,t){1&e&&(c.Vb(0),c.Xb(1,"span",12),c.Sb(2,"img",13),c.Wb(),c.Ub()),2&e&&(c.Cb(1),c.wc("ngbTooltip","Fix timezone mismatch to see approval status"))}function Th(e,t){1&e&&(c.Xb(0,"span",16),c.Yc(1," Approved "),c.Wb())}function Dh(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",18),c.Xb(2,"span",19),c.Yc(3," Pending approval "),c.Xb(4,"span",20),c.jc("click",(function(){c.Oc(e);const t=c.nc(4),i=c.Lc(15);return t.openModal(i)})),c.Yc(5," \u2715 "),c.Wb(),c.Wb(),c.Wb(),c.Ub()}}function Rh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",21),c.jc("click",(function(){c.Oc(e);const t=c.nc(4),i=c.Lc(13);return t.openModal(i)})),c.Yc(1,"Submit"),c.Wb()}}function Ah(e,t){if(1&e&&(c.Wc(0,Dh,6,0,"ng-container",4),c.Wc(1,Rh,2,0,"a",17)),2&e){const e=c.nc(3);c.wc("ngIf",e.weekStatus.id),c.Cb(1),c.wc("ngIf",!e.weekStatus.id)}}function jh(e,t){if(1&e&&(c.Wc(0,Th,2,0,"span",14),c.Wc(1,Ah,2,2,"ng-template",null,15,c.Xc)),2&e){const e=c.Lc(2),t=c.nc(2);c.wc("ngIf",t.weekStatus.isApprovedAllOnCurrentPage&&t.weekStatus.isApprovedAllOnOtherPages)("ngIfElse",e)}}function xh(e,t){if(1&e&&(c.Vb(0),c.Wc(1,Eh,3,1,"ng-container",2),c.Wc(2,jh,3,2,"ng-template",null,11,c.Xc),c.Ub()),2&e){const e=c.Lc(3),t=c.nc();c.Cb(1),c.wc("ngIf",t.timeZoneMissmatch)("ngIfElse",e)}}function Ph(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",22),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().submit(i)}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Xb(1,"p",23),c.Yc(2),c.oc(3,"momentUtcFormat"),c.oc(4,"momentUtcFormat"),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Submit week for approval")("btnText","Submit")("inProgress",e.inProgress),c.Cb(2),c.bd(" Ready to submit ",c.qc(3,5,e.weekStatus.dateRange.start,"MMM D")," - ",c.qc(4,8,e.weekStatus.dateRange.end,"MMM D")," for approval? ")}}function Mh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",22),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().withdrawSubmission(i)}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Xb(1,"p",23),c.Yc(2," If you withdraw, admin won't be able to approve your time unless you submit it again. "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Withdraw submission")("btnText","Withdraw")("inProgress",e.inProgress)}}let Yh=(()=>{class e{constructor(e,t,i,n){this.modalService=e,this.approvalService=t,this.notificationService=i,this.cd=n,this.onWithdraw=new c.n,this.onSubmit=new c.n,this.ApprovalStatus=Ot,this.unsubscribe$=new Ee.a}set weekStatus(e){this._weekStatus=e;const t=Object(ke.e)(Se(),this.startOfWeek);this.weekLabel=t.format("YYYY-MM-DD")===e.startDayOfWeek?"This week":t.subtract(7,"days").format("YYYY-MM-DD")===e.startDayOfWeek?"Last week":""}get weekStatus(){return this._weekStatus}ngOnInit(){this.notificationService.timeZoneMissmatch$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.timeZoneMissmatch=e,this.cd.markForCheck()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}openModal(e){this.modalService.open(e,{centered:!0})}submit(e){this.inProgress=!0,this.approvalService.createSubmitRequest(this.weekStatus.startDayOfWeek).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.onSubmit.emit({id:t.id,startDayOfWeek:this.weekStatus.startDayOfWeek}),this.inProgress=!1,e.close(),this.cd.detectChanges()},()=>{this.inProgress=!1})}withdrawSubmission(e){this.inProgress=!0,this.approvalService.withdrawSubmission(this.weekStatus.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.onWithdraw.emit({startDayOfWeek:this.weekStatus.startDayOfWeek}),this.inProgress=!1,e.close(),this.cd.detectChanges()},()=>{this.inProgress=!1})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(g.q),c.Rb(Mt),c.Rb(D.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["approval-header"]],inputs:{startOfWeek:"startOfWeek",weekStatus:"weekStatus",format:"format",timeApprovalEnabled:"timeApprovalEnabled"},outputs:{onWithdraw:"onWithdraw",onSubmit:"onSubmit"},decls:16,vars:7,consts:[[1,"cl-d-flex","cl-align-items-center"],[1,"cl-d-flex","cl-flex-column","cl-flex-sm-row","cl-mr-3"],[4,"ngIf","ngIfElse"],["fromToDateTemplate",""],[4,"ngIf"],[1,"cl-d-flex","cl-align-items-end","cl-mt-2","cl-mt-lg-0"],[1,"cl-h6","cl-mb-0","cl-lh-1"],[1,"cl-h2","cl-mb-0","cl-ml-2","cl-lh-1"],["submitApprovalModal",""],["witdhDrawApprovalModal",""],[1,"cl-d-none","cl-d-sm-inline-flex","cl-mx-1"],["approvalFeatureTemplate",""],["placement","top",3,"ngbTooltip"],["src","assets/images/ui-icons/icon-warning.svg"],["class","cl-badge-approve cl-approve-status-approved",4,"ngIf","ngIfElse"],["submitAndPendingTemplate",""],[1,"cl-badge-approve","cl-approve-status-approved"],["title","Submit time for approval","class","cl-small",3,"click",4,"ngIf"],[1,"cl-mr-3"],[1,"cl-badge-approve","cl-approve-status-pending"],["title","Withdraw approval",1,"pointer","cl-ml-1",3,"click"],["title","Submit time for approval",1,"cl-small",3,"click"],[3,"title","btnText","inProgress","confirmed","close"],[1,"cl-text-dark","cl-mb-0"]],template:function(e,t){if(1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Wc(2,Oh,2,1,"span",2),c.Wc(3,Xh,8,8,"ng-template",null,3,c.Xc),c.Wb(),c.Wc(5,xh,4,2,"ng-container",4),c.Wb(),c.Xb(6,"div",5),c.Xb(7,"div",6),c.Yc(8,"Week total:"),c.Wb(),c.Xb(9,"div",7),c.Yc(10),c.oc(11,"timeFormat"),c.Wb(),c.Wb(),c.Wc(12,Ph,5,11,"ng-template",null,8,c.Xc),c.Wc(14,Mh,3,3,"ng-template",null,9,c.Xc)),2&e){const e=c.Lc(4);c.Cb(2),c.wc("ngIf",t.weekLabel)("ngIfElse",e),c.Cb(3),c.wc("ngIf",t.timeApprovalEnabled),c.Cb(5),c.ad(" ",c.qc(11,4,t.weekStatus.total,t.format)," ")}},directives:[s.u,g.Z,Ui.a],pipes:[yh.a,Ih.a],encapsulation:2,changeDetection:0}),e})();const Lh=["tabFocusDuplicate"];let Fh=(()=>{class e{constructor(e,t,i,n,s,r,o,a,l){this.trackerService=e,this.entryHelper=t,this.entryGroupService=i,this.toaster=n,this.keyboardService=s,this.modalService=r,this.entryBulk=o,this.workspaceService=a,this.cd=l,this.entryIsDuplicated=new c.n,this.entryIsDeleted=new c.n,this.unsubscribe$=new Ee.a}set isAdminOrOwner(e){void 0!==e&&(this._isAdminOrOwner=e,this.checkIsEnableToEdit())}get isAdminOrOwner(){return this._isAdminOrOwner}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.subscribeToBulkChange(),this.projectAttributeTitle=Object(Pt.o)(this.timeEntry)}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}checkIsEnableToEdit(){this.disableEdit=this.timeEntry.isLocked&&!this.isAdminOrOwner||!!this.timeEntry.approvalRequestId}duplicateEntry(){this.disableManualModeEdit||(this.trackerService.duplicateTimeEntry(this.timeEntry.children?this.timeEntry.children[0]:this.timeEntry).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.entryIsDuplicated.next(),this.entryGroupService.setNewEntryCreated(e)}),this.focusToRowEnd())}setEntryToPlay(){this.entryGroupService.setEntryToPlay(this.timeEntry.children?this.timeEntry.children[0]:this.timeEntry)}deleteTimeEntryConfirmed(){}dateTimeChanged(e){}setProjectToEntry(e,t){var i;t.project=e.project,t.project&&(t.project.clientName=(null===(i=t.project.client)||void 0===i?void 0:i.name)||t.project.clientName),t.task=e.task,this.projectAttributeTitle=Object(Pt.o)(e)}openDeleteModal(e){this.entriesToModify=this.timeEntry.children&&this.timeEntry.children.length||null,this.keyboardService.removeListener(),this.modalService.open(e,{centered:!0}).result.then(e=>{e&&this.deleteTimeEntryConfirmed(),this.focusToRowEnd(),this.keyboardService.addListener()},e=>{this.focusToRowEnd(),this.keyboardService.addListener()})}toggleCollapseSameEntries(e){this.timeEntry.children&&(this.timeEntry.expanded=!this.timeEntry.expanded,e&&e.stopPropagation())}focusToRowEnd(){this.tabFocusDuplicate&&this.tabFocusDuplicate.nativeElement.focus()}subscribeToBulkChange(){this.entryBulk.selectAllChanged$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{if(this.timeEntry.children)this.timeEntry.children.forEach(t=>{this.disableEdit||(t.bulkEdit=e)});else{if(this.disableEdit)return;this.timeEntry.bulkEdit=e}this.cd.detectChanges()})}closeDatepicker(){this.datepicker&&this.datepicker.closeDatepicker(!0)}selectProjectAndTask(e,t){t&&t.focus();const i={project:Object(Pt.e)(this.timeEntry.project),task:Object(Pt.e)(this.timeEntry.task),workspaceId:this.timeEntry.workspaceId};if(this.setProjectToEntry(e,this.timeEntry),!this.entryHelper.validateProjectAndTask(e))return;const n=e&&e.workspace&&e.workspace.id,s=this.timeEntry.workspaceId;this.timeEntry.workspaceId=n,this.saveProjectAndTask(i,s,n,e)}saveProjectAndTask(e,t,i,n){}}return e.\u0275fac=function(t){return new(t||e)(c.Rb($d.a),c.Rb(Gd.a),c.Rb(_d.a),c.Rb(M.a),c.Rb(Vd.a),c.Rb(g.q),c.Rb(xe),c.Rb(U.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["time-entry-base"]],viewQuery:function(e,t){var i;1&e&&(c.ed(so.a,!0),c.ed(Bp.a,!0),c.ed(Lh,!0)),2&e&&(c.Kc(i=c.kc())&&(t.datepicker=i.first),c.Kc(i=c.kc())&&(t.billableComponent=i.first),c.Kc(i=c.kc())&&(t.tabFocusDuplicate=i.first))},inputs:{format:"format",timeEntry:"timeEntry",editMode:"editMode",hideWorkspacesInPicker:"hideWorkspacesInPicker",customFields:"customFields",isAdminOrOwner:"isAdminOrOwner",disableManualModeEdit:"disableManualModeEdit",projectData:"projectData"},outputs:{entryIsDuplicated:"entryIsDuplicated",entryIsDeleted:"entryIsDeleted"},decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),e})();function Nh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"input",38),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc(2).timeEntry.bulkEdit=t}))("change",(function(){c.Oc(e);const t=c.nc(2);return t.signleBulkChange(t.timeEntry.bulkEdit)}))("keyup.enter",(function(){c.Oc(e);const t=c.nc(2);return t.timeEntry.bulkEdit=!t.timeEntry.bulkEdit,t.signleBulkChange(t.timeEntry.bulkEdit)})),c.Wb()}if(2&e){const e=c.nc(2);c.yc("id","edit_",e.timeEntry.id,""),c.wc("ngModel",e.timeEntry.bulkEdit)}}function Uh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"input",39),c.jc("change",(function(){return c.Oc(e),c.nc(2).groupBulkChange()}))("keyup.enter",(function(){return c.Oc(e),c.nc(2).groupBulkChange()})),c.Wb()}if(2&e){const e=c.nc(2);c.yc("id","edit_",e.timeEntry.id,""),c.wc("ngModel",e.bulkSelected===e.allChilds)("indeterminate",e.bulkSelected>0&&e.bulkSelected<e.allChilds)}}function $h(e,t){if(1&e&&(c.Xb(0,"div",34),c.Wc(1,Nh,1,2,"input",35),c.Wc(2,Uh,1,3,"input",36),c.Sb(3,"label",37),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",!(null!=e.timeEntry&&null!=e.timeEntry.children&&e.timeEntry.children.length)),c.Cb(1),c.wc("ngIf",null==e.timeEntry||null==e.timeEntry.children?null:e.timeEntry.children.length),c.Cb(1),c.yc("for","edit_",e.timeEntry.id,"")}}function _h(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",40),c.jc("keyup.space",(function(){return c.Oc(e),c.nc().toggleCollapseSameEntries()}))("keyup.enter",(function(){return c.Oc(e),c.nc().toggleCollapseSameEntries()}))("click",(function(){return c.Oc(e),c.nc().toggleCollapseSameEntries()})),c.Xb(1,"span",41),c.Yc(2),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title",e.childrenLength+" time entries (click to toggle)"),c.Cb(2),c.Zc(e.childrenLength)}}function Gh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"project-picker",42,43),c.jc("selectedProjectAndTask",(function(t){c.Oc(e);const i=c.nc(),n=c.Lc(16);return i.selectProjectAndTask(t,n)}))("onResize",(function(t){return c.Oc(e),c.Lc(1).onResizeChange(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("selectedProject",e.timeEntry.project)("selectedTask",e.timeEntry.task)("hideWorkspaces",e.hideWorkspacesInPicker)("resizeableName","projectPicker")}}function Bh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"tag-dropdown",44),c.jc("close",(function(t){return c.Oc(e),c.nc().selectTags(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("entryTags",e.timeEntry.tags)("resizeableName","tagPicker")("resizeToLeft",!0)}}function Vh(e,t){if(1&e&&(c.Xb(0,"div"),c.Sb(1,"input",45),c.oc(2,"timeFormat"),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngModel",c.qc(2,1,e.timeEntry.timeInterval.duration,e.format))}}function Hh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"input-duration",46),c.jc("onFocus",(function(){return c.Oc(e),c.nc().closeDatepicker()}))("timeChanged",(function(t){return c.Oc(e),c.nc().dateTimeChanged(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("format",e.format)("timeInterval",e.timeEntry.timeInterval)("disable",e.disableEdit||(null==e.timeEntry.children?null:e.timeEntry.children.length))}}function zh(e,t){1&e&&c.Sb(0,"img",51)}function qh(e,t){1&e&&c.Sb(0,"img",52)}function Kh(e,t){if(1&e&&(c.Xb(0,"div",47),c.Xb(1,"div",48),c.Wc(2,zh,1,0,"img",49),c.Wc(3,qh,1,0,"ng-template",null,50,c.Xc),c.Wb(),c.Wb()),2&e){const e=c.Lc(4),t=c.nc();c.Cb(2),c.wc("ngIf",t.timeEntry.approvalRequestId)("ngIfElse",e)}}function Zh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",62),c.jc("keyup.enter",(function(){return c.Oc(e),c.nc(4).duplicateEntry()}))("keyup.space",(function(){return c.Oc(e),c.nc(4).duplicateEntry()}))("click",(function(){return c.Oc(e),c.nc(4).duplicateEntry()})),c.Yc(1," Duplicate "),c.Wb()}}function Qh(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",59),c.Xb(1,"list-items"),c.Wc(2,Zh,2,0,"a",60),c.Xb(3,"a",61),c.jc("keyup.enter",(function(){c.Oc(e);const t=c.nc(3),i=c.Lc(37);return t.openDeleteModal(i)}))("keyup.space",(function(){c.Oc(e);const t=c.nc(3),i=c.Lc(37);return t.openDeleteModal(i)}))("click",(function(){c.Oc(e);const t=c.nc(3),i=c.Lc(37);return t.openDeleteModal(i)})),c.Yc(4," Delete "),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc(3);c.Cb(2),c.wc("ngIf",!e.disableManualModeEdit)}}function Jh(e,t){1&e&&(c.Xb(0,"div",54),c.Xb(1,"div",55),c.Sb(2,"img",56),c.Wb(),c.Wc(3,Qh,5,1,"div",57),c.Sb(4,"span",14,58),c.Wb())}function em(e,t){if(1&e&&c.Wc(0,Jh,6,0,"div",53),2&e){const e=c.nc();c.wc("ngIf",!e.disableEdit)}}function tm(e,t){if(1&e){const e=c.Yb();c.Xb(0,"custom-fields-values",63),c.jc("entryChanged",(function(t){return c.Oc(e),c.nc().entryChanged(t)}))("manyChanged",(function(t){return c.Oc(e),c.nc().entryChanged(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("timeEntryId",e.timeEntry.id)("projectId",null==e.timeEntry.project?null:e.timeEntry.project.id)("customFields",e.customFields)("isLocked",e.timeEntry.isLocked)("disableEdit",e.timeEntry.approvalRequestId)("customFieldValues",e.timeEntry.customFieldValues)}}function im(e,t){if(1&e&&(c.Xb(0,"div",64),c.Xb(1,"h1",65),c.Yc(2,"Delete"),c.Wb(),c.Xb(3,"button",66),c.jc("click",(function(){return t.$implicit.dismiss()})),c.Xb(4,"span",67),c.Sb(5,"img",68),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",69),c.Xb(7,"p",70),c.Yc(8),c.Wb(),c.Wb(),c.Xb(9,"div",71),c.Xb(10,"a",72),c.jc("click",(function(){return t.$implicit.close()})),c.Yc(11,"Cancel"),c.Wb(),c.Xb(12,"button",73),c.jc("click",(function(){return t.$implicit.close(!0)})),c.Yc(13,"Delete"),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(8),c.bd("Are you sure you want to delete ",e.entriesToModify," ",e.entriesToModify?"entries":"entry","?")}}const nm=function(e){return{"cl-locked":e}};let sm=(()=>{class e extends Fh{constructor(e,t,i,n,s,r,o,a,l){super(e,t,i,n,s,r,o,a,l),this.trackerService=e,this.entryHelper=t,this.entryGroupService=i,this.toaster=n,this.keyboardService=s,this.modalService=r,this.entryBulk=o,this.workspaceService=a,this.cd=l,this.refreshView=new c.n,this.onBulkEditChange=new c.n}updateDescription(){this.timeEntry.description=Object(Pt.G)(this.timeEntry.description,this.toaster),this.entryHelper.validateDescription(this.timeEntry.description)?(this.timeEntry.children.forEach(e=>e.description=this.timeEntry.description),this.trackerService.updateGroup(this.timeEntry.children.map(e=>e.id),[Mp.a.DESCRIPTION],this.timeEntry).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.refreshView.emit(this.timeEntry.expanded)},e=>{this.timeEntry.description=this.backupDescription,this.timeEntry.children.forEach(e=>e.description=this.backupDescription),this.cd.detectChanges()})):this.timeEntry.description=this.backupDescription}changeBillable(e){const t=this.timeEntry.billable;t!==e&&(this.timeEntry.billable=e,this.timeEntry.children.forEach(e=>e.billable=this.timeEntry.billable),this.trackerService.updateGroup(this.timeEntry.children.map(e=>e.id),[Mp.a.BILLABLE],this.timeEntry).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.refreshView.emit(this.timeEntry.expanded)},e=>{this.timeEntry.billable=t,this.timeEntry.children.forEach(e=>e.billable=t),this.cd.detectChanges()}))}groupBulkChange(){const e=!(this.bulkSelected===this.allChilds);this.timeEntry.children.forEach(t=>{t.isLocked&&!this.isAdminOrOwner||(t.bulkEdit=e)}),this.onBulkEditChange.emit(),this.entryBulk.recalculateBulkCheckboxes()}selectTags(e){if(!e)return;if(!this.entryHelper.validateTag(e))return;const t=Object(Pt.e)(this.timeEntry.tags);this.timeEntry.tags=e,this.timeEntry.children.forEach(e=>e.tags=Object(Pt.e)(this.timeEntry.tags)),this.trackerService.updateGroup(this.timeEntry.children.map(e=>e.id),[Mp.a.TAG],this.timeEntry).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.refreshView.emit(this.timeEntry.expanded)},e=>{this.timeEntry.tags=t,this.timeEntry.children.forEach(e=>e.tags=Object(Pt.e)(t)),this.cd.detectChanges()})}deleteTimeEntryConfirmed(){this.trackerService.deleteMany(this.getChildrenIds(),this.userId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.entryIsDeleted.emit(this.timeEntry)})}getChildrenIds(){return this.timeEntry.children?this.timeEntry.children.map(e=>e.id):null}notifyParentSingleEntryChanged(){this.cd.detectChanges()}saveProjectAndTask(e,t,i,n){const s=this.timeEntry.billable;n&&n.project&&(this.timeEntry.billable=n.project.billable),this.workspace.taskBillableEnabled&&n&&n.task&&(this.timeEntry.billable=n.task.billable),this.timeEntry.children.forEach(e=>{e.billable=this.timeEntry.billable,this.setProjectToEntry(At.a.clone(this.timeEntry),e),e.workspaceId=i});const c=[Mp.a.PROJECT,Mp.a.BILLABLE];this.timeEntry.task&&c.push(Mp.a.TASK),this.trackerService.updateGroup(this.timeEntry.children.map(e=>e.id),c,this.timeEntry).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{t===e[0].workspaceId?(this.timeEntry.customFieldValues=e[0].customFieldValues,this.timeEntry.children.forEach(e=>{e.customFieldValues=this.timeEntry.customFieldValues}),this.refreshView.emit(this.timeEntry.expanded)):this.entryIsDeleted.emit(this.timeEntry)},t=>{this.timeEntry.billable=s,this.setProjectToEntry(e,this.timeEntry),this.timeEntry.workspaceId=e.workspaceId,this.timeEntry.children.forEach(t=>{t.billable=s,this.setProjectToEntry(Object(Pt.e)(e),t),t.workspaceId=e.workspaceId}),this.cd.detectChanges()})}get allChilds(){return this.timeEntry.children?this.timeEntry.children.length:0}get bulkSelected(){return this.timeEntry.children&&this.timeEntry.children.filter(e=>e.bulkEdit).length||0}entryChanged(e){this.trackerService.updateGroup(this.timeEntry.children.map(e=>e.id),[Mp.a.CUSTOM_FIELDS],this.timeEntry,[new gp.a({customFieldId:e.customFieldId,value:e.value})]).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.timeEntry.customFieldValues=e[0].customFieldValues,this.timeEntry.children.forEach(e=>e.customFieldValues=this.timeEntry.customFieldValues),this.refreshView.emit(this.timeEntry.expanded)})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb($d.a),c.Rb(Gd.a),c.Rb(_d.a),c.Rb(M.a),c.Rb(Vd.a),c.Rb(g.q),c.Rb(xe),c.Rb(U.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["parent-tracker-entry"]],inputs:{childrenLength:"childrenLength",userId:"userId"},outputs:{refreshView:"refreshView",onBulkEditChange:"onBulkEditChange"},features:[c.zb],decls:38,vars:26,consts:[["tabRow","",1,"cl-flex-container","cl-tracker-entry",3,"ngClass"],[1,"cl-col-responsive","cl-description-col","cl-flex-grow-0"],[1,"cl-d-flex","cl-align-items-center","cl-mr-2"],["class","cl-custom-control cl-custom-checkbox cl-ml-2",4,"ngIf"],["class","cl-badge-same-entries-wrapper cl-non-selectable",3,"title","keyup.space","keyup.enter","click",4,"ngIf"],[1,"cl-fake-input-wrapper","cl-cut-text","cl-w-100"],["type","text","tabindex","0","placeholder","Add description","autocomplete","off","spellcheck","true",1,"cl-form-control","cl-input-description",3,"disabled","ngModel","ngModelChange","change","focus","keyup.enter"],["description",""],[1,"cl-form-control","cl-fake-input"],[1,"cl-col-responsive","cl-project-col"],["tabCell","",1,"cl-dropdown","cl-dropdown-large","cl-d-flex","cl-w-100",3,"dropdownKey"],[1,"cl-cut-text","cl-w-100-hidden"],[3,"project","projectData","task"],["openUpAtBottom","","class","cl-dropdown-menu","resizeable","",3,"selectedProject","selectedTask","hideWorkspaces","resizeableName","selectedProjectAndTask","onResize",4,"dropdownKeyContent"],["tabFocus","","tabindex","0"],["projectTabFocus",""],[1,"cl-col-responsive","cl-tag-col"],["tabCell","",1,"cl-dropdown","cl-d-flex","cl-w-100","cl-cut-text-wrapper","cl-justify-content-end",3,"dropdownKey"],["dropdownKeyButton","","tabindex","0",1,"cl-cut-text","pointer",3,"tags"],["openUpAtBottom","","class","cl-dropdown-menu cl-entry-tag-dropdown","resizeable","",3,"entryTags","resizeableName","resizeToLeft","close",4,"dropdownKeyContent"],[1,"cl-col-fixed"],[1,"cl-timetracker-list-actions","cl-d-flex","cl-justify-content-between","cl-w-100"],[1,"cl-component-divided-left","cl-remove-divider-mob",3,"disableEdit","billable","changed"],[1,"cl-d-flex","cl-w-100",3,"disableEdit","dateTime","click","pickedDate"],[1,"cl-component-divided-left","cl-d-md-inline-flex","cl-input-time-wrapper","cl-entry-duration","cl-m-abs","cl-remove-divider-mob",3,"click"],[4,"ngIf","ngIfElse"],["inputComponent",""],["title","Continue timer for this activity","tabindex","0",1,"cl-component-divided-left","cl-icon-play","pointer","cl-non-selectable",3,"keyup.space","keyup.enter","click"],["play",""],["src","assets/images/ui-icons/play.svg"],["class","cl-dropdown cl-tree-dots cl-d-flex",4,"ngIf","ngIfElse"],["optionsTemplate",""],[3,"timeEntryId","projectId","customFields","isLocked","disableEdit","customFieldValues","entryChanged","manyChanged",4,"ngIf"],["content",""],[1,"cl-custom-control","cl-custom-checkbox","cl-ml-2"],["class","cl-custom-control-input","type","checkbox",3,"ngModel","id","ngModelChange","change","keyup.enter",4,"ngIf"],["class","cl-custom-control-input","type","checkbox",3,"ngModel","indeterminate","id","change","keyup.enter",4,"ngIf"],[1,"cl-custom-control-label",3,"for"],["type","checkbox",1,"cl-custom-control-input",3,"ngModel","id","ngModelChange","change","keyup.enter"],["type","checkbox",1,"cl-custom-control-input",3,"ngModel","indeterminate","id","change","keyup.enter"],[1,"cl-badge-same-entries-wrapper","cl-non-selectable",3,"title","keyup.space","keyup.enter","click"],[1,"cl-badge","cl-badge-same-entries"],["openUpAtBottom","","resizeable","",1,"cl-dropdown-menu",3,"selectedProject","selectedTask","hideWorkspaces","resizeableName","selectedProjectAndTask","onResize"],["projectPicker",""],["openUpAtBottom","","resizeable","",1,"cl-dropdown-menu","cl-entry-tag-dropdown",3,"entryTags","resizeableName","resizeToLeft","close"],["type","text","disabled","",1,"cl-form-control","cl-input-time-picker-sum",3,"ngModel"],[3,"format","timeInterval","disable","onFocus","timeChanged"],[1,"cl-dropdown","cl-tree-dots","cl-d-flex"],[1,"cl-non-selectable","cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow","approval-icon-align"],["title","Can't edit approved entries.","src","assets/ui-icons/checkmark-green-circle.svg",4,"ngIf","ngIfElse"],["lockIconTemplate",""],["title","Can't edit approved entries.","src","assets/ui-icons/checkmark-green-circle.svg"],["title","Can't edit locked entries. Contact your admin for more information.","src","assets/images/ui-icons/locked.svg"],["class","cl-dropdown cl-tree-dots cl-d-flex","dropdownKey","","tabCell","",4,"ngIf"],["dropdownKey","","tabCell","",1,"cl-dropdown","cl-tree-dots","cl-d-flex"],["dropdownKeyButton","","tabindex","0",1,"pointer","cl-non-selectable","cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical.svg"],["openUpAtBottom","","class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["tabFocusDuplicate",""],["openUpAtBottom","",1,"cl-dropdown-menu","cl-dropdown-menu-right"],["class","cl-dropdown-item","clickCloseDropdown","","tabindex","-1",3,"keyup.enter","keyup.space","click",4,"ngIf"],["tabindex","-1","clickCloseDropdown","",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],["clickCloseDropdown","","tabindex","-1",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],[3,"timeEntryId","projectId","customFields","isLocked","disableEdit","customFieldValues","entryChanged","manyChanged"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-mb-0"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"click"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-danger",3,"click"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"span",2),c.Wc(3,$h,4,3,"div",3),c.Wc(4,_h,3,2,"a",4),c.Xb(5,"div",5),c.Xb(6,"input",6,7),c.jc("ngModelChange",(function(e){return t.timeEntry.description=e}))("change",(function(){return t.updateDescription()}))("focus",(function(){return t.backupDescription=t.timeEntry.description}))("keyup.enter",(function(){return c.Oc(e),c.Lc(7).blur()})),c.Wb(),c.Xb(8,"div",8),c.Yc(9),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(10,"div",9),c.Xb(11,"div",10),c.Xb(12,"div",11),c.Sb(13,"project-picker-label",12),c.Wb(),c.Wc(14,Gh,2,4,"project-picker",13),c.Sb(15,"span",14,15),c.Wb(),c.Wb(),c.Xb(17,"div",16),c.Xb(18,"div",17),c.Sb(19,"tag-names",18),c.Wc(20,Bh,1,3,"tag-dropdown",19),c.Wb(),c.Wb(),c.Xb(21,"div",20),c.Xb(22,"div",21),c.Xb(23,"billable-icon",22),c.jc("changed",(function(e){return t.changeBillable(e)})),c.Wb(),c.Xb(24,"single-date-picker2",23),c.jc("click",(function(e){return t.toggleCollapseSameEntries(e)}))("pickedDate",(function(e){return t.dateTimeChanged(e)})),c.Wb(),c.Xb(25,"div",24),c.jc("click",(function(e){return t.toggleCollapseSameEntries(e)})),c.Wc(26,Vh,3,4,"div",25),c.Wc(27,Hh,1,3,"ng-template",null,26,c.Xc),c.Wb(),c.Xb(29,"div",27,28),c.jc("keyup.space",(function(){return t.setEntryToPlay()}))("keyup.enter",(function(){return t.setEntryToPlay()}))("click",(function(){c.Oc(e);const i=c.Lc(30);return t.setEntryToPlay(),i.blur()})),c.Sb(31,"img",29),c.Wb(),c.Wc(32,Kh,5,2,"div",30),c.Wc(33,em,1,1,"ng-template",null,31,c.Xc),c.Wb(),c.Wb(),c.Wb(),c.Wc(35,tm,1,6,"custom-fields-values",32),c.Wc(36,im,14,2,"ng-template",null,33,c.Xc)}if(2&e){const e=c.Lc(28),i=c.Lc(34);c.wc("ngClass",c.Bc(24,nm,t.disableEdit)),c.Cb(3),c.wc("ngIf",t.editMode&&!t.disableEdit),c.Cb(1),c.wc("ngIf",null==t.timeEntry||null==t.timeEntry.children?null:t.timeEntry.children.length),c.Cb(2),c.wc("disabled",t.disableEdit)("ngModel",t.timeEntry.description),c.Db("title",t.timeEntry.description),c.Cb(3),c.ad(" ",t.timeEntry.description," "),c.Cb(2),c.wc("dropdownKey",t.disableEdit),c.Cb(2),c.wc("project",t.timeEntry.project)("projectData",t.projectData)("task",t.timeEntry.task),c.Cb(4),c.Hb("cl-has-tags",t.timeEntry.tags&&t.timeEntry.tags.length>0),c.Cb(1),c.wc("dropdownKey",t.disableEdit),c.Cb(1),c.wc("tags",t.timeEntry.tags),c.Cb(4),c.wc("disableEdit",t.disableEdit)("billable",t.timeEntry.billable),c.Cb(1),c.wc("disableEdit",t.disableManualModeEdit||t.disableEdit||(null==t.timeEntry.children?null:t.timeEntry.children.length))("dateTime",t.timeEntry.timeInterval),c.Cb(2),c.wc("ngIf",t.disableManualModeEdit||(null==t.timeEntry.children?null:t.timeEntry.children.length))("ngIfElse",e),c.Cb(6),c.wc("ngIf",t.disableEdit)("ngIfElse",i),c.Cb(3),c.wc("ngIf",(null==t.customFields?null:t.customFields.length)>0)}},directives:[s.r,s.u,p.c,p.s,p.v,Si.a,Yp.a,Oi.a,Gp,Ii.a,Bp.a,so.a,p.a,Vp.a,Hp.a,zp.a,qp.a,Ni.a,nh.a],pipes:[yh.a],encapsulation:2,changeDetection:0}),e})();function cm(e,t){if(1&e){const e=c.Yb();c.Xb(0,"input",38),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc(2).timeEntry.bulkEdit=t}))("change",(function(){c.Oc(e);const t=c.nc(2);return t.signleBulkChange(t.timeEntry.bulkEdit)}))("keyup.enter",(function(){c.Oc(e);const t=c.nc(2);return t.timeEntry.bulkEdit=!t.timeEntry.bulkEdit,t.signleBulkChange(t.timeEntry.bulkEdit)})),c.Wb()}if(2&e){const e=c.nc(2);c.yc("id","edit_",e.timeEntry.id,""),c.wc("ngModel",e.timeEntry.bulkEdit)}}function rm(e,t){if(1&e){const e=c.Yb();c.Xb(0,"input",39),c.jc("change",(function(){return c.Oc(e),c.nc(2).groupBulkChange()}))("keyup.enter",(function(){return c.Oc(e),c.nc(2).groupBulkChange()})),c.Wb()}if(2&e){const e=c.nc(2);c.yc("id","edit_",e.timeEntry.id,""),c.wc("ngModel",e.bulkSelected===e.allChilds)("indeterminate",e.bulkSelected>0&&e.bulkSelected<e.allChilds)}}function om(e,t){if(1&e&&(c.Xb(0,"div",34),c.Wc(1,cm,1,2,"input",35),c.Wc(2,rm,1,3,"input",36),c.Sb(3,"label",37),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",!(null!=e.timeEntry&&null!=e.timeEntry.children&&e.timeEntry.children.length)),c.Cb(1),c.wc("ngIf",null==e.timeEntry||null==e.timeEntry.children?null:e.timeEntry.children.length),c.Cb(1),c.yc("for","edit_",e.timeEntry.id,"")}}function am(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",40),c.jc("keyup.space",(function(){return c.Oc(e),c.nc().toggleCollapseSameEntries()}))("keyup.enter",(function(){return c.Oc(e),c.nc().toggleCollapseSameEntries()}))("click",(function(){return c.Oc(e),c.nc().toggleCollapseSameEntries()})),c.Xb(1,"span",41),c.Yc(2),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title",e.childrenLength+" time entries (click to toggle)"),c.Cb(2),c.Zc(e.childrenLength)}}function lm(e,t){if(1&e){const e=c.Yb();c.Xb(0,"project-picker",42,43),c.jc("selectedProjectAndTask",(function(t){c.Oc(e);const i=c.nc(),n=c.Lc(16);return i.selectProjectAndTask(t,n)}))("onResize",(function(t){return c.Oc(e),c.Lc(1).onResizeChange(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("selectedProject",e.timeEntry.project)("selectedTask",e.timeEntry.task)("hideWorkspaces",e.hideWorkspacesInPicker)("resizeableName","projectPicker")}}function bm(e,t){if(1&e){const e=c.Yb();c.Xb(0,"tag-dropdown",44),c.jc("close",(function(t){return c.Oc(e),c.nc().selectTags(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("entryTags",e.timeEntry.tags)("resizeableName","tagPicker")("resizeToLeft",!0)}}function um(e,t){if(1&e&&(c.Xb(0,"div"),c.Sb(1,"input",45),c.oc(2,"timeFormat"),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngModel",c.qc(2,1,e.timeEntry.timeInterval.duration,e.format))}}function dm(e,t){if(1&e){const e=c.Yb();c.Xb(0,"input-duration",46),c.jc("onFocus",(function(){return c.Oc(e),c.nc().closeDatepicker()}))("timeChanged",(function(t){return c.Oc(e),c.nc().dateTimeChanged(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("format",e.format)("timeInterval",e.timeEntry.timeInterval)("disable",e.disableEdit||(null==e.timeEntry.children?null:e.timeEntry.children.length))}}function pm(e,t){1&e&&c.Sb(0,"img",51)}function hm(e,t){1&e&&c.Sb(0,"img",52)}function mm(e,t){if(1&e&&(c.Xb(0,"div",47),c.Xb(1,"div",48),c.Wc(2,pm,1,0,"img",49),c.Wc(3,hm,1,0,"ng-template",null,50,c.Xc),c.Wb(),c.Wb()),2&e){const e=c.Lc(4),t=c.nc();c.Cb(2),c.wc("ngIf",t.timeEntry.approvalRequestId)("ngIfElse",e)}}function gm(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",62),c.jc("keyup.enter",(function(){return c.Oc(e),c.nc(4).duplicateEntry()}))("keyup.space",(function(){return c.Oc(e),c.nc(4).duplicateEntry()}))("click",(function(){return c.Oc(e),c.nc(4).duplicateEntry()})),c.Yc(1," Duplicate "),c.Wb()}}function fm(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",59),c.Xb(1,"list-items"),c.Wc(2,gm,2,0,"a",60),c.Xb(3,"a",61),c.jc("keyup.enter",(function(){c.Oc(e);const t=c.nc(3),i=c.Lc(37);return t.openDeleteModal(i)}))("keyup.space",(function(){c.Oc(e);const t=c.nc(3),i=c.Lc(37);return t.openDeleteModal(i)}))("click",(function(){c.Oc(e);const t=c.nc(3),i=c.Lc(37);return t.openDeleteModal(i)})),c.Yc(4," Delete "),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc(3);c.Cb(2),c.wc("ngIf",!e.disableManualModeEdit)}}function vm(e,t){1&e&&(c.Xb(0,"div",54),c.Xb(1,"div",55),c.Sb(2,"img",56),c.Wb(),c.Wc(3,fm,5,1,"div",57),c.Sb(4,"span",14,58),c.Wb())}function wm(e,t){if(1&e&&c.Wc(0,vm,6,0,"div",53),2&e){const e=c.nc();c.wc("ngIf",!e.disableEdit)}}function ym(e,t){if(1&e){const e=c.Yb();c.Xb(0,"custom-fields-values",63),c.jc("entryChanged",(function(t){return c.Oc(e),c.nc().entryChanged(t)}))("manyChanged",(function(t){return c.Oc(e),c.nc().entryChanged(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("timeEntryId",e.timeEntry.id)("projectId",null==e.timeEntry.project?null:e.timeEntry.project.id)("customFields",e.customFields)("isLocked",e.timeEntry.isLocked)("disableEdit",e.timeEntry.approvalRequestId)("customFieldValues",e.timeEntry.customFieldValues)}}function Wm(e,t){if(1&e&&(c.Xb(0,"div",64),c.Xb(1,"h1",65),c.Yc(2,"Delete"),c.Wb(),c.Xb(3,"button",66),c.jc("click",(function(){return t.$implicit.dismiss()})),c.Xb(4,"span",67),c.Sb(5,"img",68),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",69),c.Xb(7,"p",70),c.Yc(8),c.Wb(),c.Wb(),c.Xb(9,"div",71),c.Xb(10,"a",72),c.jc("click",(function(){return t.$implicit.close()})),c.Yc(11,"Cancel"),c.Wb(),c.Xb(12,"button",73),c.jc("click",(function(){return t.$implicit.close(!0)})),c.Yc(13,"Delete"),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(8),c.bd("Are you sure you want to delete ",e.entriesToModify," ",e.entriesToModify?"entries":"entry","?")}}const Cm=function(e){return{"cl-locked":e}};let km=(()=>{class e extends Fh{constructor(e,t,i,n,s,r,o,a,l){super(e,t,i,n,s,r,o,a,l),this.trackerService=e,this.entryHelper=t,this.entryGroupService=i,this.toaster=n,this.keyboardService=s,this.modalService=r,this.entryBulk=o,this.workspaceService=a,this.cd=l,this.singleEntryChanged=new c.n,this.onSignleBulkChange=new c.n,this.entryDurationChanged=new c.n}getId(){return this.timeEntry.id}triggerDetection(){this.timeEntry.customFieldValues&&(this.timeEntry.customFieldValues=this.timeEntry.customFieldValues.map(e=>gp.a.clone(e))),this.cd.detectChanges()}updateDescription(){this.timeEntry.description=Object(Pt.G)(this.timeEntry.description,this.toaster),this.entryHelper.validateDescription(this.timeEntry.description)?this.trackerService.updateDescription(this.timeEntry.id,this.timeEntry.description).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.singleEntryChanged.emit(this.timeEntry)},()=>{this.timeEntry.description=this.backupDescription,this.cd.markForCheck()}):this.timeEntry.description=this.backupDescription}changeBillable(e){const t=this.timeEntry.billable;t!==e&&(this.timeEntry.billable=e,this.trackerService.updateBillable(this.timeEntry.id,e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.timeEntry.billable=e.billable,this.singleEntryChanged.emit(this.timeEntry)},()=>{this.timeEntry.billable=t,this.cd.detectChanges()}))}dateTimeChanged(e){const t=new ep.a(this.timeEntry.timeInterval);this.timeEntry.timeInterval=new ep.a(e),this.trackerService.editTimeInterval(this.timeEntry.id,e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{if(this.timeEntry.timeInterval=e.timeInterval,jt(e.timeInterval.start).isSame(t.start,"day"))this.entryDurationChanged.emit({newInterval:e.timeInterval,oldInterval:t});else{const e=At.a.clone(this.timeEntry);this.entryIsDeleted.emit(this.timeEntry),this.entryGroupService.setNewEntryCreated(e)}},e=>{this.timeEntry.timeInterval=t,this.cd.detectChanges()})}selectTags(e){if(!e)return;if(!this.entryHelper.validateTag(e))return;const t=Object(Pt.e)(this.timeEntry.tags);this.timeEntry.tags=e,this.cd.markForCheck(),this.trackerService.updateTags(this.timeEntry.id,e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.singleEntryChanged.emit(this.timeEntry)},()=>{this.timeEntry.tags=t,this.cd.detectChanges()})}deleteTimeEntryConfirmed(){this.trackerService.deleteTimeEntry(this.timeEntry).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.entryIsDeleted.emit(this.timeEntry)})}signleBulkChange(e){this.onSignleBulkChange.next(e),this.entryBulk.recalculateBulkCheckboxes()}saveProjectAndTask(e,t,i,n){this.trackerService.updateProjectAndTask(this.timeEntry,i).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{t===e.workspaceId?(this.projectAttributeTitle=Object(Pt.o)(this.timeEntry),this.timeEntry.billable!=e.billable&&(this.timeEntry.billable=e.billable),this.timeEntry.customFieldValues=e.customFieldValues,this.singleEntryChanged.emit(this.timeEntry)):this.entryIsDeleted.emit(this.timeEntry)},t=>{this.setProjectToEntry(e,this.timeEntry),this.timeEntry.workspaceId=e.workspaceId,this.cd.detectChanges()})}entryChanged(e){this.timeEntry.customFieldValues=e,this.singleEntryChanged.emit(this.timeEntry)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb($d.a),c.Rb(Gd.a),c.Rb(_d.a),c.Rb(M.a),c.Rb(Vd.a),c.Rb(g.q),c.Rb(xe),c.Rb(U.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["time-tracker-entry"]],outputs:{singleEntryChanged:"singleEntryChanged",onSignleBulkChange:"onSignleBulkChange",entryDurationChanged:"entryDurationChanged"},features:[c.zb],decls:38,vars:26,consts:[["tabRow","",1,"cl-flex-container","cl-tracker-entry",3,"ngClass"],[1,"cl-col-responsive","cl-description-col","cl-flex-grow-0"],[1,"cl-d-flex","cl-align-items-center","cl-mr-2"],["class","cl-custom-control cl-custom-checkbox cl-ml-2",4,"ngIf"],["class","cl-badge-same-entries-wrapper cl-non-selectable",3,"title","keyup.space","keyup.enter","click",4,"ngIf"],[1,"cl-fake-input-wrapper","cl-cut-text","cl-w-100"],["type","text","tabindex","0","placeholder","Add description","autocomplete","off","spellcheck","true",1,"cl-form-control","cl-input-description",3,"disabled","ngModel","ngModelChange","change","focus","keyup.enter"],["description",""],[1,"cl-form-control","cl-fake-input"],[1,"cl-col-responsive","cl-project-col"],["tabCell","",1,"cl-dropdown","cl-dropdown-large","cl-d-flex","cl-w-100",3,"dropdownKey"],[1,"cl-cut-text","cl-w-100-hidden"],[3,"project","projectData","task"],["openUpAtBottom","","class","cl-dropdown-menu","resizeable","",3,"selectedProject","selectedTask","hideWorkspaces","resizeableName","selectedProjectAndTask","onResize",4,"dropdownKeyContent"],["tabFocus","","tabindex","0"],["projectTabFocus",""],[1,"cl-col-responsive","cl-tag-col"],["tabCell","",1,"cl-dropdown","cl-d-flex","cl-w-100","cl-cut-text-wrapper","cl-justify-content-end",3,"dropdownKey"],["dropdownKeyButton","","tabindex","0",1,"cl-cut-text","pointer",3,"tags"],["openUpAtBottom","","class","cl-dropdown-menu cl-entry-tag-dropdown","resizeable","",3,"entryTags","resizeableName","resizeToLeft","close",4,"dropdownKeyContent"],[1,"cl-col-fixed"],[1,"cl-timetracker-list-actions","cl-d-flex","cl-justify-content-between","cl-w-100"],[1,"cl-component-divided-left","cl-remove-divider-mob",3,"disableEdit","billable","changed"],[1,"cl-d-flex","cl-w-100",3,"disableEdit","dateTime","click","pickedDate"],[1,"cl-component-divided-left","cl-d-md-inline-flex","cl-input-time-wrapper","cl-entry-duration","cl-m-abs","cl-remove-divider-mob",3,"click"],[4,"ngIf","ngIfElse"],["inputComponent",""],["title","Continue timer for this activity","tabindex","0",1,"cl-component-divided-left","cl-icon-play","pointer","cl-non-selectable",3,"keyup.space","keyup.enter","click"],["play",""],["src","assets/images/ui-icons/play.svg"],["class","cl-dropdown cl-tree-dots cl-d-flex",4,"ngIf","ngIfElse"],["optionsTemplate",""],[3,"timeEntryId","projectId","customFields","isLocked","disableEdit","customFieldValues","entryChanged","manyChanged",4,"ngIf"],["content",""],[1,"cl-custom-control","cl-custom-checkbox","cl-ml-2"],["class","cl-custom-control-input","type","checkbox",3,"ngModel","id","ngModelChange","change","keyup.enter",4,"ngIf"],["class","cl-custom-control-input","type","checkbox",3,"ngModel","indeterminate","id","change","keyup.enter",4,"ngIf"],[1,"cl-custom-control-label",3,"for"],["type","checkbox",1,"cl-custom-control-input",3,"ngModel","id","ngModelChange","change","keyup.enter"],["type","checkbox",1,"cl-custom-control-input",3,"ngModel","indeterminate","id","change","keyup.enter"],[1,"cl-badge-same-entries-wrapper","cl-non-selectable",3,"title","keyup.space","keyup.enter","click"],[1,"cl-badge","cl-badge-same-entries"],["openUpAtBottom","","resizeable","",1,"cl-dropdown-menu",3,"selectedProject","selectedTask","hideWorkspaces","resizeableName","selectedProjectAndTask","onResize"],["projectPicker",""],["openUpAtBottom","","resizeable","",1,"cl-dropdown-menu","cl-entry-tag-dropdown",3,"entryTags","resizeableName","resizeToLeft","close"],["type","text","disabled","",1,"cl-form-control","cl-input-time-picker-sum",3,"ngModel"],[3,"format","timeInterval","disable","onFocus","timeChanged"],[1,"cl-dropdown","cl-tree-dots","cl-d-flex"],[1,"cl-non-selectable","cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow","approval-icon-align"],["title","Can't edit approved entries.","src","assets/ui-icons/checkmark-green-circle.svg",4,"ngIf","ngIfElse"],["lockIconTemplate",""],["title","Can't edit approved entries.","src","assets/ui-icons/checkmark-green-circle.svg"],["title","Can't edit locked entries. Contact your admin for more information.","src","assets/images/ui-icons/locked.svg"],["class","cl-dropdown cl-tree-dots cl-d-flex","dropdownKey","","tabCell","",4,"ngIf"],["dropdownKey","","tabCell","",1,"cl-dropdown","cl-tree-dots","cl-d-flex"],["dropdownKeyButton","","tabindex","0",1,"pointer","cl-non-selectable","cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical.svg"],["openUpAtBottom","","class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["tabFocusDuplicate",""],["openUpAtBottom","",1,"cl-dropdown-menu","cl-dropdown-menu-right"],["class","cl-dropdown-item","clickCloseDropdown","","tabindex","-1",3,"keyup.enter","keyup.space","click",4,"ngIf"],["tabindex","-1","clickCloseDropdown","",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],["clickCloseDropdown","","tabindex","-1",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],[3,"timeEntryId","projectId","customFields","isLocked","disableEdit","customFieldValues","entryChanged","manyChanged"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-mb-0"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"click"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-danger",3,"click"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"span",2),c.Wc(3,om,4,3,"div",3),c.Wc(4,am,3,2,"a",4),c.Xb(5,"div",5),c.Xb(6,"input",6,7),c.jc("ngModelChange",(function(e){return t.timeEntry.description=e}))("change",(function(){return t.updateDescription()}))("focus",(function(){return t.backupDescription=t.timeEntry.description}))("keyup.enter",(function(){return c.Oc(e),c.Lc(7).blur()})),c.Wb(),c.Xb(8,"div",8),c.Yc(9),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(10,"div",9),c.Xb(11,"div",10),c.Xb(12,"div",11),c.Sb(13,"project-picker-label",12),c.Wb(),c.Wc(14,lm,2,4,"project-picker",13),c.Sb(15,"span",14,15),c.Wb(),c.Wb(),c.Xb(17,"div",16),c.Xb(18,"div",17),c.Sb(19,"tag-names",18),c.Wc(20,bm,1,3,"tag-dropdown",19),c.Wb(),c.Wb(),c.Xb(21,"div",20),c.Xb(22,"div",21),c.Xb(23,"billable-icon",22),c.jc("changed",(function(e){return t.changeBillable(e)})),c.Wb(),c.Xb(24,"single-date-picker2",23),c.jc("click",(function(e){return t.toggleCollapseSameEntries(e)}))("pickedDate",(function(e){return t.dateTimeChanged(e)})),c.Wb(),c.Xb(25,"div",24),c.jc("click",(function(e){return t.toggleCollapseSameEntries(e)})),c.Wc(26,um,3,4,"div",25),c.Wc(27,dm,1,3,"ng-template",null,26,c.Xc),c.Wb(),c.Xb(29,"div",27,28),c.jc("keyup.space",(function(){return t.setEntryToPlay()}))("keyup.enter",(function(){return t.setEntryToPlay()}))("click",(function(){c.Oc(e);const i=c.Lc(30);return t.setEntryToPlay(),i.blur()})),c.Sb(31,"img",29),c.Wb(),c.Wc(32,mm,5,2,"div",30),c.Wc(33,wm,1,1,"ng-template",null,31,c.Xc),c.Wb(),c.Wb(),c.Wb(),c.Wc(35,ym,1,6,"custom-fields-values",32),c.Wc(36,Wm,14,2,"ng-template",null,33,c.Xc)}if(2&e){const e=c.Lc(28),i=c.Lc(34);c.wc("ngClass",c.Bc(24,Cm,t.disableEdit)),c.Cb(3),c.wc("ngIf",t.editMode&&!t.disableEdit),c.Cb(1),c.wc("ngIf",null==t.timeEntry||null==t.timeEntry.children?null:t.timeEntry.children.length),c.Cb(2),c.wc("disabled",t.disableEdit)("ngModel",t.timeEntry.description),c.Db("title",t.timeEntry.description),c.Cb(3),c.ad(" ",t.timeEntry.description," "),c.Cb(2),c.wc("dropdownKey",t.disableEdit),c.Cb(2),c.wc("project",t.timeEntry.project)("projectData",t.projectData)("task",t.timeEntry.task),c.Cb(4),c.Hb("cl-has-tags",t.timeEntry.tags&&t.timeEntry.tags.length>0),c.Cb(1),c.wc("dropdownKey",t.disableEdit),c.Cb(1),c.wc("tags",t.timeEntry.tags),c.Cb(4),c.wc("disableEdit",t.disableEdit)("billable",t.timeEntry.billable),c.Cb(1),c.wc("disableEdit",t.disableManualModeEdit||t.disableEdit||(null==t.timeEntry.children?null:t.timeEntry.children.length))("dateTime",t.timeEntry.timeInterval),c.Cb(2),c.wc("ngIf",t.disableManualModeEdit||(null==t.timeEntry.children?null:t.timeEntry.children.length))("ngIfElse",e),c.Cb(6),c.wc("ngIf",t.disableEdit)("ngIfElse",i),c.Cb(3),c.wc("ngIf",(null==t.customFields?null:t.customFields.length)>0)}},directives:[s.r,s.u,p.c,p.s,p.v,Si.a,Yp.a,Oi.a,Gp,Ii.a,Bp.a,so.a,p.a,Vp.a,Hp.a,zp.a,qp.a,Ni.a,nh.a],pipes:[yh.a],encapsulation:2,changeDetection:0}),e})();var Sm=i("JO38");const Im=["dropdown"];function Om(e,t){1&e&&c.Sb(0,"div",47)}function Xm(e,t){1&e&&c.Sb(0,"div",47)}function Em(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Sb(1,"hr",14),c.Xb(2,"div",5),c.Xb(3,"div",6),c.Xb(4,"div",7),c.Xb(5,"input",48),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().user=t})),c.Wb(),c.Xb(6,"label",49),c.Yc(7,"User"),c.Wb(),c.Wb(),c.Wb(),c.Xb(8,"div",10),c.Wc(9,Xm,1,0,"div",11),c.Xb(10,"dropdown-items",50,51),c.jc("click",(function(){c.Oc(e);const t=c.Lc(11),i=c.nc();return!i.hasChangeUserPermission&&i.showPopup(t)}))("onFilterOptionChange",(function(t){return c.Oc(e),c.nc().onFilterChange(t)}))("onChangedDropdown",(function(t){c.Oc(e);const i=c.nc();return i.timeEntry.user.id=t.value,i.timeEntry.user.name=t.label}))("loadMore",(function(){return c.Oc(e),c.nc().loadMoreUsers()}))("onOpen",(function(){return c.Oc(e),c.nc().getUsers()})),c.Wb(),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=c.nc(),t=c.Lc(83);c.Cb(5),c.wc("ngModel",e.user),c.Cb(4),c.wc("ngIf",!e.user),c.Cb(1),c.wc("ngbPopover",t)("enableSearch",!0)("filterQuery",e.usersQuery)("list",e.users)("placeholder","Search users")("initLabel",e.timeEntry.user.name||"Select user")("itemLabel",e.timeEntry.user.name)("value",e.timeEntry.user.id)("isDisabled",!e.hasChangeUserPermission)("offlineSearch",!1)}}function Tm(e,t){1&e&&c.Sb(0,"div",47)}function Dm(e,t){if(1&e&&(c.Vb(0),c.Yc(1),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.timeEntry.project.name+(e.timeEntry.task?": "+e.timeEntry.task.name:"")," ")}}function Rm(e,t){1&e&&c.Yc(0," Select project ")}function Am(e,t){if(1&e){const e=c.Yb();c.Xb(0,"project-picker",52),c.jc("selectedProjectAndTask",(function(t){return c.Oc(e),c.nc().selectProjectAndTask(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("selectedProject",e.timeEntry.project)("selectedTask",e.timeEntry.task)("hideWorkspaces",e.hideWorkspacesInPicker)}}function jm(e,t){1&e&&c.Sb(0,"div",47)}function xm(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=t.$implicit,i=t.last;c.Cb(1),c.bd(" ",e.name," ",i?"":", "," ")}}function Pm(e,t){if(1&e&&(c.Vb(0),c.Wc(1,xm,2,2,"span",53),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.wc("ngForOf",e.timeEntry.tags)}}function Mm(e,t){1&e&&c.Yc(0," Select tags ")}function Ym(e,t){if(1&e){const e=c.Yb();c.Xb(0,"tag-dropdown",54),c.jc("close",(function(t){return c.Oc(e),c.nc().closeTagDropdown(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("resizeableName","tagPicker")("entryTags",e.timeEntry.tags)}}function Lm(e,t){1&e&&c.Sb(0,"div",47)}function Fm(e,t){1&e&&c.Sb(0,"div",47)}function Nm(e,t){1&e&&c.Sb(0,"div",47)}function Um(e,t){1&e&&c.Sb(0,"div",47)}function $m(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Sb(1,"hr",14),c.Xb(2,"div",55),c.Xb(3,"div",6),c.Xb(4,"div",7),c.Xb(5,"input",56),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().time=t})),c.Wb(),c.Xb(6,"label",57),c.Yc(7,"Time"),c.Wb(),c.Wb(),c.Wb(),c.Xb(8,"div",10),c.Wc(9,Nm,1,0,"div",11),c.Xb(10,"div",58),c.Xb(11,"single-date-picker2",59),c.jc("pickedDate",(function(t){return c.Oc(e),c.nc().pickedDateAndTime(t)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(12,"hr",14),c.Xb(13,"div",55),c.Xb(14,"div",6),c.Xb(15,"div",7),c.Xb(16,"input",60),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().date=t})),c.Wb(),c.Xb(17,"label",61),c.Yc(18,"Date"),c.Wb(),c.Wb(),c.Wb(),c.Xb(19,"div",10),c.Wc(20,Um,1,0,"div",11),c.Xb(21,"div",62),c.Xb(22,"single-date-picker2",63),c.jc("pickedDate",(function(t){return c.Oc(e),c.nc().pickedDateAndTime(t)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(2),c.wc("ngbTooltip",e.isRounding?"Editing time is not allowed while rounding is turned on.":""),c.Cb(3),c.wc("disabled",e.isRounding)("ngModel",e.time),c.Cb(4),c.wc("ngIf",!e.time),c.Cb(2),c.wc("debounce",!1)("dateTime",e.timeEntry.timeInterval)("mode","time_only"),c.Cb(2),c.wc("ngbTooltip",e.isRounding?"Editing date is not allowed while rounding is turned on.":""),c.Cb(3),c.wc("disabled",e.isRounding)("ngModel",e.date),c.Cb(4),c.wc("ngIf",!e.date),c.Cb(2),c.wc("debounce",!1)("dateTime",e.timeEntry.timeInterval)("textualDate",!0)("openUp",!0)("mode","date_only")}}function _m(e,t){1&e&&c.Sb(0,"div",47)}function Gm(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",65),c.Xb(1,"div",66),c.Xb(2,"div",7),c.Xb(3,"input",67),c.jc("ngModelChange",(function(i){return c.Oc(e),t.$implicit.isSameForAll=i})),c.Wb(),c.Xb(4,"label",68),c.Yc(5),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",69),c.Wc(7,_m,1,0,"div",11),c.Xb(8,"div",70),c.Sb(9,"custom-field-value",71),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit;c.Cb(3),c.wc("id",e.customField.id)("name",e.customField.name)("ngModel",e.isSameForAll),c.Cb(1),c.wc("for",e.customField.id),c.Cb(1),c.Zc(e.customField.name),c.Cb(2),c.wc("ngIf",!e.isSameForAll),c.Cb(2),c.wc("customField",e)}}function Bm(e,t){if(1&e&&(c.Vb(0),c.Sb(1,"hr",14),c.Wc(2,Gm,10,7,"div",64),c.Ub()),2&e){const e=c.nc();c.Cb(2),c.wc("ngForOf",e.customFieldValues)}}function Vm(e,t){if(1&e){const e=c.Yb();c.Yc(0," Upgrade to add for others "),c.Xb(1,"a",72),c.jc("click",(function(){return c.Oc(e),c.nc().navigateToUpgrade()})),c.Yc(2,"Upgrade"),c.Wb()}}let Hm=(()=>{class e{constructor(e,t,i,n){this.authService=e,this.trackerService=t,this.cd=i,this.workspaceService=n,this.autofillWithSameData=!0,this.preventSendRequest=!1,this.isRounding=!1,this.hideDates=!1,this._customFields=[],this.close=new c.n,this.emitEntries=new c.n,this.onEdit=new c.n,this.onUpdate=new c.n,this.description=!1,this.projects=!1,this.customField=!1,this.tag=!1,this.billable=!1,this.time=!1,this.date=!1,this.unsubscribe$=new Ee.a,this.overwriteTags=!1,this.sameProject=!0,this.user=!1,this.users=[],this.usersQuery={}}set customFields(e){this._customFields=e||[]}get customFields(){return this._customFields}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.hasChangeUserPermission=this.workspace.hasFeature(nr.a.ADD_TIME_FOR_OTHERS);const e=this.authService.getUser().id;this.createTimeEntry(this.workspace.id,e),this.customFieldValues=this.createCustomFieldList(),this.resetQuery(),this.cd.detectChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}createTaskHash(e){return e&&e.id||null}createProjectHash(e){let t="";return e.project&&(t+=e.project.id,e.project.clientId?t+=e.project.clientId:e.project.client&&e.project.client.id&&(t+=e.project.client.id)),t+=e.task&&e.task.id||null,t}createTagHash(e){const t=e?e.map(e=>e.id):[];return JSON.stringify(t)}createTimeEntry(e,t){if(!this.autofillWithSameData){const t=new hc.a;return void(this.timeEntry=new At.a({user:t,workspaceId:e}))}const i=At.a.clone(this.timeEntries[0]);i.workspaceId=e,i.userId=t;const n=this.timeEntries.length;for(let s=1;s<n;s++)i.description!==this.timeEntries[s].description&&(i.description=""),this.enableEditUser&&i.user&&i.user.id!==this.timeEntries[s].user.id&&(i.user=new hc.a),i.billable!==this.timeEntries[s].billable&&(i.billable=!1),this.createTagHash(i.tags)!==this.createTagHash(this.timeEntries[s].tags)&&(i.tags=null),this.createProjectHash(i)!==this.createProjectHash(this.timeEntries[s])&&(i.project=null,this.sameProject=!1),this.createTaskHash(i.task)!==this.createTaskHash(this.timeEntries[s].task)&&(i.task=null),i.timeInterval.start!==this.timeEntries[s].timeInterval.start&&(i.timeInterval.start=Se().toISOString()),i.timeInterval.end!==this.timeEntries[s].timeInterval.end&&(i.timeInterval.end=Se().toISOString());this.enableEditUser&&!i.user&&(i.user=new hc.a),this.timeEntry=i}closeBulk(e=!1){this.close.emit(e)}selectProjectAndTask(e){this.timeEntry.project=e.project,this.timeEntry.billable=this.workspace.taskBillableEnabled&&e.task?e.task.billable:e.project?e.project.billable:this.timeEntry.billable,this.timeEntry.project&&(this.timeEntry.project.clientName=this.timeEntry.project&&this.timeEntry.project.client&&this.timeEntry.project.client.name),this.timeEntry.task=e.task,this.timeEntry.workspaceId=e.workspace?e.workspace.id:this.timeEntry.workspaceId,this.sameProject=!0,this.customFieldValues=this.createCustomFieldList(),this.cd.detectChanges()}closeTagDropdown(e){e&&(this.timeEntry.tags=e)}pickedDateAndTime(e){(this.time||this.date)&&(this.timeEntry.timeInterval=e,this.cd.detectChanges())}editEntries(){this.inProgress||(this.inProgress=!0,setTimeout(()=>{const e=this.generateChangeFields(),t=[];this.timeEntries.forEach(e=>t.push(e.id)),this.preventSendRequest?this.onEdit.emit({ids:t,changeFields:e,timeEntry:this.timeEntry,customFieldValues:this.customFieldValues.filter(e=>e.isSameForAll)}):this.trackerService.updateGroup(t,e,this.timeEntry,this.customFieldValues.filter(e=>e.isSameForAll)).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.inProgress=!1,this.onEdit.emit(),this.closeBulk(!0)},()=>{this.inProgress=!1,this.cd.detectChanges()})}))}generateChangeFields(){const e=[];return this.description&&e.push(Mp.a.DESCRIPTION),this.projects?(e.push(Mp.a.PROJECT),e.push(Mp.a.TASK),this.customFields.length&&e.push(Mp.a.CUSTOM_FIELDS),this.timeEntry.project&&e.push(Mp.a.BILLABLE)):this.customFieldValues.some(e=>e.isSameForAll)&&e.push(Mp.a.CUSTOM_FIELDS),this.tag&&this.overwriteTags&&e.push(Mp.a.TAG),this.tag&&!this.overwriteTags&&e.push(Mp.a.TAG_ADD),this.billable&&e.push(Mp.a.BILLABLE),this.time&&!this.isRounding&&e.push(Mp.a.TIME),this.date&&!this.isRounding&&e.push(Mp.a.DATE),this.enableEditUser&&this.hasChangeUserPermission&&this.user&&e.push(Mp.a.USER),e}showPopup(e){this.hasChangeUserPermission||(e.isOpen()?e.close():e.open())}navigateToUpgrade(){this.onUpdate.emit()}resetQuery(){this.usersQuery={page:1,limit:ei.f,name:"",sortColumn:"name",statuses:[dn.k.ACTIVE]},this.allUsersReceived=!1}getUsers(e=this.usersQuery){this.allUsersReceived||this.workspaceService.getUsers(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(({count:t,users:i})=>{1===e.page&&(this.users=[]);const n=i.map(e=>new di.a(e.id,e.name||e.email+" (not joined yet)"));if(this.users.push.apply(this.users,n),this.allUsersReceived=this.users.length>=t||i.length<e.limit,!this.timeEntry.user.name&&this.timeEntry.user.id){const e=i.filter(e=>e.id===this.timeEntry.user.id);this.timeEntry.user.name=e&&e[0]&&e[0].label}this.cd.markForCheck(),this.dropdownItems&&this.dropdownItems.triggerDetection()})}onFilterChange(e){this.resetQuery(),this.usersQuery.email=e.searchTerm,this.allUsersReceived=!1,this.getUsers(this.usersQuery)}loadMoreUsers(){this.usersQuery.page++,this.getUsers(this.usersQuery)}createCustomFieldList(){if(!this.sameProject)return this.customFields.filter(e=>e.status===Jd.a.VISIBLE).map(e=>{const t=this.isSameValue(e);return new gp.a({customFieldId:e.id,customField:e,value:t?this.getValue(e):e.workspaceDefaultValue,isSameForAll:!1})});const e=this.timeEntry.project?this.customFields.filter(e=>e.status!==Jd.a.VISIBLE&&e.projectDefaultValues.filter(e=>e.projectId===(this.timeEntry.project&&this.timeEntry.project.id)&&e.status===Jd.a.VISIBLE).length>0):[];return[...this.customFields.filter(e=>e.status===Jd.a.VISIBLE&&0===e.projectDefaultValues.filter(e=>e.projectId===(this.timeEntry.project&&this.timeEntry.project.id)&&e.status===Jd.a.INVISIBLE).length),...e].map(e=>{const t=this.isSameValue(e);return new gp.a({customFieldId:e.id,customField:e,value:t?this.getValue(e):this.getDefault(e),isSameForAll:!1})})}getValue(e){if(this.timeEntry){const t=this.timeEntry.customFieldValues.filter(t=>t.customFieldId===e.id)[0];return t?t.value:""}}isSameValue(e){if(this.timeEntry&&this.timeEntry.customFieldValues){const t=this.timeEntry.customFieldValues.filter(t=>t.customFieldId===e.id)[0];return this.timeEntries.every(i=>{const n=i.customFieldValues.filter(t=>t.customFieldId===e.id)[0];return n&&t&&n.value===t.value})}return!1}getDefault(e){const t=e.projectDefaultValues.filter(e=>this.timeEntry.project&&e.projectId===this.timeEntry.project.id)[0];return t&&t.value?t.value:e.workspaceDefaultValue}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Ce.a),c.Rb($d.a),c.Rb(c.h),c.Rb(U.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["time-entry-bulk-edit"]],viewQuery:function(e,t){var i;1&e&&c.ed(Im,!0),2&e&&c.Kc(i=c.kc())&&(t.dropdownItems=i.first)},inputs:{timeEntries:"timeEntries",enableEditUser:"enableEditUser",overrideEntiesLength:"overrideEntiesLength",autofillWithSameData:"autofillWithSameData",preventSendRequest:"preventSendRequest",inProgress:"inProgress",isTimesheet:"isTimesheet",isRounding:"isRounding",hideWorkspacesInPicker:"hideWorkspacesInPicker",hideDates:"hideDates",customFields:"customFields"},outputs:{close:"close",emitEntries:"emitEntries",onEdit:"onEdit",onUpdate:"onUpdate"},decls:84,vars:28,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-row"],[1,"cl-col-sm-3","cl-col-form-label"],[1,"cl-custom-control","cl-custom-control-inline","cl-custom-checkbox"],["type","checkbox","id","desc-1","name","description","autocomplete","off",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","desc-1",1,"cl-custom-control-label"],[1,"cl-col-sm-9","cl-position-relative"],["class","cl-blocker",4,"ngIf"],["type","text","name","descriptionName","autocomplete","off",1,"cl-form-control",3,"ngModel","placeholder","ngModelChange"],[4,"ngIf"],[1,"cl-mt-0"],["type","checkbox","id","proj-1","name","project",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","proj-1",1,"cl-custom-control-label"],[1,"cl-dropdown","cl-dropdown-large",3,"dropdownKey"],["dropdownKeyButton","","type","button",1,"cl-btn","cl-btn-outline-light","cl-w-100","cl-cut-text","cl-text-left","cl-dropdown-toggle"],[4,"ngIf","ngIfElse"],["noProjectTemplate",""],["class","cl-dropdown-menu",3,"selectedProject","selectedTask","hideWorkspaces","selectedProjectAndTask",4,"dropdownKeyContent"],["type","checkbox","id","tags-1","name","tags",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","tags-1",1,"cl-custom-control-label"],[1,"cl-dropdown",3,"dropdownKey"],["type","button","dropdownKeyButton","",1,"cl-btn","cl-btn-outline-light","cl-w-100","cl-cut-text","cl-text-left","cl-dropdown-toggle"],["noTagsTemplate",""],[1,"cl-cut-text-wrapper"],[1,"cl-dropdown"],["class","cl-dropdown-menu","resizeable","",3,"resizeableName","entryTags","close",4,"dropdownKeyContent"],[1,"cl-form-group","cl-row","cl-position-relative"],[1,"cl-col-sm-9"],[1,"cl-custom-control","cl-custom-radio","cl-custom-control-inline"],["type","radio","id","nonBillable","name","defaultBillableProjects",1,"cl-custom-control-input",3,"value","ngModel","ngModelChange"],["for","nonBillable",1,"cl-custom-control-label"],["type","radio","id","billable","name","defaultBillableProjects",1,"cl-custom-control-input",3,"value","ngModel","ngModelChange"],["for","billable",1,"cl-custom-control-label"],[1,"cl-form-group","cl-row","cl-align-items-center"],["type","checkbox","name","billable","id","bill-1",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","bill-1",1,"cl-custom-control-label"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","id","bill-2","name","billableValue",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","bill-2",1,"cl-custom-control-label"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","submit","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"disabled","click"],["popContent",""],[1,"cl-blocker"],["type","checkbox","id","user-1","name","user",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","user-1",1,"cl-custom-control-label"],["triggers","manual","placement","left","container","body",3,"ngbPopover","enableSearch","filterQuery","list","placeholder","initLabel","itemLabel","value","isDisabled","offlineSearch","click","onFilterOptionChange","onChangedDropdown","loadMore","onOpen"],["featurePopover","ngbPopover","dropdown",""],[1,"cl-dropdown-menu",3,"selectedProject","selectedTask","hideWorkspaces","selectedProjectAndTask"],[4,"ngFor","ngForOf"],["resizeable","",1,"cl-dropdown-menu",3,"resizeableName","entryTags","close"],[1,"cl-form-group","cl-row",3,"ngbTooltip"],["type","checkbox","id","time-1","name","time",1,"cl-custom-control-input",3,"disabled","ngModel","ngModelChange"],["for","time-1",1,"cl-custom-control-label"],[1,"cl-row","cl-align-items-center","detailed-report-bulk-edit"],[1,"cl-date-picker-white",3,"debounce","dateTime","mode","pickedDate"],["type","checkbox","id","date-1","name","date",1,"cl-custom-control-input",3,"disabled","ngModel","ngModelChange"],["for","date-1",1,"cl-custom-control-label"],[1,"cl-d-flex","cl-align-items-center","detailed-report-bulk-edit"],[3,"debounce","dateTime","textualDate","openUp","mode","pickedDate"],["class","cl-row cl-mb-n2",4,"ngFor","ngForOf"],[1,"cl-row","cl-mb-n2"],[1,"cl-col-sm-12","cl-col-form-label"],["type","checkbox",1,"cl-custom-control-input",3,"id","name","ngModel","ngModelChange"],[1,"cl-custom-control-label",3,"for"],[1,"cl-col-sm-12","cl-position-relative"],[1,"cl-mb-3"],[3,"customField"],[3,"click"]],template:function(e,t){if(1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.closeBulk()})),c.Xb(4,"span"),c.Sb(5,"img",3),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",4),c.Xb(7,"form"),c.Xb(8,"div",5),c.Xb(9,"div",6),c.Xb(10,"div",7),c.Xb(11,"input",8),c.jc("ngModelChange",(function(e){return t.description=e})),c.Wb(),c.Xb(12,"label",9),c.Yc(13,"Description"),c.Wb(),c.Wb(),c.Wb(),c.Xb(14,"div",10),c.Wc(15,Om,1,0,"div",11),c.Xb(16,"input",12),c.jc("ngModelChange",(function(e){return t.timeEntry.description=e})),c.Wb(),c.Wb(),c.Wb(),c.Wc(17,Em,13,12,"ng-container",13),c.Sb(18,"hr",14),c.Xb(19,"div",5),c.Xb(20,"div",6),c.Xb(21,"div",7),c.Xb(22,"input",15),c.jc("ngModelChange",(function(e){return t.projects=e})),c.Wb(),c.Xb(23,"label",16),c.Yc(24,"Project"),c.Wb(),c.Wb(),c.Wb(),c.Xb(25,"div",10),c.Wc(26,Tm,1,0,"div",11),c.Xb(27,"div",17),c.Xb(28,"button",18),c.Wc(29,Dm,2,1,"ng-container",19),c.Wc(30,Rm,1,0,"ng-template",null,20,c.Xc),c.Wb(),c.Wc(32,Am,1,3,"project-picker",21),c.Wb(),c.Wb(),c.Wb(),c.Sb(33,"hr",14),c.Xb(34,"div",5),c.Xb(35,"div",6),c.Xb(36,"div",7),c.Xb(37,"input",22),c.jc("ngModelChange",(function(e){return t.tag=e})),c.Wb(),c.Xb(38,"label",23),c.Yc(39,"Tags"),c.Wb(),c.Wb(),c.Wb(),c.Xb(40,"div",10),c.Wc(41,jm,1,0,"div",11),c.Xb(42,"div",24),c.Xb(43,"button",25),c.Wc(44,Pm,2,1,"ng-container",19),c.Wc(45,Mm,1,0,"ng-template",null,26,c.Xc),c.Wb(),c.Xb(47,"div",27),c.Xb(48,"div",28),c.Wc(49,Ym,1,2,"tag-dropdown",29),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(50,"div",30),c.Wc(51,Lm,1,0,"div",11),c.Sb(52,"div",6),c.Xb(53,"div",31),c.Xb(54,"div",32),c.Xb(55,"input",33),c.jc("ngModelChange",(function(e){return t.overwriteTags=e})),c.Wb(),c.Xb(56,"label",34),c.Yc(57,"Add to existing"),c.Wb(),c.Wb(),c.Xb(58,"div",32),c.Xb(59,"input",35),c.jc("ngModelChange",(function(e){return t.overwriteTags=e})),c.Wb(),c.Xb(60,"label",36),c.Yc(61,"Overwrite existing"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(62,"hr",14),c.Xb(63,"div",37),c.Xb(64,"div",6),c.Xb(65,"div",7),c.Xb(66,"input",38),c.jc("ngModelChange",(function(e){return t.billable=e})),c.Wb(),c.Xb(67,"label",39),c.Yc(68,"Billable"),c.Wb(),c.Wb(),c.Wb(),c.Xb(69,"div",10),c.Wc(70,Fm,1,0,"div",11),c.Xb(71,"div",40),c.Xb(72,"input",41),c.jc("ngModelChange",(function(e){return t.timeEntry.billable=e})),c.Wb(),c.Xb(73,"label",42),c.Yc(74,"Yes"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(75,$m,23,16,"ng-container",13),c.Wc(76,Bm,3,1,"ng-container",13),c.Wb(),c.Wb(),c.Xb(77,"div",43),c.Xb(78,"a",44),c.jc("click",(function(){return t.closeBulk()})),c.Yc(79,"Cancel"),c.Wb(),c.Xb(80,"button",45),c.jc("click",(function(){return t.editEntries()})),c.Yc(81,"Save"),c.Wb(),c.Wb(),c.Wc(82,Vm,3,0,"ng-template",null,46,c.Xc)),2&e){const e=c.Lc(31),i=c.Lc(46);c.Cb(2),c.bd("Bulk edit ",t.overrideEntiesLength||t.timeEntries.length," ",(t.overrideEntiesLength||t.timeEntries.length)>1?"entries":"entry",""),c.Cb(9),c.wc("ngModel",t.description),c.Cb(4),c.wc("ngIf",!t.description),c.Cb(1),c.wc("ngModel",t.timeEntry.description)("placeholder","Add description ..."),c.Cb(1),c.wc("ngIf",t.enableEditUser),c.Cb(5),c.wc("ngModel",t.projects),c.Cb(4),c.wc("ngIf",!t.projects),c.Cb(1),c.wc("dropdownKey",!t.projects),c.Cb(2),c.wc("ngIf",t.timeEntry.project)("ngIfElse",e),c.Cb(8),c.wc("ngModel",t.tag),c.Cb(4),c.wc("ngIf",!t.tag),c.Cb(1),c.wc("dropdownKey",!t.tag),c.Cb(2),c.wc("ngIf",null==t.timeEntry.tags?null:t.timeEntry.tags.length)("ngIfElse",i),c.Cb(7),c.wc("ngIf",!t.tag),c.Cb(4),c.wc("value",!1)("ngModel",t.overwriteTags),c.Cb(4),c.wc("value",!0)("ngModel",t.overwriteTags),c.Cb(7),c.wc("ngModel",t.billable),c.Cb(4),c.wc("ngIf",!t.billable),c.Cb(2),c.wc("ngModel",t.timeEntry.billable),c.Cb(3),c.wc("ngIf",!t.hideDates),c.Cb(1),c.wc("ngIf",null==t.customFields?null:t.customFields.length),c.Cb(4),c.wc("disabled",t.inProgress)}},directives:[p.I,p.t,p.u,p.a,p.s,p.v,s.u,p.c,Si.a,Ii.a,Oi.a,p.A,pn.a,g.L,Vp.a,s.t,zp.a,Hp.a,g.Z,so.a,Sm.a],styles:[".cl-bulk-edit h4{margin:20px}"],changeDetection:0}),e})();const zm=["childrenEntries"];function qm(e,t){if(1&e){const e=c.Yb();c.Xb(0,"approval-header",6),c.jc("onSubmit",(function(t){return c.Oc(e),c.nc().onApprovalSubmit.emit(t)}))("onWithdraw",(function(t){return c.Oc(e),c.nc().onApprovalWithdraw.emit(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("startOfWeek",e.startOfWeek)("weekStatus",e.weekStatus)("timeApprovalEnabled",e.timeApprovalEnabled)("format",e.format)}}function Km(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div"),c.Xb(1,"time-tracker-entry",11,12),c.jc("singleEntryChanged",(function(i){c.Oc(e);const n=t.index,s=c.nc(3).index;return c.nc().singleEntryChanged(i,s,n)}))("onSignleBulkChange",(function(){return c.Oc(e),c.nc(2),c.Lc(2).notifyParentSingleEntryChanged()}))("entryIsDeleted",(function(i){c.Oc(e);const n=t.index,s=c.nc(3).index;return c.nc().entryIsDeleted(i,s,n)}))("entryDurationChanged",(function(t){c.Oc(e),c.nc(2);const i=c.Lc(2),n=c.nc().index;return c.nc().entryDurationChanged(t,n),null==i?null:i.notifyParentSingleEntryChanged()})),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit,i=c.nc(4);c.Cb(1),c.wc("timeEntry",e)("disableManualModeEdit",i.disableManualMode)("isAdminOrOwner",i.isAdminOrOwner)("format",i.format)("projectData",i.projectData)("editMode",i.entryGroup.editMode)("customFields",i.customFields)("hideWorkspacesInPicker",i.hideWorkspacesInPicker)}}function Zm(e,t){if(1&e&&(c.Vb(0),c.Wc(1,Km,3,8,"div",3),c.Ub()),2&e){const e=c.nc(2).$implicit,t=c.nc();c.Cb(1),c.wc("ngForOf",e.children)("ngForTrackBy",t.trackByFn)}}function Qm(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"parent-tracker-entry",9,10),c.jc("entryIsDeleted",(function(t){c.Oc(e);const i=c.nc().index;return c.nc().similarEntriesDeleted(t,i)}))("entryIsDuplicated",(function(){c.Oc(e);const t=c.nc().index;return c.nc().expandSimilarGroup(t)}))("refreshView",(function(t){c.Oc(e);const i=c.nc().index;return c.nc().refreshGroupView(i,t)}))("onBulkEditChange",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc().childTriggerDetection(t.children)})),c.Wb(),c.Wc(3,Zm,2,2,"ng-container",7),c.Ub()}if(2&e){const e=c.nc().$implicit,t=c.nc();c.Cb(1),c.Hb("cl-time-tracker-entry",t.customFields.length>0),c.wc("childrenLength",e.children.length)("timeEntry",e)("disableManualModeEdit",t.disableManualMode)("isAdminOrOwner",t.isAdminOrOwner)("format",t.format)("projectData",t.projectData)("editMode",t.entryGroup.editMode)("userId",t.userId)("customFields",t.customFields)("hideWorkspacesInPicker",t.hideWorkspacesInPicker),c.Cb(2),c.wc("ngIf",e.expanded)}}function Jm(e,t){if(1&e){const e=c.Yb();c.Xb(0,"time-tracker-entry",13),c.jc("singleEntryChanged",(function(t){c.Oc(e);const i=c.nc().index;return c.nc().singleEntryChanged(t,i)}))("entryIsDuplicated",(function(){c.Oc(e);const t=c.nc().index;return c.nc().signleEntryIsDuplicated(t)}))("entryIsDeleted",(function(t){c.Oc(e);const i=c.nc().index;return c.nc().entryIsDeleted(t,i)}))("entryDurationChanged",(function(t){return c.Oc(e),c.nc(2).entryDurationChanged(t)})),c.Wb()}if(2&e){const e=c.nc().$implicit,t=c.nc();c.wc("timeEntry",e)("disableManualModeEdit",t.disableManualMode)("isAdminOrOwner",t.isAdminOrOwner)("format",t.format)("projectData",t.projectData)("editMode",t.entryGroup.editMode)("customFields",t.customFields)("hideWorkspacesInPicker",t.hideWorkspacesInPicker)}}function eg(e,t){if(1&e&&(c.Vb(0),c.Wc(1,Qm,4,13,"ng-container",7),c.Wc(2,Jm,1,8,"time-tracker-entry",8),c.Ub()),2&e){const e=t.$implicit;c.Cb(1),c.wc("ngIf",e.children),c.Cb(1),c.wc("ngIf",!e.children)}}function tg(e,t){if(1&e){const e=c.Yb();c.Xb(0,"time-entry-bulk-edit",14),c.jc("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Wb()}if(2&e){const e=c.nc();c.wc("hideDates",e.disableManualMode)("hideWorkspacesInPicker",e.hideWorkspacesInPicker)("timeEntries",e.timeEntriesSelected)("customFields",e.customFields)}}function ig(e,t){if(1&e&&(c.Xb(0,"delete-confirm-modal",15),c.jc("onDelete",(function(){return t.$implicit.close(!0)}))("onClose",(function(){return t.$implicit.close()})),c.Xb(1,"p",16),c.Yc(2),c.Wb(),c.Wb()),2&e){const e=c.nc();c.wc("title","Delete")("btnText","Delete"),c.Cb(2),c.ad(" Are you sure that you want to delete ",e.timeEntriesSelected.length," time entries? ")}}let ng=(()=>{class e{constructor(e,t,i,n,s,r,o){this.keyboardService=e,this.trackerService=t,this.authService=i,this.entryBulk=n,this.cd=s,this.entryGroupService=r,this.modalService=o,this.deleteEntryGroup=new c.n,this.subtractWeekDuration=new c.n,this.addWeekDuration=new c.n,this.loaded=new c.n,this.onApprovalSubmit=new c.n,this.onApprovalWithdraw=new c.n,this.unsubscribe$=new Ee.a;const a=this.authService.getUser();a&&(this.userId=a.id,this.GROUPING_IS_DISABLED=a.settings.groupSimilarEntriesDisabled,this.entryGroupService.setIsGroupDisabled(this.GROUPING_IS_DISABLED))}set isAdminOrOwner(e){this._isAdminOrOwner=e,this.isEditingAvailable()}get isAdminOrOwner(){return this._isAdminOrOwner}set entryGroup(e){e&&(e.time||(e.time=this.entryGroupService.calculateTotalDuration(e.timeEntries)),this._entryGroup=this.entryGroupService.transformEntryGroup(e),this.entryBulk.recalculateBulkCheckboxes(this.entryGroup.timeEntries),this.isEditingAvailable())}get entryGroup(){return this._entryGroup}set customFields(e){this._customFields=e,e.length&&(this.hideWorkspacesInPicker=!0)}get customFields(){return this._customFields}shouldBeChild(e){if(this.GROUPING_IS_DISABLED)return!1;const t=this.entryGroup.timeEntries,i=t.length;for(let n=0;n<i;n++){const i=t[n];if(e.id!=i.id&&e.sameGroupWith(i))return!0}return!1}ngAfterViewInit(){this.loaded.emit()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}isEditingAvailable(){this.entryGroup&&this.entryGroup.timeEntries&&this.entryGroup.timeEntries[0]&&(this.disableEdit=this.entryGroup.timeEntries[0].isLocked&&!this.isAdminOrOwner)}getSelected(){let e=[];return this.entryGroup.timeEntries.forEach(t=>{t.children?e=e.concat(t.children):e.push(t)}),e.filter(e=>e.bulkEdit)}openDeleteModal(e){this.isModalOpen||(this.isModalOpen=!0,this.timeEntriesSelected=this.getSelected(),this.keyboardService.removeListener(),this.modalService.open(e,{centered:!0}).result.then(e=>{e&&this.deleteManyConfirmed(),this.isModalOpen=!1,this.keyboardService.addListener()},e=>{this.isModalOpen=!1,this.keyboardService.addListener()}))}deleteManyConfirmed(){this.trackerService.deleteMany(this.timeEntriesSelected.map(e=>e.id),this.userId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.entryGroup.editMode=!1,this.entryBulk.setSelectAll(!1),this.trackerService.getAllTimeEntries()})}openBulkEdit(e){this.isModalOpen||(this.isModalOpen=!0,this.keyboardService.removeListener(),this.modalService.open(e,{centered:!0}).result.then(e=>{e&&(this.entryGroup.editMode=!1,this.entryBulk.setSelectAll(!1),this.trackerService.getAllTimeEntries()),this.isModalOpen=!1,this.keyboardService.addListener()},e=>{this.isModalOpen=!1,this.keyboardService.addListener()}),this.timeEntriesSelected=this.getSelected())}trackByFn(e,t){return t.id}childTriggerDetection(e){if(!this.childrenEntriesRef||!e)return;const t=e.map(e=>e.id);this.childrenEntriesRef.forEach(e=>{t.indexOf(e.getId())>-1&&e.triggerDetection()})}removeParentIfNoMoreChildren(e,t){if(e.children.length<2){const i=e.children[0];this.entryGroup.timeEntries.splice(t,1),i&&(e.children.splice(0,1),this.entryGroupService.addElementToEntryGroup(i,this.entryGroup.timeEntries,this.entryGroup.date))}}refreshGroupView(e,t){if(t){const t=this.entryGroup.timeEntries[e];t&&t.children&&this.childTriggerDetection(t.children)}this.entryGroupService.refreshGroupView(this.entryGroup)}singleEntryChanged(e,t,i){if(e.isChild&&!this.GROUPING_IS_DISABLED){const n=this.entryGroup.timeEntries[t];if(!e.sameGroupWith(n)){n.children.splice(i,1);const s=this.entryGroupService.addElementToEntryGroup(e,this.entryGroup.timeEntries,this.entryGroup.date);n&&this.entryGroupService.setDateAndDurationForSameEntries(n),this.removeParentIfNoMoreChildren(n,t),s>-1&&this.entryGroupService.setDateAndDurationForSameEntries(this.entryGroup.timeEntries[s])}}else if(this.shouldBeChild(e)){this.entryGroup.timeEntries.splice(t,1);const i=this.entryGroupService.addElementToEntryGroup(e,this.entryGroup.timeEntries,this.entryGroup.date);i>-1&&(Object(Pt.F)(this.entryGroup.timeEntries[i].children),this.entryGroupService.setDateAndDurationForSameEntries(this.entryGroup.timeEntries[i]))}Object(Pt.F)(this.entryGroup.timeEntries),this.cd.detectChanges()}expandSimilarGroup(e){this.GROUPING_IS_DISABLED||(this.entryGroup.timeEntries[e].expanded=!0)}signleEntryIsDuplicated(e){if(!this.GROUPING_IS_DISABLED){const t=At.a.clone(this.entryGroup.timeEntries[e]);t.isChild=!0,this.entryGroup.timeEntries[e].id+="_PARENT",this.entryGroup.timeEntries[e].children=[t],this.expandSimilarGroup(e)}}entryIsDeleted(e,t,i){const n=new Bd.a(this.entryGroup.time),s=(new Bd.a).intervalToDuration(e.timeInterval),c=new Bd.a(s).asString();n.subtract(s),this.entryGroup.time=n.asString(),e.isChild?(this.entryGroup.timeEntries[t].children.splice(i,1),this.removeParentIfNoMoreChildren(this.entryGroup.timeEntries[t],t),this.entryGroup.timeEntries[t]&&this.entryGroupService.setDateAndDurationForSameEntries(this.entryGroup.timeEntries[t])):this.entryGroup.timeEntries.splice(t,1),0===this.entryGroup.timeEntries.length?this.deleteEntryGroup.emit(c):this.subtractWeekDuration.emit(c),this.entryBulk.recalculateBulkCheckboxes(),this.entryGroupService.numberOfEntriesChanged()}similarEntriesDeleted(e,t){const i=new Bd.a(this.entryGroup.time),n=e.timeInterval.duration;i.subtract(n),this.entryGroup.time=i.asString(),this.entryGroup.timeEntries.splice(t,1),0===this.entryGroup.timeEntries.length?this.deleteEntryGroup.emit(n):this.subtractWeekDuration.emit(n),this.entryGroupService.numberOfEntriesChanged()}entryDurationChanged({newInterval:e,oldInterval:t},i){const n=new Bd.a,s=n.intervalToDuration(e),c=n.intervalToDuration(t),r=new Bd.a(this.entryGroup.time),o=s-c;this.entryGroup.time=r.add(o).asString(),(i||0===i)&&this.entryGroup.timeEntries[i].children&&(Object(Pt.F)(this.entryGroup.timeEntries[i].children),this.entryGroupService.setDateAndDurationForSameEntries(this.entryGroup.timeEntries[i])),Object(Pt.F)(this.entryGroup.timeEntries),this.entryBulk.recalculateBulkCheckboxes(this.entryGroup.timeEntries);const a=new Bd.a(Math.abs(o)).asString();o<0?this.subtractWeekDuration.emit(a):this.addWeekDuration.emit(a)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Vd.a),c.Rb($d.a),c.Rb(Ce.a),c.Rb(xe),c.Rb(c.h),c.Rb(_d.a),c.Rb(g.q))},e.\u0275cmp=c.Lb({type:e,selectors:[["entry-group"]],viewQuery:function(e,t){var i;1&e&&c.ed(zm,!0),2&e&&c.Kc(i=c.kc())&&(t.childrenEntriesRef=i)},inputs:{isAdminOrOwner:"isAdminOrOwner",entryGroup:"entryGroup",format:"format",projectData:"projectData",timeApprovalEnabled:"timeApprovalEnabled",startOfWeek:"startOfWeek",disableManualMode:"disableManualMode",customFields:"customFields",weekStatus:"weekStatus"},outputs:{deleteEntryGroup:"deleteEntryGroup",subtractWeekDuration:"subtractWeekDuration",addWeekDuration:"addWeekDuration",loaded:"loaded",onApprovalSubmit:"onApprovalSubmit",onApprovalWithdraw:"onApprovalWithdraw"},features:[c.Bb([xe])],decls:8,vars:8,consts:[["class","cl-d-flex cl-justify-content-between cl-flex-column cl-flex-lg-row cl-px-2 cl-px-lg-0 cl-mb-3",3,"startOfWeek","weekStatus","timeApprovalEnabled","format","onSubmit","onWithdraw",4,"ngIf"],[1,"cl-card"],[3,"date","format","disableEdit","editMode","time","changeEditMode","bulkEdit","bulkDelete"],[4,"ngFor","ngForOf","ngForTrackBy"],["edit",""],["delete",""],[1,"cl-d-flex","cl-justify-content-between","cl-flex-column","cl-flex-lg-row","cl-px-2","cl-px-lg-0","cl-mb-3",3,"startOfWeek","weekStatus","timeApprovalEnabled","format","onSubmit","onWithdraw"],[4,"ngIf"],["class","cl-hover-shadow",3,"timeEntry","disableManualModeEdit","isAdminOrOwner","format","projectData","editMode","customFields","hideWorkspacesInPicker","singleEntryChanged","entryIsDuplicated","entryIsDeleted","entryDurationChanged",4,"ngIf"],[1,"cl-parent-collapse","cl-hover-shadow",3,"childrenLength","timeEntry","disableManualModeEdit","isAdminOrOwner","format","projectData","editMode","userId","customFields","hideWorkspacesInPicker","entryIsDeleted","entryIsDuplicated","refreshView","onBulkEditChange"],["parent",""],[1,"cl-collapse",3,"timeEntry","disableManualModeEdit","isAdminOrOwner","format","projectData","editMode","customFields","hideWorkspacesInPicker","singleEntryChanged","onSignleBulkChange","entryIsDeleted","entryDurationChanged"],["childrenEntries",""],[1,"cl-hover-shadow",3,"timeEntry","disableManualModeEdit","isAdminOrOwner","format","projectData","editMode","customFields","hideWorkspacesInPicker","singleEntryChanged","entryIsDuplicated","entryIsDeleted","entryDurationChanged"],[3,"hideDates","hideWorkspacesInPicker","timeEntries","customFields","close"],[3,"title","btnText","onDelete","onClose"],[1,"cl-h2","cl-cut-text-wrap"]],template:function(e,t){if(1&e){const e=c.Yb();c.Wc(0,qm,1,4,"approval-header",0),c.Xb(1,"div",1),c.Xb(2,"entry-group-header",2),c.jc("changeEditMode",(function(e){return t.entryGroup.editMode=e}))("bulkEdit",(function(){c.Oc(e);const i=c.Lc(5);return t.openBulkEdit(i)}))("bulkDelete",(function(){c.Oc(e);const i=c.Lc(7);return t.openDeleteModal(i)})),c.Wb(),c.Wc(3,eg,3,2,"ng-container",3),c.Wb(),c.Wc(4,tg,1,4,"ng-template",null,4,c.Xc),c.Wc(6,ig,3,3,"ng-template",null,5,c.Xc)}2&e&&(c.wc("ngIf",t.weekStatus),c.Cb(2),c.wc("date",t.entryGroup.date)("format",t.format)("disableEdit",t.disableEdit)("editMode",t.entryGroup.editMode)("time",t.entryGroup.time),c.Cb(1),c.wc("ngForOf",t.entryGroup.timeEntries)("ngForTrackBy",t.trackByFn))},directives:[s.u,Sh,s.t,Yh,sm,km,Hm,yl.a],styles:[".cl-collapse{background:#f2f6f8}"],changeDetection:0}),e})();function sg(e,t){if(1&e){const e=c.Yb();c.Xb(0,"entry-group",12),c.jc("loaded",(function(){c.Oc(e);const i=t.index,n=t.last;return c.nc(3).lazyLoading(i+1,n)}))("deleteEntryGroup",(function(i){c.Oc(e);const n=t.index,s=t.$implicit;return c.nc(3).deleteEntryGroup(n,s,i)}))("subtractWeekDuration",(function(i){c.Oc(e);const n=t.$implicit;return c.nc(3).changeWeekDuration(n.date,i,"subtract")}))("addWeekDuration",(function(i){c.Oc(e);const n=t.$implicit;return c.nc(3).changeWeekDuration(n.date,i,"add")}))("onApprovalSubmit",(function(t){return c.Oc(e),c.nc(3).onWeekSubmitStatusChange(t)}))("onApprovalWithdraw",(function(t){return c.Oc(e),c.nc(3).onWeekSubmitStatusChange(t)})),c.Wb()}if(2&e){const e=t.$implicit,i=c.nc(3);c.wc("format",i.format)("startOfWeek",i.startOfWeek)("isAdminOrOwner",i.isAdminOrOwner)("projectData",i.projectData)("weekStatus",e.weekStatus)("customFields",i.customFields)("timeApprovalEnabled",i.workspace.timeApprovalEnabled)("disableManualMode",i.disableManualMode)("entryGroup",e)}}function cg(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",8),c.Wc(1,sg,1,9,"entry-group",9),c.Xb(2,"pager",10,11),c.jc("pageChanged",(function(t){return c.Oc(e),c.nc(2).setPaginationUrl(t)}))("limitChanged",(function(t){return c.Oc(e),c.nc(2).setPaginationUrl(t)})),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Hb("cl-entries-w-cf",e.hasActiveCustomFields),c.Cb(1),c.wc("ngForOf",e.entryGroupsLazy)("ngForTrackBy",e.trackByFn),c.Cb(1),c.wc("visible",e.isMultiplePages)("page",e.page)("limit",e.limit)("total",e.total)}}function rg(e,t){if(1&e&&(c.Xb(0,"div",13),c.Sb(1,"message-entries",14),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.wc("isError",e.isError)("loadInProgress",e.loadInProgress)}}function og(e,t){if(1&e&&(c.Xb(0,"div",3),c.Xb(1,"div",4),c.Sb(2,"time-tracker-recorder",5),c.Wc(3,cg,4,8,"div",6),c.Wc(4,rg,2,2,"ng-template",null,7,c.Xc),c.Wb(),c.Wb()),2&e){const e=c.Lc(5),t=c.nc();c.Cb(2),c.Hb("cl-recorder-get-out",!t.isSidebarOpen),c.wc("entryInProgress",t.entryInProgress)("entryGroups",t.entryGroupsLazy)("projectData",t.projectData)("format",t.format)("disableManualMode",t.disableManualMode)("setCustomFields",t.customFields),c.Cb(1),c.wc("ngIf",(null==t.entryGroupsLazy?null:t.entryGroupsLazy.length)>0)("ngIfElse",e)}}function ag(e,t){1&e&&(c.Xb(0,"div",20),c.Sb(1,"img",21),c.Xb(2,"div"),c.Xb(3,"div",22),c.Yc(4,"Timesheet enabled!"),c.Wb(),c.Xb(5,"div",23),c.Xb(6,"a",24),c.Yc(7," Go to timesheet "),c.Wb(),c.Wb(),c.Wb(),c.Wb())}function lg(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",20),c.Sb(1,"img",25),c.Xb(2,"div"),c.Xb(3,"div",22),c.Yc(4,"Prefer to enter hours in Timesheet?"),c.Wb(),c.Xb(5,"a",26),c.jc("click",(function(){return c.Oc(e),c.nc(2).enableTimeSheet()})),c.Yc(6,"Enable Timesheet"),c.Wb(),c.Wb(),c.Wb()}}function bg(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",15),c.Xb(1,"div",16),c.Xb(2,"div",17),c.Xb(3,"button",18),c.jc("click",(function(){return c.Oc(e),c.nc().closeOnboardingTimesheet()})),c.Xb(4,"span"),c.Yc(5,"\xd7"),c.Wb(),c.Wb(),c.Wc(6,ag,8,0,"div",19),c.Wc(7,lg,7,0,"div",19),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(6),c.wc("ngIf",e.enabledTimesheet),c.Cb(1),c.wc("ngIf",!e.enabledTimesheet)}}let ug=(()=>{class e{constructor(e,t,i,n,s,c,r,o,a,l,b,u,d,p,h,m,g,f,v,w){this.authService=e,this.cd=t,this.uiSettingsService=i,this.approvalService=n,this.userService=s,this.tagService=c,this.entryHelper=r,this.workspaceService=o,this.entryGroupService=a,this.activatedRoute=l,this.router=b,this.approvalHelperService=u,this.browserService=d,this.synchronizationService=p,this.keyboardService=h,this.trackerService=m,this.customFieldService=g,this.sidebarStateService=f,this.sidebarScrollService=v,this.systemSettingsService=w,this.entryGroupsTemp=[],this.entryGroupsLazy=[],this.unsubscribe$=new Ee.a,this.stompDebouncer$=new Ee.a,this.customFields=[],this.weekStatusMap={}}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}ngOnInit(){this.isNew="true"===localStorage.getItem("isNew"),this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(({isAdminOrOwner:e})=>{this.isAdminOrOwner=e,this.setOnboardingTimesheet(),this.cd.detectChanges()}),this.startOfWeek=this.authService.getUser().settings.weekStart,this.activatedRoute.queryParams.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{if(this.page=Object(Pt.u)(e.page)&&e.page>0?Number(e.page||1):1,Object(Pt.u)(e.limit)&&e.limit>0&&e.limit<=500)this.limit=Number(e.limit||ei.j);else{const e=this.uiSettingsService.getSettings(hi.b.TRACKER_PAGINATION)||{};this.limit=e.limit||ei.j}this.getAllTimeEntries()}),this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.setWorkspaceSettings(e),e.hasFeature(nr.a.CUSTOM_FIELDS)&&this.getCustomFields()}),this.subscribeToAllTimeEntries(),this.tagService.clearTagsSubject(),this.tagService.getAllTags(ni.a.ACTIVE),this.subscribeToNewEntry(),this.subscribeEntryChanged(),this.synchronizationService.onStompEntryChange$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.stompDebouncer$.next(e)}),this.stompDebouncer$.pipe(Object(Te.a)(600),Object(De.a)(this.unsubscribe$)).subscribe(()=>this.trackerService.getAllTimeEntries()),this.userService.onTimeZoneChange$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>this.getAllTimeEntries()),this.subscribeToSidebarState()}subscribeToSidebarState(){this.sidebarStateService.sidebarState$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isSidebarOpen=e,this.cd.markForCheck()})}getAllTimeEntries(){this.isError=!1,this.loadInProgress=!0,this.trackerService.getAllTimeEntries(this.page,this.limit,!0)}setWorkspaceSettings(e){this.workspace=e,this.disableManualMode=e.disableManualMode;const t=this.authService.getUser();this.projectData=new zd.a(e,t),this.format=e.getTimeFormat(),this.entryHelper.projectGroupingLabel=e.projectGroupingLabel,this.cd.detectChanges()}setOnboardingTimesheet(){this.workspace&&(this.onboardingTimesheet=!this.workspace.canSeeTimeSheet&&this.isAdminOrOwner&&this.isNew)}lazyLoading(e,t){if(!this.lazyLoadingInProgress)return;const i=this.entryGroupsTemp.length;e<i?setTimeout(()=>{if(t&&!this.cd.destroyed){let t=e+this.lazyStep;t=t>i?i:t;for(let i=e;i<t;i++)this.entryGroupsLazy.push(this.entryGroupsTemp[i]);this.cd.detectChanges()}}):(this.keyboardService.addListener(),this.lazyLoadingInProgress=!1,this.lazyLoading$.next(),this.lazyLoading$.complete())}onWeekSubmitStatusChange({id:e,startDayOfWeek:t}){this.weekStatusMap[t].id=e||null,this.refreshSingleWeekHeader(t)}refreshSingleWeekHeader(e){this.entryGroupsLazy.find(t=>{var i;return(null===(i=t.weekStatus)||void 0===i?void 0:i.startDayOfWeek)===e}).weekStatus=new Ie.a(this.weekStatusMap[e])}subscribeToAllTimeEntries(){this.trackerService.timeEntries$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{if(!e)return this.isError=!0,this.loadInProgress=!1,void this.cd.detectChanges();if(this.weekStatusMap=e.weekStatusMap||{},this.approvalHelperService.updateWeekStatusToGroups(e.entryGroups,this.weekStatusMap,!0),this.total=e.total,this.isMultiplePages=this.total>ei.j||this.total>this.limit,this.numberOfEntries=e.received,0===e.entryGroups.length&&1!=this.page&&(this.page=1,this.setPaginationUrl({page:this.page}),this.pager)&&this.pager.setPaginationManually({page:this.page,limit:this.limit,total:this.total}),this.isError=!1,this.loadInProgress=!1,e.entryInProgress&&(this.entryInProgress=e.entryInProgress),e.preventScroll||this.browserService.scrollToTop(),e.lazyLoading){this.entryGroupsTemp=e.entryGroups,this.lazyStep=this.setLazyStep(this.entryGroupsTemp)||2;const t=this.lazyStep>e.entryGroups.length?e.entryGroups.length:this.lazyStep;this.entryGroupsLazy=this.entryGroupsTemp.slice(0,t),this.cd.detectChanges(),t<e.entryGroups.length&&(this.keyboardService.removeListener(),this.lazyLoadingInProgress=!0,this.lazyLoading$=new Ee.a,this.lazyLoading(t,!0))}else this.entryGroupsLazy=e.entryGroups,this.cd.detectChanges()})}setLazyStep(e){let t=0;for(let i=0;i<e.length;i++)if(t+=e[i].timeEntries.length,t>10)return(0===i?1:i)+1;return e.length}setPaginationUrl(e){this.uiSettingsService.setSettings(hi.b.TRACKER_PAGINATION,e),this.router.navigate(["/"+ei.o],{queryParams:{page:e.page||this.page,limit:e.limit||this.limit}})}trackByFn(e,t){return t.id}subscribeEntryChanged(){this.entryGroupService.numberOfEntriesChanged$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.checkPaginationSize()})}checkPaginationSize(){let e=0;this.entryGroupsLazy.forEach(t=>{t.timeEntries.forEach(t=>{t.children?e+=t.children.length:e++})}),this.numberOfEntries=e,this.pager&&this.pager.setNumberOfEntriesOnPage(e),0===e&&this.getAllTimeEntries()}deleteEntryGroup(e,t,i){this.lazyLoadingInProgress?this.lazyLoading$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>this.removeEntryGroup(e,t,i)):this.removeEntryGroup(e,t,i)}removeEntryGroup(e,t,i){this.entryGroupsLazy.splice(e,1),this.changeWeekDuration(t.date,i,"subtract")}changeWeekDuration(e,t,i){const n=Object(ke.e)(jt(e),this.startOfWeek).format("YYYY-MM-DD");this.weekStatusMap[n]&&("add"===i?this.weekStatusMap[n].addTotalDuration(t):this.weekStatusMap[n].subtractTotalDuration(t),this.approvalHelperService.updateWeekStatusToGroups(this.entryGroupsLazy,this.weekStatusMap))}getSingleWeekStatus(e){if(!this.workspace.timeApprovalEnabled)return;const t=jt.utc(e).toISOString();this.approvalService.getWeekStatus(t,e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{const{entriesCount:i,approvedCount:n}=this.approvalHelperService.getTotalsOfWeek(this.entryGroupsLazy,t.startDayOfWeek);t.initIsApprovedOnOtherPages(i,n),this.weekStatusMap[e]=t,this.approvalHelperService.updateWeekStatusToGroups(this.entryGroupsLazy,this.weekStatusMap),this.cd.detectChanges()})}subscribeToNewEntry(){this.entryGroupService.newEntryCreated$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.lazyLoadingInProgress?this.lazyLoading$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.addEntryGroup(e)}):this.addEntryGroup(e)})}addEntryGroup(e){const t=this.userService.getTimeZone(),i=jt.tz(e.timeInterval.start,t).format("YYYY-MM-DD"),n=this.entryGroupsLazy.findIndex(e=>e.date===i);if(n>=0&&this.entryGroupsLazy[n]){const t=new Bd.a(this.entryGroupsLazy[n].time);t.add(e.timeInterval.duration),this.entryGroupsLazy[n].time=t.asString(),this.entryGroupsLazy[n].timeEntries.push(e);const i=this.entryGroupsLazy[n];this.entryGroupsLazy[n]=new xt.a(i.date,i.time,i.timeEntries,i.editMode,i.weekStatus),this.changeWeekDuration(i.date,e.timeInterval.duration,"add")}else{const t=this.entryGroupsLazy.length?this.entryGroupsLazy[this.entryGroupsLazy.length-1].date:0,n=this.entryGroupsLazy.length?this.entryGroupsLazy[0].date:0;if(this.numberOfEntries<this.limit)this.createNewEntryGroup(e,i);else if(1===this.page&&jt(i).isAfter(jt(n)))this.createNewEntryGroup(e,i);else if(jt(i).isAfter(jt(t))&&jt(i).isBefore(jt(n)))this.createNewEntryGroup(e,i);else if(jt(i).isBefore(jt(t))){this.isMultiplePages=!0,this.pager&&this.pager.allowNextPage();const t=Object(ke.e)(jt(i),this.startOfWeek).format("YYYY-MM-DD");this.weekStatusMap[t]&&(this.weekStatusMap[t].isApprovedAllOnOtherPages=!1),this.changeWeekDuration(i,e.timeInterval.duration,"add")}}this.checkPaginationSize(),this.cd.detectChanges()}createNewEntryGroup(e,t){const i=new xt.a(t,e.timeInterval.duration,[e]),n=this.entryGroupsLazy.length;let s=0;for(let r=0;r<n;r++)jt(t).isBefore(jt(this.entryGroupsLazy[r].date))&&(s=r+1);s>=n?this.entryGroupsLazy.push(i):this.entryGroupsLazy.splice(s,0,i);const c=Object(ke.e)(jt(t),this.startOfWeek).format("YYYY-MM-DD");if(this.weekStatusMap[c])this.changeWeekDuration(t,i.time,"add");else{const e={startDayOfWeek:c,total:i.time,isApprovedAllOnOtherPages:!0,dateRange:{start:jt(c).startOf("day").toISOString(),end:jt(c).add(6,"day").endOf("day").toISOString()}};this.weekStatusMap[c]=new Ie.a(e),this.approvalHelperService.updateWeekStatusToGroups(this.entryGroupsLazy,this.weekStatusMap),this.getSingleWeekStatus(c)}this.cd.detectChanges()}enableTimeSheet(){this.workspace.canSeeTimeSheet=!0;const e={preventToast:!0,onSuccess:this.enableTimeSheetOnSuccess.bind(this)};this.workspaceService.updateWorkspaceSettings(this.workspace,e)}enableTimeSheetOnSuccess(){this.enabledTimesheet=!0}closeOnboardingTimesheet(){this.onboardingTimesheet=!1}getCustomFields(){this.customFieldService.get().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.customFields=e,this.hasActiveCustomFields=e.some(e=>e.status===Jd.a.VISIBLE),this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Ce.a),c.Rb(c.h),c.Rb(hi.a),c.Rb(Mt),c.Rb(ys.a),c.Rb(Qt.a),c.Rb(Gd.a),c.Rb(U.a),c.Rb(_d.a),c.Rb(W.a),c.Rb(W.c),c.Rb(Oe),c.Rb(pi.a),c.Rb(Hd.a),c.Rb(Vd.a),c.Rb($d.a),c.Rb(qd.a),c.Rb(Qd),c.Rb(Zd),c.Rb(Lt.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["tracker2"]],viewQuery:function(e,t){var i;1&e&&c.ed(cn.a,!0),2&e&&c.Kc(i=c.kc())&&(t.pager=i.first)},decls:3,vars:2,consts:[[1,"cl-page-wrapper","cl-px-0","cl-px-lg-2","cl-pt-0"],["class","cl-tracker-wrapper",4,"ngIf"],["class","cl-toast-wrapper",4,"ngIf"],[1,"cl-tracker-wrapper"],[1,"cl-container-fluid","cl-px-0","cl-px-lg-2"],[1,"cl-time-tracker-recorder","cl-new-layer",3,"entryInProgress","entryGroups","projectData","format","disableManualMode","setCustomFields"],["class","cl-tracker-entries-wrapper",3,"cl-entries-w-cf",4,"ngIf","ngIfElse"],["messageEntries",""],[1,"cl-tracker-entries-wrapper"],[3,"format","startOfWeek","isAdminOrOwner","projectData","weekStatus","customFields","timeApprovalEnabled","disableManualMode","entryGroup","loaded","deleteEntryGroup","subtractWeekDuration","addWeekDuration","onApprovalSubmit","onApprovalWithdraw",4,"ngFor","ngForOf","ngForTrackBy"],[3,"visible","page","limit","total","pageChanged","limitChanged"],["pager",""],[3,"format","startOfWeek","isAdminOrOwner","projectData","weekStatus","customFields","timeApprovalEnabled","disableManualMode","entryGroup","loaded","deleteEntryGroup","subtractWeekDuration","addWeekDuration","onApprovalSubmit","onApprovalWithdraw"],[1,"cl-no-entries-wrapper"],[3,"isError","loadInProgress"],[1,"cl-toast-wrapper"],[1,"cl-toast"],[1,"cl-toast-body"],["type","button",1,"cl-ml-3","cl-close",3,"click"],["class","cl-d-flex cl-align-items-start",4,"ngIf"],[1,"cl-d-flex","cl-align-items-start"],["src","assets/images/ui-icons/checkmark-green-circle.svg",1,"cl-mr-2"],[1,"cl-h3","cl-mb-0"],[1,"cl-text-gray-9","cl-small"],["routerLink","/timesheet",1,"cl-color-blue"],["src","assets/images/nav-icons/timesheet.svg",1,"cl-mr-2"],[1,"cl-small","cl-color-blue",3,"click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Wc(1,og,6,10,"div",1),c.Wb(),c.Wc(2,bg,8,2,"div",2)),2&e&&(c.Cb(1),c.wc("ngIf",t.workspace),c.Cb(1),c.wc("ngIf",t.onboardingTimesheet))},directives:[s.u,fh,s.t,cn.a,ng,Pi,W.f],encapsulation:2,changeDetection:0}),e})();var dg=i("SxV6");let pg=(()=>{class e{constructor(e,t,i){this.http=e,this.toaster=t,this.authService=i,this.error=new Ee.a,this.apiKey$=new Ee.a}generateApiKey(){const e=this.authService.getUser().id;this.http.post(`/apiKey/${e}/generateApiKey`,{}).pipe(Object(Y.a)(e=>new F(e))).subscribe(e=>{this.apiKey$.next(e),this.toaster.pop("success","Api Key is generated.")},e=>{this.toaster.pop("error",e.error&&e.error.message||"Generate Api Key failed.")})}getApiKeyForUser(){const e=this.authService.getUser().id;this.http.get("/apiKey/"+e).pipe(Object(Y.a)(e=>new F(e))).subscribe(e=>this.apiKey$.next(e))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(P.b),c.fc(M.a),c.fc(Ce.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var hg=i("1+cd"),mg=i("ePBx"),gg=i("B4wx");let fg=(()=>{class e{constructor(e){this._sendNewsletter=e&&e.sendNewsletter,this._weeklyUpdates=e&&e.weeklyUpdates,this._longRunning=e&&e.longRunning,this._timeZone=e&&e.timeZone,this._dateFormat=e&&e.dateFormat,this._timeFormat=e&&e.timeFormat,this._weekStart=e&&e.weekStart,this._timeTrackingManual=e&&e.timeTrackingManual,this._summaryReportSettings=e&&e.summaryReportSettings,this._isCompactViewOn=e&&e.isCompactViewOn,this._dashboardSelection=e&&e.dashboardSelection,this._dashboardDateRange=e&&e.dashboardDateRange,this._dashboardViewType=e&&e.dashboardViewType?e.dashboardViewType:Cs.a.BILLABILITY,this._dashboardPinToTop=e&&e.dashboardPinToTop,this._projectListCollapse=e&&e.projectListCollapse,this._collapseAllProjectLists=e&&e.collapseAllProjectLists,this._groupSimilarEntriesDisabled=e&&e.groupSimilarEntriesDisabled,this._myStartOfDay=e&&e.myStartOfDay,this._darkTheme=e&&e.darkTheme,this._projectPickerSpecialFilter=e&&e.projectPickerSpecialFilter}get sendNewsletter(){return this._sendNewsletter}get weeklyUpdates(){return this._weeklyUpdates}get longRunning(){return this._longRunning}get timeZone(){return this._timeZone}get dateFormat(){return this._dateFormat}get timeFormat(){return this._timeFormat}get weekStart(){return this._weekStart}get timeTrackingManual(){return this._timeTrackingManual}get summaryReportSettings(){return this._summaryReportSettings}set sendNewsletter(e){this._sendNewsletter=e}set weeklyUpdates(e){this._weeklyUpdates=e}set longRunning(e){this._longRunning=e}set timeZone(e){this._timeZone=e}set dateFormat(e){this._dateFormat=e}set timeFormat(e){this._timeFormat=e}set weekStart(e){this._weekStart=e}set timeTrackingManual(e){this._timeTrackingManual=e}set summaryReportSettings(e){this._summaryReportSettings=e}get isCompactViewOn(){return this._isCompactViewOn}set isCompactViewOn(e){this._isCompactViewOn=e}get dashboardSelection(){return this._dashboardSelection}set dashboardSelection(e){this._dashboardSelection=e}get dashboardDateRange(){return this._dashboardDateRange}set dashboardDateRange(e){this._dashboardDateRange=e}get dashboardViewType(){return this._dashboardViewType}set dashboardViewType(e){this._dashboardViewType=e}get dashboardPinToTop(){return this._dashboardPinToTop}set dashboardPinToTop(e){this._dashboardPinToTop=e}get projectListCollapse(){return this._projectListCollapse}get collapseAllProjectLists(){return this._collapseAllProjectLists}set collapseAllProjectLists(e){this._collapseAllProjectLists=e}set projectListCollapse(e){this._projectListCollapse=e}get groupSimilarEntriesDisabled(){return this._groupSimilarEntriesDisabled}set groupSimilarEntriesDisabled(e){this._groupSimilarEntriesDisabled=e}get myStartOfDay(){return this._myStartOfDay}set myStartOfDay(e){this._myStartOfDay=e}get darkTheme(){return this._darkTheme}set darkTheme(e){this._darkTheme=e}get projectPickerSpecialFilter(){return this._projectPickerSpecialFilter}set projectPickerSpecialFilter(e){this._projectPickerSpecialFilter=e}}return e.defaultMyStartOfDay="09:00",e})();function vg(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",10),c.jc("keyup.enter",(function(){c.Oc(e);const i=t.$implicit;return c.nc(2).valueChange(i)}))("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc(2).valueChange(i)})),c.Yc(1),c.Wb()}if(2&e){const e=t.$implicit,i=c.nc(2);c.Hb("cl-active",i.selected===e),c.Cb(1),c.ad(" ",i.options[e]," ")}}function wg(e,t){if(1&e&&(c.Xb(0,"div",6),c.Xb(1,"div",7),c.Wc(2,vg,2,3,"a",8),c.Sb(3,"span",9),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.wc("ngForOf",e.objectKeys(e.options))}}function yg(e,t){if(1&e&&(c.Xb(0,"div"),c.Xb(1,"small",17),c.Yc(2),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(2),c.ad(" If your clients have ",e.limit,"+ projects, all projects will be collapsed ")}}function Wg(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",11),c.Xb(1,"div",12),c.Xb(2,"div",13),c.Xb(3,"input",14,15),c.jc("change",(function(){return c.Oc(e),c.nc().numberChanged()}))("keyup.enter",(function(){return c.Oc(e),c.Lc(4).blur()}))("ngModelChange",(function(t){return c.Oc(e),c.nc().settings.projectListCollapse=t})),c.Wb(),c.Wb(),c.Wc(5,yg,3,1,"div",16),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.wc("ngModel",e.settings.projectListCollapse),c.Cb(2),c.wc("ngIf",e.showWarning&&e.settings.projectListCollapse>=50)}}var Cg=function(e){return e.ALL="ALL",e.DONT="DONT",e.NUMBER="NUMBER",e}({});let kg=(()=>{class e{constructor(){this.limit=50,this.defaultValue=40,this.objectKeys=Object.keys,this.options={ALL:"Collapse all",DONT:"Don't collapse",NUMBER:"Collapse if too many projects"},this.onChange=new c.n,this.unsubscribe$=new Ee.a}ngOnInit(){this.fromSettingsToDropdownValues()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}fromSettingsToDropdownValues(){this.numberOfProjectsBackup=this.settings.projectListCollapse||this.defaultValue,this.selected=this.settings.projectListCollapse&&this.settings.collapseAllProjectLists?Cg.ALL:null!==this.settings.projectListCollapse?Cg.NUMBER:Cg.DONT}valueChange(e){if(e!==this.selected)return this.selected=e,e===Cg.DONT?(this.settings.collapseAllProjectLists=!1,this.numberOfProjectsBackup=this.settings.projectListCollapse||this.numberOfProjectsBackup,this.settings.projectListCollapse=null,void this.emitChanges()):e===Cg.ALL?(this.settings.collapseAllProjectLists=!0,this.settings.projectListCollapse=this.numberOfProjectsBackup,void this.emitChanges()):e===Cg.NUMBER?(this.showWarning=!1,this.settings.collapseAllProjectLists=!1,this.numberOfProjectsBackup>this.limit&&(this.numberOfProjectsBackup=this.defaultValue),this.settings.projectListCollapse=this.numberOfProjectsBackup,void this.emitChanges()):void 0}numberChanged(){this.settings.projectListCollapse>this.limit&&(this.settings.projectListCollapse=this.limit,this.showWarning=!0),this.settings.projectListCollapse<1&&(this.settings.projectListCollapse=1),this.emitChanges()}emitChanges(){this.onChange.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["compact-project"]],inputs:{settings:"settings"},outputs:{onChange:"onChange"},decls:7,vars:2,consts:[[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-6"],["dropdownKey","",1,"cl-dropdown"],["tabindex","0","dropdownKeyButton","",1,"cl-btn","cl-btn-outline-light","cl-w-100","cl-text-left","cl-dropdown-toggle","cl-cut-text","cl-pr-3"],["class","cl-dropdown-menu","openUpAtBottom","",4,"dropdownKeyContent"],["class","cl-col-md-6",4,"ngIf"],["openUpAtBottom","",1,"cl-dropdown-menu"],[1,"cl-scroll-area"],["clickCloseDropdown","","tabindex","0","class","cl-dropdown-item",3,"cl-active","keyup.enter","click",4,"ngFor","ngForOf"],["dropdownClose","","tabindex","0"],["clickCloseDropdown","","tabindex","0",1,"cl-dropdown-item",3,"keyup.enter","click"],[1,"cl-col-md-6"],[1,"cl-form-group"],[1,"cl-input-group"],["type","number","name","projectListCollapse2","tabindex","0",1,"cl-form-control",3,"ngModel","change","keyup.enter","ngModelChange"],["compactProjectInput",""],[4,"ngIf"],[1,"cl-form-text","cl-text-gray-9"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"a",3),c.Yc(4),c.Wb(),c.Wc(5,wg,4,1,"div",4),c.Wb(),c.Wb(),c.Wc(6,Wg,6,2,"div",5),c.Wb()),2&e&&(c.Cb(4),c.ad(" ",t.options[t.selected]," "),c.Cb(2),c.wc("ngIf","NUMBER"===t.selected))},directives:[Si.a,Ii.a,Oi.a,s.u,s.t,p.y,p.c,p.s,p.v],encapsulation:2}),e})();var Sg=i("WQ+v");let Ig=(()=>{class e{constructor(e,t,i){this.timeInputConverterService=e,this.timeZoneConverterService=t,this.userService=i,this._hours=fg.defaultMyStartOfDay,this.onTimeChanged=new c.n,this.format="HH:mm"}set hours(e){e&&(this._hours=e,this.backup=e,this.isInitialized&&this.initDate())}get hours(){return this._hours}set timeFormat(e){e&&(this.format=e===gg.a.HOUR12?"hh:mmA":"HH:mm",this.isInitialized&&this.initDate())}ngOnInit(){this.initDate(),this.isInitialized=!0}timeChanged(){let e=this.hoursModel.trim();if(!e)return void(this.hours=this.backup);if(e=this.timeInputConverterService.parseInput(e.replace(/ /g,"")),!e)return void(this.hours=this.backup);e.indexOf(":")<0&&(e=e.substring(0,2).concat(":").concat(e.substring(2,4)));const t=Se(),i=Number(e.split(":")[0]),n=Number(e.split(":")[1]);t.hours(i),t.minutes(n);const s=this.emitFormat||this.format,c=Se(t).format(s).toString();c!==this.backup?this.emit(c):this.hours=this.backup}initDate(){this.hoursModel=Object(Se.utc)(this.hours,"HH:mm").format(this.format)}emit(e){this.hours=e,this.onTimeChanged.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Sg.a),c.Rb(vs.a),c.Rb(ys.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["input-hours"]],inputs:{hours:"hours",timeFormat:"timeFormat",emitFormat:"emitFormat"},outputs:{onTimeChanged:"onTimeChanged"},decls:2,vars:1,consts:[["spellcheck","false","autocomplete","off","type","text","tabindex","0",1,"cl-form-control","cl-input-time-picker",3,"ngModel","ngModelChange","blur","keyup.enter"],["inputField",""]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"input",0,1),c.jc("ngModelChange",(function(e){return t.hoursModel=e}))("blur",(function(){return t.timeChanged()}))("keyup.enter",(function(){return c.Oc(e),c.Lc(1).blur()})),c.Wb()}2&e&&c.wc("ngModel",t.hoursModel)},directives:[p.c,p.s,p.v],encapsulation:2,changeDetection:0}),e})();function Og(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" Password must have at least ",e.minLength," characters. ")}}function Xg(e,t){if(1&e&&(c.Xb(0,"div",10),c.Wc(1,Og,2,1,"span",11),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.oldPassword.errors.required||e.oldPassword.errors.minlength)}}function Eg(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" Password must have at least ",e.minLength," characters. ")}}function Tg(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" Password can't be longer than ",e.maxLength," characters. ")}}function Dg(e,t){if(1&e&&(c.Xb(0,"div",10),c.Wc(1,Eg,2,1,"span",11),c.Wc(2,Tg,2,1,"span",11),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.newPassword.errors.required||e.newPassword.errors.minlength),c.Cb(1),c.wc("ngIf",e.newPassword.errors.maxlength)}}function Rg(e,t){1&e&&(c.Xb(0,"span"),c.Yc(1," Passwords don't match. "),c.Wb())}function Ag(e,t){if(1&e&&(c.Xb(0,"div",10),c.Wc(1,Rg,2,0,"span",11),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.newPasswordRepeated.errors.matchInputs)}}let jg=(()=>{class e{constructor(e,t){this.formBuilder=e,this.authService=t,this.unsubscribe$=new Ee.a,this.onClose=new c.n}ngOnInit(){this.minLength=ei.s,this.maxLength=ei.r,this.changePasswordForm=this.formBuilder.group({oldPassword:["",[p.G.required,p.G.minLength(this.minLength)]],newPassword:["",[p.G.required,p.G.minLength(this.minLength),p.G.maxLength(this.maxLength)]],newPasswordRepeated:["",[]]},{validator:Object(Pt.B)("newPassword","newPasswordRepeated")})}get oldPassword(){return this.changePasswordForm.get("oldPassword")}get newPassword(){return this.changePasswordForm.get("newPassword")}get newPasswordRepeated(){return this.changePasswordForm.get("newPasswordRepeated")}get isOldPasswordInvalid(){return this.oldPassword.dirty&&this.oldPassword.touched&&!!this.oldPassword.errors}get isNewPasswordInvalid(){return this.newPassword.dirty&&this.newPassword.touched&&!!this.newPassword.errors}get isNewPasswordRepeatedInvalid(){return this.newPasswordRepeated.dirty&&this.newPasswordRepeated.touched&&!!this.newPasswordRepeated.errors}onSubmit(){this.changePasswordForm.invalid||(this.inProgress=!0,this.authService.changePassword(this.oldPassword.value,this.newPassword.value,this.newPasswordRepeated.value).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>this.closeModal(),()=>this.inProgress=!1))}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}closeModal(){this.onClose.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(p.f),c.Rb(Ce.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["change-password"]],outputs:{onClose:"onClose"},decls:22,vars:11,consts:[["novalidate","",3,"formGroup","ngSubmit"],[1,"cl-modal-body"],[1,"cl-form-group"],["formControlName","oldPassword","type","password","ngbAutofocus","","autofill","off","autocomplete","current-password",1,"cl-form-control"],["class","cl-invalid-feedback",4,"ngIf"],["type","password","autocomplete","current-password","autofill","off","formControlName","newPassword","autocomplete","new-password",1,"cl-form-control"],["type","password","autocomplete","new-password","autofill","off","formControlName","newPasswordRepeated",1,"cl-form-control"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"click","keyup.enter"],["type","submit","tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-invalid-feedback"],[4,"ngIf"]],template:function(e,t){1&e&&(c.Xb(0,"form",0),c.jc("ngSubmit",(function(){return t.onSubmit()})),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"label"),c.Yc(4,"Old password"),c.Wb(),c.Sb(5,"input",3),c.Wc(6,Xg,2,1,"div",4),c.Wb(),c.Xb(7,"div",2),c.Xb(8,"label"),c.Yc(9,"New password"),c.Wb(),c.Sb(10,"input",5),c.Wc(11,Dg,3,2,"div",4),c.Wb(),c.Xb(12,"div",2),c.Xb(13,"label"),c.Yc(14,"Retype new password"),c.Wb(),c.Sb(15,"input",6),c.Wc(16,Ag,2,1,"div",4),c.Wb(),c.Wb(),c.Xb(17,"div",7),c.Xb(18,"a",8),c.jc("click",(function(){return t.closeModal()}))("keyup.enter",(function(){return t.closeModal()})),c.Yc(19,"Cancel"),c.Wb(),c.Xb(20,"button",9),c.Yc(21,"Save"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.wc("formGroup",t.changePasswordForm),c.Cb(5),c.Hb("cl-is-invalid",t.isOldPasswordInvalid),c.Cb(1),c.wc("ngIf",t.isOldPasswordInvalid),c.Cb(4),c.Hb("cl-is-invalid",t.isNewPasswordInvalid),c.Cb(1),c.wc("ngIf",t.isNewPasswordInvalid),c.Cb(4),c.Hb("cl-is-invalid",t.isNewPasswordRepeatedInvalid),c.Cb(1),c.wc("ngIf",t.isNewPasswordRepeatedInvalid),c.Cb(4),c.wc("disabled",t.inProgress||t.changePasswordForm.invalid))},directives:[p.I,p.t,p.k,p.c,p.s,p.i,s.u],encapsulation:2}),e})();function xg(e,t){1&e&&(c.Xb(0,"div",9),c.Yc(1," Enter a valid email. "),c.Wb())}function Pg(e,t){1&e&&(c.Xb(0,"div",9),c.Yc(1," Emails don't match. "),c.Wb())}let Mg=(()=>{class e{constructor(e,t,i){this.formBuilder=e,this.authService=t,this.toaster=i,this.unsubscribe$=new Ee.a,this.onClose=new c.n}ngOnInit(){this.oldEmail=this.authService.getUser().email,this.changePasswordForm=this.formBuilder.group({newEmail:["",[p.G.required,p.G.email]],retypedNewEmail:["",[]]},{validator:Object(Pt.B)("newEmail","retypedNewEmail")})}get newEmail(){return this.changePasswordForm.get("newEmail")}get retypedNewEmail(){return this.changePasswordForm.get("retypedNewEmail")}get isNewEmailInvalid(){return this.newEmail.dirty&&this.newEmail.touched&&!!this.newEmail.errors}get isRetypedNewEmailInvalid(){return this.retypedNewEmail.dirty&&this.retypedNewEmail.touched&&!!this.retypedNewEmail.errors}onSubmit(){if(!this.changePasswordForm.invalid){if(this.oldEmail.toLowerCase()===this.newEmail.value.toLowerCase())return this.toaster.pop("success","Email saved"),void this.closeModal();this.inProgress=!0,this.authService.changeEmail(this.newEmail.value.toLowerCase(),this.userId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>this.closeModal(),e=>this.inProgress=!1)}}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}closeModal(){this.onClose.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(p.f),c.Rb(Ce.a),c.Rb(n.d))},e.\u0275cmp=c.Lb({type:e,selectors:[["change-email"]],inputs:{userId:"userId"},outputs:{onClose:"onClose"},decls:17,vars:8,consts:[["novalidate","",3,"formGroup","ngSubmit"],[1,"cl-modal-body"],[1,"cl-form-group"],["formControlName","newEmail","type","email","ngbAutofocus","","autocomplete","off",1,"cl-form-control"],["class","cl-invalid-feedback",4,"ngIf"],["type","email","autocomplete","off","formControlName","retypedNewEmail",1,"cl-form-control"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"keyup.enter","click"],["type","submit","tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-invalid-feedback"]],template:function(e,t){1&e&&(c.Xb(0,"form",0),c.jc("ngSubmit",(function(){return t.onSubmit()})),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"label"),c.Yc(4,"New email"),c.Wb(),c.Sb(5,"input",3),c.Wc(6,xg,2,0,"div",4),c.Wb(),c.Xb(7,"div",2),c.Xb(8,"label"),c.Yc(9,"Retype new email"),c.Wb(),c.Sb(10,"input",5),c.Wc(11,Pg,2,0,"div",4),c.Wb(),c.Wb(),c.Xb(12,"div",6),c.Xb(13,"a",7),c.jc("keyup.enter",(function(){return t.closeModal()}))("click",(function(){return t.closeModal()})),c.Yc(14,"Cancel"),c.Wb(),c.Xb(15,"button",8),c.Yc(16,"Save"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.wc("formGroup",t.changePasswordForm),c.Cb(5),c.Hb("cl-is-invalid",t.isNewEmailInvalid),c.Cb(1),c.wc("ngIf",t.isNewEmailInvalid),c.Cb(4),c.Hb("cl-is-invalid",t.isRetypedNewEmailInvalid),c.Cb(1),c.wc("ngIf",t.isRetypedNewEmailInvalid),c.Cb(4),c.wc("disabled",t.inProgress||t.changePasswordForm.invalid))},directives:[p.I,p.t,p.k,p.c,p.s,p.i,s.u],encapsulation:2}),e})(),Yg=(()=>{class e{constructor(e){this.apiKeyService=e,this.unsubscribe$=new Ee.a,this.onClose=new c.n}ngOnInit(){}confirmGenerateApiKey(){this.apiKeyService.generateApiKey(),this.closeModal()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}closeModal(){this.onClose.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(pg))},e.\u0275cmp=c.Lb({type:e,selectors:[["generate-api"]],outputs:{onClose:"onClose"},decls:14,vars:1,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-mb-0"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"disabled","keyup.enter","click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2,"Generate API key"),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.closeModal()})),c.Xb(4,"span",3),c.Sb(5,"img",4),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",5),c.Xb(7,"p",6),c.Yc(8," If you generate a new key, the old key will stop working. "),c.Wb(),c.Wb(),c.Xb(9,"div",7),c.Xb(10,"a",8),c.jc("click",(function(){return t.closeModal()})),c.Yc(11,"Cancel"),c.Wb(),c.Xb(12,"button",9),c.jc("keyup.enter",(function(){return t.confirmGenerateApiKey()}))("click",(function(){return t.confirmGenerateApiKey()})),c.Yc(13,"Generate new key"),c.Wb(),c.Wb()),2&e&&(c.Cb(12),c.wc("disabled",t.inProgress))},encapsulation:2}),e})();var Lg=i("xJiw");const Fg=["fileInput"],Ng=["dropdownItems"],Ug=["dropdownTimeZone"];function $g(e,t){1&e&&(c.Xb(0,"modal-header",66),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"change-password",67),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb()),2&e&&c.wc("title","Change password")}function _g(e,t){if(1&e){const e=c.Yb();c.Xb(0,"modal-header",66),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"set-password",68),c.jc("onClose",(function(){return t.$implicit.close()}))("onSetPassword",(function(){c.Oc(e);const i=t.$implicit;return c.nc().onSetPassword(),i.close()})),c.Wb()}2&e&&c.wc("title","Set password")}function Gg(e,t){if(1&e&&(c.Xb(0,"modal-header",66),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"change-email",69),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb()),2&e){const e=c.nc();c.wc("title","Change email"),c.Cb(1),c.wc("userId",null==e.user?null:e.user.id)}}function Bg(e,t){1&e&&(c.Xb(0,"generate-api",67),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb())}function Vg(e,t){if(1&e&&(c.Xb(0,"li"),c.Yc(1),c.oc(2,"momentFormat"),c.oc(3,"momentFormat"),c.Wb()),2&e){const e=t.$implicit,i=c.nc(3);c.Cb(1),c.bd(" ",c.qc(2,2,e.start,i.user.settings.dateFormat)," - ",c.qc(3,5,e.end,i.user.settings.dateFormat)," ")}}function Hg(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"div",73),c.Yc(2),c.Wb(),c.Xb(3,"ul",74),c.Wc(4,Vg,4,8,"li",72),c.Wb(),c.Ub()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e.name),c.Cb(2),c.wc("ngForOf",e.ranges)}}function zg(e,t){if(1&e){const e=c.Yb();c.Xb(0,"delete-confirm-modal",70),c.jc("onDelete",(function(){c.Oc(e);const i=t.$implicit;return c.nc().confirmWithdrawnAll(i)}))("onClose",(function(){c.Oc(e);const i=t.$implicit;return c.nc().cancelWithdrawnAllApprovals(),i.close(!1)})),c.Xb(1,"p",71),c.Yc(2),c.Wb(),c.Wc(3,Hg,5,2,"ng-container",72),c.Wb()}if(2&e){const e=c.nc();c.wc("title","timeZone"===e.approvalInProgressProp?"Change Time zone":"Change Week start")("btnText","Unsubmit")("showConfirmation",!0)("confirmationText","unsubmit")("inProgress",e.inProgress),c.Cb(2),c.ad(" Before you can change ","timeZone"===e.approvalInProgressProp?"time zone":"when your week starts",", you first have to unsubmit all your submitted time that's waiting for approval: "),c.Cb(1),c.wc("ngForOf",e.pendingApprovals)}}function qg(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",75),c.jc("keyup.enter",(function(){return c.Oc(e),c.nc().removeImage()}))("click",(function(){return c.Oc(e),c.nc().removeImage()})),c.Yc(1,"Remove image"),c.Wb()}}function Kg(e,t){1&e&&(c.Xb(0,"span",76),c.Xb(1,"a",77),c.Yc(2,"Change"),c.Wb(),c.Wb())}function Zg(e,t){if(1&e){const e=c.Yb();c.Xb(0,"span",62),c.Xb(1,"a",63,78),c.jc("click",(function(){c.Oc(e);const t=c.Lc(2),i=c.nc(),n=c.Lc(5);return t.blur(),i.openModal(n)}))("keyup.enter",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(5);return t.openModal(i)})),c.Yc(3," Change "),c.Wb(),c.Wb()}}function Qg(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",79),c.jc("click",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(1);return t.canChangeReceived&&t.openModal(i)}))("keyup.enter",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(1);return t.openModal(i)})),c.Yc(1," Change password "),c.Wb()}}function Jg(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",79),c.jc("click",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(3);return t.canChangeReceived&&t.openModal(i)}))("keyup.enter",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(3);return t.openModal(i)})),c.Yc(1," Set password"),c.Wb(),c.Xb(2,"small",80),c.Yc(3," In addition to Google log-in, you can also log in using email and password. "),c.Wb()}}function ef(e,t){if(1&e&&(c.Xb(0,"div"),c.Sb(1,"img",82),c.Xb(2,"span"),c.Yc(3),c.oc(4,"displayUserName"),c.Wb(),c.Xb(5,"span"),c.Yc(6),c.Wb(),c.Wb()),2&e){const e=t.$implicit,i=c.nc(2);c.Cb(3),c.ad("",c.rc(4,3,e.users,i.users,i.userGroups),":"),c.Cb(3),c.bd(" ",e.hours," hours per ",e.dateRange,"")}}function tf(e,t){if(1&e&&(c.Xb(0,"div",13),c.Xb(1,"div",14),c.Xb(2,"div",16),c.Yc(3,"Time tracking targets"),c.Wb(),c.Wb(),c.Xb(4,"div",81),c.Wc(5,ef,7,7,"div",72),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(5),c.wc("ngForOf",e.targets)}}const nf=function(){return["/webhooks"]};let sf=(()=>{class e{constructor(e,t,i,n,s,c,r,o,a,l,b,u){this.userService=e,this.authService=t,this.notificationService=i,this.apiKeyService=n,this.reminderService=s,this.userGroupService=c,this.workspaceService=r,this.systemSettingsService=o,this.approvalService=a,this.loader=l,this.modalService=b,this.cd=u,this.userGroups=[],this.users=[],this.updateSettingsDebouncer$=new Ee.a,this.unsubscribe$=new mi.a}ngOnInit(){this.initTimeZones(),this.initDropDowns(),this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e}),this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(({isAdminOrOwner:e})=>{this.isAdminOrOwner=e,this.cd.markForCheck()}),this.authService.user.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.setUser(e)});const e=this.authService.getUser();this.setUser(e),this.apiKeyService.apiKey$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{e.apiKey&&(this.apiKey=e.apiKey,e.active||(this.apiKey+=" (deactivated)"),this.cd.detectChanges())}),this.apiKeyService.getApiKeyForUser(),this.authService.canChangePassword.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.canChangeReceived=!0,this.canChangePassword=e,this.cd.detectChanges()}),this.reminderService.targets.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.targets=e,this.cd.detectChanges()}),this.userGroupService.userGroups.pipe(Object(dg.a)(),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.userGroups=e.filter(e=>"Admins"!==e.name),this.workspaceService.getAllUsersForWorkspace(),this.cd.detectChanges()}),this.workspaceService.activeUsers.pipe(Object(dg.a)(),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.users=e,this.cd.detectChanges()}),this.user.settings.sendNewsletter&&this.userService.checkNewsletterSubscription(this.user.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.user.settings.sendNewsletter=e,this.cd.detectChanges()}),this.workspace.hasFeature(nr.a.TARGETS_AND_REMINDERS)&&this.reminderService.getTargets(),this.authService.canChange(),this.userGroupService.getAllUserGroups(),this.subscribeToSaveSettings()}ngAfterViewInit(){this.inputEl&&this.inputEl.nativeElement.focus()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initTimeZones(){let e=Se.tz.names();e=e.map(e=>({timeZone:e,offset:Se.tz(e).format("Z")})).filter(e=>ei.x.indexOf(e.timeZone)<0),e.sort((e,t)=>{const i=t.offset;return parseInt(e.offset.replace(":",""),10)-parseInt(i.replace(":",""),10)}),this.timezones=e.map(({timeZone:e,offset:t})=>{let i=`(UTC ${t}) `+e;return i=i.replace(/_/g," "),new di.a(e,i)})}initDropDowns(){this.dateFormat=[new di.a("MM/DD/YYYY"),new di.a("MM-DD-YYYY"),new di.a("MM DD YYYY"),new di.a("MM.DD.YYYY"),new di.a("DD/MM/YYYY"),new di.a("DD-MM-YYYY"),new di.a("DD MM YYYY"),new di.a("DD.MM.YYYY"),new di.a("YYYY-MM-DD"),new di.a("YYYY/MM/DD"),new di.a("YYYY MM DD"),new di.a("YYYY.MM.DD"),new di.a("YYYY-DD-MM"),new di.a("YYYY/DD/MM"),new di.a("YYYY DD MM"),new di.a("YYYY.DD.MM")],this.timeFormat=[new di.a(gg.a.HOUR12,"12-hour"),new di.a(gg.a.HOUR24,"24-hour")],this.dayOfWeek=[new di.a("MONDAY","Monday"),new di.a("TUESDAY","Tuesday"),new di.a("WEDNESDAY","Wednesday"),new di.a("THURSDAY","Thursday"),new di.a("FRIDAY","Friday"),new di.a("SATURDAY","Saturday"),new di.a("SUNDAY","Sunday")]}updateSettingsDebounce(){this.updateSettingsDebouncer$.next()}nameChanged(){this.user.name=this.user.name.trim(),this.user.name?this.updateSettingsDebounce():this.user.name=this.usernameBackup}setUser(e){this.user=e,this.usernameBackup=this.user.name,this.userTimeFormat=this.user.settings.timeFormat,this.groupSimilarEntries=!this.user.settings.groupSimilarEntriesDisabled,this.cd.detectChanges()}setSettingsProperty(e,t){this.user.settings[t]!==e&&(this.user.settings[t]=e,this.updateSettingsDebounce())}toggleProperty(e){this.user.settings[e]=!this.user.settings[e],this.updateSettingsDebounce()}subscribeToSaveSettings(){this.updateSettingsDebouncer$.pipe(Object(Te.a)(600),Object(De.a)(this.unsubscribe$)).subscribe(()=>this.updateSettings())}updateSettings(){this.user.name||(this.user.name=this.usernameBackup,this.cd.detectChanges()),this.userService.updateSettings(this.user).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.notificationService.userSettingChanged(this.user.settings.timeZone),this.loader.hide()},()=>this.loader.hide())}removeImage(){this.user.profilePicture=hc.a.DEFAULT_PROFILE_PICTURE,this.updateSettings()}get hasCustomProfileImage(){return!this.user.profilePicture.endsWith(ei.t)}setImage(e){this.user.profilePicture=e,this.updateSettings()}openModal(e){this.isModalOpen||(this.isModalOpen=!0,this.modalService.open(e,{centered:!0}).result.then(()=>setTimeout(()=>this.isModalOpen=!1,100),()=>setTimeout(()=>this.isModalOpen=!1,100)))}onTimeZoneChange(e,t){Se.tz(this.user.settings.timeZone).format("Z")!==Se.tz(t).format("Z")?this.checkApprovalSubmittedStatus(e,t,"timeZone"):this.setSettingsProperty(t,"timeZone")}checkApprovalSubmittedStatus(e,t,i){t!==this.user.settings[i]&&(this.approvalInProgressBackupValue=t,this.approvalInProgressProp=i,this.loader.showBar(),this.approvalService.getAllPendingRequestsForAllWorkspaces().pipe(Object(De.a)(this.unsubscribe$)).subscribe(n=>{n.length?(this.pendingApprovals=n,this.modalService.open(e,{centered:!0}).result.then(null,()=>{this.cancelWithdrawnAllApprovals()}),this.loader.hide()):(this.user.settings[i]=t,this.updateSettings())},e=>{this.cancelWithdrawnAllApprovals()}))}confirmWithdrawnAll(e){this.loader.showBar(!0,!0),this.inProgress=!0,this.approvalService.withdrawAllRequestsForAllWorkspaces().pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.user.settings[this.approvalInProgressProp]=this.approvalInProgressBackupValue,this.updateSettings(),this.inProgress=!1,e.close()},e=>{this.inProgress=!1,this.loader.hide()})}cancelWithdrawnAllApprovals(){this.dropdownItems.setValue(this.user.settings.weekStart,null,!1),this.dropdownTimeZone.setValue(this.user.settings.timeZone,null,!1),this.loader.hide()}onSetPassword(){this.canChangePassword=!0}generateApiKey(e){this.apiKey?this.openModal(e):this.apiKeyService.generateApiKey()}timeChanged(e){this.user.settings.myStartOfDay=e,this.updateSettingsDebounce()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(ys.a),c.Rb(Ce.a),c.Rb(D.a),c.Rb(pg),c.Rb(hg.a),c.Rb(mg.a),c.Rb(U.a),c.Rb(Lt.a),c.Rb(Mt),c.Rb(wi.a),c.Rb(g.q),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["userProfile"]],viewQuery:function(e,t){var i;1&e&&(c.ed(Fg,!0),c.ed(Ng,!0),c.ed(Ug,!0)),2&e&&(c.Kc(i=c.kc())&&(t.inputEl=i.first),c.Kc(i=c.kc())&&(t.dropdownItems=i.first),c.Kc(i=c.kc())&&(t.dropdownTimeZone=i.first))},decls:176,vars:37,consts:[["changePasswordModal",""],["setPasswordModal",""],["changeEmailModal",""],["generateApiModal",""],["approvalListModal",""],[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-h1"],[1,"cl-card"],[1,"cl-card-body"],[1,"cl-row"],[1,"cl-col-12"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12"],[1,"cl-mb-3"],[1,"cl-h2","cl-mb-0"],[1,"cl-text-gray-9","cl-w-lg-75"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-upload-img",3,"classSize","src","name"],[1,"cl-upload-file-wrapper"],[1,"cl-upload-btn-wrapper","cl-mr-3"],[3,"onUploaded"],["class","cl-color-blue","tabindex","0",3,"keyup.enter","click",4,"ngIf"],[1,"cl-mt-0"],[1,"cl-form-group","cl-mb-0","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-5"],[1,"cl-form-group","cl-col-md-6"],["type","text","tabindex","0",1,"cl-form-control",3,"ngModel","change","keyup.enter","ngModelChange"],["userNameInput",""],[1,"cl-input-group"],["type","email","autocomplete","off","readonly","",1,"cl-form-control","cl-cut-text",3,"ngModel"],[1,"cl-input-group-append"],["class","cl-input-group-text",4,"ngIf"],["class","cl-input-group-text cl-bg-white",4,"ngIf"],[1,"cl-form-group","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-5"],[1,"cl-form-group","cl-mb-0","cl-col-md-6"],["tabindex","0","class","cl-btn cl-btn-block cl-btn-outline-light",3,"click","keyup.enter",4,"ngIf","ngIfElse"],["setPasswordTemplate",""],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","id","similarGroup","tabindex","0",1,"cl-custom-control-input",3,"ngModel","ngModelChange","keyup.enter"],["for","similarGroup",1,"cl-custom-control-label"],[3,"settings","onChange"],[1,"cl-form-group","cl-col-md-12","cl-col-lg-5"],["type","checkbox","id","searchByTask",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","searchByTask",1,"cl-custom-control-label"],[1,"cl-custom-control","cl-custom-checkbox"],["type","checkbox","name","sendNewsletter","id","newsletter",1,"cl-custom-control-input",3,"ngModel","ngModelChange","keyup.enter"],["for","newsletter",1,"cl-custom-control-label"],["type","checkbox","name","sendNewsletter","id","sendWeeklyUpdates",1,"cl-custom-control-input",3,"ngModel","ngModelChange","keyup.enter"],["for","sendWeeklyUpdates",1,"cl-custom-control-label"],["type","checkbox","name","sendNewsletter","id","longRunningTimers",1,"cl-custom-control-input",3,"ngModel","ngModelChange","keyup.enter"],["for","longRunningTimers",1,"cl-custom-control-label"],["class","cl-form-row",4,"ngIf"],[3,"enableSearch","list","placeholder","value","title","onChanged"],["dropdownTimeZone",""],[3,"list","value","title","onChanged"],["dropdownItems",""],[1,"reset-cl-form-control"],[3,"emitFormat","timeFormat","hours","onTimeChanged"],[1,"cl-form-group","cl-mb-0","cl-col-md-6","cl-col-lg-8","cl-col-lg-custom-5"],["type","text","readonly","",1,"cl-form-control",2,"cursor","text",3,"ngModel","click"],["apiKeyInput",""],[1,"cl-input-group-text","cl-bg-white"],["tabindex","0",1,"cl-color-blue",3,"click","keyup.enter"],["generateLink",""],[3,"routerLink"],[3,"title","onClose"],[3,"onClose"],[3,"onClose","onSetPassword"],[3,"userId","onClose"],[3,"title","btnText","showConfirmation","confirmationText","inProgress","onDelete","onClose"],[1,"cl-text-dark"],[4,"ngFor","ngForOf"],[1,"cl-h2"],[1,"cl-list-unstyled","cl-ml-0"],["tabindex","0",1,"cl-color-blue",3,"keyup.enter","click"],[1,"cl-input-group-text"],["ngbTooltip","Email can't be changed until you set a password","placement","bottom",1,"cl-color-blue","cl-disabled-not-allowed"],["emailBtn",""],["tabindex","0",1,"cl-btn","cl-btn-block","cl-btn-outline-light",3,"click","keyup.enter"],[1,"cl-form-text","cl-text-gray-9"],[1,"cl-col-md-12","cl-mb-2"],["src","../assets/checked.png",1,"cl-mr-2"]],template:function(e,t){if(1&e){const e=c.Yb();c.Wc(0,$g,2,1,"ng-template",null,0,c.Xc),c.Wc(2,_g,2,1,"ng-template",null,1,c.Xc),c.Wc(4,Gg,2,2,"ng-template",null,2,c.Xc),c.Wc(6,Bg,1,0,"ng-template",null,3,c.Xc),c.Wc(8,zg,4,7,"ng-template",null,4,c.Xc),c.Xb(10,"div",5),c.Xb(11,"div",6),c.Xb(12,"div",7),c.Xb(13,"h1",8),c.Yc(14,"Profile settings"),c.Wb(),c.Wb(),c.Xb(15,"div",9),c.Xb(16,"div",10),c.Xb(17,"div",11),c.Xb(18,"div",12),c.Xb(19,"div"),c.Xb(20,"div",13),c.Xb(21,"div",14),c.Xb(22,"div",15),c.Xb(23,"div",16),c.Yc(24,"Profile photo"),c.Wb(),c.Xb(25,"div",17),c.Yc(26," Formats: png, jpg, gif. Max size: 1 MB. "),c.Wb(),c.Wb(),c.Xb(27,"div",18),c.Sb(28,"avatar",19),c.Xb(29,"div",20),c.Xb(30,"div",21),c.Xb(31,"btn-upload-file",22),c.jc("onUploaded",(function(e){return t.setImage(e)})),c.Wb(),c.Wb(),c.Wc(32,qg,2,0,"a",23),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(33,"hr",24),c.Xb(34,"div",13),c.Xb(35,"div",14),c.Xb(36,"div",16),c.Yc(37,"Personal info"),c.Wb(),c.Xb(38,"div",17),c.Yc(39," Your log-in credentials and the name that is displayed in reports. "),c.Wb(),c.Wb(),c.Xb(40,"div",25),c.Xb(41,"div",13),c.Xb(42,"div",26),c.Xb(43,"label"),c.Yc(44,"Name"),c.Wb(),c.Xb(45,"input",27,28),c.jc("change",(function(){return t.nameChanged()}))("keyup.enter",(function(){return c.Oc(e),c.Lc(46).blur()}))("ngModelChange",(function(e){return t.user.name=e})),c.Wb(),c.Wb(),c.Xb(47,"div",26),c.Xb(48,"label"),c.Yc(49,"Email"),c.Wb(),c.Xb(50,"div",29),c.Sb(51,"input",30),c.Xb(52,"div",31),c.Wc(53,Kg,3,0,"span",32),c.Wc(54,Zg,4,0,"span",33),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(55,"div",13),c.Xb(56,"div",34),c.Xb(57,"label"),c.Yc(58,"Password"),c.Wb(),c.Xb(59,"div",13),c.Xb(60,"div",35),c.Wc(61,Qg,2,0,"a",36),c.Wc(62,Jg,4,0,"ng-template",null,37,c.Xc),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(64,"hr",24),c.Xb(65,"div",13),c.Xb(66,"div",14),c.Xb(67,"div",16),c.Yc(68,"Group time entries"),c.Wb(),c.Xb(69,"div",17),c.Yc(70,"Entries for the same activity are grouped for easier overview. Disable if you wish to see entries in chronological order."),c.Wb(),c.Wb(),c.Xb(71,"div",14),c.Xb(72,"div",38),c.Xb(73,"input",39),c.jc("ngModelChange",(function(e){return t.groupSimilarEntries=e}))("ngModelChange",(function(){return t.setSettingsProperty(!t.groupSimilarEntries,"groupSimilarEntriesDisabled")}))("keyup.enter",(function(){return t.groupSimilarEntries=!t.groupSimilarEntries,t.setSettingsProperty(!t.groupSimilarEntries,"groupSimilarEntriesDisabled")})),c.Wb(),c.Xb(74,"label",40),c.Yc(75," Group similar time entries "),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(76,"hr",24),c.Xb(77,"div",13),c.Xb(78,"div",14),c.Xb(79,"div",16),c.Yc(80,"Compact project list"),c.Wb(),c.Xb(81,"div",17),c.Yc(82," Make project selection easier when you have hundreds of projects by collapsing the list."),c.Wb(),c.Wb(),c.Xb(83,"div",25),c.Xb(84,"compact-project",41),c.jc("onChange",(function(){return t.updateSettingsDebounce()})),c.Wb(),c.Wb(),c.Wb(),c.Sb(85,"hr",24),c.Xb(86,"div",13),c.Xb(87,"div",14),c.Xb(88,"div",16),c.Yc(89,"Task filter"),c.Wb(),c.Xb(90,"div",17),c.Yc(91," Quickly find the right task in project picker by using the task@project syntax. "),c.Wb(),c.Wb(),c.Xb(92,"div",42),c.Xb(93,"div",38),c.Xb(94,"input",43),c.jc("change",(function(){return t.updateSettingsDebounce()}))("ngModelChange",(function(e){return t.user.settings.projectPickerSpecialFilter=e})),c.Wb(),c.Xb(95,"label",44),c.Yc(96," Activate task filter "),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(97,"hr",24),c.Xb(98,"div",13),c.Xb(99,"div",14),c.Xb(100,"div",16),c.Yc(101,"Email notifications"),c.Wb(),c.Xb(102,"div",17),c.Yc(103,"Receive updates about your time and new features via email."),c.Wb(),c.Wb(),c.Xb(104,"div",14),c.Xb(105,"div",45),c.Xb(106,"input",46),c.jc("ngModelChange",(function(e){return t.user.settings.sendNewsletter=e}))("keyup.enter",(function(){return t.toggleProperty("sendNewsletter")}))("ngModelChange",(function(){return t.updateSettingsDebounce()})),c.Wb(),c.Xb(107,"label",47),c.Yc(108," Clockify can send me newsletters over e-mail"),c.Wb(),c.Wb(),c.Xb(109,"div",45),c.Xb(110,"input",48),c.jc("ngModelChange",(function(e){return t.user.settings.weeklyUpdates=e}))("keyup.enter",(function(){return t.toggleProperty("weeklyUpdates")}))("ngModelChange",(function(){return t.updateSettingsDebounce()})),c.Wb(),c.Xb(111,"label",49),c.Yc(112," Send weekly time entry updates "),c.Wb(),c.Wb(),c.Xb(113,"div",45),c.Xb(114,"input",50),c.jc("ngModelChange",(function(e){return t.user.settings.longRunning=e}))("keyup.enter",(function(){return t.toggleProperty("longRunning")}))("ngModelChange",(function(){return t.updateSettingsDebounce()})),c.Wb(),c.Xb(115,"label",51),c.Yc(116," Email me about long-running (over 8 hours) timers"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(117,tf,6,1,"div",52),c.Sb(118,"hr",24),c.Xb(119,"div",13),c.Xb(120,"div",14),c.Xb(121,"div",16),c.Yc(122,"Time settings"),c.Wb(),c.Xb(123,"div",17),c.Yc(124," Change time zone, when your week starts, and your preferred data and time format. "),c.Wb(),c.Wb(),c.Xb(125,"div",25),c.Xb(126,"div",13),c.Xb(127,"div",26),c.Xb(128,"dropdown-items",53,54),c.jc("onChanged",(function(i){c.Oc(e);const n=c.Lc(9);return t.onTimeZoneChange(n,i)})),c.Wb(),c.Wb(),c.Wb(),c.Xb(130,"div",13),c.Xb(131,"div",26),c.Xb(132,"dropdown-items",55),c.jc("onChanged",(function(e){return t.setSettingsProperty(e,"dateFormat")})),c.Wb(),c.Wb(),c.Xb(133,"div",26),c.Xb(134,"dropdown-items",55),c.jc("onChanged",(function(e){return t.setSettingsProperty(e,"timeFormat")})),c.Wb(),c.Wb(),c.Wb(),c.Xb(135,"div",13),c.Xb(136,"div",26),c.Xb(137,"dropdown-items",55,56),c.jc("onChanged",(function(i){c.Oc(e);const n=c.Lc(9);return t.checkApprovalSubmittedStatus(n,i,"weekStart")})),c.Wb(),c.Wb(),c.Xb(139,"div",26),c.Xb(140,"label"),c.Yc(141,"Day start"),c.Wb(),c.Xb(142,"div",57),c.Xb(143,"input-hours",58),c.jc("onTimeChanged",(function(e){return t.timeChanged(e)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(144,"hr",24),c.Xb(145,"div",13),c.Xb(146,"div",14),c.Xb(147,"div",16),c.Yc(148,"API"),c.Wb(),c.Xb(149,"div",17),c.Yc(150,"Connect Clockify to other apps using your personal API key."),c.Wb(),c.Wb(),c.Xb(151,"div",59),c.Xb(152,"div",13),c.Xb(153,"div",14),c.Xb(154,"label"),c.Yc(155,"API key"),c.Wb(),c.Xb(156,"div",29),c.Xb(157,"input",60,61),c.jc("click",(function(){return c.Oc(e),c.Lc(158).select()})),c.Wb(),c.Xb(159,"div",31),c.Xb(160,"span",62),c.Xb(161,"a",63,64),c.jc("click",(function(){c.Oc(e);const i=c.Lc(162),n=c.Lc(7);return i.blur(),t.generateApiKey(n)}))("keyup.enter",(function(){c.Oc(e);const i=c.Lc(162),n=c.Lc(7);return i.blur(),t.generateApiKey(n)})),c.Yc(163,"Generate"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(164,"hr",24),c.Xb(165,"div",13),c.Xb(166,"div",14),c.Xb(167,"div",16),c.Yc(168,"Webhooks"),c.Wb(),c.Xb(169,"div",17),c.Yc(170," Create triggers so Clockify can let you know when something happens in your workspace. "),c.Wb(),c.Wb(),c.Xb(171,"div",59),c.Xb(172,"div",13),c.Xb(173,"div",14),c.Xb(174,"a",65),c.Yc(175,"Manage webhooks"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.Lc(63);c.Cb(28),c.wc("classSize","cl-no-image-wrapper-lg")("src",t.user.profilePicture)("name",t.usernameBackup),c.Cb(4),c.wc("ngIf",t.hasCustomProfileImage),c.Cb(13),c.wc("ngModel",t.user.name),c.Cb(6),c.wc("ngModel",null==t.user?null:t.user.email),c.Cb(2),c.wc("ngIf",!t.canChangePassword),c.Cb(1),c.wc("ngIf",t.canChangePassword),c.Cb(7),c.wc("ngIf",t.canChangePassword)("ngIfElse",e),c.Cb(12),c.wc("ngModel",t.groupSimilarEntries),c.Cb(11),c.wc("settings",t.user.settings),c.Cb(10),c.wc("ngModel",t.user.settings.projectPickerSpecialFilter),c.Cb(12),c.wc("ngModel",t.user.settings.sendNewsletter),c.Cb(4),c.wc("ngModel",t.user.settings.weeklyUpdates),c.Cb(4),c.wc("ngModel",t.user.settings.longRunning),c.Cb(3),c.wc("ngIf",null==t.targets?null:t.targets.length),c.Cb(11),c.wc("enableSearch",!0)("list",t.timezones)("placeholder","Search time zone...")("value",t.user.settings.timeZone)("title","Time zone"),c.Cb(4),c.wc("list",t.dateFormat)("value",t.user.settings.dateFormat)("title","Date format"),c.Cb(2),c.wc("list",t.timeFormat)("value",t.user.settings.timeFormat)("title","Time format"),c.Cb(3),c.wc("list",t.dayOfWeek)("value",t.user.settings.weekStart)("title","Week start"),c.Cb(6),c.wc("emitFormat","HH:mm")("timeFormat",null==t.user||null==t.user.settings?null:t.user.settings.timeFormat)("hours",null==t.user||null==t.user.settings?null:t.user.settings.myStartOfDay),c.Cb(14),c.wc("ngModel",t.apiKey),c.Cb(17),c.wc("routerLink",c.Ac(36,nf))}},directives:[Ds.a,br,s.u,p.c,p.s,p.v,p.a,kg,pn.a,Ig,W.f,wl.a,jg,zl,Mg,Yg,yl.a,s.t,g.Z],pipes:[$i.a,Lg.a],encapsulation:2,changeDetection:0}),e})(),cf=(()=>{class e{constructor(e){this.workspaceService=e}canActivate(){if(this.workspaceService.getLocalDefaultWorkspace())return!0;const e=this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>null!==e)),t=this.workspaceService.defaultWorkspaceError;return this.workspaceService.getDefaultWorkspace(),e.pipe(iu(t),Object(It.a)(e=>null!==e),Object(Yt.a)(1),Object(Y.a)(e=>!!e))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(U.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),rf=(()=>{class e{constructor(e){this.authService=e}resolve(){let e;const t=this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(Yt.a)(1));let i;return t.subscribe(()=>e=!0),i=e?t:this.authService.getPermissionsForUser(),i.pipe(Object(Yt.a)(1),Object(Y.a)(e=>!!e))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(Ce.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),of=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(){if(this.workspaceService.getLocalDefaultWorkspace().canSeeTimeSheet)return!0;this.router.navigate(["tracker"])}}return e.\u0275fac=function(t){return new(t||e)(c.fc(U.a),c.fc(W.c))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})(),af=(()=>{class e{constructor(e,t){this.authService=e,this.router=t}canActivate(e,t){const{id:i,token:n,refreshToken:s,workspaceId:c}=e.queryParams;return!(i&&n&&s)||(this.authService.saveTokenToLocalStorage(n,s),this.authService.getUserById(i).pipe(Object(Y.a)(i=>{let n;if(i.defaultWorkspaceId===c){const i=e.fragment;n={url:(t.url||"").split("?")[0],fragment:i}}return this.authService.redirectAfterLogin(n),!0},()=>!0)))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(Ce.a),c.fc(W.c))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var lf=i("dU7q"),bf=i("IlrW");function uf(e,t){1&e&&(c.Xb(0,"div",18),c.Yc(1,"Invoice information"),c.Wb())}function df(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",13),c.Xb(1,"input",19),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().editInvoiceInformation.vatNumber=t})),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.wc("placeholder",null!=e.tax?e.tax.placeholder:"")("ngModel",e.editInvoiceInformation.vatNumber)}}function pf(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",4),c.Xb(1,"div",5),c.Xb(2,"a",20),c.jc("click",(function(){return c.Oc(e),c.nc().addAddress()})),c.Yc(3,"Add address "),c.Wb(),c.Xb(4,"label"),c.Xb(5,"span",7),c.Yc(6," (optional)"),c.Wb(),c.Wb(),c.Wb(),c.Wb()}}function hf(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div"),c.Xb(1,"div",4),c.Xb(2,"div",5),c.Xb(3,"label"),c.Yc(4,"Address"),c.Wb(),c.Wb(),c.Wb(),c.Xb(5,"div",4),c.Xb(6,"div",5),c.Xb(7,"label"),c.Yc(8,"Country "),c.Xb(9,"span",7),c.Yc(10,"(required)"),c.Wb(),c.Wb(),c.Xb(11,"input",21),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().editInvoiceInformation.country=t})),c.Wb(),c.Wb(),c.Wb(),c.Xb(12,"div",4),c.Xb(13,"div",5),c.Xb(14,"label"),c.Yc(15,"Address 1 "),c.Xb(16,"span",7),c.Yc(17,"(required)"),c.Wb(),c.Wb(),c.Xb(18,"input",22),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().editInvoiceInformation.address1=t})),c.Wb(),c.Wb(),c.Wb(),c.Xb(19,"div",4),c.Xb(20,"div",5),c.Xb(21,"label"),c.Yc(22,"Address 2 "),c.Xb(23,"span",7),c.Yc(24,"(optional)"),c.Wb(),c.Wb(),c.Xb(25,"input",23),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().editInvoiceInformation.address2=t})),c.Wb(),c.Wb(),c.Wb(),c.Xb(26,"div",4),c.Xb(27,"div",5),c.Xb(28,"label"),c.Yc(29,"City "),c.Xb(30,"span",7),c.Yc(31,"(required)"),c.Wb(),c.Wb(),c.Xb(32,"input",24),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().editInvoiceInformation.city=t})),c.Wb(),c.Wb(),c.Wb(),c.Xb(33,"div",4),c.Xb(34,"div",5),c.Xb(35,"label"),c.Yc(36,"State "),c.Xb(37,"span",7),c.Yc(38,"(required)"),c.Wb(),c.Wb(),c.Xb(39,"input",25),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().editInvoiceInformation.state=t})),c.Wb(),c.Wb(),c.Wb(),c.Xb(40,"div",4),c.Xb(41,"div",5),c.Xb(42,"label"),c.Yc(43,"ZIP "),c.Xb(44,"span",7),c.Yc(45,"(required)"),c.Wb(),c.Wb(),c.Xb(46,"input",26),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().editInvoiceInformation.zip=t})),c.Wb(),c.Wb(),c.Wb(),c.Xb(47,"div",4),c.Xb(48,"div",5),c.Xb(49,"a",20),c.jc("click",(function(){return c.Oc(e),c.nc().removeAddress()})),c.Yc(50,"Remove address"),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(11),c.wc("ngModel",e.editInvoiceInformation.country),c.Cb(7),c.wc("ngModel",e.editInvoiceInformation.address1),c.Cb(7),c.wc("ngModel",e.editInvoiceInformation.address2),c.Cb(7),c.wc("ngModel",e.editInvoiceInformation.city),c.Cb(7),c.wc("ngModel",e.editInvoiceInformation.state),c.Cb(7),c.wc("ngModel",e.editInvoiceInformation.zip)}}function mf(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",4),c.Xb(1,"div",27),c.Xb(2,"button",28),c.jc("click",(function(){return c.Oc(e),c.nc().next()})),c.Yc(3,"Next step "),c.Wb(),c.Wb(),c.Wb()}}let gf=(()=>{class e{constructor(e,t){this.formBuilder=e,this.toaster=t,this.saveInfo=new c.n,this.closeModal=new c.n,this.nextStep=new c.n,this.turnAddress=new c.n,this.mode="create",this.taxes=[new uc.a(null,"Select ID type ...",""),new uc.a("ae_trn","AE TRN United Arab Emirates","123456789012345"),new uc.a("eu_vat at","AT VAT Austria","ATU12345678"),new uc.a("au_abn","AU ABN Australia","12345678912"),new uc.a("eu_vat be","BE VAT Belgium","BE0123456789"),new uc.a("eu_vat bg","BG VAT Bulgaria","BG0123456789"),new uc.a("br_cnpj","BR CNPJ Brazil","01.234.456/5432-10"),new uc.a("br_cpf","BR CPF Brazil","123.456.789-87"),new uc.a("ca_bn","CA BN Canada","123456789"),new uc.a("ca_qst","CA QST Canada","1234567890TQ1234"),new uc.a("ch_vat","CH VAT Switzerland","CHE-123.456.789 MWST"),new uc.a("cl_tin","CL TIN Chile","12.345.678-K"),new uc.a("eu_vat cy","CY VAT Cyprus","CY12345678Z"),new uc.a("eu_vat cz","CZ VAT Czech Republic","CZ1234567890"),new uc.a("eu_vat de","DE VAT Germany","DE123456789"),new uc.a("eu_vat dk","DK VAT Denmark","DK12345678"),new uc.a("eu_vat ee","EE VAT Estonia","EE123456789"),new uc.a("es_cif","ES CIF Spain","A12345678"),new uc.a("eu_vat es","ES VAT Spain","ESA1234567Z"),new uc.a("eu_vat fi","FI VAT Finland","FI12345678"),new uc.a("eu_vat fr","FR VAT France","FRAB123456789"),new uc.a("eu_vat gb","GB VAT United Kingdom","GB123456789"),new uc.a("eu_vat el","GR VAT Greece","EL123456789"),new uc.a("hk_br","HK BR Hong Kong","12345678"),new uc.a("eu_vat hr","HR VAT Croatia","HR12345678912"),new uc.a("eu_vat hu","HU VAT Hungary","HU12345678"),new uc.a("id_npwp","ID NPWP Indonesia","12.345.678.9-012.345"),new uc.a("eu_vat ie","IE VAT Ireland","IE1234567AB"),new uc.a("in_gst","IN GST India","12ABCDE3456FGZH"),new uc.a("eu_vat it","IT VAT Italy","IT12345678912"),new uc.a("jp_cn","JP CN Japan","1234567891234"),new uc.a("kr_brn","KR BRN South Korea","123-45-67890"),new uc.a("li_uid","LI UID Liechtenstein","CHE123456789"),new uc.a("eu_vat lt","LT VAT Lithuania","LT123456789123"),new uc.a("eu_vat lu","LU VAT Luxembourg","LU12345678"),new uc.a("eu_vat lv","LV VAT Latvia","LV12345678912"),new uc.a("eu_vat mt","MT VAT Malta","MT12345678"),new uc.a("mx_rfc","MX RFC Mexico","ABC010203AB9"),new uc.a("my_frp","MY FRP Malaysia","12345678"),new uc.a("my_itn","MY ITN Malaysia","C 1234567890"),new uc.a("my_sst","MY SST Malaysia","A12-3456-78912345"),new uc.a("eu_vat nl","NL VAT Netherlands","NL123456789B12"),new uc.a("no_vat","NO VAT Norway","123456789MVA"),new uc.a("nz_gst","NZ GST New Zealand","123456789"),new uc.a("eu_vat pl","PL VAT Poland","PL1234567890"),new uc.a("eu_vat pt","PT VAT Portugal","PT123456789"),new uc.a("eu_vat ro","RO VAT Romania","RO1234567891"),new uc.a("ru_inn","RU INN Russia","1234567891"),new uc.a("sa_vat","SA VAT Saudi Arabia","123456789012345"),new uc.a("eu_vat se","SE VAT Sweden","SE123456789123"),new uc.a("sg_gst","SG GST Singapore","M12345678X"),new uc.a("sg_uen","SG UEN Singapore","123456789F"),new uc.a("eu_vat si","SI VAT Slovenia","SI12345678"),new uc.a("eu_vat sk","SK VAT Slovakia","SK1234567891"),new uc.a("th_vat","TH VAT Thailand","1234567891234"),new uc.a("tw_vat","TW VAT Taiwan","12345678"),new uc.a("us_ein","US EIN United States","12-3456789"),new uc.a("za_vat","ZA VAT South Africa","4123456789")]}ngOnInit(){this.editInvoiceInformation.vatType||(this.editInvoiceInformation.vatType=null),this.editInvoiceInformation.vatType&&"eu_vat"===this.editInvoiceInformation.vatType&&(this.editInvoiceInformation.vatType=this.editInvoiceInformation.vatType+" "+this.editInvoiceInformation.vatNumber.substring(0,2).toLowerCase()),this.tax=this.editInvoiceInformation.vatType?this.taxes.filter(e=>e.value===this.editInvoiceInformation.vatType)[0]:null,this.informationGroup=this.formBuilder.group({email:["",[p.G.required,p.G.email]]}),this.editInvoiceInformation||(this.editInvoiceInformation=new lf.a),this.editInvoiceInformation.companyName=this.editInvoiceInformation.companyName||this.workspaceName,this.editInvoiceInformation.address1&&(this.address=!0,this.turnAddress.emit(this.address))}get email(){return this.informationGroup.get("email")}save(){this.saveInfo.emit(!0)}close(){this.closeModal.emit()}next(){this.editInvoiceInformation.isCompanyNameEmpty()?this.toaster.pop("error","Company name is mandatory"):this.editInvoiceInformation.isAddressEmpty(this.address)?this.toaster.pop("error","All address fields are mandatory"):this.editInvoiceInformation.isVatEmpty()?this.toaster.pop("error","Missing Tax ID information"):this.nextStep.emit(!0)}checkEmail(){this.mailBad=!Object(Pt.A)(this.editInvoiceInformation.email)}removeAddress(){this.address=!1,this.editInvoiceInformation.address1=null,this.editInvoiceInformation.address2=null,this.editInvoiceInformation.city=null,this.editInvoiceInformation.country=null,this.editInvoiceInformation.state=null,this.editInvoiceInformation.zip=null,this.turnAddress.emit(this.address)}addAddress(){this.address=!0,this.turnAddress.emit(this.address)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(p.f),c.Rb(M.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["stripe-invoice"]],inputs:{mode:"mode",workspaceName:"workspaceName",editInvoiceInformation:"editInvoiceInformation"},outputs:{saveInfo:"saveInfo",closeModal:"closeModal",nextStep:"nextStep",turnAddress:"turnAddress"},decls:32,vars:9,consts:[[1,"cl-tab-pane","cl-active"],[1,"cl-py-2"],["class","cl-h1 cl-mb-3",4,"ngIf"],["autocomplete","off"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-lg-custom-12"],[1,"cl-mb-1"],[1,"cl-text-gray-9"],["type","text","placeholder","","name","si_companyName","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","name","si_email","autocomplete","off","placeholder","If you don't enter a valid email, we will use yours",1,"cl-form-control",3,"ngModel","blur","ngModelChange"],[1,"cl-form-group","cl-mb-0","cl-col-md-12"],[1,"cl-m-0","cl-mb-1"],[1,"cl-form-row","cl-align-items-center"],[1,"cl-form-group","cl-col-md-6"],[3,"list","value","onChangedDropdown","onChanged"],["class","cl-form-group cl-col-md-6",4,"ngIf"],["class","cl-form-row",4,"ngIf"],[4,"ngIf"],[1,"cl-h1","cl-mb-3"],["type","text","placeholder","","name","si_vat","autocomplete","off",1,"cl-form-control",3,"placeholder","ngModel","ngModelChange"],[3,"click"],["type","text","placeholder","","name","si_country","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","si_address1","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","si_address2","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","si_city","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","si_state","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","si_zip","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],[1,"cl-form-group","cl-mb-0","cl-col-lg-custom-12"],["type","submit",1,"cl-btn","cl-btn-block","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Wc(2,uf,2,0,"div",2),c.Xb(3,"form",3),c.Xb(4,"div",4),c.Xb(5,"div",5),c.Xb(6,"label",6),c.Yc(7,"Company name "),c.Xb(8,"span",7),c.Yc(9,"(required)"),c.Wb(),c.Wb(),c.Xb(10,"input",8),c.jc("ngModelChange",(function(e){return t.editInvoiceInformation.companyName=e})),c.Wb(),c.Wb(),c.Wb(),c.Xb(11,"div",4),c.Xb(12,"div",5),c.Xb(13,"label",6),c.Yc(14,"Send emails to "),c.Xb(15,"span",7),c.Yc(16,"(optional)"),c.Wb(),c.Wb(),c.Xb(17,"input",9),c.jc("blur",(function(){return t.checkEmail()}))("ngModelChange",(function(e){return t.editInvoiceInformation.email=e})),c.Wb(),c.Wb(),c.Wb(),c.Xb(18,"div",4),c.Xb(19,"div",10),c.Xb(20,"label",11),c.Yc(21,"Tax ID "),c.Xb(22,"span",7),c.Yc(23,"(optional)"),c.Wb(),c.Wb(),c.Xb(24,"div",12),c.Xb(25,"div",13),c.Xb(26,"dropdown-items",14),c.jc("onChangedDropdown",(function(e){return t.tax=e}))("onChanged",(function(e){return t.editInvoiceInformation.vatType=e,t.editInvoiceInformation.vatNumber=null})),c.Wb(),c.Wb(),c.Wc(27,df,2,2,"div",15),c.Wb(),c.Wb(),c.Wb(),c.Sb(28,"hr"),c.Wc(29,pf,7,0,"div",16),c.Wc(30,hf,51,6,"div",17),c.Wc(31,mf,4,0,"div",16),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(2),c.wc("ngIf","create"===t.mode),c.Cb(8),c.wc("ngModel",t.editInvoiceInformation.companyName),c.Cb(7),c.wc("ngModel",t.editInvoiceInformation.email),c.Cb(9),c.wc("list",t.taxes)("value",t.editInvoiceInformation.vatType),c.Cb(1),c.wc("ngIf",null==t.tax?null:t.tax.value),c.Cb(2),c.wc("ngIf",!t.address),c.Cb(1),c.wc("ngIf",t.address),c.Cb(1),c.wc("ngIf","create"===t.mode))},directives:[s.u,p.I,p.t,p.u,p.c,p.s,p.v,pn.a],encapsulation:2}),e})();var ff=i("F2Zd");function vf(e,t){1&e&&(c.Xb(0,"div",30),c.Yc(1,"Payment information"),c.Wb())}function wf(e,t){if(1&e&&(c.Xb(0,"div",31),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.Zc(e.failMessage)}}function yf(e,t){1&e&&(c.Xb(0,"div",33),c.Yc(1," Once you add payment information, you'll be charged for all your open invoices. "),c.Wb())}function Wf(e,t){if(1&e&&(c.Xb(0,"div"),c.Wc(1,yf,2,0,"div",32),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf","edit"===e.mode)}}function Cf(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",4),c.Xb(1,"div",5),c.Xb(2,"button",34),c.jc("click",(function(){return c.Oc(e),c.nc().createToken()})),c.Yc(3),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.wc("disabled",e.disableButton||!e.agreement),c.Cb(1),c.ad(" ",e.isPaymentInfo?"Save payment info":"Finish payment"," ")}}function kf(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",4),c.Xb(1,"div",35),c.Xb(2,"a",36),c.jc("click",(function(){return c.Oc(e),c.nc().close()})),c.Yc(3,"Cancel"),c.Wb(),c.Wb(),c.Wb()}}function Sf(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",37),c.Xb(1,"a",36),c.jc("click",(function(){return c.Oc(e),c.nc().close()})),c.Yc(2,"Cancel"),c.Wb(),c.Xb(3,"button",38),c.jc("click",(function(){return c.Oc(e),c.nc().createToken()})),c.Yc(4,"Save "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.wc("disabled",e.disableButton||!e.agreement)}}const If=function(){return{standalone:!0}};let Of=(()=>{class e{constructor(e,t,i,n,s){this.fb=e,this.stripeService=t,this.paymentService=i,this.loader=n,this.toaster=s,this.agreement=!1,this.mode="create",this.style={base:{iconColor:"#666EE8",color:ff.g[Object(ff.b)()].stripeTextColor,lineHeight:"40px",fontWeight:"300",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSize:"16px","::placeholder":{color:ff.g[Object(ff.b)()].placeholderInput}}},this.cardOptions={style:this.style},this.elementsOptions={locale:"auto"},this.closeDialog=new c.n,this.showSuccessDialog=new c.n,this.paid=new c.n,this.paymentInformation=new c.n,this.stripeService.changeKey(tr.a.environment.stripePublicKey)}ngOnInit(){this.editPaymentInformation?(this.editPaymentInformation.cardHolder=this.editPaymentInformation.cardHolder||this.invoiceInformation&&this.invoiceInformation.companyName,this.editPaymentInformation.street=this.editPaymentInformation.street||this.invoiceInformation&&this.invoiceInformation.address1,this.editPaymentInformation.zip=this.editPaymentInformation.zip||this.invoiceInformation&&this.invoiceInformation.zip,this.editPaymentInformation.state=this.editPaymentInformation.state||this.invoiceInformation&&this.invoiceInformation.state,this.editPaymentInformation.country=this.editPaymentInformation.country||this.invoiceInformation&&this.invoiceInformation.country,this.editPaymentInformation.city=this.editPaymentInformation.city||this.invoiceInformation&&this.invoiceInformation.city):this.editPaymentInformation=new bf.a,this.stripeService.elements(this.elementsOptions).subscribe(e=>{this.elements=e,this.cardNumber||(this.cardNumber=this.elements.create("cardNumber",{showIcon:!0,style:this.style}),this.cardNumber.mount("#card-number")),this.cardExpiry||(this.cardExpiry=this.elements.create("cardExpiry",this.cardOptions),this.cardExpiry.mount("#card-expiry")),this.cardCvc||(this.cardCvc=this.elements.create("cardCvc",this.cardOptions),this.cardCvc.mount("#card-cvc"))})}set paymentFailedMessage(e){this.failMessage=e,this.failMessage&&(this.disableButton=!1)}createToken(){this.isSomeEmpty()?(this.disableButton=!1,this.toaster.pop("error","All fields are mandatory")):(this.loader.show(),this.disableButton=!0,this.paymentService.createClientSecretOfSetupIntent(this.invoiceInformation).subscribe(e=>{this.stripeService.createToken(this.cardNumber,{name:this.editPaymentInformation.cardHolder,address_line1:this.editPaymentInformation.street,address_city:this.editPaymentInformation.city,address_state:this.editPaymentInformation.state,address_zip:this.editPaymentInformation.zip,address_country:this.editPaymentInformation.country}).subscribe(t=>{t.error?(this.disableButton=!1,this.loader.hide(),this.toaster.pop("error",t.error.message)):this.stripeService.confirmCardSetup(e.clientSecret,{payment_method:{card:{token:t.token.id},billing_details:{name:this.editPaymentInformation.cardHolder}}}).subscribe(e=>{e.error?(this.loader.hide(),this.toaster.pop("error",e.error.message)):(this.loader.hide(),this.paymentInformation.emit({id:t.token.id,cardExpMonth:t.token.card.exp_month,cardExpYear:t.token.card.exp_year,last4:t.token.card.last4,cardHolder:this.editPaymentInformation.cardHolder,street:this.editPaymentInformation.street,zip:this.editPaymentInformation.zip,country:this.editPaymentInformation.country,state:this.editPaymentInformation.state,city:this.editPaymentInformation.city}))})})},e=>{this.loader.hide(),this.toaster.pop("error",e.error.message)}))}isSomeEmpty(){return null==this.editPaymentInformation.cardHolder||null==this.editPaymentInformation.street||null==this.editPaymentInformation.zip||null==this.editPaymentInformation.country||null==this.editPaymentInformation.state||null==this.editPaymentInformation.city||""==this.editPaymentInformation.cardHolder.trim()||""==this.editPaymentInformation.street.trim()||""==this.editPaymentInformation.zip.trim()||""==this.editPaymentInformation.country.trim()||""==this.editPaymentInformation.state.trim()||""==this.editPaymentInformation.city.trim()}close(){this.closeDialog.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(p.f),c.Rb(Ue.c),c.Rb(Cu.a),c.Rb(wi.a),c.Rb(M.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["stripe"]],viewQuery:function(e,t){var i;1&e&&c.ed(Ue.b,!0),2&e&&c.Kc(i=c.kc())&&(t.card=i.first)},inputs:{editPaymentInformation:"editPaymentInformation",isMonthly:"isMonthly",invoiceInformation:"invoiceInformation",mode:"mode",isPaymentInfo:"isPaymentInfo",disableButton:"disableButton",paymentFailedMessage:"paymentFailedMessage"},outputs:{closeDialog:"closeDialog",showSuccessDialog:"showSuccessDialog",paid:"paid",paymentInformation:"paymentInformation"},decls:85,vars:17,consts:[[1,"cl-tab-pane","cl-active"],[1,"cl-py-2"],["class","cl-h1 cl-mb-3",4,"ngIf"],["autocomplete","off"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-lg-custom-12"],["for","card-number"],[1,"cl-text-gray-9"],["id","card-number",1,"field"],["stripeCard",""],["class","cl-invalid-feedback cl-block",4,"ngIf"],[1,"cl-form-group","cl-col-lg-custom-6"],["id","card-expiry",1,"stripe__expiration","field"],["id","card-cvc",1,"stripe__cvc","field"],["type","text","placeholder","","name","s_cardHolder","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","s_street","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","s_city","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","s_zip","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","s_state","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","s_country","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],[4,"ngIf"],[1,"cl-form-group","cl-col-lg-custom-12","cl-mt-1","cl-mb-3"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox","id","agreementCheckbox",1,"cl-custom-control-input",3,"ngModel","ngModelOptions","ngModelChange"],["for","agreementCheckbox",1,"cl-custom-control-label"],[1,"cl-font-weight-bold"],["href","https://clockify.me/terms","target","_blank","tabindex","0",1,"cl-color-blue"],[1,"cl-color-grey","cl-d-block"],["class","cl-form-row",4,"ngIf"],["class","cl-modal-footer",4,"ngIf"],[1,"cl-h1","cl-mb-3"],[1,"cl-invalid-feedback","cl-block"],["class","cl-alert cl-alert-primary cl-d-block",4,"ngIf"],[1,"cl-alert","cl-alert-primary","cl-d-block"],["type","submit",1,"cl-btn","cl-btn-block","cl-btn-primary",3,"disabled","click"],[1,"cl-form-group","cl-mb-0","cl-col-lg-custom-12","cl-text-center"],[1,"cl-color-blue",3,"click"],[1,"cl-modal-footer"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Wc(2,vf,2,0,"div",2),c.Xb(3,"form",3),c.Xb(4,"div",4),c.Xb(5,"div",5),c.Xb(6,"label",6),c.Yc(7,"Card number "),c.Xb(8,"span",7),c.Yc(9,"(required)"),c.Wb(),c.Wb(),c.Sb(10,"div",8,9),c.Wc(12,wf,2,1,"div",10),c.Wb(),c.Wb(),c.Xb(13,"div",4),c.Xb(14,"div",11),c.Xb(15,"label"),c.Yc(16,"Expiration date "),c.Xb(17,"span",7),c.Yc(18,"(required)"),c.Wb(),c.Wb(),c.Sb(19,"div",12,9),c.Wb(),c.Xb(21,"div",11),c.Xb(22,"label"),c.Yc(23,"CVC "),c.Xb(24,"span",7),c.Yc(25,"(required)"),c.Wb(),c.Wb(),c.Sb(26,"div",13,9),c.Wb(),c.Wb(),c.Xb(28,"div",4),c.Xb(29,"div",5),c.Xb(30,"label"),c.Yc(31,"Cardholder name "),c.Xb(32,"span",7),c.Yc(33,"(required)"),c.Wb(),c.Wb(),c.Xb(34,"input",14),c.jc("ngModelChange",(function(e){return t.editPaymentInformation.cardHolder=e})),c.Wb(),c.Wb(),c.Wb(),c.Xb(35,"div",4),c.Xb(36,"div",5),c.Xb(37,"label"),c.Yc(38,"Street "),c.Xb(39,"span",7),c.Yc(40,"(required)"),c.Wb(),c.Wb(),c.Xb(41,"input",15),c.jc("ngModelChange",(function(e){return t.editPaymentInformation.street=e})),c.Wb(),c.Wb(),c.Wb(),c.Xb(42,"div",4),c.Xb(43,"div",5),c.Xb(44,"label"),c.Yc(45,"City "),c.Xb(46,"span",7),c.Yc(47,"(required)"),c.Wb(),c.Wb(),c.Xb(48,"input",16),c.jc("ngModelChange",(function(e){return t.editPaymentInformation.city=e})),c.Wb(),c.Wb(),c.Wb(),c.Xb(49,"div",4),c.Xb(50,"div",5),c.Xb(51,"label"),c.Yc(52,"ZIP / Postal code "),c.Xb(53,"span",7),c.Yc(54,"(required)"),c.Wb(),c.Wb(),c.Xb(55,"input",17),c.jc("ngModelChange",(function(e){return t.editPaymentInformation.zip=e})),c.Wb(),c.Wb(),c.Wb(),c.Xb(56,"div",4),c.Xb(57,"div",5),c.Xb(58,"label"),c.Yc(59,"State / Province "),c.Xb(60,"span",7),c.Yc(61,"(required)"),c.Wb(),c.Wb(),c.Xb(62,"input",18),c.jc("ngModelChange",(function(e){return t.editPaymentInformation.state=e})),c.Wb(),c.Wb(),c.Wb(),c.Xb(63,"div",4),c.Xb(64,"div",5),c.Xb(65,"label"),c.Yc(66,"Country "),c.Xb(67,"span",7),c.Yc(68,"(required)"),c.Wb(),c.Wb(),c.Xb(69,"input",19),c.jc("ngModelChange",(function(e){return t.editPaymentInformation.country=e})),c.Wb(),c.Wb(),c.Wb(),c.Wc(70,Wf,2,1,"div",20),c.Xb(71,"div",4),c.Xb(72,"div",21),c.Xb(73,"div",22),c.Xb(74,"input",23),c.jc("ngModelChange",(function(e){return t.agreement=e})),c.Wb(),c.Xb(75,"label",24),c.Xb(76,"span",25),c.Yc(77,"I have read and agree to the "),c.Xb(78,"a",26),c.Yc(79,"Terms of Use"),c.Wb(),c.Wb(),c.Xb(80,"span",27),c.Yc(81,"There are no refunds. Your subscription will renew automatically, and you will be charged in advance. You may cancel at any time. The cancellation goes into effect at the start of your following billing cycle."),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(82,Cf,4,2,"div",28),c.Wc(83,kf,4,0,"div",28),c.Wb(),c.Wb(),c.Wb(),c.Wc(84,Sf,5,1,"div",29)),2&e&&(c.Cb(2),c.wc("ngIf","create"===t.mode),c.Cb(8),c.Hb("cl-is-invalid",t.failMessage),c.Cb(2),c.wc("ngIf",t.failMessage),c.Cb(22),c.wc("ngModel",t.editPaymentInformation.cardHolder),c.Cb(7),c.wc("ngModel",t.editPaymentInformation.street),c.Cb(7),c.wc("ngModel",t.editPaymentInformation.city),c.Cb(7),c.wc("ngModel",t.editPaymentInformation.zip),c.Cb(7),c.wc("ngModel",t.editPaymentInformation.state),c.Cb(7),c.wc("ngModel",t.editPaymentInformation.country),c.Cb(1),c.wc("ngIf",!t.isPaymentInfo),c.Cb(4),c.wc("ngModel",t.agreement)("ngModelOptions",c.Ac(16,If)),c.Cb(8),c.wc("ngIf","create"===t.mode),c.Cb(1),c.wc("ngIf","create"===t.mode),c.Cb(1),c.wc("ngIf","edit"===t.mode))},directives:[s.u,p.I,p.t,p.u,p.c,p.s,p.v,p.a],encapsulation:2}),e})();const Xf=["featuresInfoModal"],Ef=["successModal"];function Tf(e,t){1&e&&c.Yc(0," You can't buy fewer seats than there are active users. ")}function Df(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",46),c.Xb(1,"div",47),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Yc(4,"-"),c.Xb(5,"span"),c.Yc(6),c.Wb(),c.Wb(),c.Xb(7,"div",48),c.Xb(8,"span"),c.Yc(9,"User seats"),c.Wb(),c.Xb(10,"a",49),c.jc("click",(function(){return c.Oc(e),c.nc(2).openFeaturesInfo("user-seats")})),c.Sb(11,"img",50),c.Wb(),c.Xb(12,"div",51),c.Xb(13,"input",52),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc(2).numberOfSeats=t})),c.Wb(),c.Xb(14,"div",53),c.Wc(15,Tf,1,0,"ng-template",null,54,c.Xc),c.Xb(17,"span",55),c.jc("click",(function(){return c.Oc(e),c.nc(2).addSeat()})),c.Wb(),c.Xb(18,"span",56,57),c.jc("click",(function(){c.Oc(e);const t=c.Lc(19);return c.nc(2).removeSeat(t)})),c.Wb(),c.Wb(),c.Wb(),c.Xb(20,"span",58),c.Yc(21),c.Wb(),c.Xb(22,"div",59),c.Yc(23),c.oc(24,"number"),c.Wb(),c.Wb(),c.Sb(25,"hr"),c.Xb(26,"div",60),c.Xb(27,"span",61),c.Yc(28,"Total price"),c.Wb(),c.Xb(29,"div",61),c.Xb(30,"span"),c.Yc(31,"$"),c.Wb(),c.Yc(32),c.oc(33,"number"),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.Lc(16),t=c.nc(2);c.Cb(3),c.Zc(t.moment2().format("MMM DD").toUpperCase()),c.Cb(3),c.ad(" ",t.isMonthly?t.moment2().add(1,"months").format("MMM DD, YYYY").toUpperCase():t.moment2().add(1,"year").format("MMM DD, YYYY").toUpperCase()," "),c.Cb(7),c.xc("min",t.activeMembers),c.wc("ngModel",t.numberOfSeats),c.Cb(5),c.Hb("cl-arrow-disabled",t.numberOfSeats===t.activeMembers),c.wc("ngbPopover",e),c.Cb(3),c.ad("x $",t.isMonthly?t.paymentPlan.fullPrice:12*t.paymentPlan.fullPrice,""),c.Cb(2),c.ad("$",c.qc(24,10,t.seatsPrice,"1.2-2"),""),c.Cb(9),c.Zc(c.qc(33,13,t.seatsPrice,"1.2-2"))}}function Rf(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",49),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(2).openFeaturesInfo(t.type)})),c.Sb(1,"img",50),c.Wb()}}function Af(e,t){if(1&e&&(c.Xb(0,"li"),c.mc(),c.Xb(1,"svg",62),c.Sb(2,"path",63),c.Wb(),c.lc(),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wc(5,Rf,2,0,"a",64),c.Wb()),2&e){const e=t.$implicit;c.Cb(4),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function jf(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",66),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(3).openFeaturesInfo(t.type)})),c.Sb(1,"img",67),c.Wb()}}function xf(e,t){if(1&e&&(c.Xb(0,"li"),c.mc(),c.Xb(1,"svg",62),c.Sb(2,"path",63),c.Wb(),c.lc(),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wc(5,jf,2,0,"a",65),c.Wb()),2&e){const e=t.$implicit;c.Cb(4),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function Pf(e,t){if(1&e&&(c.Vb(0),c.Wc(1,xf,6,2,"li",28),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngForOf",e.STANDARD_2021_FEATURE_TYPES)}}function Mf(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",66),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(3).openFeaturesInfo(t.type)})),c.Sb(1,"img",67),c.Wb()}}function Yf(e,t){if(1&e&&(c.Xb(0,"li"),c.mc(),c.Xb(1,"svg",62),c.Sb(2,"path",63),c.Wb(),c.lc(),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wc(5,Mf,2,0,"a",65),c.Wb()),2&e){const e=t.$implicit;c.Cb(4),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function Lf(e,t){if(1&e&&(c.Vb(0),c.Wc(1,Yf,6,2,"li",28),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngForOf",e.PRO_2021_FEATURE_TYPES)}}function Ff(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",66),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(3).openFeaturesInfo(t.type)})),c.Sb(1,"img",67),c.Wb()}}function Nf(e,t){if(1&e&&(c.Xb(0,"li"),c.mc(),c.Xb(1,"svg",62),c.Sb(2,"path",63),c.Wb(),c.lc(),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wc(5,Ff,2,0,"a",65),c.Wb()),2&e){const e=t.$implicit;c.Cb(4),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function Uf(e,t){if(1&e&&(c.Vb(0),c.Wc(1,Nf,6,2,"li",28),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function $f(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",66),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(3).openFeaturesInfo(t.type)})),c.Sb(1,"img",67),c.Wb()}}function _f(e,t){if(1&e&&(c.Xb(0,"li"),c.Sb(1,"img",69),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Wc(4,$f,2,0,"a",65),c.Wb()),2&e){const e=t.$implicit;c.Cb(3),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function Gf(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",66),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(3).openFeaturesInfo(t.type)})),c.Sb(1,"img",67),c.Wb()}}function Bf(e,t){if(1&e&&(c.Xb(0,"li"),c.Sb(1,"img",69),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Wc(4,Gf,2,0,"a",65),c.Wb()),2&e){const e=t.$implicit;c.Cb(3),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function Vf(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",66),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(3).openFeaturesInfo(t.type)})),c.Sb(1,"img",67),c.Wb()}}function Hf(e,t){if(1&e&&(c.Xb(0,"li"),c.Sb(1,"img",69),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Wc(4,Vf,2,0,"a",65),c.Wb()),2&e){const e=t.$implicit;c.Cb(3),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function zf(e,t){if(1&e&&(c.Xb(0,"ul",27),c.Wc(1,_f,5,2,"li",28),c.Xb(2,"div",68),c.Wc(3,Bf,5,2,"li",28),c.Wb(),c.Xb(4,"div",68),c.Wc(5,Hf,5,2,"li",28),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngForOf",e.STANDARD_2021_FEATURE_TYPES),c.Cb(2),c.wc("ngForOf",e.PRO_2021_FEATURE_TYPES),c.Cb(2),c.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function qf(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",66),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(3).openFeaturesInfo(t.type)})),c.Sb(1,"img",67),c.Wb()}}function Kf(e,t){if(1&e&&(c.Xb(0,"li"),c.Sb(1,"img",69),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Wc(4,qf,2,0,"a",65),c.Wb()),2&e){const e=t.$implicit;c.Cb(3),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function Zf(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",66),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(3).openFeaturesInfo(t.type)})),c.Sb(1,"img",67),c.Wb()}}function Qf(e,t){if(1&e&&(c.Xb(0,"li"),c.Sb(1,"img",69),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Wc(4,Zf,2,0,"a",65),c.Wb()),2&e){const e=t.$implicit;c.Cb(3),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function Jf(e,t){if(1&e&&(c.Xb(0,"ul",70),c.Wc(1,Kf,5,2,"li",28),c.Xb(2,"div",68),c.Wc(3,Qf,5,2,"li",28),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngForOf",e.PRO_2021_FEATURE_TYPES),c.Cb(2),c.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function ev(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",66),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(3).openFeaturesInfo(t.type)})),c.Sb(1,"img",67),c.Wb()}}function tv(e,t){if(1&e&&(c.Xb(0,"li"),c.Sb(1,"img",69),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Wc(4,ev,2,0,"a",65),c.Wb()),2&e){const e=t.$implicit;c.Cb(3),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function iv(e,t){if(1&e&&(c.Xb(0,"ul",70),c.Wc(1,tv,5,2,"li",28),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function nv(e,t){1&e&&c.Sb(0,"img",71)}function sv(e,t){if(1&e){const e=c.Yb();c.Xb(0,"stripe-invoice",72),c.jc("turnAddress",(function(t){return c.Oc(e),c.nc(2).addressOn=t}))("nextStep",(function(){return c.Oc(e),c.nc(2).toggleInformation(!0)})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("editInvoiceInformation",e.invoiceInformation)("workspaceName",e.workspace.name)}}function cv(e,t){if(1&e){const e=c.Yb();c.Xb(0,"stripe",73),c.jc("paymentInformation",(function(t){return c.Oc(e),c.nc(2).getPaymentInformation(t)}))("closeDialog",(function(){return c.Oc(e),c.nc(2).toggleInformation(!1)})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("disableButton",e.disableButton)("invoiceInformation",e.invoiceInformation)("paymentFailedMessage",e.paymentFailedMessage)("isMonthly",e.isMonthly)}}function rv(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",3),c.Xb(1,"div",4),c.Xb(2,"div",5),c.Xb(3,"div",6),c.Xb(4,"div",7),c.Xb(5,"div",8),c.Xb(6,"div",9),c.Xb(7,"div",10),c.Xb(8,"label",11),c.jc("click",(function(){return c.Oc(e),c.nc().changeToMonthly(!0)})),c.Sb(9,"input",12),c.Yc(10,"Monthly Billing "),c.Wb(),c.Xb(11,"label",13),c.jc("click",(function(){return c.Oc(e),c.nc().changeToMonthly(!1)})),c.Sb(12,"input",12),c.Yc(13,"Annual Billing"),c.Xb(14,"span",14),c.Yc(15,"SAVE 20%"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(16,"div",15),c.Xb(17,"span",16),c.Yc(18),c.Xb(19,"span",17),c.Yc(20),c.Wb(),c.Wb(),c.Wb(),c.Xb(21,"div",18),c.Xb(22,"div",19),c.Xb(23,"div",20),c.Xb(24,"span",21),c.Yc(25,"$"),c.Wb(),c.Xb(26,"span",22),c.Yc(27),c.Wb(),c.Xb(28,"span",23),c.Yc(29),c.Wb(),c.Wb(),c.Xb(30,"div"),c.Xb(31,"div",24),c.Yc(32,"per seat/ per month"),c.Wb(),c.Wb(),c.Wb(),c.Wc(33,Df,34,16,"div",25),c.Xb(34,"div",26),c.Xb(35,"ul",27),c.Wc(36,Af,6,2,"li",28),c.Wc(37,Pf,2,1,"ng-container",29),c.Wc(38,Lf,2,1,"ng-container",29),c.Wc(39,Uf,2,1,"ng-container",29),c.Wb(),c.Sb(40,"hr"),c.Wc(41,zf,6,3,"ul",30),c.Wc(42,Jf,4,2,"ul",31),c.Wc(43,iv,2,1,"ul",31),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(44,"div",32),c.Xb(45,"div",33),c.Xb(46,"div",34),c.Xb(47,"div",35),c.Xb(48,"div",34),c.Xb(49,"div",36),c.Xb(50,"ul",37),c.Xb(51,"li",38),c.Xb(52,"a",39),c.jc("click",(function(){return c.Oc(e),c.nc().toggleInformation(!1)})),c.Xb(53,"div",40),c.Yc(54,"step 1 "),c.Wc(55,nv,1,0,"img",41),c.Wb(),c.Xb(56,"div",42),c.Yc(57,"Invoice information"),c.Wb(),c.Wb(),c.Wb(),c.Xb(58,"li",38),c.Xb(59,"a",39),c.jc("click",(function(){return c.Oc(e),c.nc().toggleInformation(!0)})),c.Xb(60,"div",40),c.Yc(61,"step 2"),c.Wb(),c.Xb(62,"div",42),c.Yc(63,"Payment information"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(64,"div",43),c.Wc(65,sv,1,2,"stripe-invoice",44),c.Wc(66,cv,1,4,"stripe",45),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(4),c.wc("ngClass","cl-parent-"+e.paymentPlan.color),c.Cb(4),c.Hb("cl-active",e.isMonthly),c.Cb(3),c.Hb("cl-active",!e.isMonthly),c.Cb(7),c.ad("",e.paymentPlan.title," Upgrade "),c.Cb(2),c.ad(" for ",e.workspace.name," workspace"),c.Cb(7),c.Zc(e.paymentPlan.price),c.Cb(2),c.Zc("."+e.paymentPlan.fullPrice.toString().split(".")[1]),c.Cb(4),c.wc("ngIf",null==e.paymentPlan?null:e.paymentPlan.bySeat),c.Cb(3),c.wc("ngForOf",e.BASIC_2021_FEATURE_TYPES),c.Cb(1),c.wc("ngIf",e.isStandard(e.paymentPlan.value)||e.isPro(e.paymentPlan.value)||e.isEnterprise(e.paymentPlan.value)),c.Cb(1),c.wc("ngIf",e.isPro(e.paymentPlan.value)||e.isEnterprise(e.paymentPlan.value)),c.Cb(1),c.wc("ngIf",e.isEnterprise(e.paymentPlan.value)),c.Cb(2),c.wc("ngIf",e.isBasic(e.paymentPlan.value)),c.Cb(1),c.wc("ngIf",e.isStandard(e.paymentPlan.value)),c.Cb(1),c.wc("ngIf",e.isPro(e.paymentPlan.value)),c.Cb(9),c.Hb("cl-active",!e.isPayment),c.Cb(3),c.wc("ngIf",e.isPayment),c.Cb(4),c.Hb("cl-active",e.isPayment),c.Cb(6),c.wc("ngIf",!e.isPayment),c.Cb(1),c.wc("ngIf",e.isPayment)}}function ov(e,t){if(1&e&&(c.Xb(0,"features-info",74),c.jc("close",(function(){return t.$implicit.close()})),c.Wb()),2&e){const e=c.nc();c.wc("type",e.featuresInfoType)}}function av(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",83),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit,i=c.nc();return t.close(),i.goToSubscription()})),c.Yc(1," Go to subscription "),c.Wb()}}function lv(e,t){if(1&e&&(c.Xb(0,"div",75),c.Xb(1,"div",76),c.Sb(2,"img",77),c.Wb(),c.Xb(3,"div",78),c.Yc(4,"Success!"),c.Wb(),c.Xb(5,"p",79),c.Yc(6),c.Wb(),c.Wb(),c.Xb(7,"div",80),c.Xb(8,"a",81),c.jc("click",(function(){return t.$implicit.close()})),c.Yc(9,"Close"),c.Wb(),c.Wc(10,av,2,0,"a",82),c.Wb()),2&e){const e=c.nc();c.Cb(6),c.ad("You can now start using all the extra features on ",e.workspace.name," workspace, without any limitation."),c.Cb(4),c.wc("ngIf",e.workspaceIsRefreshed)}}let bv=(()=>{class e{constructor(e,t,i,n,s,c,r){this.activatedRoute=e,this.router=t,this.loader=i,this.workspaceService=n,this.modalService=s,this.paymentService=c,this.toaster=r,this.unsubscribe$=new Ee.a,this.invoiceInformation=new lf.a,this.paymentInformation=new bf.a,this.isBasic=ku.e,this.isStandard=ku.m,this.isPro=ku.l,this.isEnterprise=ku.g,this.numberOfSeats=0,this.moment2=Se,this.BASIC_2021_FEATURE_TYPES=Eu,this.STANDARD_2021_FEATURE_TYPES=Du,this.PRO_2021_FEATURE_TYPES=Au,this.ENTERPRISE_2021_FEATURE_TYPES=xu}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.activatedRoute.queryParams.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{e&&Object(ku.c)(e.plan)&&Object(ku.c)(e.plan)!=ku.a.FREE?(this.paymentPlan=Object(ku.c)(e.plan),this.isMonthly=Object(ku.i)(this.paymentPlan.value),this.getActiveMembersCount()):this.router.navigate(["/upgrade"])})}toggleInformation(e){this.invoiceInformation.isCompanyNameEmpty()?this.toaster.pop("error","Company name is mandatory"):this.invoiceInformation.isAddressEmpty(this.addressOn)?this.toaster.pop("error","All address fields are mandatory"):this.invoiceInformation.isVatEmpty()?this.toaster.pop("error","Missing vat information"):(window.scrollTo(0,0),this.isPayment=e)}openFeaturesInfo(e){this.modalService.open(this.featuresInfoModal,{size:"lg",centered:!0}),this.featuresInfoType=e}goToUpgrade(){this.router.navigate(["/upgrade"])}changeToMonthly(e){let t=this.paymentPlan.label.split("_2021")[0];t=e?t.split("_YEAR")[0]:t.includes("_YEAR")?t:t.concat("_YEAR"),t=t.concat("_2021"),this.router.navigate(["upgrade",this.workspace.id],{queryParams:{plan:t}})}getPaymentInformation(e){this.paymentInformation=e,this.pay()}pay(){this.disableButton=!0,this.loader.show("Processing payment"),this.paymentFailedMessage=void 0,this.paymentService.chargeCard(this.paymentInformation,this.numberOfSeats,this.paymentPlan.value).subscribe(()=>{this.disableButton=!1,this.loader.hide(),this.modalService.open(this.successModal,{centered:!0}),this.onPaymentSuccess()},e=>{this.disableButton=!1,this.loader.hide(),this.paymentFailedMessage=e.error.message})}onPaymentSuccess(){this.loader.showBar();const e=this.workspaceService.getPaymentDate(),t=this.workspaceService.getDefaultWorkspace();Object(la.a)(e,t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.workspaceIsRefreshed=!0,this.loader.hideBar()},()=>this.loader.hideBar())}goToSubscription(){this.router.navigate(["subscription"],{fragment:"payment"})}closeSuccess(){this.router.navigate(["workspaces",this.workspace.id,"settings"],{fragment:"subscription"})}setTotalPrice(){this.numberOfSeats<-1&&(this.numberOfSeats=0),this.seatsPrice=this.numberOfSeats*this.paymentPlan.fullPrice,this.isMonthly||(this.seatsPrice=12*this.seatsPrice)}addSeat(){this.numberOfSeats++,this.setTotalPrice()}removeSeat(e){this.numberOfSeats<=this.activeMembers?e.isOpen()?e.close():e.open():(this.numberOfSeats--,this.setTotalPrice())}getActiveMembersCount(){this.workspaceService.getActiveMembersCount().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.activeMembers=e.activeMembersCount,this.numberOfSeats=this.activeMembers,this.setTotalPrice()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.a),c.Rb(W.c),c.Rb(wi.a),c.Rb(U.a),c.Rb(g.q),c.Rb(Cu.a),c.Rb(M.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["payment"]],viewQuery:function(e,t){var i;1&e&&(c.ed(Xf,!0),c.ed(Ef,!0)),2&e&&(c.Kc(i=c.kc())&&(t.featuresInfoModal=i.first),c.Kc(i=c.kc())&&(t.successModal=i.first))},decls:5,vars:1,consts:[["class","cl-page-wrapper",4,"ngIf"],["featuresInfoModal",""],["successModal",""],[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-upgrade-wrapper"],[1,"cl-row","upgrade-row"],[1,"cl-col-lg-custom-4","cl-upgrade-col","cl-mb-2","cl-mb-lg-custom-0",3,"ngClass"],[1,"cl-card","cl-h-100","cl-border-bottom"],[1,"cl-p-3","cl-pb-0"],["data-toggle","buttons",1,"cl-btn-group","cl-btn-group-toggle","cl-w-100"],[1,"cl-btn","cl-btn-outline-light","cl-d-flex","cl-align-items-center","cl-justify-content-center","cl-hover-pointer",3,"click"],["type","radio"],[1,"cl-btn","cl-btn-outline-light","cl-d-flex","cl-align-items-center","cl-justify-content-center","cl-hover-pointer","cl-active",3,"click"],[1,"cl-badge","cl-badge-success","cl-ml-2"],[1,"cl-card-header","cl-border-0","cl-bg-transparent","cl-pt-2"],[1,"cl-font-weight-normal","cl-h2","cl-mb-0","cl-text-color"],[1,"cl-text-gray-6"],[1,"cl-card-body","cl-pb-0","cl-px-3"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-start","cl-mr-2"],[1,"cl-mr-1"],[1,"cl-display-1","cl-lh-1","cl-mb-0","cl-text-gray-3"],[1,"cl-align-self-end"],[1,"cl-text-gray-6","cl-small","cl-lh-1"],["class","cl-border cl-rounded cl-p-3 cl-mt-3",4,"ngIf"],[1,"cl-d-none","cl-d-lg-custom-block","cl-mt-3"],[1,"cl-list-unstyled","cl-add-lh"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","cl-list-unstyled cl-add-lh",4,"ngIf"],["class","cl-list-unstyled cl-add-lh cl-ml-0",4,"ngIf"],[1,"cl-col-lg-custom-8","cl-upgrade-col"],[1,"cl-h-100","cl-pt-2","cl-px-3","cl-pb-3","cl-bg-white","cl-border","cl-rounded"],[1,"cl-row"],[1,"cl-col-lg-custom-6"],[1,"cl-col-lg-custom-12"],["id","myTab","role","tablist",1,"cl-nav","cl-nav-tabs","cl-custom-tabs-minimal","cl-mb-2"],[1,"cl-nav-item","cl-flex-grow-1"],[1,"cl-nav-link","cl-pl-0","cl-text-left",3,"click"],[1,"cl-h5","cl-mb-0"],["src","/assets/images/ui-icons/checkmark-green.svg","class","cl-ml-2",4,"ngIf"],[1,"cl-lowercase"],[1,"cl-tab-content"],[3,"editInvoiceInformation","workspaceName","turnAddress","nextStep",4,"ngIf"],[3,"disableButton","invoiceInformation","paymentFailedMessage","isMonthly","paymentInformation","closeDialog",4,"ngIf"],[1,"cl-border","cl-rounded","cl-p-3","cl-mt-3"],[1,"cl-h5"],[1,"cl-d-flex","cl-align-items-center","cl-input-no-arrow"],["data-toggle","modal","data-target","#modal-template-info",1,"cl-ml-1","cl-d-inline-flex",3,"click"],["src","/assets/images/ui-icons/info-9.svg"],[1,"cl-ml-3","cl-d-flex","cl-mr-2","cl-border"],["type","number",1,"cl-input-5-digits","cl-form-control","cl-border-0",3,"min","ngModel","ngModelChange"],[1,"cl-d-flex","cl-flex-column","cl-pr-2"],["popContent",""],[1,"cl-arrow-up","cl-hover-pointer",3,"click"],["triggers","manual","placement","right","container","body",1,"cl-arrow-down","cl-hover-pointer",3,"ngbPopover","click"],["featurePopover","ngbPopover"],[1,"cl-mr-2"],[1,"cl-ml-auto"],[1,"cl-d-flex","cl-justify-content-between"],[1,"cl-h2","cl-mb-0"],["viewBox","0 0 15 13","fill","none",1,"cl-checkmark-svg","cl-mr-1","cl-dynamic-color"],["d","M13 2L5.47368 10L2 6.30769"],["class","cl-ml-1 cl-d-inline-flex","data-toggle","modal","data-target","#modal-template-info",3,"click",4,"ngIf"],["class","cl-ml-1 cl-d-inline-flex",3,"click",4,"ngIf"],[1,"cl-ml-1","cl-d-inline-flex",3,"click"],["src","assets/ui-icons/info-9.svg"],[1,"cl-mt-3"],["src","assets/ui-icons/cross.svg",1,"cl-mr-1"],[1,"cl-list-unstyled","cl-add-lh","cl-ml-0"],["src","/assets/images/ui-icons/checkmark-green.svg",1,"cl-ml-2"],[3,"editInvoiceInformation","workspaceName","turnAddress","nextStep"],[3,"disableButton","invoiceInformation","paymentFailedMessage","isMonthly","paymentInformation","closeDialog"],[3,"type","close"],[1,"cl-modal-body","cl-text-center","cl-py-4"],[1,"cl-mb-3"],["src","assets/images/illustrations/success.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-mb-0","cl-text-gray-6"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["class","cl-btn cl-btn-primary","ngbAutofocus","",3,"click",4,"ngIf"],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(c.Wc(0,rv,67,24,"div",0),c.Wc(1,ov,1,1,"ng-template",null,1,c.Xc),c.Wc(3,lv,11,2,"ng-template",null,2,c.Xc)),2&e&&c.wc("ngIf",t.paymentPlan)},directives:[s.u,s.r,s.t,p.y,p.c,p.s,p.v,g.L,gf,Of,qu],pipes:[s.g],encapsulation:2}),e})();var uv=i("awBr"),dv=i("y+xF");class pv{constructor(e){this.projectId=e&&e.project,this.taskId=e&&e.task}}var hv=i("npmQ"),mv=i("O3o7"),gv=i("tnjF");class fv{constructor(e,t,i){this.date=e,this.project=t,this.task=i}toJson(){var e,t;return{date:this.date,project:{id:this.project.id,name:this.project.name,billable:this.project.billable,color:this.project.color,clientId:this.project.clientId||(null===(e=this.project.client)||void 0===e?void 0:e.id),clientName:this.project.clientName||(null===(t=this.project.client)||void 0===t?void 0:t.name),favorite:this.project.favorite,archived:this.project.archived},task:this.task?this.task.toJson():null}}}var vv=i("i6c7"),wv=i("6qRu"),yv=i("wkZx"),Wv=i("2qzj"),Cv=i("3QTq");const kv=["timeDurationInput"];function Sv(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",3),c.jc("click",(function(){return c.Oc(e),c.nc().openEditModal()})),c.Sb(1,"img",4),c.Wb()}if(2&e){const e=c.nc();c.Vc("cursor",e.disabled?"not-allowed":"pointer")}}let Iv=(()=>{class e{constructor(){this.durationChanged=new c.n,this.onFocus=new c.n,this.openModalEmitter=new c.n}set initialValue(e){this._initialValue=e,this.format&&this.initData()}get initialValue(){return this._initialValue}ngOnInit(){this.initData()}initData(){this.timeEntryDurationInput=this.initialValue&&"00:00:00"!==this.initialValue&&"0:00"!==this.initialValue?Object(Cv.c)(this.initialValue,this.format):this.initialValue,this.timeEntryDurationBackup=this.timeEntryDurationInput||""}addFromTimeDurationInput(){this.timeEntryDurationInput=this.timeEntryDurationInput.trim();const e=Object(Cv.c)(this.timeEntryDurationInput,this.format);e||!this.timeEntryDurationInput?(this.timeEntryDurationInput="00:00:00"!==e&&"00:00"!==e&&e?e:"",this.timeEntryDurationInput!==this.timeEntryDurationBackup&&this.durationChanged.emit(this.timeEntryDurationInput),this.timeEntryDurationBackup=this.timeEntryDurationInput):this.timeEntryDurationInput=this.timeEntryDurationBackup}focusInput(){this.timeDurationInput.nativeElement.focus()}openEditModal(){this.disabled||(this.timeDurationInput.nativeElement.blur(),this.openModalEmitter.emit(!0))}inputFocused(){this.disabled?this.timeDurationInput.nativeElement.blur():this.onFocus.emit(this.timeDurationInput)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["time-duration"]],viewQuery:function(e,t){var i;1&e&&c.ed(kv,!0),2&e&&c.Kc(i=c.kc())&&(t.timeDurationInput=i.first)},inputs:{initialValue:["duration","initialValue"],disabled:"disabled",disabledText:"disabledText",showOptions:"showOptions",hasEntries:"hasEntries",format:"format",isDesktop:"isDesktop"},outputs:{durationChanged:"durationChanged",onFocus:"onFocus",openModalEmitter:"openModalEmitter"},decls:3,vars:7,consts:[["type","text","autocomplete","off","placement","left",1,"cl-form-control","cl-form-control-sm","cl-timesheet-input",3,"ngModel","ngbTooltip","ngModelChange","change","focus","keyup.enter"],["timeDurationInput",""],["class","cl-input-dots",3,"cursor","click",4,"ngIf"],[1,"cl-input-dots",3,"click"],["src","assets/images/ui-icons/input-dots-menu.svg"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"input",0,1),c.jc("ngModelChange",(function(e){return t.timeEntryDurationInput=e}))("change",(function(){return t.addFromTimeDurationInput()}))("focus",(function(){return t.inputFocused()}))("keyup.enter",(function(){return c.Oc(e),c.Lc(1).blur()})),c.Wb(),c.Wc(2,Sv,2,2,"a",2)}2&e&&(c.Hb("cl-timesheet-show-dots",t.hasEntries||!t.isDesktop)("cl-disabled-not-allowed",t.disabled),c.wc("ngModel",t.timeEntryDurationInput)("ngbTooltip",t.disabled?t.disabledText:""),c.Cb(2),c.wc("ngIf",t.hasEntries||!t.isDesktop))},directives:[p.c,p.s,p.v,g.Z,s.u],encapsulation:2,changeDetection:0}),e})();var Ov=i("soCN"),Xv=i("MXpx");const Ev=["pickerDropdown"],Tv=["timeDuration"];function Dv(e,t){1&e&&(c.Xb(0,"span"),c.Yc(1,":"),c.Wb())}function Rv(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.Zc(e.timesheetRow.task.name)}}function Av(e,t){if(1&e&&(c.Vb(0),c.Sb(1,"span",12),c.Xb(2,"span",13),c.Yc(3),c.Wb(),c.Ub()),2&e){const e=c.nc(2);c.Cb(3),c.ad(" ",e.timesheetRow.project.clientName||e.timesheetRow.project.client.name," ")}}function jv(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"span"),c.Sb(2,"i",11),c.Yc(3),c.Wb(),c.Wc(4,Dv,2,0,"span",8),c.Wc(5,Rv,2,1,"span",8),c.Wc(6,Av,4,1,"ng-container",8),c.Ub()),2&e){const e=c.nc();c.Cb(2),c.Vc("background",e.timesheetRow.project.color,c.Kb),c.Cb(1),c.Zc(e.timesheetRow.project.name),c.Cb(1),c.wc("ngIf",null==e.timesheetRow.task?null:e.timesheetRow.task.id),c.Cb(1),c.wc("ngIf",e.timesheetRow.task),c.Cb(1),c.wc("ngIf",e.timesheetRow.project.clientName||(null==e.timesheetRow.project.client?null:e.timesheetRow.project.client.name))}}function xv(e,t){if(1&e&&(c.Sb(0,"img",14),c.Xb(1,"span",15),c.Yc(2),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.Zc(e.projectPickerTrigger)}}function Pv(e,t){if(1&e){const e=c.Yb();c.Xb(0,"project-picker",16,17),c.jc("selectedProjectAndTask",(function(t){return c.Oc(e),c.nc().selectProjectAndTask(t)}))("dropdownClosed",(function(){return c.Oc(e),c.nc().focusFirstInput()}))("onResize",(function(t){return c.Oc(e),c.Lc(1).onResizeChange(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("timesheetRows",e.timesheetRows)("hideWorkspaces",!0)}}function Mv(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"span",18),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.isExpanded=!t.isExpanded})),c.Yc(2),c.oc(3,"sumDurations"),c.Wb(),c.Xb(4,"a",19),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.isExpanded=!t.isExpanded})),c.Xb(5,"span",20),c.Sb(6,"img",21),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(2),c.Zc(c.qc(3,2,e.timesheetRow.durationsByDay,e.format)),c.Cb(4),c.wc("src",e.isExpanded?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",c.Qc)}}function Yv(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",22),c.jc("click",(function(){return c.Oc(e),c.nc().delete.emit(!0)})),c.Sb(1,"img",23),c.Wb()}}function Lv(e,t){if(1&e){const e=c.Yb();c.Xb(0,"tr"),c.Xb(1,"th",26),c.Xb(2,"span",31),c.Yc(3),c.Wb(),c.Wb(),c.Xb(4,"td",32),c.Xb(5,"time-duration",33,34),c.jc("onFocus",(function(i){c.Oc(e);const n=t.index,s=c.nc(2);return s.focusRow(),s.clickInput(n,i)}))("durationChanged",(function(i){c.Oc(e);const n=t.index;return c.nc(2).durationChanged(i,n)}))("openModalEmitter",(function(){c.Oc(e);const i=t.index;return c.nc(2).bulkEditEntries(i)})),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit,i=t.index,n=c.nc(2);c.Cb(3),c.Zc(e),c.Cb(2),c.wc("disabled",n.isInputDisabled(i))("format",n.format)("duration",n.durations[i])("disabledText",n.getDisabledText(i))("showOptions",!n.workspace.canSeeTracker)("isDesktop",n.isDesktop)}}function Fv(e,t){1&e&&(c.Xb(0,"span",35),c.Sb(1,"img",36),c.Wb())}function Nv(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",37),c.jc("click",(function(){return c.Oc(e),c.nc(2).deleteRow()})),c.Sb(1,"img",23),c.Wb()}if(2&e){const e=c.nc(2);c.wc("disabled",e.isTeamManagerSelectUser||e.timesheetRow.disabled||e.allEntriesLocked)}}function Uv(e,t){if(1&e&&(c.Xb(0,"table",24),c.Xb(1,"tbody"),c.Wc(2,Lv,7,7,"tr",25),c.Xb(3,"tr"),c.Xb(4,"th",26),c.Xb(5,"span",27),c.Yc(6,"Total:"),c.Wb(),c.Wb(),c.Xb(7,"td",28),c.Xb(8,"span"),c.Yc(9),c.oc(10,"sumDurations"),c.Wb(),c.Wc(11,Fv,2,0,"span",29),c.Wc(12,Nv,2,1,"ng-template",null,30,c.Xc),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.Lc(13),t=c.nc();c.Cb(2),c.wc("ngForOf",t.week),c.Cb(5),c.wc("ngClass",0===t.timesheetRow.durationsByDay.length?"cl-text-gray-9":"cl-text-dark"),c.Cb(2),c.Zc(c.qc(10,5,t.timesheetRow.durationsByDay,t.format)),c.Cb(2),c.wc("ngIf",t.timesheetRow.isApproved)("ngIfElse",e)}}function $v(e,t){if(1&e){const e=c.Yb();c.Xb(0,"td",44),c.oc(1,"checkIfEditedEntries"),c.Xb(2,"time-duration",45,34),c.jc("onFocus",(function(i){c.Oc(e);const n=t.index,s=c.nc(2);return s.focusRow(),s.clickInput(n,i)}))("durationChanged",(function(i){c.Oc(e);const n=t.index;return c.nc(2).durationChanged(i,n)}))("openModalEmitter",(function(){c.Oc(e);const i=t.index;return c.nc(2).bulkEditEntries(i)})),c.Wb(),c.Wb()}if(2&e){const e=t.index,i=c.nc(2);c.Hb("cl-edited",c.pc(1,10,i.timesheetRow.entries[e]))("cl-hide-dots",i.shouldHideDots(e)),c.Cb(2),c.wc("disabled",i.isInputDisabled(e))("format",i.format)("duration",i.durations[e])("disabledText",i.getDisabledText(e))("showOptions",!i.workspace.canSeeTracker)("hasEntries",!!i.timesheetRow.entries[e])}}function _v(e,t){1&e&&(c.Xb(0,"a",46),c.Sb(1,"img",36),c.Wb())}function Gv(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",47),c.jc("click",(function(){return c.Oc(e),c.nc(2).deleteRow()})),c.Sb(1,"img",23),c.Wb()}if(2&e){const e=c.nc(2);c.wc("disabled",e.isTeamManagerSelectUser||e.timesheetRow.disabled||e.allEntriesLocked)}}function Bv(e,t){if(1&e&&(c.Vb(0),c.Wc(1,$v,4,12,"td",38),c.Xb(2,"td",39),c.Xb(3,"div",40),c.Xb(4,"span",41),c.Yc(5),c.oc(6,"sumDurations"),c.Wb(),c.Wc(7,_v,2,0,"a",42),c.Wc(8,Gv,2,1,"ng-template",null,43,c.Xc),c.Wb(),c.Wb(),c.Ub()),2&e){const e=c.Lc(9),t=c.nc();c.Cb(1),c.wc("ngForOf",t.week),c.Cb(3),c.wc("ngClass",0===t.timesheetRow.durationsByDay.length?"cl-text-gray-9":"cl-text-dark"),c.Cb(1),c.ad(" ",c.qc(6,5,t.timesheetRow.durationsByDay,t.format)," "),c.Cb(2),c.wc("ngIf",t.timesheetRow.isApproved)("ngIfElse",e)}}const Vv=function(e){return{"cl-project-name cl-project-name-colored cl-dropdown-toggle cl-no-arrow cl-listing-project-client cl-text-dark":e}};let Hv=(()=>{class e{constructor(e,t,i){this.timezoneConverter=e,this.authService=t,this.cd=i,this.delete=new c.n,this.changeDuration=new c.n,this.selectedProjectAndTask=new c.n,this.openNextPicker=new c.n,this.preventOpenPickerOnTab=new c.n,this.focusedRow=new c.n,this.openModalEmitter=new c.n,this.durations=[],this.lockedEntries=[],this.hasLockedEntries=!1,this.allEntriesLocked=!1,this.projectPickerTrigger="",this.unsubscribe$=new Ee.a}set expandAll(e){this.timesheetRow&&this.timesheetRow.project&&(this.isExpanded=e)}get expandAll(){return this._expandAll}set userGroups(e){this._userGroups=e,this.isLoaded&&(this.disableRowWithoutPermission(),this.cd.detectChanges())}get userGroups(){return this._userGroups}set selectedUser(e){this._selectedUser=e,this.isLoaded&&(this.disableRowWithoutPermission(),this.cd.detectChanges())}get selectedUser(){return this._selectedUser}ngOnInit(){this.title=Object(Pt.o)(this.timesheetRow,this.workspace.projectGroupingLabel),this.projectPickerTrigger=this.projectPickerSpecialFilter?"Task @Project":this.workspace.forceTasks?"Select task":"Select project",this.getFormattedDurations(),this.workspace.lockTimeEntries&&!this.isAdminOrOwner&&this.checkLockedEntries()}ngAfterViewInit(){this.disableRowWithoutPermission(),this.isLoaded=!0,this.cd.detectChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getFormattedDurations(){this.durations=this.timesheetRow.durationsByDay.map(e=>e&&e.format(this.format,{trim:!1})||""),this.timesheetRow.durationsByDay=[...this.timesheetRow.durationsByDay],this.cd.detectChanges()}checkLockedEntries(){const e=this.authService.getUser().settings.timeZone,t=this.timezoneConverter.addOffsetToUTCTime(jt.tz(this.workspace.lockTimeEntries,e).clone()),i=this.dateRange.start.clone();this.lockedEntries=this.week.map((e,n)=>Object(Se.utc)(i).startOf("day").add(n,"days").isBefore(jt(t))),this.hasLockedEntries=this.lockedEntries.some(e=>e),this.allEntriesLocked=this.lockedEntries.every(e=>e)}selectProjectAndTask(e){this.selectedProjectAndTask.emit({task:e.task,project:e.project,workspace:e.workspace}),this.isDesktop||!this.timesheetRow.project||this.timesheetRow.entries.length||(this.isExpanded=!0),(this.isDesktop||this.isExpanded)&&this.focusFirstInput()}durationChanged(e,t){this.changeDuration.emit({duration:e,index:t}),0===Object(Se.duration)(e).asSeconds()&&(this.timesheetRow.durationsByDay[t]=null,this.timesheetRow.entries[t]=[])}getDisabledText(e){return this.isTeamManagerSelectUser?"":this.disableManualMode?"Manual mode disabled.":this.timesheetRow.isApproved?"Can't edit approved entries.":this.lockedEntries[e]?"Can't edit locked entries. Contact your admin for more information.":this.timesheetRow.disabled?"You don't have access to this project or task.":this.timesheetRow.project?this.timesheetRow.entries[e]&&this.timesheetRow.entries[e].some(e=>e.tags&&e.tags.some(e=>e.archived))?"Can't edit entries when tag is archived.":"":"Select project/task first."}disableRowWithoutPermission(){if(this.selectedUser&&this.userGroups&&this.timesheetRow){const e=this.userGroups.filter(e=>e.userIds.indexOf(this.selectedUser.id)>-1).map(e=>e.id);if(!this.isAdminOrOwner&&this.timesheetRow.project&&this.timesheetRow.project.archived)return void(this.timesheetRow.disabled=!0);if(!this.isAdminOrOwner&&this.timesheetRow.task&&"DONE"===this.timesheetRow.task.status)return void(this.timesheetRow.disabled=!0);if(!this.isAdminOrOwner&&this.timesheetRow.task&&this.timesheetRow.task.assigneeIds&&this.timesheetRow.task.assigneeIds.length&&-1===this.timesheetRow.task.assigneeIds.indexOf(this.selectedUser.id))return void(this.timesheetRow.disabled=!0);if(this.timesheetRow.project&&new mv.a(this.timesheetRow.project).public)return void(this.timesheetRow.disabled=!1);if(!this.isAdminOrOwner&&this.timesheetRow.project&&this.timesheetRow.project.memberships&&!this.timesheetRow.project.memberships.some(t=>t.userId===this.selectedUser.id||e.indexOf(t.userId)>-1))return void(this.timesheetRow.disabled=!0)}}deleteRow(){this.timesheetRow.disabled||this.allEntriesLocked||this.timesheetRow.isApproved||this.delete.emit()}focusFirstInput(){this.workspace.forceDescription||this.workspace.forceTags||(setTimeout(()=>{this.inputs&&this.inputs.first&&this.inputs.first.focusInput()},200),this.preventOpenPickerOnTab.emit(!0))}openProjectPicker(){this.pickerDropdown.nativeElement.focus()}pickerOpened(){this.preventOpenPickerOnTab.emit(!0)}focusRow(){this.focusedRow.emit(this.index)}clickInput(e,t){const i=this.timesheetRow.entries[e];(this.workspace.forceDescription||this.workspace.forceTags||i&&i.length&&1!==i.length)&&((!this.workspace.forceDescription&&!this.workspace.forceTags||i&&i.length)&&this.areDescriptionsSame(i)&&this.areTagsSame(i)&&this.isBillabilitySame(i)&&this.areCustomFieldsSame(i)&&(!this.workspace.forceDescription||this.workspace.forceDescription&&i[0].description)&&(!this.workspace.forceTags||this.workspace.forceTags&&i[0].tags&&i[0].tags.length)||this.openEditModal(e,t))}areDescriptionsSame(e){return!e||e.every(t=>t.description===e[0].description)}areTagsSame(e){return!e||e.every(t=>Object(Pt.c)(t.tags.map(e=>e.id),e[0].tags.map(e=>e.id)))}isBillabilitySame(e){return!e||e.every(t=>t.billable===e[0].billable)}areCustomFieldsSame(e){let t=[],i=[];return e&&e[0]&&e[0].customFieldValues&&e[0].customFieldValues.length&&(t=e[0].customFieldValues.map(e=>e.customFieldId),i=e[0].customFieldValues.map(e=>e.value)),!e||e.every(n=>{if(!(e[0].customFieldValues&&e[0].customFieldValues.length||n.customFieldValues&&n.customFieldValues.length))return!0;const s=Object(Pt.c)(n.customFieldValues.map(e=>e.customFieldId),t),c=Object(Pt.c)(n.customFieldValues.map(e=>e.value),i);return s&&c})}openEditModal(e,t){t.nativeElement.blur(),this.bulkEditEntries(e)}bulkEditEntries(e){this.timesheetRow.disabled||this.lockedEntries[e]||!this.timesheetRow.project||(this.openModalEmitter.emit({timesheetRow:this.timesheetRow,index:e}),this.preventOpenPickerOnTab.emit(!0))}isInputDisabled(e){return this.isTeamManagerSelectUser||this.timesheetRow.isApproved||this.timesheetRow.disabled||this.lockedEntries[e]||this.disableManualMode||!this.timesheetRow.project||this.timesheetRow.entries[e]&&this.timesheetRow.entries[e].some(e=>e.tags&&e.tags.some(e=>e.archived))}shouldHideDots(e){return!(this.workspace.forceDescription||this.workspace.forceTags||this.timesheetRow.entries[e]&&this.timesheetRow.entries[e].length)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(vs.a),c.Rb(Ce.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["timesheet-row"],["","timesheet-row",""]],viewQuery:function(e,t){var i;1&e&&(c.ed(Ev,!0),c.ed(Tv,!0)),2&e&&(c.Kc(i=c.kc())&&(t.pickerDropdown=i.first),c.Kc(i=c.kc())&&(t.inputs=i))},inputs:{expandAll:"expandAll",userGroups:"userGroups",selectedUser:"selectedUser",timesheetRows:"timesheetRows",timesheetRow:"timesheetRow",week:"week",isDesktop:"isDesktop",format:"format",isAdminOrOwner:"isAdminOrOwner",dateRange:"dateRange",workspace:"workspace",projectPickerSpecialFilter:"projectPickerSpecialFilter",index:"index",disableManualMode:"disableManualMode",isTeamManagerSelectUser:"isTeamManagerSelectUser"},outputs:{delete:"delete",changeDuration:"changeDuration",selectedProjectAndTask:"selectedProjectAndTask",openNextPicker:"openNextPicker",preventOpenPickerOnTab:"preventOpenPickerOnTab",focusedRow:"focusedRow",openModalEmitter:"openModalEmitter"},decls:13,vars:13,consts:[[1,"cl-px-lg-3","cl-cut-text-wrapper-td"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-dropdown","cl-dropdown-large","cl-d-inline-flex","cl-cut-text-wrapper","cl-w-100",3,"dropdownKey"],["dropdownKeyButton","","tabindex","0",1,"cl-cut-text",3,"ngClass","click"],["pickerDropdown",""],[4,"ngIf","ngIfElse"],["noSelectedTemplate",""],["openUpAtBottom","","class","cl-dropdown-menu","resizeable","",3,"timesheetRows","hideWorkspaces","selectedProjectAndTask","dropdownClosed","onResize",4,"dropdownKeyContent"],[4,"ngIf"],["class","cl-ml-2 cl-mr-1 cl-lh-0",3,"click",4,"ngIf"],["class","cl-table cl-table-bordered cl-remove-cell-borders cl-mt-2 cl-mt-lg-3",4,"ngIf"],[1,"cl-entry__project__dot"],[1,"cl-h-line-divider"],[1,"cl-listing-client"],["src","assets/images/ui-icons/plus-blue-req.svg"],[1,"cl-ml-2","cl-color-blue"],["openUpAtBottom","","resizeable","",1,"cl-dropdown-menu",3,"timesheetRows","hideWorkspaces","selectedProjectAndTask","dropdownClosed","onResize"],["projectPicker",""],[1,"cl-text-dark",3,"click"],[1,"cl-ml-3",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"],[1,"cl-ml-2","cl-mr-1","cl-lh-0",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-mt-2","cl-mt-lg-3"],[4,"ngFor","ngForOf"],[1,"cl-bg-light"],[1,"cl-h6","cl-mb-0"],[1,"cl-bg-light","cl-text-right",3,"ngClass"],["class","cl-ml-2 cl-mr-1 cl-lh-0",4,"ngIf","ngIfElse"],["deleteTemplateMobile",""],[1,"cl-h6"],[1,"cl-timesheet-input-td","cl-edited"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center",3,"disabled","format","duration","disabledText","showOptions","isDesktop","onFocus","durationChanged","openModalEmitter"],["timeDuration",""],[1,"cl-ml-2","cl-mr-1","cl-lh-0"],["src","assets/ui-icons/checkmark-green-circle.svg"],[1,"cl-ml-2","cl-mr-1","cl-lh-0",3,"disabled","click"],["class","cl-timesheet-input-td",3,"cl-edited","cl-hide-dots",4,"ngFor","ngForOf"],[1,"cl-timesheet-total-td","cl-pr-lg-2"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-between"],[3,"ngClass"],["title","Approved","class","cl-ml-2 cl-lh-0 cl-d-print-none cl-disabled-light",4,"ngIf","ngIfElse"],["deleteTemplate",""],[1,"cl-timesheet-input-td"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center","cl-position-relative",3,"disabled","format","duration","disabledText","showOptions","hasEntries","onFocus","durationChanged","openModalEmitter"],["title","Approved",1,"cl-ml-2","cl-lh-0","cl-d-print-none","cl-disabled-light"],[1,"cl-ml-2","cl-lh-0","cl-d-print-none",3,"disabled","click"]],template:function(e,t){if(1&e&&(c.Xb(0,"td",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"a",3,4),c.jc("click",(function(){return t.pickerOpened()})),c.Wc(5,jv,7,6,"ng-container",5),c.Wc(6,xv,3,1,"ng-template",null,6,c.Xc),c.Wb(),c.Wc(8,Pv,2,2,"project-picker",7),c.Wb(),c.Wc(9,Mv,7,5,"ng-container",8),c.Wc(10,Yv,2,0,"a",9),c.Wb(),c.Wc(11,Uv,14,8,"table",10),c.Wb(),c.Wc(12,Bv,10,8,"ng-container",8)),2&e){const e=c.Lc(7);c.Cb(2),c.wc("dropdownKey",t.isTeamManagerSelectUser||t.timesheetRow.isApproved||t.disableManualMode||t.timesheetRow.project&&t.hasLockedEntries&&!t.isAdminOrOwner),c.Cb(1),c.Hb("cl-disabled",t.isTeamManagerSelectUser||t.timesheetRow.isApproved||t.disableManualMode||t.timesheetRow.project&&t.hasLockedEntries&&!t.isAdminOrOwner),c.wc("ngClass",c.Bc(11,Vv,t.timesheetRow.project&&t.timesheetRow.project.name)),c.Db("title",t.timesheetRow.project?t.title:""),c.Cb(2),c.wc("ngIf",t.timesheetRow.project)("ngIfElse",e),c.Cb(4),c.wc("ngIf",!t.isDesktop&&t.timesheetRow.project),c.Cb(1),c.wc("ngIf",!t.isDesktop&&!t.timesheetRow.project),c.Cb(1),c.wc("ngIf",!t.isDesktop&&t.isExpanded),c.Cb(1),c.wc("ngIf",t.isDesktop)}},directives:[Si.a,Ii.a,s.r,s.u,Oi.a,Vp.a,Hp.a,s.t,Iv],pipes:[Ov.a,Xv.a],encapsulation:2,changeDetection:0}),e})();function zv(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",6),c.Xb(1,"span",7),c.Yc(2),c.oc(3,"stringDurationToTime"),c.Wb(),c.Xb(4,"a",8),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.isExpanded=!t.isExpanded})),c.Xb(5,"span",9),c.Sb(6,"img",10),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.Zc(c.qc(3,1,e.total,e.format))}}function qv(e,t){if(1&e&&(c.Xb(0,"tr"),c.Xb(1,"th",13),c.Xb(2,"span",16),c.Yc(3),c.Wb(),c.Wb(),c.Xb(4,"td",15),c.Yc(5),c.oc(6,"stringDurationToTime"),c.Wb(),c.Wb()),2&e){const e=t.$implicit,i=t.index,n=c.nc(2);c.Cb(3),c.Zc(e),c.Cb(1),c.wc("ngClass",n.totalList[i]?"cl-text-dark":"cl-text-gray-9"),c.Cb(1),c.ad(" ",c.qc(6,3,n.totalList[i],n.format)," ")}}function Kv(e,t){if(1&e&&(c.Xb(0,"table",11),c.Xb(1,"tbody"),c.Wc(2,qv,7,6,"tr",12),c.Xb(3,"tr"),c.Xb(4,"th",13),c.Xb(5,"span",14),c.Yc(6,"Total:"),c.Wb(),c.Wb(),c.Xb(7,"td",15),c.Yc(8),c.oc(9,"stringDurationToTime"),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.wc("ngForOf",e.week),c.Cb(5),c.wc("ngClass",e.isTotalZero?"cl-text-gray-9":"cl-text-dark"),c.Cb(1),c.ad(" ",c.qc(9,3,e.total,e.format)," ")}}function Zv(e,t){if(1&e&&(c.Xb(0,"td",20),c.Yc(1),c.oc(2,"stringDurationToTime"),c.Wb()),2&e){const e=t.index,i=c.nc(2);c.wc("ngClass",i.totalList[e]?"cl-text-dark":"cl-text-gray-9"),c.Cb(1),c.ad(" ",c.qc(2,2,i.totalList[e],i.format)," ")}}function Qv(e,t){if(1&e&&(c.Vb(0),c.Wc(1,Zv,3,5,"td",17),c.Xb(2,"td",18),c.Xb(3,"span",19),c.Yc(4),c.oc(5,"stringDurationToTime"),c.Wb(),c.Wb(),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.wc("ngForOf",e.week),c.Cb(1),c.wc("ngClass",e.isTotalZero?"cl-text-gray-9":"cl-text-dark"),c.Cb(2),c.Zc(c.qc(5,3,e.total,e.format))}}let Jv=(()=>{class e{constructor(){this.isExpanded=!1}set total(e){this._total=e||Object(Se.duration)(0),this.isTotalZero=0===Object(Se.duration)(this.total).asSeconds()}set expandAll(e){this.isExpanded=e}get expandAll(){return this._expandAll}get total(){return this._total}ngOnInit(){}ngOnDestroy(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["timesheet-row-total"],["","timesheet-row-total",""]],inputs:{total:"total",expandAll:"expandAll",totalList:"totalList",week:"week",isDesktop:"isDesktop",format:"format"},decls:7,vars:3,consts:[[1,"cl-px-lg-3"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-text-gray-9"],["class","cl-d-flex",4,"ngIf"],["class","cl-table cl-table-bordered cl-remove-cell-borders cl-mt-2 cl-mt-lg-3",4,"ngIf"],[4,"ngIf"],[1,"cl-d-flex"],[1,"cl-text-dark"],[1,"cl-ml-3",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],["src","assets/images/ui-icons/chevron-down.svg"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-mt-2","cl-mt-lg-3"],[4,"ngFor","ngForOf"],[1,"cl-bg-light"],[1,"cl-h6","cl-mb-0"],[1,"cl-bg-light","cl-text-right",3,"ngClass"],[1,"cl-h6"],["class","cl-text-center",3,"ngClass",4,"ngFor","ngForOf"],[1,"cl-timesheet-total-td","cl-text-left",3,"ngClass"],[1,"timesheet-total-pr"],[1,"cl-text-center",3,"ngClass"]],template:function(e,t){1&e&&(c.Xb(0,"td",0),c.Xb(1,"div",1),c.Xb(2,"span",2),c.Yc(3,"Total:"),c.Wb(),c.Wc(4,zv,7,4,"div",3),c.Wb(),c.Wc(5,Kv,10,6,"table",4),c.Wb(),c.Wc(6,Qv,6,6,"ng-container",5)),2&e&&(c.Cb(4),c.wc("ngIf",!t.isDesktop),c.Cb(1),c.wc("ngIf",!t.isDesktop&&t.isExpanded),c.Cb(1),c.wc("ngIf",t.isDesktop))},directives:[s.u,s.t,s.r],pipes:[Ps.a],encapsulation:2,changeDetection:0}),e})();function ew(e,t){if(1&e&&c.Sb(0,"img",14),2&e){const e=c.nc(2);c.wc("ngbTooltip",e.template.projectsAndTasks&&0===e.template.projectsAndTasks.length?"You should delete this template because it's empty":"")}}function tw(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Wc(1,ew,1,1,"img",12),c.Xb(2,"button",13),c.jc("click",(function(){return c.Oc(e),c.nc().applyTemplate()})),c.Yc(3," Activate "),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.template.projectsAndTasks&&0===e.template.projectsAndTasks.length),c.Cb(1),c.wc("disabled",e.template.projectsAndTasks&&0===e.template.projectsAndTasks.length)}}function iw(e,t){1&e&&(c.Xb(0,"a",15),c.Sb(1,"img",16),c.Yc(2," Active "),c.Wb())}function nw(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=c.nc(2).$implicit;c.Cb(1),c.ad(" - ",e.task.name?e.task.name:"Without project"," ")}}function sw(e,t){if(1&e&&(c.Xb(0,"span",31),c.Yc(1),c.Wb()),2&e){const e=c.nc(2).$implicit;c.Cb(1),c.ad(" - ",e.project.clientName," ")}}function cw(e,t){if(1&e&&(c.Xb(0,"span",28),c.Sb(1,"i",29),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Wc(4,nw,2,1,"span",3),c.Wc(5,sw,2,1,"span",30),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(1),c.Vc("background",e.project.color,c.Kb),c.Cb(2),c.ad(" ",e.project.name?e.project.name:"Without project"," "),c.Cb(1),c.wc("ngIf",e.task&&e.task.name),c.Cb(1),c.wc("ngIf",e.project.clientName)}}function rw(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"div",26),c.Wc(2,cw,6,5,"span",27),c.Wb(),c.Ub()),2&e){const e=t.$implicit;c.Cb(2),c.wc("ngIf",e.project)}}function ow(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",17),c.Xb(1,"h1",18),c.Xb(2,"div",19),c.Yc(3),c.Wb(),c.Wb(),c.Xb(4,"button",20),c.jc("click",(function(){return c.Oc(e),c.nc().closeModal()})),c.Xb(5,"span",21),c.Sb(6,"img",8),c.Wb(),c.Wb(),c.Wb(),c.Xb(7,"div",22),c.Wc(8,rw,3,1,"ng-container",23),c.Wb(),c.Xb(9,"div",24),c.Xb(10,"button",25),c.jc("click",(function(){return c.Oc(e),c.nc().closeModal()})),c.Yc(11,"Close"),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.Zc(e.fullTemplate.name),c.Cb(5),c.wc("ngForOf",e.fullTemplate.projectsAndTasks)}}function aw(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",17),c.Xb(1,"h1",32),c.Yc(2,"Edit template"),c.Wb(),c.Xb(3,"button",20),c.jc("click",(function(){return c.Oc(e),c.nc().closeModal()})),c.Xb(4,"span",21),c.Sb(5,"img",8),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",33),c.Xb(7,"form"),c.Xb(8,"div",34),c.Xb(9,"label",35),c.Yc(10,"Change name"),c.Wb(),c.Xb(11,"div",36),c.Xb(12,"input",37),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().newTemplateName=t}))("keyup.enter",(function(){c.Oc(e);const t=c.nc();return t.editTemplate(t.newTemplateName)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(13,"div",24),c.Xb(14,"a",38),c.jc("click",(function(){return c.Oc(e),c.nc().closeModal()})),c.Yc(15,"Cancel"),c.Wb(),c.Xb(16,"button",39),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.editTemplate(t.newTemplateName)})),c.Yc(17," Save "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(12),c.wc("ngModel",e.newTemplateName),c.Cb(4),c.wc("disabled",""===e.newTemplateName.trim())}}function lw(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",17),c.Xb(1,"h1",32),c.Yc(2,"Delete"),c.Wb(),c.Xb(3,"button",20),c.jc("click",(function(){return c.Oc(e),c.nc().closeModal()})),c.Xb(4,"span",21),c.Sb(5,"img",8),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",33),c.Xb(7,"p",40),c.Yc(8),c.Wb(),c.Wb(),c.Xb(9,"div",24),c.Xb(10,"a",38),c.jc("click",(function(){return c.Oc(e),c.nc().closeModal()})),c.Yc(11,"Cancel"),c.Wb(),c.Xb(12,"button",41),c.jc("click",(function(){return c.Oc(e),c.nc().deleteTemplate()})),c.Yc(13," Delete "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(8),c.ad("Are you sure you want to delete template ",e.template.name,"?")}}i("z1wq");let bw=(()=>{class e{constructor(e,t){this.tracker2Service=e,this.modalService=t,this.templateApplied=new c.n,this.templateEdited=new c.n,this.templateDeleted=new c.n,this.newTemplateName=""}applyTemplate(){0!==this.template.projectsAndTasks.length&&this.templateApplied.emit(!0)}editTemplate(e){this.templateEdited.emit(e)}deleteTemplate(){this.templateDeleted.emit(!0)}openModal(e,t){this.template=t,this.newTemplateName=t.name,this.modalService.open(e,{centered:!0})}openInfoModal(e,t){this.tracker2Service.templateOfId(t.id).subscribe(t=>{this.fullTemplate=t,this.modalService.open(e,{centered:!0})})}closeModal(){this.modalService.dismissAll()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb($d.a),c.Rb(g.q))},e.\u0275cmp=c.Lb({type:e,selectors:[["template-row"]],inputs:{template:"template",hasEntries:"hasEntries",disableManualMode:"disableManualMode"},outputs:{templateApplied:"templateApplied",templateEdited:"templateEdited",templateDeleted:"templateDeleted"},decls:18,vars:3,consts:[[1,"cl-d-flex","cl-flex-column","cl-flex-lg-row","cl-w-100","cl-align-items-start","cl-align-items-lg-center"],[1,"cl-px-2","cl-px-lg-3","cl-py-3","cl-cut-text","cl-w-100","cl-w-lg-auto"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end","cl-template-separator-mob","cl-min-height-40","cl-w-100","cl-w-lg-auto","cl-ml-auto"],[4,"ngIf"],["class","cl-text-success cl-component-divided-left cl-no-divider-border",4,"ngIf"],[1,"cl-component-divided-left",3,"click"],["src","assets/images/ui-icons/info-icon.svg"],["src","assets/images/ui-icons/edit.svg"],["src","assets/images/ui-icons/close.svg"],["infoTemplateModal",""],["editTemplateModal",""],["deleteTemplateModal",""],["src","assets/info-icon.png","class","cl-mr-0","placement","left",3,"ngbTooltip",4,"ngIf"],[1,"cl-component-divided-left","cl-no-divider-border","cl-btn-link","cl-pl-1",3,"disabled","click"],["src","assets/info-icon.png","placement","left",1,"cl-mr-0",3,"ngbTooltip"],[1,"cl-text-success","cl-component-divided-left","cl-no-divider-border"],["src","assets/images/ui-icons/checkmark-green.svg",1,"cl-mr-2"],[1,"cl-modal-header"],[1,"cl-modal-title","cl-cut-text-wrapper"],[1,"cl-cut-text"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],[1,"cl-modal-body","cl-p-0"],[4,"ngFor","ngForOf"],[1,"cl-modal-footer"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-dropdown-item","cl-white-space-normal"],["class","cl-project-name cl-text-dark",4,"ngIf"],[1,"cl-project-name","cl-text-dark"],[1,"cl-entry__project__dot"],["class","cl-listing-client",4,"ngIf"],[1,"cl-listing-client"],[1,"cl-modal-title"],[1,"cl-modal-body"],[1,"cl-form-group","cl-row","cl-mb-0"],["for","template-name-create",1,"cl-col-sm-3","cl-col-form-label"],[1,"cl-col-sm-9"],["type","text","ngbAutofocus","","id","template-name-create","name","newTemplateName",1,"cl-form-control",3,"ngModel","ngModelChange","keyup.enter"],[3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-mb-0"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-danger",3,"click"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",1),c.Yc(2),c.Wb(),c.Xb(3,"div",2),c.Wc(4,tw,4,2,"ng-container",3),c.Wc(5,iw,3,0,"a",4),c.Xb(6,"a",5),c.jc("click",(function(){c.Oc(e);const i=c.Lc(13);return t.openInfoModal(i,t.template)})),c.Sb(7,"img",6),c.Wb(),c.Xb(8,"a",5),c.jc("click",(function(){c.Oc(e);const i=c.Lc(15);return t.openModal(i,t.template)})),c.Sb(9,"img",7),c.Wb(),c.Xb(10,"a",5),c.jc("click",(function(){c.Oc(e);const i=c.Lc(17);return t.openModal(i,t.template)})),c.Sb(11,"img",8),c.Wb(),c.Wb(),c.Wb(),c.Wc(12,ow,12,2,"ng-template",null,9,c.Xc),c.Wc(14,aw,18,2,"ng-template",null,10,c.Xc),c.Wc(16,lw,14,1,"ng-template",null,11,c.Xc)}2&e&&(c.Cb(2),c.Zc(t.template.name),c.Cb(2),c.wc("ngIf",!t.template.isActive&&!t.hasEntries&&!t.disableManualMode),c.Cb(1),c.wc("ngIf",t.template.isActive&&!t.hasEntries))},directives:[s.u,g.Z,s.t,p.I,p.t,p.u,p.c,p.s,p.v],encapsulation:2}),e})();var uw=function(e){return e[e.TIME=0]="TIME",e[e.DESCRIPTION=1]="DESCRIPTION",e[e.TAG=2]="TAG",e[e.BILLABLE=3]="BILLABLE",e}({});class dw{constructor(e,t,i,n){this._type=e,this._initialValue=t,this._value=t,this._different=void 0!==n&&n,this._forced=i,this.checkIfInvalid()}get type(){return this._type}set type(e){this._type=e}get initialValue(){return this._initialValue}set initialValue(e){this._initialValue=e}get value(){return this._value}set value(e){this._value=e,this.checkIfInvalid()}get different(){return this._different}set different(e){this._different=e}get forced(){return this._forced}set forced(e){this._forced=e}get invalid(){return this._invalid}set invalid(e){this._invalid=e}checkIfInvalid(){this._type===uw.DESCRIPTION&&(this.invalid=this._forced&&""==this._value),this._type===uw.TAG&&(this.invalid=this._forced&&(!this._value||!this._value.length)),this._type===uw.BILLABLE&&(this.invalid=!1),this._type===uw.TIME&&(this.invalid=this._value instanceof ep.a&&(!this._value||0===Object(Se.duration)(this._value.duration).asSeconds()))}}const pw=["descriptionInput"];function hw(e,t){if(1&e&&(c.Xb(0,"div",31),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.row.project.clientName||e.row.project.client.name," ")}}function mw(e,t){if(1&e&&(c.Xb(0,"div",31),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.row.task.name," ")}}function gw(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",32),c.Xb(1,"single-date-picker2",33),c.jc("pickedDate",(function(t){return c.Oc(e),c.nc().pickedTime(t)})),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.wc("debounce",!1)("dateTime",e.timeValue&&e.timeValue.value)("mode","time_only")}}function fw(e,t){if(1&e&&(c.Xb(0,"div",34),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" You have multiple entries with different ",e.differentValues,". If you override, all entries will have the same description. ")}}function vw(e,t){1&e&&(c.Xb(0,"span",35),c.Yc(1,"*"),c.Wb())}function ww(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",29),c.jc("click",(function(){return c.Oc(e),c.nc().overrideDescription()})),c.Yc(1," Override descriptions "),c.Wb()}}function yw(e,t){if(1&e){const e=c.Yb();c.Xb(0,"textarea",36,37),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().descriptionValue.value=t}))("ngModelChange",(function(){return c.Oc(e),c.nc().shouldDisableSave()})),c.Wb()}if(2&e){const e=c.nc();c.wc("ngModel",e.descriptionValue.value)}}function Ww(e,t){1&e&&(c.Xb(0,"span",35),c.Yc(1,"*"),c.Wb())}function Cw(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",29),c.jc("click",(function(){return c.Oc(e),c.nc().tagValue.different=!1})),c.Yc(1," Override tags "),c.Wb()}}function kw(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=t.$implicit,i=t.last;c.Cb(1),c.bd(" ",e.name," ",i?"":", "," ")}}function Sw(e,t){if(1&e&&(c.Vb(0),c.Wc(1,kw,2,2,"span",45),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngForOf",e.tagValue.value)}}function Iw(e,t){1&e&&c.Yc(0," Select tags ")}function Ow(e,t){if(1&e){const e=c.Yb();c.Xb(0,"tag-dropdown",46),c.jc("close",(function(t){return c.Oc(e),c.nc(2).closeTagDropdown(t)})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("resizeableName","tagPicker")("entryTags",e.tagValue.value)}}function Xw(e,t){if(1&e&&(c.Xb(0,"div",38),c.Xb(1,"button",39),c.Wc(2,Sw,2,1,"ng-container",40),c.Wc(3,Iw,1,0,"ng-template",null,41,c.Xc),c.Wb(),c.Xb(5,"div",42),c.Xb(6,"div",43),c.Wc(7,Ow,1,2,"tag-dropdown",44),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.Lc(4),t=c.nc();c.Cb(2),c.wc("ngIf",null==t.tagValue.value?null:t.tagValue.value.length)("ngIfElse",e)}}function Ew(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",29),c.jc("click",(function(){return c.Oc(e),c.nc().billableValue.different=!1})),c.Yc(1,"Override billable"),c.Wb()}}function Tw(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",47),c.Xb(1,"input",48),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().billableValue.value=t})),c.Wb(),c.Xb(2,"label",49),c.Yc(3,"Yes"),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.wc("ngModel",e.billableValue.value)}}function Dw(e,t){1&e&&c.Sb(0,"hr")}function Rw(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",29),c.jc("click",(function(){return c.Oc(e),c.nc().$implicit.isSameForAll=!0})),c.Yc(1),c.Wb()}if(2&e){const e=c.nc().$implicit;c.Cb(1),c.ad("Override ",e.customField.name,"")}}function Aw(e,t){if(1&e&&(c.Xb(0,"div",52),c.Sb(1,"custom-field-value",53),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(1),c.wc("customField",e)}}function jw(e,t){if(1&e&&(c.Xb(0,"div",24),c.Xb(1,"label",21),c.Yc(2),c.Wb(),c.Xb(3,"div",50),c.Wc(4,Rw,2,1,"a",19),c.Wc(5,Aw,2,1,"div",51),c.Wb(),c.Wb()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e.customField.name),c.Cb(2),c.wc("ngIf",!e.isSameForAll),c.Cb(1),c.wc("ngIf",e.isSameForAll)}}let xw=(()=>{class e{constructor(e){this.toaster=e,this.close=new c.n,this.createEntryEmitter=new c.n,this.differentValues=[],this.disableSaveButton=!1}ngOnInit(){this.dateFormat=this.user.settings.dateFormat,this.timeFormat=this.user.settings.timeFormat,this.durationFormat=this.workspace.getTimeFormat(),this.entries=this.row.entries[this.index],this.selectedDate=Se(Object(Se.utc)(this.dateRange.start.clone())).add(this.index,"day").format(this.dateFormat),this.customFieldsForProject=this.filterCustomFieldsOfProject(),this.init()}ngAfterViewInit(){this.descriptionInput&&this.entries&&0!==this.entries.length&&this.descriptionInput.nativeElement.focus()}init(){if(!this.entries||!this.entries.length){const e=this.createInterval(this.start,this.row.durationsByDay[this.index]);return this.initTime(e),this.initDesc(""),this.initTags([]),void this.initBillable(this.row.project.billable)}if(1===this.entries.length)return this.initTime(this.entries[0].timeInterval),this.initDesc(this.entries[0].description),this.initTags(this.entries[0].tags),void this.initBillable(this.entries[0].billable);const e=new ep.a({start:this.start,end:this.start,duration:this.row.durationsByDay[this.index]});this.initTime(e),this.setDescriptionForMultipleEntries(),this.setTagsForMultipleEntries(),this.setBillableForMultipleEntries(),setTimeout(()=>{this.getDifferentValues()})}initDesc(e,t){this.descriptionValue=new dw(uw.DESCRIPTION,e,this.workspace.forceDescription,t)}initTags(e,t){this.tagValue=new dw(uw.TAG,e,this.workspace.forceTags,t)}initBillable(e,t){this.billableValue=new dw(uw.BILLABLE,e,!1,t)}initTime(e,t){this.timeValue=new dw(uw.TIME,e,!1,t)}createInterval(e,t){return new ep.a({start:e,end:Se(e).add(t).toISOString(),duration:t||Object(Se.duration)(0)})}setDescriptionForMultipleEntries(){const e=!this.entries.every(e=>e.description===this.entries[0].description);this.initDesc(e?"":this.entries[0].description,e)}setTagsForMultipleEntries(){const e=!this.entries.every(e=>Object(Pt.c)(e.tags.map(e=>e.id),this.entries[0].tags.map(e=>e.id)));this.initTags(e?[]:this.entries[0].tags,e)}setBillableForMultipleEntries(){const e=!this.entries.every(e=>e.billable===this.entries[0].billable);this.initBillable(!e&&this.entries[0].billable,e)}overrideDescription(){this.descriptionValue.different=!1,setTimeout(()=>{this.descriptionInput.nativeElement.focus()})}getDifferentValues(){this.descriptionValue.different&&this.differentValues.push("descriptions"),this.tagValue.different&&this.differentValues.push("tags"),this.billableValue.different&&this.differentValues.push("billable"),this.differentValues.length>0&&(this.differentValues=this.differentValues.join(", ").split(","))}timeChanged(e){this.timeValue.value=e,this.shouldDisableSave()}pickedTime(e){this.timeValue.value=e,this.shouldDisableSave()}closeTagDropdown(e){e&&(this.tagValue.value=e,this.shouldDisableSave())}save(){this.shouldDisableSave(),this.disableSaveButton?this.toastForDisabledSave():setTimeout(()=>{const e=new At.a;e.description=this.descriptionValue.value,e.tags=this.tagValue.value,e.billable=this.billableValue.value,e.project=this.row.project,e.task=this.row.task,e.timeInterval=this.entries&&this.entries.length>1?this.timeValue.value:new ep.a({start:Object(Se.utc)(this.timeValue.value.start),end:Object(Se.utc)(this.timeValue.value.end),duration:this.timeValue.value.duration});const t=[Mp.a.TIMEINTERVAL,Mp.a.CUSTOM_FIELDS];this.descriptionValue.different||t.push(Mp.a.DESCRIPTION),this.tagValue.different||t.push(Mp.a.TAG),this.billableValue.different||t.push(Mp.a.BILLABLE),this.createEntryEmitter.emit({entry:e,entriesToEdit:this.entries,changeFields:t,index:this.index,customFieldValues:this.customFieldsForProject.filter(e=>e.isSameForAll)})})}toastForDisabledSave(){this.disableSaveButton&&this.toaster.pop("error",this.timeValue.invalid&&(this.descriptionValue.invalid||this.tagValue.invalid)?"Can't save without time and required fields.":this.timeValue.invalid?"Can't save without time.":"Can't save without required fields.")}closeEdit(){this.close.emit(!1)}shouldDisableSave(){this.disableSaveButton=this.descriptionValue.invalid||this.tagValue.invalid||this.timeValue.invalid}filterCustomFieldsOfProject(){if(!this.row.project)return this.customFields.filter(e=>e.status===Jd.a.VISIBLE).map(e=>{const t=this.isSameValue(e);return new gp.a({customFieldId:e.id,customField:e,value:t?this.getValue(e):null,isSameForAll:t})});const e=this.customFields.filter(e=>e.status!==Jd.a.VISIBLE&&e.projectDefaultValues.filter(e=>e.projectId===this.row.project.id&&e.status===Jd.a.VISIBLE).length>0);return[...this.customFields.filter(e=>e.status===Jd.a.VISIBLE&&0===e.projectDefaultValues.filter(e=>e.projectId===this.row.project.id&&e.status===Jd.a.INVISIBLE).length),...e].map(e=>{const t=this.isSameValue(e);return new gp.a({customFieldId:e.id,customField:e,value:t?this.getValue(e):null,isSameForAll:t})})}getValue(e){if(this.entries&&this.entries.length>0){const t=this.entries[0].customFieldValues.filter(t=>t.customFieldId===e.id)[0];return t?t.value:null}}isSameValue(e){if(this.entries&&this.entries.length>0){const t=this.entries[0].customFieldValues&&this.entries[0].customFieldValues.filter(t=>t.customFieldId===e.id)[0];return this.entries.every(i=>{const n=i.customFieldValues&&i.customFieldValues.filter(t=>t.customFieldId===e.id)[0];return n&&t&&n.value===t.value})}return!1}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(M.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["edit-time-modal"]],viewQuery:function(e,t){var i;1&e&&c.ed(pw,!0),2&e&&c.Kc(i=c.kc())&&(t.descriptionInput=i.first)},inputs:{row:"row",index:"index",workspace:"workspace",user:"user",dateRange:"dateRange",start:"start",customFields:"customFields"},outputs:{close:"close",createEntryEmitter:"createEntryEmitter"},decls:50,vars:21,consts:[[1,"cl-modal-content"],[1,"cl-modal-header"],["id","exampleModalLabel",1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-pb-2"],[1,"cl-h4"],[1,""],["class","cl-text-gray-9",4,"ngIf"],[1,"cl-row","cl-d-flex","cl-justify-content-between"],[1,"cl-col","cl-d-flex","cl-justify-content-center","cl-w-100"],[1,"cl-border","cl-px-2","cl-max-height-40","cl-rounded",3,"format","focusOnInput","focusOnInit","timeInterval","timeChanged"],["class","cl-col-8 cl-p-0 detailed-report-bulk-edit",4,"ngIf"],["class","cl-alert cl-alert-warning","role","alert",4,"ngIf"],[1,"cl-form-group","cl-row"],["for","descriptionName",1,"cl-col-sm-4","cl-col-form-label","cl-mb-0"],["class","cl-color-red",4,"ngIf"],[1,"cl-col-sm-8","cl-d-flex","cl-align-items-center"],[3,"click",4,"ngIf"],["class","cl-form-control","placeholder","What have you worked on?","name","descriptionName","id","descriptionName","rows","2","autocomplete","off",3,"ngModel","ngModelChange",4,"ngIf"],[1,"cl-col-sm-4","cl-col-form-label","cl-mb-0"],[3,"ngClass"],["class","cl-dropdown","dropdownKey","",4,"ngIf"],[1,"cl-form-group","cl-row","cl-mb-0"],["class","cl-custom-control cl-custom-switch",4,"ngIf"],[4,"ngIf"],["class","cl-form-group cl-row cl-mb-0",4,"ngFor","ngForOf"],[1,"cl-modal-footer"],[3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-text-gray-9"],[1,"cl-col-8","cl-p-0","detailed-report-bulk-edit"],[1,"cl-date-picker-white",3,"debounce","dateTime","mode","pickedDate"],["role","alert",1,"cl-alert","cl-alert-warning"],[1,"cl-color-red"],["placeholder","What have you worked on?","name","descriptionName","id","descriptionName","rows","2","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["descriptionInput",""],["dropdownKey","",1,"cl-dropdown"],["type","button","dropdownKeyButton","",1,"cl-btn","cl-btn-outline-light","cl-w-100","cl-cut-text","cl-text-left","cl-dropdown-toggle"],[4,"ngIf","ngIfElse"],["noTagsTemplate",""],[1,"cl-cut-text-wrapper"],[1,"cl-dropdown"],["class","cl-dropdown-menu","resizeable","",3,"resizeableName","entryTags","close",4,"dropdownKeyContent"],[4,"ngFor","ngForOf"],["resizeable","",1,"cl-dropdown-menu",3,"resizeableName","entryTags","close"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","id","bill-2","name","billable",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","bill-2",1,"cl-custom-control-label"],[1,"cl-col-sm-8","cl-d-flex","cl-align-items-center","cl-cut-text-wrapper"],["class","cl-w-100",4,"ngIf"],[1,"cl-w-100"],[3,"customField"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"h1",2),c.Yc(3,"Edit time"),c.Wb(),c.Xb(4,"button",3),c.jc("click",(function(){return t.closeEdit()})),c.Xb(5,"span"),c.Sb(6,"img",4),c.Wb(),c.Wb(),c.Wb(),c.Xb(7,"div",5),c.Xb(8,"div",6),c.Xb(9,"div",7),c.Yc(10),c.Wb(),c.Xb(11,"div",8),c.Yc(12),c.Wb(),c.Wc(13,hw,2,1,"div",9),c.Wc(14,mw,2,1,"div",9),c.Wb(),c.Sb(15,"hr"),c.Xb(16,"form"),c.Xb(17,"div",10),c.Xb(18,"div",11),c.Xb(19,"input-duration",12),c.jc("timeChanged",(function(e){return t.timeChanged(e)})),c.Wb(),c.Wb(),c.Wc(20,gw,2,3,"div",13),c.Wb(),c.Sb(21,"hr"),c.Wc(22,fw,2,1,"div",14),c.Xb(23,"div",15),c.Xb(24,"label",16),c.Yc(25," Description "),c.Wc(26,vw,2,0,"span",17),c.Wb(),c.Xb(27,"div",18),c.Wc(28,ww,2,0,"a",19),c.Wc(29,yw,2,1,"textarea",20),c.Wb(),c.Wb(),c.Xb(30,"div",15),c.Xb(31,"label",21),c.Yc(32," Tags "),c.Wc(33,Ww,2,0,"span",17),c.Wb(),c.Xb(34,"div",22),c.Wc(35,Cw,2,0,"a",19),c.Wc(36,Xw,8,2,"div",23),c.Wb(),c.Wb(),c.Xb(37,"div",24),c.Xb(38,"label",21),c.Yc(39,"Billable"),c.Wb(),c.Xb(40,"div",18),c.Wc(41,Ew,2,0,"a",19),c.Wc(42,Tw,4,1,"div",25),c.Wb(),c.Wb(),c.Wc(43,Dw,1,0,"hr",26),c.Wc(44,jw,6,3,"div",27),c.Wb(),c.Wb(),c.Xb(45,"div",28),c.Xb(46,"a",29),c.jc("click",(function(){return t.closeEdit()})),c.Yc(47,"Cancel"),c.Wb(),c.Xb(48,"button",30),c.jc("click",(function(){return t.save()})),c.Yc(49," Save "),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(10),c.Zc(t.selectedDate),c.Cb(2),c.ad(" ",t.row.project.name," "),c.Cb(1),c.wc("ngIf",t.row.project.clientName||t.row.project.client),c.Cb(1),c.wc("ngIf",t.row.task&&t.row.task.id),c.Cb(5),c.wc("format",t.durationFormat)("focusOnInput",!0)("focusOnInit",!0)("timeInterval",t.timeValue&&t.timeValue.value),c.Cb(1),c.wc("ngIf",!(t.entries&&t.entries.length>1)),c.Cb(2),c.wc("ngIf",t.descriptionValue.different),c.Cb(4),c.wc("ngIf",t.workspace.forceDescription),c.Cb(2),c.wc("ngIf",t.descriptionValue.different),c.Cb(1),c.wc("ngIf",!t.descriptionValue.different),c.Cb(4),c.wc("ngIf",t.workspace.forceTags),c.Cb(1),c.wc("ngClass",t.tagValue.different?"cl-col-sm-8 cl-d-flex cl-align-items-center":"cl-col-sm-8"),c.Cb(1),c.wc("ngIf",t.tagValue.different),c.Cb(1),c.wc("ngIf",!t.tagValue.different),c.Cb(5),c.wc("ngIf",t.billableValue.different),c.Cb(1),c.wc("ngIf",!t.billableValue.different),c.Cb(1),c.wc("ngIf",(null==t.customFieldsForProject?null:t.customFieldsForProject.length)>0),c.Cb(1),c.wc("ngForOf",t.customFieldsForProject))},directives:[s.u,p.I,p.t,p.u,qp.a,s.r,s.t,so.a,p.c,p.s,p.v,Si.a,Ii.a,Oi.a,zp.a,Hp.a,p.a,Sm.a],encapsulation:2}),e})();const Pw=["rowComponent"];function Mw(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",37),c.Yc(1),c.oc(2,"stringDurationToTime"),c.Xb(3,"a",38),c.jc("click",(function(){return c.Oc(e),c.nc().fixEntriesWithoutProject()})),c.Yc(4,"Fix"),c.Wb(),c.Xb(5,"button",39),c.jc("click",(function(){return c.Oc(e),c.nc().closeEntriesAlert()})),c.Xb(6,"span"),c.Yc(7,"\xd7"),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.bd(" ",e.entriesAlert," (",c.qc(2,2,e.entriesWithoutTaskTotal,e.format),") without required fields. ")}}function Yw(e,t){1&e&&(c.Xb(0,"span",42),c.Sb(1,"img",43),c.Wb()),2&e&&c.wc("ngbTooltip","Fix timezone mismatch to see approval status")}function Lw(e,t){1&e&&(c.Xb(0,"span",47),c.Yc(1,"Approved"),c.Wb())}function Fw(e,t){if(1&e){const e=c.Yb();c.Xb(0,"span",49),c.Yc(1," Pending approval "),c.Xb(2,"span",50),c.jc("click",(function(){c.Oc(e);const t=c.nc(4),i=c.Lc(49);return t.openModal(i)})),c.Yc(3," \u2715 "),c.Wb(),c.Wb()}}function Nw(e,t){if(1&e&&c.Wc(0,Fw,4,0,"span",48),2&e){const e=c.nc(3);c.wc("ngIf",e.approvalRequestId)}}function Uw(e,t){if(1&e&&(c.Xb(0,"div",44),c.Wc(1,Lw,2,0,"span",45),c.Wc(2,Nw,1,1,"ng-template",null,46,c.Xc),c.Wb()),2&e){const e=c.Lc(3),t=c.nc(2);c.Cb(1),c.wc("ngIf",t.isApproved)("ngIfElse",e)}}function $w(e,t){if(1&e&&(c.Vb(0),c.Wc(1,Yw,2,1,"span",40),c.Wc(2,Uw,4,2,"div",41),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.timeZoneMissmatch),c.Cb(1),c.wc("ngIf",!e.timeZoneMissmatch)}}function _w(e,t){if(1&e&&(c.Xb(0,"button",51),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.selectedUser.id===e.user.id?"Teammates":e.selectedUser.name," ")}}function Gw(e,t){if(1&e){const e=c.Yb();c.Xb(0,"teammate-picker",52),c.jc("userSelected",(function(t){return c.Oc(e),c.nc().selectUser(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("user",e.user)("hasAddTimeForOthersFeature",e.hasAddTimeForOthersFeature)("selectedUser",e.selectedUser)("showSelectedAsActive",!0)}}function Bw(e,t){1&e&&c.Sb(0,"img",53)}function Vw(e,t){1&e&&c.Sb(0,"img",54)}function Hw(e,t){if(1&e&&(c.Xb(0,"span",64),c.Yc(1),c.oc(2,"stringDurationToTime"),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.Zc(c.qc(2,1,e.total,e.format))}}function zw(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",65),c.jc("click",(function(){c.Oc(e);const t=c.nc(2);return t.expandAll=!t.expandAll})),c.Xb(1,"span",66),c.Sb(2,"img",67),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(2),c.wc("src",e.expandAll?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",c.Qc)}}function qw(e,t){if(1&e&&(c.Xb(0,"th",71),c.Xb(1,"span",72),c.Yc(2),c.Wb(),c.Wb()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e)}}function Kw(e,t){if(1&e&&(c.Vb(0),c.Wc(1,qw,3,1,"th",68),c.Xb(2,"th",69),c.Xb(3,"span",70),c.Yc(4,"Total:"),c.Wb(),c.Wb(),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngForOf",e.week)}}function Zw(e,t){if(1&e){const e=c.Yb();c.Xb(0,"tr",73,74),c.jc("delete",(function(){c.Oc(e);const i=t.$implicit,n=c.nc(2),s=c.Lc(43);return n.openDeleteRowModal(i,s)}))("changeDuration",(function(i){c.Oc(e);const n=t.$implicit;return c.nc(2).changeInputDuration(n,i.index,i.duration)}))("selectedProjectAndTask",(function(i){c.Oc(e);const n=t.$implicit;return c.nc(2).changeProject(i,n)}))("preventOpenPickerOnTab",(function(){return c.Oc(e),c.nc(2).preventOpeningPicker()}))("openNextPicker",(function(i){c.Oc(e);const n=t.index;return c.nc(2).openNextRowPicker(i,n)}))("focusedRow",(function(t){return c.Oc(e),c.nc(2).focusedRow(t)}))("openModalEmitter",(function(t){c.Oc(e);const i=c.nc(2),n=c.Lc(45);return i.openEditModal(t,n)})),c.Wb()}if(2&e){const e=t.$implicit,i=t.index,n=c.nc(2);c.wc("timesheetRow",e)("week",n.week)("format",n.format)("isAdminOrOwner",n.isAdminOrOwner)("dateRange",n.dateRange)("workspace",n.workspace)("projectPickerSpecialFilter",n.projectPickerSpecialFilter)("isDesktop",n.isDesktop)("timesheetRows",n.timesheetRows)("selectedUser",n.selectedUser)("isTeamManagerSelectUser",n.isTeamManager&&n.user.id!==n.selectedUser.id)("expandAll",n.expandAll)("userGroups",n.userGroups)("index",i)("disableManualMode",n.disableManualMode)}}function Qw(e,t){if(1&e&&c.Sb(0,"tr",75),2&e){const e=c.nc(2);c.wc("week",e.week)("format",e.format)("totalList",e.totalList)("total",e.total)("isDesktop",e.isDesktop)("expandAll",e.expandAll)}}function Jw(e,t){if(1&e&&(c.Xb(0,"table",55),c.Xb(1,"thead",56),c.Xb(2,"tr"),c.Xb(3,"th",57),c.Xb(4,"div",58),c.Xb(5,"span"),c.Yc(6,"Projects"),c.Wb(),c.Xb(7,"div",59),c.Wc(8,Hw,3,4,"span",60),c.Wc(9,zw,3,1,"a",61),c.Wb(),c.Wb(),c.Wb(),c.Wc(10,Kw,5,1,"ng-container",7),c.Wb(),c.Wb(),c.Xb(11,"tbody"),c.Wc(12,Zw,2,15,"tr",62),c.Wc(13,Qw,1,6,"tr",63),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Hb("cl-compact",e.isCompactViewOn),c.Cb(8),c.wc("ngIf",!e.isDesktop),c.Cb(1),c.wc("ngIf",!e.isDesktop),c.Cb(1),c.wc("ngIf",e.isDesktop),c.Cb(2),c.wc("ngForOf",e.timesheetRows),c.Cb(1),c.wc("ngIf",e.totalList)}}function ey(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",76),c.jc("click",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(47);return t.openModal(i)})),c.Yc(1," Submit for approval "),c.Wb()}}function ty(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",81),c.Xb(1,"template-row",82),c.jc("templateApplied",(function(){c.Oc(e);const i=t.$implicit;return c.nc(2).applyTemplate(i)}))("templateEdited",(function(i){c.Oc(e);const n=t.$implicit,s=t.index;return c.nc(2).editTemplate(n,s,i)}))("templateDeleted",(function(){c.Oc(e);const i=t.$implicit;return c.nc(2).deleteTemplate(i)})),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit,i=c.nc(2);c.Cb(1),c.wc("template",e)("hasEntries",i.hasEntries)("disableManualMode",i.disableManualMode)}}function iy(e,t){if(1&e&&(c.Xb(0,"div",77),c.Xb(1,"div",78),c.Xb(2,"span",79),c.Yc(3,"Templates"),c.Wb(),c.Wb(),c.Wc(4,ty,2,3,"div",80),c.Wb()),2&e){const e=c.nc();c.Cb(4),c.wc("ngForOf",e.savedTemplates)}}function ny(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",83),c.Xb(1,"h1",84),c.Yc(2,"Create template"),c.Wb(),c.Xb(3,"button",39),c.jc("click",(function(){return c.Oc(e),c.nc().closeModal()})),c.Xb(4,"span"),c.Sb(5,"img",85),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",86),c.Xb(7,"form"),c.Xb(8,"div",87),c.Xb(9,"label",88),c.Yc(10,"Template name"),c.Wb(),c.Xb(11,"div",89),c.Xb(12,"input",90),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().newTemplateName=t}))("keyup.enter",(function(){c.Oc(e);const t=c.nc();return t.saveTemplate(t.newTemplateName)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(13,"div",91),c.Xb(14,"a",92),c.jc("click",(function(){return c.Oc(e),c.nc().closeModal()})),c.Yc(15,"Cancel"),c.Wb(),c.Xb(16,"button",93),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.saveTemplate(t.newTemplateName)})),c.Yc(17," Save "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(12),c.wc("ngModel",e.newTemplateName),c.Cb(4),c.wc("disabled",""===e.newTemplateName.trim())}}function sy(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",83),c.Xb(1,"h1",84),c.Yc(2,"Delete"),c.Wb(),c.Xb(3,"button",39),c.jc("click",(function(){return c.Oc(e),c.nc().closeModal()})),c.Xb(4,"span"),c.Sb(5,"img",85),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",86),c.Xb(7,"p"),c.Yc(8,"Are you sure you want to delete this row?"),c.Wb(),c.Xb(9,"p",94),c.Yc(10,"If you delete, it will also delete all time entries with this project/task for this week."),c.Wb(),c.Wb(),c.Xb(11,"div",91),c.Xb(12,"a",92),c.jc("click",(function(){return c.Oc(e),c.nc().closeModal()})),c.Yc(13,"Cancel"),c.Wb(),c.Xb(14,"button",95),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.removeRow(t.selectedRow)})),c.Yc(15," Delete "),c.Wb(),c.Wb()}}function cy(e,t){if(1&e){const e=c.Yb();c.Xb(0,"edit-time-modal",96),c.jc("close",(function(i){c.Oc(e);const n=t.$implicit,s=c.nc();return n.close(i),s.closeEditModal()}))("createEntryEmitter",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().createOrUpdateFromBulk(i,n)})),c.Wb()}if(2&e){const e=c.nc();c.wc("row",e.selectedTSR)("index",e.index)("workspace",e.workspace)("user",e.user)("dateRange",e.dateRange)("start",e.startForModal)("customFields",e.customFields)}}function ry(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",97),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().submitApproval(i)}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Xb(1,"p",98),c.Yc(2),c.oc(3,"momentUtcFormat"),c.oc(4,"momentUtcFormat"),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Submit week for approval")("btnText","Submit")("inProgress",e.inProgress),c.Cb(2),c.bd(" Ready to submit ",c.qc(3,5,e.dateRange.start.toISOString(),"MMM D")," - ",c.qc(4,8,e.dateRange.end.toISOString(),"MMM D")," for approval? ")}}function oy(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",97),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().withdrawApproval(i)}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Xb(1,"p",98),c.Yc(2," If you withdraw, admin won't be able to approve your time unless you submit it again. "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Withdraw submission")("btnText","Withdraw")("inProgress",e.inProgress)}}let ay=(()=>{class e{constructor(e,t,i,n,s,c,r,o,a,l,b,u,d,p,h,m,g,f,v){this.workspaceService=e,this.approvalService=t,this.notificationService=i,this.authService=n,this.timezoneConverter=s,this.systemSettingsService=c,this.toaster=r,this.trackerService=o,this.tracker2Service=a,this.browserService=l,this.projectService=b,this.userService=u,this.userGroupService=d,this.taskService=p,this.tagService=h,this.cd=m,this.router=g,this.modalService=f,this.customFieldService=v,this.newTemplateName="",this.timesheetRows=[],this.savedRows=[],this.zoomLevel="week",this.entriesAlert="",this.pickerNeverOpened=!0,this.customFields=[],this.unsubscribe$=new mi.a}ngOnInit(){this.subscribeToBrowserWidth(),this.subscribeToWorkspace(),this.user=this.authService.getUser(),this.projectPickerSpecialFilter=this.user.settings.projectPickerSpecialFilter,this.selectedUser=this.user,this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.timeZone=this.user.settings.timeZone,this.dateRange=Object(ws.c)(this.user.settings.weekStart,this.timezoneConverter),this.format=this.workspace.getTimeFormat(),this.isCompactViewOn=this.user.settings.isCompactViewOn,this.hasAddTimeForOthersFeature=this.workspace.hasFeature(nr.a.ADD_TIME_FOR_OTHERS);const e=this.workspace.hasFeature(nr.a.CUSTOM_FIELDS);e&&this.customFieldService.get().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.customFields=e,this.cd.detectChanges()}),this.tracker2Service.savedTemplates.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.savedTemplates=e,this.checkIfShouldShowTemplates(),this.cd.detectChanges()}),this.tracker2Service.newTemplate.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.savedTemplates.push(e),this.checkIfShouldShowTemplates(),this.cd.detectChanges()}),this.userGroupService.userGroups.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.userGroups=e,this.cd.detectChanges()}),e&&this.customFieldService.get().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.customFields=e,this.cd.detectChanges()}),this.notificationService.timeZoneMissmatch$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.timeZoneMissmatch=e,this.cd.markForCheck()}),this.makeWeek(),this.tagService.clearTagsSubject(),this.systemSettingsService.getSystemSettings(),this.tracker2Service.getTemplates(),this.userGroupService.getAllUserGroups()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}get showSubmitForAll(){var e,t,i,n;return!this.timeZoneMissmatch&&(null===(e=this.timeEntries)||void 0===e?void 0:e.length)&&(null===(t=this.selectedUser)||void 0===t?void 0:t.id)===(null===(i=this.user)||void 0===i?void 0:i.id)&&(null===(n=this.workspace)||void 0===n?void 0:n.timeApprovalEnabled)&&!this.isApproved&&!this.approvalRequestId}subscribeToWorkspace(){this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,this.disableManualMode=this.workspace.disableManualMode,this.subscribeToUserRolesOnce()})}subscribeToUserRolesOnce(){this.authService.isUserAdminOnWorkspace(this.workspace.id).pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isTeamManager=e.isTeamManager,this.cd.detectChanges()})}subscribeToBrowserWidth(){this.browserService.isBreakpointLg$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.detectChanges()})}updateDateRange(e){this.dateRange&&!Object(uv.a)(e.dateRange,this.dateRange)&&(this.dateRange.start=e.dateRange.start,this.dateRange.end=e.dateRange.end,this.dateRange.label=e.dateRange.label,this.zoomLevel=e.zoomLevel,this.makeWeek()),this.makeAllTemplatesInactive()}makeWeek(){const e=Se.utc(this.dateRange.start);this.week=[],this.week.push(Se(e).format("dd, MMM D"));for(let t=1;t<7;t++)this.week.push(Se(e).add(t,"days").format("dd, MMM D"));this.getTimeEntriesInRange(this.selectedUser.id,e,this.dateRange.end)}getTimeEntriesInRange(e,t,i){const n=this.tracker2Service.getTimeEntriesForTimesheet(e,t.toISOString(),i.toISOString());let s;if(this.workspace.timeApprovalEnabled&&this.selectedUser.id===this.user.id){const e=this.dateRange.start.toISOString(),t=Se.utc(this.dateRange.start).format("YYYY-MM-DD");s=Object(la.a)(n,this.approvalService.getWeekStatus(e,t))}else s=Object(la.a)(n),this.approvalRequestId=null;s.pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(([e,t])=>{this.approvalRequestId=null==t?void 0:t.id,this.isApproved=e.length&&e.every(e=>!!e.approvalRequestId),this.timeEntries=e,this.timesheetRows=[],this.entriesWithoutTaskCount=0,this.entriesWithoutTaskTotal=Object(Se.duration)(0),this.fillTimesheetWithEntries(e.filter(e=>e.approvalRequestId),!0),this.fillTimesheetWithEntries(e.filter(e=>!e.approvalRequestId),!1),this.isMe()&&this.addFromSavedRows(),this.sortTimesheetRowsByName(),this.calculateTotals(),this.isApproved||this.disableManualMode||this.addRow(),this.cd.detectChanges()})}refreshIsApproved(){this.workspace.timeApprovalEnabled&&(this.isApproved=this.timeEntries.length&&this.timeEntries.every(e=>!!e.approvalRequestId),this.cd.markForCheck())}fillTimesheetWithEntries(e,t){e.forEach(e=>{if(null===e.timeInterval.end)return;if(!(this.workspace.forceTasks?e.project&&e.task:e.project))return this.entriesWithoutTaskCount++,void(this.entriesWithoutTaskTotal=Object(Se.duration)(this.entriesWithoutTaskTotal).add(Object(Se.duration)(e.timeInterval.duration)));const i=Object(Se.utc)(e.timeInterval.start).clone().add(Se(Object(Se.utc)(e.timeInterval.start)).tz(this.timeZone).utcOffset(),"minutes").startOf("day").diff(this.dateRange.start.clone(),"day"),n=this.timesheetRows.filter(t=>this.areProjectAndTaskTheSame(t.project,t.task,e.project,e.task)).filter(e=>e.isApproved===t)[0];if(!n){const n=[],s=[];return n[i]=Object(Se.duration)(e.timeInterval.duration),s[i]=[e],void this.timesheetRows.push(new hv.a(e.project,e.task,n,s,t))}n.durationsByDay[i]||(n.durationsByDay[i]=Object(Se.duration)(0),n.entries[i]=[]),n.durationsByDay[i]=Object(Se.duration)(n.durationsByDay[i]).add(Object(Se.duration)(e.timeInterval.duration)),n.entries[i]=[...n.entries[i],e]}),this.entriesAlert=this.entriesWithoutTaskCount>0?1===this.entriesWithoutTaskCount?"There is 1 additional time entry":"There are "+this.entriesWithoutTaskCount+" additional time entries":""}addFromSavedRows(){const e=this.getSavedRows();e&&(this.savedRows=e.filter(e=>e.date===this.dateRange.start.clone().toISOString()),this.savedRows.length&&this.savedRows.forEach(e=>{this.timesheetRows.filter(t=>this.areProjectAndTaskTheSame(t.project,e.project,t.task,e.task)).length||this.timesheetRows.push(new hv.a(e.project,e.task,[],[]))}))}addRow(){this.timesheetRows.push(new hv.a(null,null,[],[]))}removeRow(e){(e.project||1!==this.timesheetRows.filter(e=>!e.project).length)&&(this.removeDependingOnData(e),this.makeAllTemplatesInactive())}removeDependingOnData(e){if(e.project){if(!e.entries.length&&this.isMe())return this.removeFromSavedRows(e.project,e.task),void this.timesheetRows.splice(this.timesheetRows.indexOf(e),1);e.entries.length&&(e.entries.every(e=>e.every(e=>!e.isLocked))||this.isAdminOrOwner?this.removeWholeRow(e):this.removeUnlockedEntriesFromRow(e))}else this.timesheetRows.splice(this.timesheetRows.indexOf(e),1)}removeWholeRow(e){const t=[].concat(...e.entries.filter(e=>e&&!!e.length));0!==t.length?this.tracker2Service.deleteMany(t.map(e=>e.id),this.selectedUser.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.timesheetRows.splice(this.timesheetRows.indexOf(e),1),this.deleteEntries(t),this.refreshIsApproved(),this.calculateTotals(),this.closeModal()},()=>{this.closeModal()}):this.closeModal()}removeUnlockedEntriesFromRow(e){const t=hv.a.clone(e),i=this.timezoneConverter.addOffsetToUTCTime(this.dateRange.start.clone()),n=this.timezoneConverter.addOffsetToUTCTime(Se(this.workspace.lockTimeEntries).clone()),s=Se(n).startOf("day").diff(Se(i).startOf("day"),"days"),c=[].concat(...e.entries.slice(s,7).filter(e=>e&&!!e.length));0!==c.length?this.tracker2Service.deleteMany(c.map(e=>e.id),this.selectedUser.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.deleteEntries(t),e.entries.fill([],s,7),e.durationsByDay.fill(null,s,7),this.closeModal(),this.formatRowDurations(e),this.calculateTotals()},()=>{e=t,this.closeModal()}):this.closeModal()}createEntry(e,t,i,n){e.billable=this.decideBillability(e),this.tracker2Service.createForUser(e,this.selectedUser.id,n||[],this.approvalRequestId?{message:"Time successfully submitted."}:null).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.addEntryToTimesheet(e,t,i),this.closeEditModal(),this.isMe()&&this.removeFromSavedRows(t.project,t.task),this.refreshIsApproved()},e=>this.cd.detectChanges())}updateEntries(e,t,i){this.tracker2Service.updateMany(e,this.selectedUser.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.replaceEntriesInRow(t,i,e),this.closeEditModal()})}bulkEdit(e,t,i,n,s,c){this.tracker2Service.updateGroup(n,s,i,c).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.getAllEntries(),this.closeEditModal()})}updateOne(e,t,i,n,s){const c=e.entries[t].map(e=>e.id);this.tracker2Service.updateGroup(c,n,i,s).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.updateRow(e,t,[i],Object(Se.duration)(i.timeInterval.duration)),this.closeEditModal()})}updateMultiple(e,t,i,n,s,c){const r=Object(Se.duration)(i).subtract(Object(Se.duration)(e.durationsByDay[t])),o=s&&1===s.length&&s[0]===Mp.a.TIMEINTERVAL;r.asSeconds()<0?this.subtractAndUpdate(e,t,r,n,s,c):(o||this.bulkEdit(e,t,n,e.entries[t].map(e=>e.id),s.filter(e=>e!==Mp.a.TIMEINTERVAL),c||[]),r.asSeconds()>0&&(n.timeInterval=new ep.a({start:n.timeInterval.start,end:Se(n.timeInterval.start).add(r).toISOString(),duration:r}),n.billable=this.decideBillability(n),this.createEntry(n,e,t,c||[])))}subtractAndUpdate(e,t,i,n,s,c){const r=e.entries[t];r.sort(Object(Ss.a)(e=>Se(e.timeInterval.start).unix(),!0)),this.updateEntries(this.subtractFromEntries(r,i,n,s,c),e,t)}subtractFromEntries(e,t,i,n,s){const c=[...e],r=[];let o=0;for(;t.asSeconds()<0;){const i=Object(Se.duration)(e[o].timeInterval.duration);i.asSeconds()>0-t.asSeconds()?(c[o].timeInterval.duration=Object(Se.duration)(e[o].timeInterval.duration).add(t).toISOString(),c[o].timeInterval.end=Se(c[o].timeInterval.end).add(t).toISOString()):(c[o].timeInterval.duration=Object(Se.duration)(0).toISOString(),c[o].timeInterval.end=e[o].timeInterval.start),r.push(c[o]),t=t.add(i),o++}return i?this.applyChangesToEntries(r,i,n,s):r}changeProject(e,t){t.entries&&t.entries.length||!this.isMe()?this.changeProjectOfRowWithEntries(t,e):this.changeProjectOfRowWithoutEntries(t,e)}changeProjectOfRowWithoutEntries(e,t){e.project=t.project,e.task=t.task,this.removeFromSavedRows(e.project,e.task),this.addToSavedRows(t.project,t.task),this.timesheetRows.every(e=>!!e.project)&&this.addRow()}changeProjectOfRowWithEntries(e,t){const i=[].concat(...e.entries.filter(e=>!!e)),n=new pc.a;n.projectId=t.project&&t.project.id,n.taskId=t.task&&t.task.id,n.billable=this.decideBillability(t);const s=i.map(e=>e.id);this.tracker2Service.updateGroup(s,[Mp.a.PROJECT,Mp.a.TASK,Mp.a.BILLABLE],n).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{e.project=t.project,e.task=t.task,e.entries.forEach(e=>{e.forEach(e=>{e.project=t.project,e.task=t.task,e.billable=this.decideBillability(e)})}),this.timesheetRows.every(e=>!!e.project)&&this.addRow(),this.timeEntries=[...this.timeEntries.filter(e=>-1===s.indexOf(e.id)),...[].concat(...e.entries.filter(e=>!!e))],this.timesheetRows=[...this.timesheetRows],this.cd.detectChanges()},e=>{this.getAllEntries()})}updateRow(e,t,i,n){e.entries[t]=i,e.durationsByDay[t]=n;const s=i.map(e=>e.id);this.timeEntries=[...this.timeEntries.filter(e=>-1===s.indexOf(e.id)),...i],this.formatRowDurations(e),this.calculateTotals()}changeInputDuration(e,t,i){if(Object(Se.duration)(i).asSeconds()===Object(Se.duration)(0).asSeconds())return void this.removeEntries(e,t);if(0===Object(Se.duration)(i).subtract(Object(Se.duration)(e.durationsByDay[t])).asSeconds())return;const n=this.getStartTimeFromEntries(t);if(e.entries[t]&&1===e.entries[t].length){const n=e.entries[t][0];return n.timeInterval=new ep.a({start:n.timeInterval.start,end:Se(n.timeInterval.start).add(Object(Se.duration)(i)).toISOString(),duration:Object(Se.duration)(i)}),void this.updateOne(e,t,n,[Mp.a.TIMEINTERVAL])}if(!e.entries[t]||!e.entries[t].length){const s=this.createEntryFromTimesheet(e,n,i);return void this.createEntry(new At.a(s,e.project,e.task,this.selectedUser),e,t)}const s=e.entries[t][0],c=s.customFieldValues&&s.customFieldValues.length?s.customFieldValues.map(e=>new gp.a(e)):[];this.updateMultiple(e,t,i,new At.a(s,e.project,e.task,this.selectedUser),[Mp.a.TIMEINTERVAL],c)}createOrUpdateFromBulk(e,t){this.openedModal=t;const i=e.entry,n=e.entriesToEdit,s=e.customFieldValues;if(i.description=i.description.split("\n").join("\n "),n&&0!==n.length)return 1===n.length?(i.id=n[0].id,void this.updateOne(this.selectedTSR,e.index,i,e.changeFields,s)):void this.updateMultiple(this.selectedTSR,e.index,i.timeInterval.duration,i,e.changeFields,s);this.createEntry(i,this.selectedTSR,e.index,s)}removeEntries(e,t){if(!e.entries[t]||!e.entries[t].length)return;const i=hv.a.clone(e);this.tracker2Service.deleteMany(e.entries[t].map(e=>e.id),this.selectedUser.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(i=>{this.deleteEntries(i),e.entries[t]=[],e.durationsByDay[t]=null,this.formatRowDurations(e),this.refreshIsApproved(),this.calculateTotals()},()=>{e=i})}getStartTimeFromEntries(e){const t=(i=this.timeZone,n=this.week[e],this.timeEntries.filter(e=>Se.tz(e.timeInterval.start,i).format("dd, MMM D")===n&&null!==e.timeInterval.end));var i,n;if(0===t.length)return this.getStartTimeFromSettings(e);const s=t.map(e=>Se(e.timeInterval.start).unix()),c=t[s.indexOf(Math.max(...s))].timeInterval.end;return Se(c).format("dd, MMM D")!==this.week[e]?this.getStartTimeFromSettings(e):c}getStartTimeFromSettings(e){const t=this.authService.getUser().settings.myStartOfDay,i=this.dateRange.start.clone().add(e,"day").add(1,"hour"),n=Se(t,"hh:mm"),s=Object(Se.utc)(Se(i.clone())).set("hour",n.hour()).set("minutes",n.minutes());return Se(s.clone().subtract(Se(Object(Se.utc)()).tz(this.timeZone).utcOffset(),"minutes")).toISOString()}addToSavedRows(e,t){this.savedRows=this.getSavedRows(),this.savedRows.push(new fv(this.dateRange.start.toISOString(),e,t)),this.setSavedRows(this.savedRows)}addMultipleToSavedRows(e){this.savedRows=this.getSavedRows(),this.savedRows=[...this.savedRows,...e.map(e=>new fv(this.dateRange.start.toISOString(),e.project,e.task))],this.setSavedRows(this.savedRows)}removeFromSavedRows(e,t){this.savedRows=this.getSavedRows();const i=this.savedRows.filter(i=>i.date!==this.dateRange.start.toISOString()||!this.areProjectAndTaskTheSame(i.project,i.task,e,t)).map(e=>new fv(e.date,e.project,e.task));this.setSavedRows(i)}removeSavedRowsFromThisWeek(){this.savedRows=this.getSavedRows();const e=this.savedRows.filter(e=>e.date!==this.dateRange.start.toISOString()).map(e=>new fv(e.date,e.project,e.task));this.setSavedRows(e)}saveTemplate(e){if(!this.isNameValid(e))return void this.throwTemplateErrorToast();const t=[];this.timesheetRows.forEach(e=>{e.project&&t.push(new pv({task:e.task?e.task.id:null,project:e.project.id}))}),this.tracker2Service.saveTemplate(t,e),this.closeModal()}applyTemplate(e){this.hasEntries||(this.isMe()&&this.removeSavedRowsFromThisWeek(),this.savedTemplates.forEach(t=>t.isActive=t.id===e.id),this.timesheetRows=e.projectsAndTasks.map(e=>new hv.a(e.project,e.task,[],[])),this.isMe()&&this.addMultipleToSavedRows(e.projectsAndTasks.map(e=>new wv.a(e.task,e.project))),this.sortTimesheetRowsByName(),this.addRow())}editTemplate(e,t,i){this.template=e,this.isNameValid(i)?this.tracker2Service.editTemplateName(this.template.id,i).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.template.name=i,this.savedTemplates[t]=this.template,this.closeModal()}):this.throwTemplateErrorToast(this.template.id)}deleteTemplate(e){this.tracker2Service.deleteTemplate(e.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.savedTemplates.splice(this.savedTemplates.indexOf(e),1),this.checkIfShouldShowTemplates(),this.closeModal()})}isNameValid(e){return e&&!!e.trim()&&this.savedTemplates.every(t=>t.name.toLowerCase()!==e.toLowerCase())}throwTemplateErrorToast(e){this.toaster.pop("error","Template not "+(e?"edited":"created"),"Template must have a name.")}openDeleteRowModal(e,t){this.selectedRow=e,e.entries&&e.entries.length?this.openModal(t):this.removeRow(e)}openModal(e){this.modalService.open(e,{centered:!0})}closeModal(){this.modalService.dismissAll(),this.newTemplateName="",this.template=null,this.cd.detectChanges()}submitApproval(e){this.inProgress=!0;const t=Se.utc(this.dateRange.start).format("YYYY-MM-DD");this.approvalService.createSubmitRequest(t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.approvalRequestId=t.id,this.inProgress=!1,e.close(),this.cd.detectChanges()},()=>{this.inProgress=!1})}withdrawApproval(e){this.inProgress=!0,this.approvalService.withdrawSubmission(this.approvalRequestId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.approvalRequestId=null,this.inProgress=!1,e.close(),this.cd.detectChanges()},()=>{this.inProgress=!1})}calculateTotals(){this.totalList=[],this.total=Object(Se.duration)(0),this.timesheetRows.forEach(e=>{e.durationsByDay.forEach((e,t)=>{this.totalList[t]||(this.totalList[t]=Object(Se.duration)(0)),this.totalList[t]=Object(Se.duration)(this.totalList[t]).add(Object(Se.duration)(e)),this.total=Object(Se.duration)(this.total).add(Object(Se.duration)(e))})}),this.checkIfHasEntries(),this.cd.detectChanges()}makeAllTemplatesInactive(){this.savedTemplates&&(this.savedTemplates.map(e=>e.isActive=!1),this.cd.detectChanges())}checkIfHasEntries(){this.hasEntries=this.timesheetRows.some(e=>e.project&&!!e.entries.length),this.cd.detectChanges()}areProjectAndTaskTheSame(e,t,i,n){return!((e&&e.id)!==(i&&i.id)||(t&&t.id||n&&n.id)&&(t&&t.id)!==(n&&n.id))}copyLastWeek(){this.tracker2Service.getWeekBeforeEntries(this.selectedUser.id,this.dateRange.start.toISOString()).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{if(!e.length)return;this.timesheetRows=[];const t=new Map;e.forEach(e=>{if(e.project){const i=e.project.id+(e.task&&e.task.id||"");t.get(i)||(t.set(i,new hv.a(e.project,e.task,[],[])),this.timesheetRows.push(new hv.a(e.project,e.task,[],[])))}}),this.sortTimesheetRowsByName(),this.isMe()&&e.length&&this.addMultipleToSavedRows(this.timesheetRows.map(e=>new wv.a(e.task,e.project))),this.addRow(),this.cd.detectChanges()})}selectUser(e){this.selectedUser=e,this.getTimeEntriesInRange(this.selectedUser.id,this.dateRange.start,this.dateRange.end),this.checkIfShouldShowTemplates(),this.isMe()||this.toaster.pop("success","Switched to "+e.name+"'s timesheet")}toggleCompactView(){this.isCompactViewOn=!this.isCompactViewOn,this.userService.updateCompactViewSettings(this.isCompactViewOn)}isEmptyTimesheet(){return this.timesheetRows.every(e=>!e.project)}isMe(){return this.user.id===this.selectedUser.id}checkIfShouldShowTemplates(){this.showTemplates=this.savedTemplates&&this.savedTemplates.length>0&&this.isMe()}closeEntriesAlert(){this.entriesAlert=""}deleteEntries(e){const t=e.map(e=>e.id);this.timeEntries=this.timeEntries.filter(e=>-1===t.indexOf(e.id))}openNextRowPicker(e,t){this.timesheetRows&&this.timesheetRows.length===t+1&&this.addRow(),setTimeout(()=>{const e=this.rows.find(e=>e&&e.index==t+1);e&&e.openProjectPicker()})}openFirstPicker(){const e=this.rows.first;e&&e.openProjectPicker()}onKeyboard(e){const t=e.keyCode?e.keyCode:e.which;if(t===ya.i&&this.pickerNeverOpened)this.openFirstPicker(),this.pickerNeverOpened=!1;else if(t===ya.a&&"time-duration"===document.activeElement.parentElement.tagName.toLowerCase()){const e=this.getTimesheetRowByIndex(this.focusedIndex+1);e&&e.openProjectPicker()}}preventOpeningPicker(){this.pickerNeverOpened=!1}focusedRow(e){this.focusedIndex=e,this.preventOpeningPicker()}fixEntriesWithoutProject(){const e=this.dateRange.start.toISOString(),t=this.dateRange.end.toISOString();this.router.navigate(["reports","detailed"],{queryParams:{start:e,end:t,filterValuesData:JSON.stringify({[dn.j]:[this.selectedUser.id],[dn.h.PROJECTS]:[dv.b]})}})}formatRowDurations(e){const t=this.timesheetRows.filter(t=>t.isApproved===e.isApproved&&this.areProjectAndTaskTheSame(t.project,t.task,e.project,e.task))[0]||null;t&&this.getTimesheetRowByIndex(this.timesheetRows.indexOf(t)).getFormattedDurations()}getTimesheetRowByIndex(e){return this.rows.find(t=>t&&t.index==e)}sortTimesheetRowsByName(){this.timesheetRows.sort(Object(Ss.c)(e=>e.project.name.toLowerCase(),!1))}openEditModal(e,t){if(this.selectedTSR=e.timesheetRow,this.index=e.index,this.selectedTSR.entries[this.index]&&1===this.selectedTSR.entries[this.index].length)return this.startForModal=this.selectedTSR.entries[this.index][0].timeInterval.start,void this.modalService.open(t,{centered:!0});this.startForModal=this.getStartTimeFromEntries(this.index),this.modalService.open(t,{centered:!0})}getAllEntries(){this.getTimeEntriesInRange(this.selectedUser.id,Se.utc(this.dateRange.start),Se.utc(this.dateRange.end))}addEntryToTimesheet(e,t,i){this.timeEntries.push(e),t.entries[i]&&t.entries[i].length||(t.entries[i]=[],t.durationsByDay[i]=Object(Se.duration)(0)),t.entries[i].push(e),t.durationsByDay[i]=t.durationsByDay[i].add(e.timeInterval.duration),this.calculateTotals(),this.formatRowDurations(t)}replaceEntriesInRow(e,t,i){const n=i.map(e=>e.id);this.timeEntries=[...this.timeEntries.filter(e=>-1===n.indexOf(e.id)),...i],e.entries[t]=[...e.entries[t].filter(e=>-1===n.indexOf(e.id)),...i],e.durationsByDay[t]=Object(yv.a)(e.entries[t].map(e=>e.timeInterval.duration)),this.calculateTotals(),this.formatRowDurations(e)}closeEditModal(){this.openedModal&&(this.pickerNeverOpened=!1,this.openedModal.close(),this.openedModal=null)}getSavedRows(){const e=JSON.parse(localStorage.getItem("savedRows"))||[];return e.length?e.map(e=>new fv(e.date,new mv.a(e.project),e.task?new gv.a(e.task):null)):[]}setSavedRows(e){const t=e.map(e=>e.toJson());localStorage.setItem("savedRows",JSON.stringify(Array.from(new Set(t))))}createEntryFromTimesheet(e,t,i){return new pc.a({timeInterval:new ep.a({start:t,end:Se(t).add(Object(Se.duration)(i)),duration:Object(Se.duration)(i)}),billable:this.workspace.taskBillableEnabled&&e.task&&e.task.id?e.task.billable:e.project&&e.project.billable,projectId:e.project?e.project.id:null,taskId:e.task?e.task.id:null,description:"",tagIds:[]})}applyChangesToEntries(e,t,i,n){return e.forEach(e=>{i.indexOf(Mp.a.DESCRIPTION)>-1&&(e.description=t.description),i.indexOf(Mp.a.TAG)>-1&&(e.tags=t.tags),i.indexOf(Mp.a.BILLABLE)>-1&&(e.billable=this.decideBillability(t)),n&&i.indexOf(Mp.a.CUSTOM_FIELDS)>-1&&(e.customFieldValues=t.customFieldValues)}),e}decideBillability({project:e,task:t,billable:i}){return this.workspace.taskBillableEnabled&&(null==t?void 0:t.id)?t.billable:e?e.billable:i}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(Mt),c.Rb(D.a),c.Rb(Ce.a),c.Rb(vs.a),c.Rb(Lt.a),c.Rb(M.a),c.Rb(dc),c.Rb($d.a),c.Rb(pi.a),c.Rb(ci.a),c.Rb(ys.a),c.Rb(mg.a),c.Rb(vv.a),c.Rb(Qt.a),c.Rb(c.h),c.Rb(W.c),c.Rb(g.q),c.Rb(qd.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["timesheet2"]],viewQuery:function(e,t){var i;1&e&&c.ed(Pw,!0),2&e&&c.Kc(i=c.kc())&&(t.rows=i)},hostBindings:function(e,t){1&e&&c.jc("keyup",(function(e){return t.onKeyboard(e)}),!1,c.Nc)},decls:50,vars:14,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],["class","cl-d-block cl-alert cl-alert-warning",4,"ngIf"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-center","cl-col-md-4","cl-mb-3","cl-mb-md-0"],[1,"cl-h1"],[4,"ngIf"],[1,"cl-col-md-8"],[1,"cl-d-flex","cl-align-items-sm-center","cl-justify-content-sm-end","cl-flex-column","cl-flex-sm-row"],[1,"cl-page-header-action","cl-w-md-auto","cl-mr-0","cl-mr-sm-2","cl-mb-3","cl-mb-sm-0"],["dropdown","",1,"cl-dropdown"],["class","cl-d-print-none cl-btn cl-btn-outline-light cl-text-left cl-dropdown-toggle","type","button","closeDropdown","",4,"ngIf"],[1,"cl-d-none","cl-d-print-block","cl-btn","cl-btn-outline-light","cl-text-left","cl-dropdown-toggle"],[3,"user","hasAddTimeForOthersFeature","selectedUser","showSelectedAsActive","userSelected",4,"dropdownContent"],[1,"cl-page-header-action","cl-d-none","cl-d-lg-block"],["type","button",1,"cl-btn","cl-btn-outline-light",3,"click"],["src","assets/images/ui-icons/comfortable.svg",4,"ngIf"],["src","assets/images/ui-icons/compact.svg",4,"ngIf"],[1,"cl-page-header-action"],[3,"timeEntriesDateRange","isWeekly","dateRangeOut"],[1,"cl-page-component-wrapper"],["class","cl-table cl-table-bordered cl-remove-cell-borders cl-table-timesheet",3,"cl-compact",4,"ngIf"],[1,"cl-page-component-wrapper","cl-d-lg-flex","cl-d-print-none"],[1,"cl-btn","cl-btn-outline-light","cl-d-block","cl-d-lg-inline-block","cl-mr-0","cl-mr-lg-2","cl-mb-2","cl-mb-lg-0","cl-min-height-40","cl-max-height-40",3,"disabled","click"],["src","assets/images/ui-icons/plus-blue.svg","alt","add"],[1,"cl-ml-2"],["src","assets/images/ui-icons/template.svg","alt","copy"],[1,"cl-btn","cl-btn-outline-light","cl-d-block","cl-d-lg-inline-block","cl-min-height-40","cl-max-height-40",3,"disabled","click"],["src","assets/images/ui-icons/save.svg","alt","save"],["class","cl-btn cl-btn-outline-primary cl-d-block cl-d-lg-inline-block cl-ml-auto cl-mt-2 cl-mt-lg-0",3,"click",4,"ngIf"],["class","cl-card cl-d-print-none",4,"ngIf"],["createTemplateModal",""],["deleteRowModal",""],["editTimeModal",""],["submitApprovalModal",""],["witdhDrawApprovalModal",""],[1,"cl-d-block","cl-alert","cl-alert-warning"],[1,"cl-btn",3,"click"],["type","button",1,"cl-close",3,"click"],["class","cl-ml-3","placement","bottom",3,"ngbTooltip",4,"ngIf"],["class","cl-ml-3",4,"ngIf"],["placement","bottom",1,"cl-ml-3",3,"ngbTooltip"],["src","assets/images/ui-icons/icon-warning.svg"],[1,"cl-ml-3"],["class","cl-badge-approve cl-approve-status-approved",4,"ngIf","ngIfElse"],["pendingTemplate",""],[1,"cl-badge-approve","cl-approve-status-approved"],["class","cl-badge-approve cl-approve-status-pending",4,"ngIf"],[1,"cl-badge-approve","cl-approve-status-pending"],["title","Withdraw approval",1,"pointer","cl-ml-1",3,"click"],["type","button","closeDropdown","",1,"cl-d-print-none","cl-btn","cl-btn-outline-light","cl-text-left","cl-dropdown-toggle"],[3,"user","hasAddTimeForOthersFeature","selectedUser","showSelectedAsActive","userSelected"],["src","assets/images/ui-icons/comfortable.svg"],["src","assets/images/ui-icons/compact.svg"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-table-timesheet"],[1,"cl-thead-light"],[1,"cl-h6","cl-mb-0","cl-pl-lg-3"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-center"],["class","cl-h4 cl-mb-0",4,"ngIf"],["class","cl-ml-3",3,"click",4,"ngIf"],["timesheet-row","","class","timesheet-row-component",3,"timesheetRow","week","format","isAdminOrOwner","dateRange","workspace","projectPickerSpecialFilter","isDesktop","timesheetRows","selectedUser","isTeamManagerSelectUser","expandAll","userGroups","index","disableManualMode","delete","changeDuration","selectedProjectAndTask","preventOpenPickerOnTab","openNextPicker","focusedRow","openModalEmitter",4,"ngFor","ngForOf"],["timesheet-row-total","","class","cl-bg-light cl-table-footer",3,"week","format","totalList","total","isDesktop","expandAll",4,"ngIf"],[1,"cl-h4","cl-mb-0"],[1,"cl-ml-3",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"],["class","cl-text-lg-center",4,"ngFor","ngForOf"],[1,"cl-text-left"],[1,"cl-h6","cl-mb-0","timesheet-total-pr"],[1,"cl-text-lg-center"],[1,"cl-h6"],["timesheet-row","",1,"timesheet-row-component",3,"timesheetRow","week","format","isAdminOrOwner","dateRange","workspace","projectPickerSpecialFilter","isDesktop","timesheetRows","selectedUser","isTeamManagerSelectUser","expandAll","userGroups","index","disableManualMode","delete","changeDuration","selectedProjectAndTask","preventOpenPickerOnTab","openNextPicker","focusedRow","openModalEmitter"],["rowComponent",""],["timesheet-row-total","",1,"cl-bg-light","cl-table-footer",3,"week","format","totalList","total","isDesktop","expandAll"],[1,"cl-btn","cl-btn-outline-primary","cl-d-block","cl-d-lg-inline-block","cl-ml-auto","cl-mt-2","cl-mt-lg-0",3,"click"],[1,"cl-card","cl-d-print-none"],[1,"cl-card-header","cl-px-2","cl-px-lg-3"],[1,"cl-h6","cl-mb-0"],["class","cl-component-row cl-component-row-divide-md cl-px-0",4,"ngFor","ngForOf"],[1,"cl-component-row","cl-component-row-divide-md","cl-px-0"],[1,"cl-w-100",3,"template","hasEntries","disableManualMode","templateApplied","templateEdited","templateDeleted"],[1,"cl-modal-header"],[1,"cl-modal-title"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-row","cl-mb-0"],["for","template-name-create",1,"cl-col-sm-3","cl-col-form-label"],[1,"cl-col-sm-9"],["type","text","ngbAutofocus","","id","template-name-create","name","newTemplateName","placeholder","",1,"cl-form-control",3,"ngModel","ngModelChange","keyup.enter"],[1,"cl-modal-footer"],[3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-mb-0"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-danger",3,"click"],[3,"row","index","workspace","user","dateRange","start","customFields","close","createEntryEmitter"],[3,"title","btnText","inProgress","confirmed","close"],[1,"cl-text-dark","cl-mb-0"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",1),c.Wc(2,Mw,8,5,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"div",5),c.Xb(6,"h1",6),c.Yc(7,"Timesheet"),c.Wb(),c.Wc(8,$w,3,2,"ng-container",7),c.Wb(),c.Xb(9,"div",8),c.Xb(10,"div",9),c.Xb(11,"div",10),c.Xb(12,"div",11),c.Wc(13,_w,2,1,"button",12),c.Xb(14,"button",13),c.Yc(15),c.Wb(),c.Wc(16,Gw,1,4,"teammate-picker",14),c.Wb(),c.Wb(),c.Xb(17,"div",15),c.Xb(18,"button",16),c.jc("click",(function(){return t.toggleCompactView()})),c.Wc(19,Bw,1,0,"img",17),c.Wc(20,Vw,1,0,"img",18),c.Wb(),c.Wb(),c.Xb(21,"div",19),c.Xb(22,"datepicker-range",20),c.jc("dateRangeOut",(function(e){return t.updateDateRange(e)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(23,"div",21),c.Wc(24,Jw,14,7,"table",22),c.Wb(),c.Xb(25,"div",23),c.Xb(26,"button",24),c.jc("click",(function(){return t.addRow()})),c.Sb(27,"img",25),c.Xb(28,"span",26),c.Yc(29,"Add new row"),c.Wb(),c.Wb(),c.Xb(30,"button",24),c.jc("click",(function(){return t.copyLastWeek()})),c.Sb(31,"img",27),c.Xb(32,"span",26),c.Yc(33,"Copy last week"),c.Wb(),c.Wb(),c.Xb(34,"button",28),c.jc("click",(function(){c.Oc(e);const i=c.Lc(41);return t.openModal(i)})),c.Sb(35,"img",29),c.Xb(36,"span",26),c.Yc(37,"Save as template"),c.Wb(),c.Wb(),c.Wc(38,ey,2,0,"a",30),c.Wb(),c.Wc(39,iy,5,1,"div",31),c.Wc(40,ny,18,2,"ng-template",null,32,c.Xc),c.Wc(42,sy,16,0,"ng-template",null,33,c.Xc),c.Wc(44,cy,1,7,"ng-template",null,34,c.Xc),c.Wb(),c.Wb(),c.Wc(46,ry,5,11,"ng-template",null,35,c.Xc),c.Wc(48,oy,3,3,"ng-template",null,36,c.Xc)}2&e&&(c.Cb(2),c.wc("ngIf",t.entriesAlert),c.Cb(6),c.wc("ngIf",null==t.workspace?null:t.workspace.timeApprovalEnabled),c.Cb(5),c.wc("ngIf",t.isAdminOrOwner||t.isTeamManager),c.Cb(2),c.ad(" ",null==t.selectedUser?null:t.selectedUser.name," "),c.Cb(4),c.wc("ngIf",!t.isCompactViewOn),c.Cb(1),c.wc("ngIf",t.isCompactViewOn),c.Cb(2),c.wc("timeEntriesDateRange",t.dateRange)("isWeekly",!0),c.Cb(2),c.wc("ngIf",t.week),c.Cb(2),c.wc("disabled",t.disableManualMode),c.Cb(4),c.wc("disabled",t.disableManualMode||t.hasEntries),c.Cb(4),c.wc("disabled",t.isEmptyTimesheet()||!t.isMe()),c.Cb(4),c.wc("ngIf",t.showSubmitForAll),c.Cb(1),c.wc("ngIf",t.showTemplates))},directives:[s.u,Es.a,Ts.a,jn.a,g.Z,Wv.a,s.t,Hv,Jv,bw,p.I,p.t,p.u,p.c,p.s,p.v,xw,Ui.a],pipes:[Ps.a,Ih.a],encapsulation:2,changeDetection:0}),e})();var ly=i("Vpr3"),by=i("QeEd"),uy=i("lWAS"),dy=i("XLnJ"),py=i("BuEj"),hy=i("dMTz"),my=i("fANO"),gy=i("xzCI");class fy extends gy.a{constructor(e){super(e),this.isDropdownCheckbox=!0;const t=[...new Set(e.allowedValues)].map(e=>({id:e,name:e}));this.selectableMaps=new Jt.a([new dv.a(this.id,t,{hideTitle:!0})]),this.checkboxValues=new ti.a({map:{[this.id]:[]}}),this.isDropdownCheckbox=!0}setIndicator(){const{numberOfSelected:e,label:t}=this.checkboxValues.getSelectedData(this.selectableMaps,null,!0);this.indicator=e,this.tooltip=t}getApiParamsIfChanged(){return this.isClean()||this.isFilterDisabled?null:this.getApiParams()}getApiParams(){const e=this.selectableMaps.getAllSelectedEntities().map(e=>e.id);return{id:this.id,value:e,type:this.type}}setValuesFromParam(e){if(!e)return;const t=Array.isArray(e.value)&&e.value;this.checkboxValues.pushIds(this.id,t),ti.a.updateMapFromValuesData(this.checkboxValues,this.selectableMaps)}clear(){this.checkboxValues.reset(),this.selectableMaps.setSelected(!1),this.tooltip="",this.indicator=0}isClean(){const{numberOfSelected:e}=this.checkboxValues.getSelectedData(this.selectableMaps,null,!0);return!e}}var vy=i("f1uh");class wy extends gy.a{constructor(e){super(e),this.isDropdownSwitch=!0,this.tooltipConfig={[vy.b.BOTH]:"",[vy.b.YES]:"Yes",[vy.b.NO]:"No"},this.value=vy.b.BOTH}getApiParamsIfChanged(){return this.isClean()||this.isFilterDisabled?null:this.getApiParams()}getApiParams(){return{id:this.id,value:this.value,type:this.type}}setIndicator(){this.indicator=this.value===vy.b.BOTH?0:1,this.tooltip=this.tooltipConfig[this.value]}clear(){this.value=vy.b.BOTH,this.tooltip="",this.indicator=0}isClean(){return this.value===vy.b.BOTH}}var yy=function(e){return e.LESS_THAN="LESS_THAN",e.GREATER_THAN="GREATER_THAN",e.EQUAL="EQUAL",e}({}),Wy=i("91AR");class Cy extends gy.a{constructor(e){super(e),this.isDropdownNumber=!0,this.resetValue()}get numberOfChecked(){return this.value.filter(e=>e.isChecked).length}setValuesFromParam(e){if(!e||!e.value)return;const t=e.value;this.value.forEach(e=>{const i=t.find(t=>t.type===e.type);e.updateValue(i)})}setIndicator(){this.indicator=this.numberOfChecked}clear(){this.resetValue(),this.tooltip="",this.indicator=0}getApiParamsIfChanged(){return this.isClean()||this.isFilterDisabled?null:this.getApiParams()}getApiParams(){const e=this.value.filter(e=>e.isChecked).map(e=>new Wy.a(e));return{id:this.id,value:e,type:this.type}}isClean(){return!this.numberOfChecked}resetValue(){this.value=[new Wy.a({type:yy.EQUAL,value:0,isChecked:!1,label:"Exactly"}),new Wy.a({type:yy.LESS_THAN,value:0,isChecked:!1,label:"Smaller than"}),new Wy.a({type:yy.GREATER_THAN,value:0,isChecked:!1,label:"Larger than"})]}static areParamsEqaul(e,t){if(e.value.length!==t.value.length)return!1;for(let i=0;i<e.value.length;i++)if(!e.value[i].sameWith(t.value[i]))return!1;return!0}}class ky extends gy.a{constructor(e){super(e),this.isDropdownTextual=!0}setValuesFromParam(e){e&&(this.value=e.value||"")}setIndicator(){this.indicator=0,this.value&&this.indicator++,this.tooltip=this.value||""}clear(){this.value="",this.tooltip="",this.indicator=0}getApiParamsIfChanged(){return this.isClean()||this.isFilterDisabled?null:this.getApiParams()}getApiParams(){return{id:this.id,value:this.value,type:this.type}}isClean(){return!this.value}}function Sy(e){const t=e.type;return t===my.b.DROPDOWN_MULTIPLE||t===my.b.DROPDOWN_SINGLE?new fy(e):t===my.b.CHECKBOX?new wy(e):t===my.b.NUMBER?new Cy(e):t===my.b.LINK||t===my.b.TXT?new ky(e):void console.warn("Custom field type unknown",t)}var Iy=i("RkOr"),Oy=i("vqWo"),Xy=i("Ig2A"),Ey=i("wBNX");let Ty=(()=>{class e{constructor(e,t,i,n,s,c,r,o,a,l,b,u,d,p,h,m,g){this.workspaceService=e,this.authService=t,this.cd=i,this.uiSettingsService=n,this.router=s,this.paginationHelperService=c,this.activatedRoute=r,this.reportService=o,this.browserService=a,this.loader=l,this.trackerService=b,this.modalService=u,this.systemSettingsService=d,this.exportReportsService=p,this.customFieldService=h,this.switchReportService=m,this.timezoneConverter=g,this.pagination={},this.AmountOptions=hy.a,this.unsubscribe$=new Ee.a}ngOnInit(){this.setBrowserWidth(),this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(({isTeamManager:e,isAdminOrOwner:t,isProjectManager:i})=>{this.isTeamManager=e,this.isAdminOrOwner=t,this.isProjectManager=i,this.setCanSeeRates(),this.cd.detectChanges()}),this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{e.hasFeature(nr.a.CUSTOM_FIELDS)&&this.getCustomFields(),this.hasAddTimeForOthersFeature=e.hasFeature(nr.a.ADD_TIME_FOR_OTHERS)}),this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,this.setCanSeeRates(),this.afterWorkspaceSet(),this.initPage()}),this.getCustomizationSettings()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}afterWorkspaceSet(){}initPage(){this.enabledStandardFilters=this.uiSettingsService.getStandardFilters(this.workspace.id),this.summaryFilterGroups=this.uiSettingsService.getSummaryGroupsBy(this.workspace.id),this.showEstimate=this.uiSettingsService.getSummaryShowEstimate(this.workspace.id),this.customFields=null;const e=this.authService.getUser();this.projectData=new zd.a(this.workspace,e),this.format=this.workspace.getTimeFormat(),this.isAdminOrOwner=this.authService.isAdminOrOwner();const t=this.workspace.onlyAdminsSeePublicProjectsEntries&&this.workspace.onlyAdminsSeeAllTimeEntries;this.hideMembers=t&&!(this.isAdminOrOwner||this.isTeamManager||this.isProjectManager),this.hideUserGroupMembers=t&&this.isTeamManager&&!this.isAdminOrOwner,this.hideAmountsFromUser=!this.isAdminOrOwner&&this.workspace.onlyAdminsSeeBillableRates,this.isRounding=this.uiSettingsService.isWorkspaceRounding(this.workspace.id),this.setCanSeeRates(),this.initAmountOption(),this.getRouteParams(),this.initSortData(),this.getDateParams(),this.getReports(),this.setSwitchReportService()}setSwitchReportService(){const e=this.getChangedFilterValues(),{exclude:t,filters:i}=Object(yi.g)(e),n=this.generatefilterOptions(e);this.switchReportService.queryParams=this.generateQueryParams(t,i,n)}setCanSeeRates(){this.workspace&&(this.canSeeRates=!this.workspace.onlyAdminsSeeBillableRates||this.isAdminOrOwner)}initSortData(){let e,t;if(this.TYPE===py.a.DETAILED){const i=this.uiSettingsService.getSettings(hi.b.DETAILED_SORT)||{};e=Oy.b[i.sortColumn]||Oy.b.DATE,t=Is.a[i.sortOrder]||Is.a.DESCENDING}else{const i=this.uiSettingsService.getSettings(hi.b.SUMMARY_SORT)||{};e=Iy.c[i.sortColumn]||Iy.c.GROUP,t=Is.a[i.sortOrder]||Is.a.ASCENDING}this.sortData={sortColumn:e,sortOrder:t}}getRouteParams(){const e=this.paginationHelperService.getUrlParams(this.activatedRoute.snapshot.queryParams,this.workspace.id,this.TYPE);this.hideMembers&&(e.filterValuesData[dn.h.USERS_AND_GROUP]=this.removeExtraUserAndUserGroups(e.filterValuesData[dn.h.USERS_AND_GROUP])),this.filterValuesData=e.filterValuesData,this.description=e.description,this.withoutDescription=e.withoutDescription,this.pagination=e.pagination,this.customFieldParams=e.customFieldParams,this.TYPE===py.a.DETAILED&&(this.audit=e.audit),!this.workspace.timeApprovalEnabled&&e.filterValuesData[dn.h.STATUSES]&&e.filterValuesData[dn.h.STATUSES].removeSingleKey(dn.a),!this.workspace.invoicingEnabled&&e.filterValuesData[dn.h.STATUSES]&&e.filterValuesData[dn.h.STATUSES].removeSingleKey(dn.g)}removeExtraUserAndUserGroups(e){return!e||e.exclude||e.getTotalOfChecked()>1?new ti.a:e}getDateParams(){const{start:e,end:t}=this.activatedRoute.snapshot.queryParams,i=this.uiSettingsService.getSettings(hi.b.DATE_REPORTS),n=this.workspace.features.includes(nr.a.UNLIMITED_REPORTS),s=this.authService.getUser().settings.weekStart||"MONDAY";if(e&&t){const{dateRange:i,zoomLevel:s}=this.paginationHelperService.getDateAndZoomLevel({start:e,end:t},null,n);this.dateRange=i,this.zoomLevel=s||Wc.a.WEEK}else if(i){const e=Object(ke.c)(i.label,s);this.dateRange=e||{start:Se(i.start),end:Se(i.end)},this.zoomLevel=i.zoomLevel||Wc.a.WEEK}else this.dateRange=Object(ws.c)(s,this.timezoneConverter),this.zoomLevel=Wc.a.WEEK;if(this.TYPE===py.a.WEEKLY){const e=Object(ke.e)(Se.utc(this.dateRange.start),s);this.dateRange.start=e.startOf("day"),this.dateRange.end=e.clone().add(6,"day").endOf("day"),this.zoomLevel=Wc.a.WEEK,this.saveDateToStorage(),this.setParamsToUrl()}}updateDateRange({dateRange:e,zoomLevel:t}){this.dateRange=e,this.zoomLevel=t,this.navigate(),this.saveDateToStorage()}saveDateToStorage(){if(!Object(Pt.y)(this.dateRange.start,this.dateRange.end))return void this.uiSettingsService.setSettings(hi.b.DATE_REPORTS,null);const e={start:this.dateRange.start.toISOString(),end:this.dateRange.end.toISOString(),label:this.dateRange.label};this.uiSettingsService.setSettings(hi.b.DATE_REPORTS,e)}onRoundingChange(e){this.isRounding=e,this.getReports()}amountOptionChanged(e){this.amountOption=e,this.uiSettingsService.setAmountOption(e,this.workspace.id),this.TYPE===py.a.SUMMARY&&e===hy.a.HIDE_AMOUNT&&(this.sortData.sortColumn=Iy.c.GROUP),this.navigate()}setPagination(e){this.pagination.page=e.page||this.pagination.page,this.pagination.pageSize=e.limit||this.pagination.pageSize,this.uiSettingsService.setSettings(hi.b.DETAILED_PAGE_SIZE,this.pagination.pageSize),this.navigate({keepSelectedAllGlobally:!0})}activeFilterChanged(e){this.enabledStandardFilters=e}navigate(e){this.setParamsToUrl(),this.getReports(e)}getReports(e){}getCustomFields(){this.customFieldService.get().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.customFields=e,this.generateCustomFieldFilters(),this.cd.detectChanges()})}generateCustomFieldFilters(){if(!this.customFields)return;const e=[];this.customFields.forEach(t=>{const i=Sy(t);i&&(i.setValuesFromParams(this.customFieldParams),e.push(i))}),this.customFieldFilters=e}openModal(e){this.isModalOpen||(this.isModalOpen=!0,this.modalService.open(e,{centered:!0}).result.then(()=>setTimeout(()=>this.isModalOpen=!1,100),e=>setTimeout(()=>this.isModalOpen=!1,100)))}generatefilterOptions(e){const t={};for(const i in e)e[i]&&e[i].options&&(t[i]=Object(Pt.e)(e[i].options));return t}getChangedFilterValues(){const e={};for(const t in this.filterValuesData){const i=this.filterValuesData[t];i.isDirty()&&(e[t]=i)}return e}setParamsToUrl(){const e=this.getChangedFilterValues(),{exclude:t,filters:i}=Object(yi.g)(e),n=this.generatefilterOptions(e),s=this.generateQueryParams(t,i,n);if(this.switchReportService.queryParams=this.generateQueryParams(t,i,n),this.TYPE===py.a.DETAILED&&(s.page=this.pagination.page,s.pageSize=this.pagination.pageSize,this.audit.isDirty())){const e=this.audit.generateUrlParameters();s.audit=e.audit,s.unit=e.unit,s.compare=e.compare,s.durationInput=e.durationInput}const c=this.router.createUrlTree([],{queryParams:s}),r=this.router.serializeUrl(c);this.router.navigateByUrl(r),this.cd.detectChanges()}generateQueryParams(e,t,i){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({start:this.dateRange.start.toISOString()},{end:this.dateRange.end.toISOString()}),{description:this.description||null}),{withoutDescription:this.withoutDescription||null}),{filterValuesData:Object(Pt.r)(t)?null:JSON.stringify(t)}),{exclude:e.length?e.join(","):null}),{filterOptions:Object(Pt.r)(i)?null:JSON.stringify(i)}),{customFieldParams:Object(Pt.r)(this.customFieldParams)?null:JSON.stringify(this.customFieldParams)})}createReportQuery(){return new dy.b(this.dateRange,this.dateRangeType,this.filterValuesData,this.description,this.audit,this.pagination,this.sortData,this.zoomLevel,this.sharedData,this.isRounding,this.amountOption,this.withoutDescription,this.customFieldParams,this.summaryFilterGroups,this.weeklyGroup,this.showEstimate&&this.hideEstimateColumn)}initAmountOption(){let e=this.TYPE===py.a.WEEKLY?this.uiSettingsService.getWeeklyAmountOption(this.workspace.id):this.uiSettingsService.getAmountOption(this.workspace.id);(e===hy.a.COST||e===hy.a.PROFIT)&&(this.workspace.hasFeature(nr.a.LABOR_COST)&&this.workspace.isCostRateActive||(e=hy.a.EARNED)),this.canSeeRates||(e=hy.a.HIDE_AMOUNT),this.amountOption=e}exportAsPdf(){const e=this.createReportQuery();this.exportReportsService.exportAsPdf(e,this.TYPE,this.entriesCount,this.reportName)}exportAsCsv(){const e=this.createReportQuery();this.exportReportsService.exportAsCsv(e,this.TYPE,this.entriesCount,this.reportName)}exportAsExcel(){const e=this.createReportQuery();this.exportReportsService.exportAsExcel(e,this.TYPE,this.entriesCount,this.reportName)}applyFilter({description:e,valuesData:t,withoutDescription:i,customFieldParams:n}){this.description=e,this.withoutDescription=i,this.filterValuesData=t,this.customFieldParams=n,this.navigate()}setBrowserWidth(){this.browserService.isBreakpointLgCustom$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.markForCheck()})}getDateRangeValue(){const e=this.authService.getUser().settings.weekStart||"MONDAY",t=Object(ke.d)(this.dateRange),i=Object(ke.b)(t,e);return this.dateRangeType=i.dateRangeType,i.dateRangeType.label}saveExportSettings(e,t){this.customizeReport=e,this.customizationInProgress=!0,this.reportService.customizeReport(e,this.TYPE).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.reportName=e.name,this.currentSettings=e.reportFields.map(e=>Object(yi.e)(this.TYPE)[e]),this.customizationInProgress=!1},e=>{this.customizationInProgress=!1})}getCustomizationSettings(){this.workspace.hasFeature(nr.a.CUSTOM_REPORTING)?this.reportService.getCustomizationSettings(this.TYPE).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{const t=e.visibleElements;this.reportName=e.name,this.currentSettings=t.map(e=>Object(yi.e)(this.TYPE)[e]),this.currentCustomFieldSettings=e.customFieldIds,this.removeTotalFromSettings()},e=>{}):this.currentSettings=null}removeTotalFromSettings(){if(this.TYPE===py.a.WEEKLY&&!this.canSeeRates&&this.currentSettings.includes(Xy.a.TOTAL)){const e={name:this.reportName,reportFields:this.currentSettings.filter(e=>e!==Xy.a.TOTAL),customFieldIds:this.currentCustomFieldSettings};this.saveExportSettings(e,null)}}shareReport(e,t,i){this.sharedData=e,this.sharedData.showEstimate=this.showEstimate&&this.hideEstimateColumn;const n=this.createReportQuery();this.shareInProgress=!0,this.reportService.saveReport(n,this.TYPE).pipe(Object(De.a)(this.unsubscribe$)).subscribe(({id:e})=>{this.sharedLink=`${window.location.protocol}//${window.location.host}/shared/${e}`,this.shareInProgress=!1,t.close(),setTimeout(()=>{this.modalService.open(i,{centered:!0})},50)},()=>{this.shareInProgress=!1})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(Ce.a),c.Rb(c.h),c.Rb(hi.a),c.Rb(W.c),c.Rb(by.a),c.Rb(W.a),c.Rb(ly.a),c.Rb(pi.a),c.Rb(wi.a),c.Rb($d.a),c.Rb(g.q),c.Rb(Lt.a),c.Rb(uy.a),c.Rb(qd.a),c.Rb(Ey.a),c.Rb(vs.a))},e.\u0275dir=c.Mb({type:e}),e})();var Dy=i("R0Ic"),Ry=i("EcM4");class Ay{constructor(e,t,i,n,s){this.value=e,this.label=t,this.disabled=i,this.popUpText=n,this.checked=s,t||"string"!=typeof e||(this.label=e)}static getDropdownOf(e,t){for(let i=0;i<e.length;i++){const n=e[i];if(n.value===t)return n}return null}}var jy=i("msBQ");let xy=(()=>{class e{constructor(e){this.switchReportService=e}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Ey.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["switch-reports"]],inputs:{page:"page"},decls:10,vars:11,consts:[[1,"cl-btn","cl-btn-outline-light","cl-page-switcher-name","cl-d-none","cl-d-sm-inline-flex"],["routerLink","/reports/summary",1,"cl-btn","cl-btn-outline-light",3,"queryParams"],["routerLink","/reports/detailed",1,"cl-btn","cl-btn-outline-light",3,"queryParams"],["routerLink","/reports/weekly",1,"cl-btn","cl-btn-outline-light",3,"queryParams"],["routerLink","/reports/shared",1,"cl-btn","cl-btn-outline-light"]],template:function(e,t){1&e&&(c.Xb(0,"span",0),c.Yc(1," Reports\n"),c.Wb(),c.Xb(2,"a",1),c.Yc(3,"Summary"),c.Wb(),c.Xb(4,"a",2),c.Yc(5,"Detailed"),c.Wb(),c.Xb(6,"a",3),c.Yc(7,"Weekly"),c.Wb(),c.Xb(8,"a",4),c.Yc(9,"Shared"),c.Wb()),2&e&&(c.Cb(2),c.Hb("cl-active","SUMMARY"===t.page),c.wc("queryParams",t.switchReportService.queryParams),c.Cb(2),c.Hb("cl-active","DETAILED"===t.page),c.wc("queryParams",t.switchReportService.queryParams),c.Cb(2),c.Hb("cl-active","WEEKLY"===t.page),c.wc("queryParams",t.switchReportService.queryParams),c.Cb(2),c.Hb("cl-active","SHARED"===t.page))},directives:[W.f],encapsulation:2}),e})();var Py=i("uX6w"),My=i("VHTb"),Yy=i("Rt6l"),Ly=i("D0uv");const Fy=["featurePopover"];function Ny(e,t){if(1&e){const e=c.Yb();c.Xb(0,"dropdown-checkbox",12),c.jc("onChange",(function(t){return c.Oc(e),c.nc().auditDropdownChanged(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("labelProp","label")("valueProp","value")("isResizeable",!1)("showSearch",!1)("showSelectAll",!1)("selectableMaps",e.auditMaps)}}function Uy(e,t){if(1&e&&(c.Xb(0,"div"),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.auditLabel," ")}}function $y(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",23),c.jc("click",(function(){return c.Oc(e),c.nc(3).resetFilter()})),c.Yc(1,"Clear all"),c.Wb()}}function _y(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Sb(1,"hr",14),c.Xb(2,"div",15),c.Xb(3,"div",16),c.Xb(4,"dropdown-items",17),c.jc("onChanged",(function(t){c.Oc(e);const i=c.nc(2);return i.auditFilters.compare=t,i.emit()})),c.Wb(),c.Xb(5,"div",18),c.Xb(6,"input",19,20),c.jc("keyup.enter",(function(){return c.Oc(e),c.Lc(7).blur()}))("inputChange",(function(t){c.Oc(e);const i=c.nc(2);return i.auditFilters.durationInput=t,i.durationInputChanged()})),c.Wb(),c.Wb(),c.Xb(8,"dropdown-items",21),c.jc("onChanged",(function(t){c.Oc(e);const i=c.nc(2);return i.auditFilters.unit=t,i.emit()})),c.Wb(),c.Wb(),c.Wc(9,$y,2,0,"a",22),c.Wb(),c.Ub()}if(2&e){const e=c.nc(2);c.Cb(4),c.wc("list",e.compareDropdown)("value",e.auditFilters.compare)("type","DROPDOWN"),c.Cb(2),c.wc("ngModel",e.auditFilters.durationInput),c.Cb(2),c.wc("list",e.unitsDropdown)("value",e.auditFilters.unit)("type","DROPDOWN"),c.Cb(1),c.wc("ngIf",e.auditFilters.audit.length)}}function Gy(e,t){if(1&e&&(c.Xb(0,"div",13),c.Wc(1,_y,10,8,"ng-container",9),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.isDurationSelected)}}const By=function(){return["/upgrade"]};function Vy(e,t){1&e&&(c.Vb(0),c.Xb(1,"a",24),c.Yc(2,"Upgrade"),c.Wb(),c.Yc(3," to use audit "),c.Ub()),2&e&&(c.Cb(1),c.wc("routerLink",c.Ac(1,By)))}function Hy(e,t){1&e&&(c.Vb(0),c.Yc(1," Upgrade to use audit "),c.Ub())}function zy(e,t){if(1&e&&(c.Wc(0,Vy,4,2,"ng-container",9),c.Wc(1,Hy,2,0,"ng-container",9)),2&e){const e=c.nc();c.wc("ngIf",e.isAdminOrOwner),c.Cb(1),c.wc("ngIf",!e.isAdminOrOwner)}}let qy=(()=>{class e{constructor(e,t){this.cd=e,this.workspaceService=t,this._auditFilters=new Yy.a,this.onChange=new c.n,this.unitsDropdown=[new di.a("SECONDS","Seconds"),new di.a("MINUTES","Minutes"),new di.a("HOURS","Hours")],this.compareDropdown=[new di.a("SHORTER","Shorter than"),new di.a("LONGER","Longer than")],this.durationDebouncer$=new Ee.a,this.unsubscribe$=new Ee.a}set auditFilters(e){this._auditFilters=Yy.a.clone(e)}get auditFilters(){return this._auditFilters}ngOnInit(){this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.hasPermission=e.hasFeature(nr.a.WORKSPACE_TIME_AUDIT)}),this.initAuditMap(),this.durationDebouncer$.pipe(Object(Te.a)(180),Object(Cp.a)()).subscribe(()=>this.emit())}ngAfterViewInit(){this.generateLabel(),this.auditLabel&&this.cd.detectChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}auditDropdownChanged({selectableMaps:e}){const t=e.getSelectedEntities("Audit");this.auditFilters.audit=t.map(e=>e.value),this.generateLabel(),this.emit()}generateLabel(){this.auditLabel=this.auditMaps.getSelectedEntities("Audit").filter(e=>e.value!==Yy.b.SUSPICIOUS).map(e=>e.label).join(", ")}emit(){this.hasPermission?this.onChange.emit(this.auditFilters):this.featurePopover.isOpen()?this.featurePopover.close():this.featurePopover.open()}resetFilter(){this.auditFilters=new Yy.a,this.auditMaps.setSelected(!1),this.emit()}durationInputChanged(){this.durationDebouncer$.next(this.auditFilters.durationInput)}get isDurationSelected(){return this.auditFilters.audit.includes(Yy.b.SUSPICIOUS)}initAuditMap(){const e=[new di.a(Yy.b.NO_PROJECT,"Without project"),new di.a(Yy.b.NO_TASK,"Without task"),new di.a(Yy.b.SUSPICIOUS,"Suspicious duration")],t=new dv.a("Audit",e);t.setSelected(this.auditFilters.audit),this.auditMaps=new Jt.a([t])}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.h),c.Rb(U.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["audit"]],viewQuery:function(e,t){var i;1&e&&c.ed(Fy,!0),2&e&&c.Kc(i=c.kc())&&(t.featurePopover=i.first)},inputs:{auditFilters:"auditFilters",isAdminOrOwner:"isAdminOrOwner"},outputs:{onChange:"onChange"},decls:15,vars:4,consts:[[1,"cl-row","cl-no-gutters","cl-w-100"],[1,"cl-col-lg-custom-auto"],[1,"cl-report-entry-actions","cl-border-bottom-0","cl-d-flex","cl-py-md-3","cl-py-lg-custom-2"],["dropdownKey","",1,"cl-dropdown","cl-d-flex","cl-w-auto"],["dropdownKeyButton","","tabindex","0","triggers","manual","placement","right","container","body",1,"pointer","cl-component-divided-left","cl-no-divider-border","cl-dropdown-toggle","cl-d-flex",3,"ngbPopover"],["featurePopover","ngbPopover"],[3,"labelProp","valueProp","isResizeable","showSearch","showSelectAll","selectableMaps","onChange",4,"dropdownKeyContent"],[1,"cl-component-divided-left","cl-justify-content-start"],[1,"cl-text-gray-9","cl-d-none","cl-d-lg-custom-block","cl-mr-2"],[4,"ngIf"],["class","cl-col",4,"ngIf"],["popContent",""],[3,"labelProp","valueProp","isResizeable","showSearch","showSelectAll","selectableMaps","onChange"],[1,"cl-col"],[1,"cl-m-0","cl-d-lg-custom-none"],[1,"cl-d-flex","cl-align-items-center","cl-h-100","cl-py-1","cl-py-lg-custom-0","cl-pl-1","cl-pr-2"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-ml-2",3,"list","value","type","onChanged"],[1,"cl-d-flex"],["type","text","inputNumber","",1,"cl-form-control","cl-input-report-main","cl-input-3-digits","cl-ml-2","cl-mr-2","cl-text-center",3,"ngModel","keyup.enter","inputChange"],["durationInputField",""],[1,"cl-px-1",3,"list","value","type","onChanged"],["class","cl-small cl-ml-auto cl-mr-1 cl-my-auto",3,"click",4,"ngIf"],[1,"cl-small","cl-ml-auto","cl-mr-1","cl-my-auto",3,"click"],[3,"routerLink"]],template:function(e,t){if(1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4,5),c.Yc(6," Audit "),c.Wb(),c.Wc(7,Ny,1,6,"dropdown-checkbox",6),c.Wb(),c.Xb(8,"div",7),c.Xb(9,"div",8),c.Yc(10),c.Wb(),c.Wc(11,Uy,2,1,"div",9),c.Wb(),c.Wb(),c.Wb(),c.Wc(12,Gy,2,1,"div",10),c.Wb(),c.Wc(13,zy,2,2,"ng-template",null,11,c.Xc)),2&e){const e=c.Lc(14);c.Cb(4),c.wc("ngbPopover",e),c.Cb(6),c.ad(" ",t.auditFilters.audit.length&&t.hasPermission?"Showing entries:":"Showing all time entries."," "),c.Cb(1),c.wc("ngIf",t.auditFilters.audit.length&&t.hasPermission),c.Cb(1),c.wc("ngIf",t.hasPermission)}},directives:[Si.a,Ii.a,g.L,Oi.a,s.u,Ly.a,pn.a,p.c,Zr.a,p.s,p.v,W.f],encapsulation:2,changeDetection:0}),e})();var Ky=i("QTph"),Zy=i("cGux");const Qy=["featurePopover"];function Jy(e,t){if(1&e&&(c.Xb(0,"span",34),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.numberOfSelected," ")}}function eW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"dropdown-checkbox",35),c.jc("loadMore",(function(){return c.Oc(e),c.nc().loadMore()}))("onChange",(function(t){return c.Oc(e),c.nc().setSelectedUsers(t)}))("onSearchChange",(function(t){return c.Oc(e),c.nc().onSearchChange(t)}))("onSelectAllWithTextInput",(function(t){return c.Oc(e),c.nc().selectAllUserIds(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("resizeableName","addTimeDropdownCheckbox")("checkboxValues",e.valuesData)("selectableMaps",e.usersAndGroupsMaps)("searchValue",e.query.name)("countMap",e.count)("inProgressSelectAll",e.inProgressGetIds)("filterName","team")}}function tW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"project-picker",36,37),c.jc("selectedProjectAndTask",(function(t){return c.Oc(e),c.nc().selectProjectAndTask(t)}))("onResize",(function(t){return c.Oc(e),c.Lc(1).onResizeChange(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("selectedProject",e.timeEntry.project)("selectedTask",e.timeEntry.task)("hideWorkspaces",!0)("resizeableName","projectPicker")}}function iW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"tag-dropdown",38),c.jc("close",(function(t){return c.Oc(e),c.nc().selectTags(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("resizeableName","tagPicker")("resizeToLeft",!0)("entryTags",e.timeEntry.tags)}}function nW(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"custom-fields-values",39),c.jc("entryChanged",(function(t){return c.Oc(e),c.nc().customFieldValueChanged(t)})),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(1),c.wc("projectId",null==e.timeEntry.project?null:e.timeEntry.project.id)("customFields",e.customFields)("customFieldValues",e.timeEntry.customFieldValues)}}const sW=function(){return["/upgrade"]};function cW(e,t){1&e&&(c.Xb(0,"a",40),c.Yc(1,"Upgrade"),c.Wb(),c.Yc(2," to add time for others\n")),2&e&&c.wc("routerLink",c.Ac(1,sW))}let rW=(()=>{class e{constructor(e,t,i,n,s,r,o,a,l,b){this.entryHelperService=e,this.workspaceService=t,this.tagService=i,this.cd=n,this.toaster=s,this.trackerService=r,this.authService=o,this.userService=a,this.userGroupV1Service=l,this.userGroupService=b,this.onAdded=new c.n,this.onDropdownOpen$=new Ee.a,this.reachedLimit={},this.unsubscribe$=new Ee.a,this.valuesData=new ti.a}ngOnInit(){this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.hasPermission=e.hasFeature(nr.a.ADD_TIME_FOR_OTHERS)}),this.valuesData=new ti.a({options:Object(dn.o)()});const e=this.workspaceService.getLocalDefaultWorkspace();this.format=e.getTimeFormat(),this.tagService.clearTagsSubject(),this.tagService.getAllTags(ni.a.ACTIVE);const t=this.authService.getUser();this.projectData=new zd.a(e,t),this.initEntry();const i=[new dv.a(dn.f,null,{label:"Groups"}),new dv.a(dn.j)];this.usersAndGroupsMaps=new Jt.a(i),this.resetQuery(),this.onDropdownOpen$.pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(()=>this.getUsersAndUserGroups())}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}selectTags(e){this.timeEntry.tags=e,this.checkPermissionPopup(),this.cd.markForCheck()}resetQuery(){this.query={page:1,limit:ei.f,name:"",sortColumn:"name",status:dn.k.ACTIVE},this.reachedLimit={},this.count=new Zy.a}initEntry(e){if(this.timeEntry=new kp.a,!e){const t=Se().set({second:0,millisecond:0}).toISOString();e=new ep.a({start:t,end:t,duration:Se.duration(Se(t).diff(Se(t))).toISOString()})}this.timeEntry.timeInterval=new ep.a(e)}checkPermissionPopup(){this.hasPermission||this.featurePopover.open()}createEntry(){this.timeEntry.description=this.timeEntry.description.trim(),this.checkPermissionPopup(),this.hasPermission&&(this.inProgress||this.entryHelperService.isValid(this.timeEntry)&&setTimeout(()=>{if(!this.valuesData.isDirty())return void this.toaster.pop("error","This entry can't be saved, please add user.");const e=this.valuesData.getContainsFilter(dn.f),t=this.valuesData.getContainsFilter(dn.j);this.inProgress=!0,this.trackerService.createTimeEntryForMembers(this.timeEntry,{groups:e,users:t}).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{const t=e.map(e=>{const t=kp.a.fromTimeEntryAndReportEntry(e,this.timeEntry);return t.refreshEarned(this.amountOption),t});this.onAdded.emit(t),this.initEntry(this.timeEntry.timeInterval),this.usersAndGroupsMaps.setSelected(!1),this.valuesData.reset(),this.numberOfSelected=null,this.inProgress=!1,this.cd.detectChanges()},()=>{this.inProgress=!1,this.cd.detectChanges()})}))}customFieldValueChanged(e){this.timeEntry.customFieldValues=e}selectProjectAndTask(e){this.checkPermissionPopup(),Object(Pt.E)(this.timeEntry,e,this.workspaceService.getLocalDefaultWorkspace())}onSearchChange(e){this.onFilterChange({searchTerm:e},!1)}onFilterChange(e,t=!0){this.resetQuery(),this.query.name=e.searchTerm,this.query.page=1,this.reachedLimit[dn.j]=!1,this.reachedLimit[dn.f]=!1,t&&this.count.reset(),this.getUsersAndUserGroups()}selectAllUserIds(e){if(!this.hasPermission)return;const t={status:this.valuesData[dn.h.USERS_AND_GROUP].options.status,name:e.searchTerm},i=this.userService.getUserIds(t),n=this.userGroupService.getUserGroupIds(t);this.setInProgress(!0),Object(la.a)(i,n).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{let i=e.isSelected;this.valuesData.exclude&&(i=!i),this.valuesData.toggleMultipleIds(dn.j,t[0],i),this.valuesData.toggleMultipleIds(dn.f,t[1],i),this.isDropdownFilterOpen||this.generateIndicator(),this.setInProgress()},e=>{this.setInProgress()})}setInProgress(e=!1){this.inProgressGetIds=e,this.cd.markForCheck()}loadMore(){this.query.page++,this.getUsersAndUserGroups()}getUsersAndUserGroups(){this.getUserGroups(this.query),this.getUsers(this.query)}getUserGroups(e){this.reachedLimit[dn.f]||this.userGroupV1Service.getUserGroups(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(({groups:t,count:i})=>{const n=t.length;t=t.filter(e=>"Admins"!==e.name),!!e.name||this.count.set(dn.f,i),1===e.page&&this.usersAndGroupsMaps.resetMap(dn.f),this.usersAndGroupsMaps.pushToMap(dn.f,t,{label:"Groups"});const s=this.usersAndGroupsMaps.countSelectablesOf(dn.f);this.reachedLimit[dn.f]=s>=i||n<e.limit,this.cd.detectChanges()})}getUsers(e=this.query[dn.h.USERS_AND_GROUP]){this.reachedLimit[dn.j]||(e.statuses=[this.valuesData.options.status],e.email=e.name,this.workspaceService.getUsers(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(({count:t,users:i})=>{!!e.name||this.count.set(dn.j,t),1===e.page&&this.usersAndGroupsMaps.resetMap(dn.j),this.usersAndGroupsMaps.pushToMap(dn.j,i);const n=this.usersAndGroupsMaps.countSelectablesOf(dn.j);this.reachedLimit[dn.j]=n>=t||i.length<e.limit}))}setSelectedUsers({checkboxValues:e,selectableMaps:t,numberOfSelected:i,numberOfSelectedApproximately:n}){this.checkPermissionPopup(),this.valuesData=e,this.usersAndGroupsMaps=t,this.numberOfSelected=i||n}generateIndicator(){if(!this.valuesData)return;const e=this.valuesData.getSelectedData(this.usersAndGroupsMaps);this.numberOfSelected=e.numberOfSelected||e.numberOfSelectedApproximately}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Gd.a),c.Rb(U.a),c.Rb(Qt.a),c.Rb(c.h),c.Rb(M.a),c.Rb($d.a),c.Rb(Ce.a),c.Rb(ys.a),c.Rb(Ky.a),c.Rb(mg.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["add-time"]],viewQuery:function(e,t){var i;1&e&&c.ed(Qy,!0),2&e&&c.Kc(i=c.kc())&&(t.featurePopover=i.first)},inputs:{amountOption:"amountOption",customFields:"customFields"},outputs:{onAdded:"onAdded"},decls:38,vars:19,consts:[[1,"cl-component-row","cl-p-0"],[1,"cl-row","cl-no-gutters","cl-w-100"],[1,"cl-col"],[1,"cl-timetracker-entry-actions","cl-report-entry-actions","cl-d-flex","cl-flex-column","cl-flex-lg-row"],[1,"cl-d-flex","cl-mr-auto","cl-w-100"],[1,"cl-px-0","cl-px-lg-custom-2","cl-w-100"],["type","text","tabindex","0","placeholder","Add description","autocomplete","off",1,"cl-form-control","cl-input-timetracker-main","cl-cut-text",3,"ngModel","keyup.enter","ngModelChange","change"],["descriptionInput",""],[1,"cl-w-100","cl-m-0","cl-d-block","cl-d-lg-none"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-lg-end","cl-w-100","cl-w-lg-auto","cl-min-height-40"],["dropdownKey","",1,"cl-dropdown","cl-w-auto","cl-d-lg-custom-flex",3,"onOpen","onClose"],["dropdownKeyButton","","tabindex","0",1,"pointer","cl-component-divided-left","cl-remove-divider-mob","cl-dropdown-toggle","cl-d-flex"],["class","cl-badge cl-badge-filter",4,"ngIf"],[3,"resizeableName","checkboxValues","selectableMaps","searchValue","countMap","inProgressSelectAll","filterName","loadMore","onChange","onSearchChange","onSelectAllWithTextInput",4,"dropdownKeyContent"],["dropdownKey","",1,"cl-dropdown","cl-component-divided-left","cl-pr-0","cl-dropdown-large","cl-d-lg-custom-flex","cl-add-time-project"],["project-picker-label","",1,"cl-cut-text",3,"project","task","projectData"],["openUpAtBottom","","class","cl-dropdown-menu","resizeable","",3,"selectedProject","selectedTask","hideWorkspaces","resizeableName","selectedProjectAndTask","onResize",4,"dropdownKeyContent"],["dropdownKey","","tabCell","",1,"cl-dropdown","cl-lg-custom-down-r-0-wrapper","cl-d-report-add-time-tags"],["dropdownKeyButton","","tabindex","0",1,"pointer",3,"tags"],["class","cl-dropdown-menu cl-entry-tag-dropdown","resizeable","",3,"resizeableName","resizeToLeft","entryTags","close",4,"dropdownKeyContent"],[1,"cl-component-divided-left",3,"billable","changed"],[1,"cl-col-lg-custom-auto","cl-d-flex"],[1,"cl-border-0","cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-lg-custom-end","cl-pr-2","cl-w-100"],[1,"cl-d-flex","cl-w-100",3,"textualDate","focusOnInput","dateTime","canTriggerNextDay","pickedDate"],[1,"cl-component-divided-left","cl-d-none","cl-d-md-flex"],[3,"format","focusOnInput","timeInterval","timeChanged"],["triggers","manual","placement","left","container","body",3,"ngbPopover"],["featurePopover","ngbPopover"],["tabindex","0",1,"cl-btn","cl-btn-primary","cl-d-none","cl-d-lg-custom-block",3,"disabled","keyup.enter","keyup.space","click"],["addBtn",""],["tabindex","0",1,"cl-btn","cl-btn-primary","cl-btn-sm","cl-d-block","cl-d-lg-custom-none",3,"disabled","keyup.enter","keyup.space","click"],["addBtnSm",""],[4,"ngIf"],["popContent",""],[1,"cl-badge","cl-badge-filter"],[3,"resizeableName","checkboxValues","selectableMaps","searchValue","countMap","inProgressSelectAll","filterName","loadMore","onChange","onSearchChange","onSelectAllWithTextInput"],["openUpAtBottom","","resizeable","",1,"cl-dropdown-menu",3,"selectedProject","selectedTask","hideWorkspaces","resizeableName","selectedProjectAndTask","onResize"],["projectPicker",""],["resizeable","",1,"cl-dropdown-menu","cl-entry-tag-dropdown",3,"resizeableName","resizeToLeft","entryTags","close"],[3,"projectId","customFields","customFieldValues","entryChanged"],[3,"routerLink"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"div",5),c.Xb(6,"input",6,7),c.jc("keyup.enter",(function(){return c.Oc(e),c.Lc(7).blur()}))("ngModelChange",(function(e){return t.timeEntry.description=e}))("change",(function(){return t.checkPermissionPopup()})),c.Wb(),c.Wb(),c.Wb(),c.Sb(8,"hr",8),c.Xb(9,"div",9),c.Xb(10,"div",10),c.jc("onOpen",(function(){return t.onDropdownOpen$.next(),t.isDropdownFilterOpen=!0}))("onClose",(function(){return t.isDropdownFilterOpen=!1})),c.Xb(11,"div",11),c.Yc(12," Users "),c.Wc(13,Jy,2,1,"span",12),c.Wb(),c.Wc(14,eW,1,7,"dropdown-checkbox",13),c.Wb(),c.Xb(15,"div",14),c.Sb(16,"div",15),c.Wc(17,tW,2,4,"project-picker",16),c.Wb(),c.Xb(18,"div",17),c.Sb(19,"tag-names",18),c.Wc(20,iW,1,3,"tag-dropdown",19),c.Wb(),c.Xb(21,"billable-icon",20),c.jc("changed",(function(e){return t.timeEntry.billable=e,t.checkPermissionPopup()})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(22,"div",21),c.Xb(23,"div",22),c.Xb(24,"single-date-picker2",23),c.jc("pickedDate",(function(e){return t.timeEntry.timeInterval=e,t.checkPermissionPopup()})),c.Wb(),c.Xb(25,"div",24),c.Xb(26,"input-duration",25),c.jc("timeChanged",(function(e){return t.timeEntry.timeInterval=e,t.checkPermissionPopup()})),c.Wb(),c.Wb(),c.Xb(27,"div",26,27),c.Xb(29,"button",28,29),c.jc("keyup.enter",(function(){return t.createEntry()}))("keyup.space",(function(){return t.createEntry()}))("click",(function(){c.Oc(e);const i=c.Lc(30);return t.createEntry(),i.blur()})),c.Yc(31," Add "),c.Wb(),c.Xb(32,"button",30,31),c.jc("keyup.enter",(function(){return t.createEntry()}))("keyup.space",(function(){return t.createEntry()}))("click",(function(){c.Oc(e);const i=c.Lc(33);return t.createEntry(),i.blur()})),c.Yc(34," Add "),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(35,nW,2,3,"ng-container",32),c.Wc(36,cW,3,2,"ng-template",null,33,c.Xc)}if(2&e){const e=c.Lc(37);c.Cb(6),c.wc("ngModel",t.timeEntry.description),c.Db("title",t.timeEntry.description),c.Cb(7),c.wc("ngIf",t.numberOfSelected),c.Cb(3),c.wc("project",t.timeEntry.project)("task",t.timeEntry.task)("projectData",t.projectData),c.Cb(3),c.wc("tags",t.timeEntry.tags),c.Cb(2),c.wc("billable",t.timeEntry.billable),c.Cb(3),c.wc("textualDate",!0)("focusOnInput",!0)("dateTime",t.timeEntry.timeInterval)("canTriggerNextDay",!0),c.Cb(2),c.wc("format",t.format)("focusOnInput",!0)("timeInterval",t.timeEntry.timeInterval),c.Cb(1),c.wc("ngbPopover",e),c.Cb(2),c.wc("disabled",t.inProgress),c.Cb(3),c.wc("disabled",t.inProgress),c.Cb(3),c.wc("ngIf",null==t.customFields?null:t.customFields.length)}},directives:[p.c,p.s,p.v,Si.a,Ii.a,s.u,Oi.a,Yp.a,Gp,Bp.a,so.a,qp.a,g.L,Ly.a,Vp.a,Hp.a,zp.a,nh.a,W.f],encapsulation:2,changeDetection:0}),e})();var oW=i("AIwn"),aW=i("/pT+"),lW=i("nQ1P"),bW=(i("Y9C3"),i("PS6/"));const uW=["dropdown"],dW=["scheduleFeaturePopover"],pW=function(){return["/upgrade"]};function hW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",20),c.jc("click",(function(){return c.Oc(e),c.nc(2).closeModal()})),c.Yc(1,"Upgrade"),c.Wb()}2&e&&c.wc("routerLink",c.Ac(1,pW))}function mW(e,t){if(1&e&&(c.Xb(0,"div",18),c.Xb(1,"info"),c.Yc(2," BASIC feature "),c.Wc(3,hW,2,2,"a",19),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(3),c.wc("ngIf",e.isAdminOrOwner)}}function gW(e,t){1&e&&c.Sb(0,"div",21)}function fW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",24),c.Xb(1,"input",25),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc().addElement(t.value)})),c.Wb(),c.Xb(2,"label",26),c.Yc(3),c.Wb(),c.Wb()}if(2&e){const e=c.nc(),t=e.index,i=e.$implicit,n=c.nc();c.Cb(1),c.xc("id",t),c.wc("checked",n.checkIfChecked(i.value)&&!i.disabled)("disabled",i.disabled),c.Cb(1),c.xc("for",t),c.Cb(1),c.Zc(i.label)}}const vW=function(e,t){return{"cl-col-md-12":e," cl-col-md-6":t}};function wW(e,t){if(1&e&&(c.Xb(0,"div",22),c.Wc(1,fW,4,5,"div",23),c.Wb()),2&e){const e=t.$implicit,i=c.nc();c.wc("ngClass",c.Cc(2,vW,"DETAILED"!==i.reportType,"DETAILED"==i.reportType)),c.Cb(1),c.wc("ngIf",!e.disabled)}}function yW(e,t){1&e&&(c.Xb(0,"label",7),c.Yc(1,"Visible only in CSV and Excel"),c.Wb())}function WW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",29),c.Xb(1,"div",24),c.Xb(2,"input",25),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc(2).addElement(i.value)})),c.Wb(),c.Xb(3,"label",26),c.Yc(4),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit,i=t.index,n=c.nc(2);c.Cb(2),c.yc("id","o+",i,""),c.wc("checked",n.checkIfChecked(e.value)&&!e.disabled)("disabled",e.disabled),c.Cb(1),c.yc("for","o+",i,""),c.Cb(1),c.Zc(e.label)}}function CW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",29),c.Xb(1,"div",24),c.Xb(2,"input",30),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).addCustomField(i)})),c.Wb(),c.Xb(3,"label",26),c.Yc(4),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit,i=t.index,n=c.nc(3);c.Cb(2),c.yc("id","p+",i,""),c.wc("checked",n.containsCustomField(e)),c.Cb(1),c.yc("for","p+",i,""),c.Cb(1),c.Zc(e.name)}}function kW(e,t){if(1&e&&(c.Vb(0),c.Wc(1,CW,5,4,"div",27),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngForOf",e.customFields)}}function SW(e,t){if(1&e&&(c.Xb(0,"div",8),c.Wc(1,WW,5,5,"div",27),c.Wc(2,kW,2,1,"ng-container",28),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngForOf",e.options.csvXlsxOptions),c.Cb(1),c.wc("ngIf","DETAILED"==e.reportType&&e.customFields&&0!==e.customFields.length)}}function IW(e,t){1&e&&(c.Xb(0,"label",7),c.Yc(1,"Visible only in PDF"),c.Wb())}function OW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",22),c.Xb(1,"div",24),c.Xb(2,"input",25),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc(2).addElement(i.value)})),c.Wb(),c.Xb(3,"label",26),c.Yc(4),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit,i=t.index,n=c.nc(2);c.wc("ngClass",c.Cc(6,vW,"DETAILED"!==n.reportType,"DETAILED"==n.reportType)),c.Cb(2),c.yc("id","z+",i,""),c.wc("checked",n.checkIfChecked(e.value)&&!e.disabled)("disabled",e.disabled),c.Cb(1),c.yc("for","z+",i,""),c.Cb(1),c.Zc(e.label)}}function XW(e,t){if(1&e&&(c.Xb(0,"div",8),c.Wc(1,OW,5,9,"div",9),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngForOf",e.options.pdfOptions)}}function EW(e,t){1&e&&(c.Xb(0,"label",7),c.Yc(1,"Visible only in PDF"),c.Wb())}let TW=(()=>{class e{constructor(e,t,i,n,s,r){this.formBuilder=e,this.cd=t,this.router=i,this.modalService=n,this.userGroupServiceOld=s,this.workspaceService=r,this.reportName="",this.scheduledReport=null,this.onOpen=new c.n,this.onClose=new c.n,this.onSave=new c.n,this.ReportFilter=dn.h,this.unsubscribe$=new Ee.a,this.ScheduledReportType=lW.a,this.isSelfHosted=tr.a.environment.selfHosted,this.Features=nr.a}set checkedCustomFields(e){e&&(e.forEach(e=>{var t;return null===(t=this.customFieldIds)||void 0===t?void 0:t.push(new p.g(e))}),this._checkedCustomFields=e)}get checkedCustomFields(){return this._checkedCustomFields}set currentSettings(e){if(void 0!==e)return e?void(e&&(e.forEach(e=>{var t;return null===(t=this.reportFields)||void 0===t?void 0:t.push(new p.g(e))}),this._currentSettings=e)):(this._currentSettings=Object.keys(Object(yi.e)(this.reportType)).map(e=>Object(yi.e)(this.reportType)[e]),void(this._currentSettings=this._currentSettings.filter(e=>"RTL"!=e)))}get currentSettings(){return this._currentSettings}set options(e){e&&(this._options=e)}get options(){return this._options}ngOnInit(){this.onOpen.emit(),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.customizeForm=this.formBuilder.group({name:[this.reportName,[]],reportFields:[this.formBuilder.array([],p.G.required)],customFieldIds:[this.formBuilder.array([],p.G.required)]}),this.hasCustomReportsFeature=this.workspace.hasFeature(nr.a.CUSTOM_REPORTING)}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}get reportFields(){var e,t;return null===(t=null===(e=this.customizeForm)||void 0===e?void 0:e.get("reportFields"))||void 0===t?void 0:t.value}get customFieldIds(){var e;return null===(e=this.customizeForm)||void 0===e?void 0:e.get("customFieldIds").value}get placeholder(){return Object(bW.a)(this.reportType)+" name"}disableButton(){return this.reportFields.length+this.customFieldIds.length<1&&"DETAILED"==this.reportType}navigateToUpgrade(){this.modalService.dismissAll(),this.router.navigate(["/upgrade"])}closeModal(){this.onClose.emit()}checkIfChecked(e){var t;return null===(t=this.currentSettings)||void 0===t?void 0:t.includes(e)}containsCustomField(e){var t;return null===(t=this.checkedCustomFields)||void 0===t?void 0:t.includes(e.id)}addCustomField(e){this.customFieldIds.value.findIndex(t=>t===e.id)>-1?this.customFieldIds.removeAt(this.customFieldIds.value.findIndex(t=>t===e.id)):this.customFieldIds.push(new p.g(e.id))}addElement(e){this.elementExists(e)?this.removeElement(e):this.reportFields.push(new p.g(e))}elementExists(e){return this.reportFields.value.findIndex(t=>t===e)>-1}removeElement(e){this.reportFields.removeAt(this.reportFields.value.findIndex(t=>t===e))}onSubmit(){setTimeout(()=>{var e,t;if(this.inProgress)return;const i={name:null===(t=null===(e=this.customizeForm.value)||void 0===e?void 0:e.name)||void 0===t?void 0:t.trim(),reportFields:this.customizeForm.value.reportFields.value,customFieldIds:this.customizeForm.value.customFieldIds.value};this.onSave.emit(i),this.closeModal()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(p.f),c.Rb(c.h),c.Rb(W.c),c.Rb(g.q),c.Rb(mg.a),c.Rb(U.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["customize-report"]],viewQuery:function(e,t){var i;1&e&&(c.ed(uW,!0),c.ed(dW,!0)),2&e&&(c.Kc(i=c.kc())&&(t.dropdownItems=i.first),c.Kc(i=c.kc())&&(t.scheduleFeaturePopover=i.first))},inputs:{inProgress:"inProgress",reportType:"reportType",canSeeRates:"canSeeRates",reportName:"reportName",customFields:"customFields",_checkedCustomFields:"_checkedCustomFields",checkedCustomFields:"checkedCustomFields",isCostRateActive:"isCostRateActive",scheduledReport:"scheduledReport",isAdminOrOwner:"isAdminOrOwner",currentSettings:"currentSettings",options:"options"},outputs:{onOpen:"onOpen",onClose:"onClose",onSave:"onSave"},decls:26,vars:14,consts:[["class","cl-form-group cl-mt-2 cl-mt-lg-0",4,"ngIf"],["novalidate","",3,"formGroup","ngSubmit"],[1,"cl-modal-body"],["class","cl-blocker cl-ml-n3 cl-mt-n3",4,"ngIf"],[1,"cl-form-group"],["for","reportName"],["type","text","ngbAutofocus","","autocomplete","off","formControlName","name","id","reportName",1,"cl-form-control",3,"readOnly","ngModel","placeholder","ngModelChange"],[1,"cl-col-form-label"],[1,"cl-form-row"],["class","cl-form-group",3,"ngClass",4,"ngFor","ngForOf"],["class","cl-col-form-label",4,"ngIf"],["class","cl-form-row",4,"ngIf"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","name","rtl","id","rtl",1,"cl-custom-control-input",3,"checked","change"],["for","rtl",1,"cl-custom-control-label"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"click","keyup.enter"],["type","submit","tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-form-group","cl-mt-2","cl-mt-lg-0"],["class","cl-btn",3,"routerLink","click",4,"ngIf"],[1,"cl-btn",3,"routerLink","click"],[1,"cl-blocker","cl-ml-n3","cl-mt-n3"],[1,"cl-form-group",3,"ngClass"],["class","cl-custom-control cl-custom-checkbox",4,"ngIf"],[1,"cl-custom-control","cl-custom-checkbox"],["type","checkbox",1,"cl-custom-control-input",3,"checked","disabled","id","click"],[1,"cl-custom-control-label",3,"for"],["class","cl-form-group cl-col-md-6",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"cl-form-group","cl-col-md-6"],["type","checkbox",1,"cl-custom-control-input",3,"checked","id","click"]],template:function(e,t){1&e&&(c.Wc(0,mW,4,1,"div",0),c.Xb(1,"form",1),c.jc("ngSubmit",(function(){return t.onSubmit()})),c.Xb(2,"div",2),c.Wc(3,gW,1,0,"div",3),c.Xb(4,"div",4),c.Xb(5,"label",5),c.Yc(6,"Report name"),c.Wb(),c.Xb(7,"input",6),c.jc("ngModelChange",(function(e){return t.reportName=e})),c.Wb(),c.Wb(),c.Xb(8,"label",7),c.Yc(9,"Visible in PDF, CSV and Excel"),c.Wb(),c.Xb(10,"div",8),c.Wc(11,wW,2,5,"div",9),c.Wb(),c.Wc(12,yW,2,0,"label",10),c.Wc(13,SW,3,2,"div",11),c.Wc(14,IW,2,0,"label",10),c.Wc(15,XW,2,1,"div",11),c.Wc(16,EW,2,0,"label",10),c.Xb(17,"div",12),c.Xb(18,"input",13),c.jc("change",(function(){return t.addElement("RTL")})),c.Wb(),c.Xb(19,"label",14),c.Yc(20," Display text right-to-left "),c.Wb(),c.Wb(),c.Wb(),c.Xb(21,"div",15),c.Xb(22,"a",16),c.jc("click",(function(){return t.closeModal()}))("keyup.enter",(function(){return t.closeModal()})),c.Yc(23,"Close"),c.Wb(),c.Xb(24,"button",17),c.Yc(25,"Save"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.wc("ngIf",!1===t.hasCustomReportsFeature),c.Cb(1),c.wc("formGroup",t.customizeForm),c.Cb(2),c.wc("ngIf",!t.hasCustomReportsFeature),c.Cb(4),c.xc("placeholder",t.placeholder),c.wc("readOnly",!t.hasCustomReportsFeature)("ngModel",t.reportName),c.Cb(4),c.wc("ngForOf",t.options.allOptions),c.Cb(1),c.wc("ngIf","WEEKLY"!==t.reportType),c.Cb(1),c.wc("ngIf","WEEKLY"!==t.reportType),c.Cb(1),c.wc("ngIf","SUMMARY"==t.reportType),c.Cb(1),c.wc("ngIf","SUMMARY"==t.reportType),c.Cb(1),c.wc("ngIf","SUMMARY"!==t.reportType),c.Cb(2),c.wc("checked",t.checkIfChecked("RTL")),c.Cb(6),c.wc("disabled",!t.hasCustomReportsFeature||t.inProgress||t.disableButton()))},directives:[s.u,p.I,p.t,p.k,p.c,p.s,p.i,s.t,fr.a,W.f,s.r],encapsulation:2}),e})();var DW=i("r5nx");const RW=["detailedHeader"],AW=["detailedRows"];function jW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"reports-filter",32),c.jc("onApply",(function(t){return c.Oc(e),c.nc(2).applyFilter(t)}))("emitClearFilters",(function(){return c.Oc(e),c.nc(2).defaultFilter()})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("hideMembers",e.hideMembers)("hideUserGroupMembers",e.hideUserGroupMembers)("description",e.description)("valuesData",e.filterValuesData)("description",e.description)("withoutDescription",e.withoutDescription)("customFieldFilters",e.customFieldFilters)}}function xW(e,t){if(1&e&&(c.Xb(0,"span",33),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" ",null==e.audit?null:e.audit.numberOfSelected," ")}}const PW=function(e){return{rotate180:e}};function MW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",34),c.jc("click",(function(){c.Oc(e);const t=c.nc(2);return t.showAddTime=!t.showAddTime})),c.Yc(1," Add time for others "),c.Sb(2,"img",21),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(2),c.wc("ngClass",c.Bc(1,PW,e.showAddTime))}}function YW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",35),c.Xb(1,"audit",36),c.jc("onChange",(function(t){return c.Oc(e),c.nc(2).onAuditChange(t)})),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.wc("@fade",void 0),c.Cb(1),c.wc("auditFilters",e.audit)("isAdminOrOwner",e.isAdminOrOwner)}}function LW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div"),c.Xb(1,"add-time",37),c.jc("onAdded",(function(t){return c.Oc(e),c.nc(2).addNewEntries(t)})),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.wc("@fade",void 0),c.Cb(1),c.wc("customFields",e.customFields)("amountOption",e.amountOption)}}const FW=function(e){return{"cl-disabled":e}};function NW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"tr",42),c.Xb(1,"td",43),c.Xb(2,"custom-fields-values",44,45),c.jc("entryChanged",(function(t){return c.Oc(e),c.nc().$implicit.customFieldValues=t})),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.Lc(3),t=c.nc().$implicit,i=c.nc(2);c.wc("ngClass",c.Bc(9,FW,(t.isLocked||i.userId!==t.user.id)&&!i.isAdminOrOwner||t.approvalRequestId)),c.Cb(1),c.Hb("cl-remove-padding-and-border",!e.customFieldValuesModified.length),c.Cb(1),c.wc("timeEntryId",t.id)("customFields",i.customFields)("isLocked",t.isLocked||i.userId!==t.user.id)("disableEdit",!!t.approvalRequestId)("projectId",null==t.project?null:t.project.id)("customFieldValues",t.customFieldValues)}}function UW(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",38),c.Xb(2,"tr",39,40),c.jc("onDelete",(function(i){c.Oc(e);const n=t.index;return c.nc(2).removeEntry(i,n)}))("onDuplicate",(function(i){c.Oc(e);const n=t.index;return c.nc(2).pushEntry(i,n+1)}))("onEarnedChange",(function(){return c.Oc(e),c.nc(2).updateTotalEarned()}))("onSelectChange",(function(){return c.Oc(e),c.nc(2).calculateNumberOfSelected()})),c.Wb(),c.Wc(4,NW,4,11,"tr",41),c.Wb(),c.Ub()}if(2&e){const e=t.$implicit,i=c.nc(2);c.Cb(2),c.wc("onlyAdminsSeeBillableRates",i.workspace.onlyAdminsSeeBillableRates)("totalInfo",i.totalInfo)("hasAddTimeForOthersFeature",i.hasAddTimeForOthersFeature)("isAdminOrOwner",i.isAdminOrOwner)("disableManualMode",i.disableManualMode)("timeEntry",e)("expandAll",i.expandAll)("format",i.format)("invoicingEnabled",i.workspace.invoicingEnabled)("disableEdit",(e.isLocked||i.userId!==e.user.id)&&!i.isAdminOrOwner||e.approvalRequestId)("ngClass",c.Bc(16,FW,(e.isLocked||i.userId!==e.user.id)&&!i.isAdminOrOwner||e.approvalRequestId))("isRounding",i.isRounding)("amountOption",i.amountOption)("projectData",i.projectData)("isDesktop",i.isDesktop),c.Cb(2),c.wc("ngIf",null==i.customFields?null:i.customFields.length)}}function $W(e,t){if(1&e){const e=c.Yb();c.Xb(0,"pager",46),c.jc("pageChanged",(function(t){return c.Oc(e),c.nc(2).setPagination(t)}))("limitChanged",(function(t){return c.Oc(e),c.nc(2).setPagination(t)})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("page",e.pagination.page)("limit",e.pagination.pageSize)("total",e.entriesCount)}}function _W(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",8),c.Xb(1,"div",9),c.Xb(2,"div",10),c.Xb(3,"div",11),c.Sb(4,"switch-reports",12),c.Wb(),c.Xb(5,"div",13),c.Xb(6,"div",14),c.Xb(7,"div",15),c.Xb(8,"datepicker-range",16),c.jc("dateRangeOut",(function(t){return c.Oc(e),c.nc().updateDateRange(t)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(9,jW,1,7,"reports-filter",17),c.Xb(10,"div",18),c.Xb(11,"a",19),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.showAudit=!t.showAudit})),c.Yc(12," Time audit "),c.Wc(13,xW,2,1,"span",20),c.Sb(14,"img",21),c.Wb(),c.Wc(15,MW,3,3,"a",22),c.Wb(),c.Wc(16,YW,2,3,"div",23),c.Wc(17,LW,2,3,"div",24),c.Xb(18,"table-info",25),c.jc("shareReports",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(5);return t.openModal(i)}))("customizeReport",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(7);return t.openModal(i)}))("exportAsPdf",(function(){return c.Oc(e),c.nc().exportAsPdf()}))("exportAsCsv",(function(){return c.Oc(e),c.nc().exportAsCsv()}))("exportAsExcel",(function(){return c.Oc(e),c.nc().exportAsExcel()}))("onRoundingChange",(function(t){return c.Oc(e),c.nc().onRoundingChange(t)}))("onAmountOptionChange",(function(t){return c.Oc(e),c.nc().amountOptionChanged(t)})),c.Wb(),c.Xb(19,"div",26),c.Xb(20,"table",27),c.Xb(21,"thead"),c.Xb(22,"tr",28,29),c.jc("bulkEdit",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(11);return t.openModal(i)}))("bulkDelete",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(3);return t.openModal(i)}))("onMarkAs",(function(t){c.Oc(e);const i=c.nc(),n=c.Lc(13);return i.markAsInvoiced=t,i.openModal(n)}))("onSelectAllChange",(function(t){return c.Oc(e),c.nc().setAllChange(t)}))("onExpandAll",(function(t){return c.Oc(e),c.nc().expandAllRows(t)}))("onChange",(function(t){return c.Oc(e),c.nc().columnOrderChanged(t)})),c.Wb(),c.Wb(),c.Xb(24,"tbody"),c.Wc(25,UW,5,18,"ng-container",30),c.Wb(),c.Wb(),c.Wb(),c.Wc(26,$W,1,3,"pager",31),c.Wb()}if(2&e){const e=c.nc();c.Cb(4),c.wc("page","DETAILED"),c.Cb(4),c.wc("timeEntriesDateRange",e.dateRange),c.Cb(1),c.wc("ngIf",e.filterValuesData),c.Cb(4),c.wc("ngIf",null==e.audit?null:e.audit.numberOfSelected),c.Cb(1),c.wc("ngClass",c.Bc(28,PW,e.showAudit)),c.Cb(1),c.wc("ngIf",e.isAdminOrOwner),c.Cb(1),c.wc("ngIf",e.showAudit),c.Cb(1),c.wc("ngIf",e.isAdminOrOwner&&e.showAddTime),c.Cb(1),c.wc("amountOption",e.amountOption)("totalNumberOfEntries",e.entriesCount)("isCostRateActive",e.workspace.isCostRateActive)("isRounding",e.isRounding)("totalInfo",e.totalInfo)("isAdminOrOwner",e.isAdminOrOwner)("canSeeRates",e.canSeeRates),c.Cb(4),c.wc("invoicingEnabled",e.workspace.invoicingEnabled)("areAllCheckedEntriesInvoiced",e.areAllCheckedEntriesInvoiced)("numberOfEntries",null==e.timeEntries?null:e.timeEntries.length)("numberOfAvailableEntries",e.numberOfAvailableEntries)("numberOfSelected",e.numberOfSelected)("entriesOnOtherPages",e.entriesOnOtherPages)("isAdminOrOwner",e.isAdminOrOwner)("isDesktop",e.isDesktop)("amountOption",e.amountOption)("sortOrder",e.sortData.sortOrder)("sortColumn",e.sortData.sortColumn),c.Cb(3),c.wc("ngForOf",e.timeEntries),c.Cb(1),c.wc("ngIf",e.showPagination)}}function GW(e,t){if(1&e&&(c.Vb(0),c.Yc(1),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" Are you sure that you want to delete ",e.numberOfTimeEntriesSelected," time entries? ")}}function BW(e,t){1&e&&c.Yc(0," Are you sure that you want to delete all my time entries? ")}function VW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"delete-confirm-modal",47),c.jc("onDelete",(function(){c.Oc(e);const i=t.$implicit;return c.nc().deleteManyConfirmed(i)}))("onClose",(function(){return t.$implicit.close()})),c.Xb(1,"p",48),c.Wc(2,GW,2,1,"ng-container",49),c.Wb(),c.Wc(3,BW,1,0,"ng-template",null,50,c.Xc),c.Wb()}if(2&e){const e=c.Lc(4),t=c.nc();c.wc("title","Delete")("inProgress",t.isDeleteInProgress)("btnText","Delete"),c.Cb(2),c.wc("ngIf",t.isAdminOrOwner||!t.bulkEditDataService.isSelectedAllGlobally)("ngIfElse",e)}}function HW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"modal-header",51),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"share-report",52),c.jc("onShare",(function(i){c.Oc(e);const n=t.$implicit,s=c.nc(),r=c.Lc(9);return s.shareReport(i,n,r)}))("onClose",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Share report"),c.Cb(1),c.wc("inProgress",e.shareInProgress)("dateRangeLabel",e.getDateRangeValue())("dateRangeType",e.dateRangeType)("isAdminOrOwner",e.isAdminOrOwner)}}function zW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"modal-header",51),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"customize-report",53),c.jc("onOpen",(function(){return c.Oc(e),c.nc().getCustomizationSettings()}))("onSave",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().saveExportSettings(i,n)}))("onClose",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Detailed export settings"),c.Cb(1),c.wc("inProgress",e.customizationInProgress)("reportType",e.TYPE)("canSeeRates",e.canSeeRates)("isAdminOrOwner",e.isAdminOrOwner)("currentSettings",e.currentSettings)("reportName",e.reportName)("customFields",e.customFields)("checkedCustomFields",e.currentCustomFieldSettings)("isCostRateActive",e.workspace.isCostRateActive)("options",e.exportOptions)}}function qW(e,t){if(1&e&&(c.Xb(0,"modal-header",51),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"div",54),c.Xb(2,"text-copy",55),c.jc("onClose",(function(){return t.$implicit.close()})),c.Xb(3,"small",56),c.Sb(4,"img",57),c.Yc(5," You can see and update this link from your Shared reports page. "),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",58),c.Xb(7,"a",59),c.jc("keyup.space",(function(){return t.$implicit.close()}))("keyup.enter",(function(){return t.$implicit.close()}))("click",(function(){return t.$implicit.close()})),c.Yc(8,"Close"),c.Wb(),c.Wb()),2&e){const e=c.nc();c.wc("title","Link created"),c.Cb(2),c.wc("text",e.sharedLink),c.Cb(2),c.wc("ngbTooltip","Share link")}}function KW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"time-entry-bulk-edit",60),c.jc("onEdit",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().onEdit(i,n)}))("onUpdate",(function(){c.Oc(e);const i=t.$implicit,n=c.nc();return i.close(),n.navigateToUpgrade()}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Wb()}if(2&e){const e=c.nc();c.wc("hideDates",!e.isAdminOrOwner&&e.disableManualMode)("timeEntries",e.timeEntriesSelected)("overrideEntiesLength",e.getBulkEditTitleCount())("enableEditUser",e.isAdminOrOwner)("isRounding",e.isRounding)("hideWorkspacesInPicker",!0)("autofillWithSameData",!e.bulkEditDataService.isSelectedAllGlobally)("preventSendRequest",e.bulkEditDataService.isSelectedAllGlobally)("inProgress",e.inProgressEditGlobally)("customFields",e.customFields)}}function ZW(e,t){1&e&&(c.Vb(0),c.Yc(1," New invoices won\u2019t import invoiced entries. "),c.Ub())}function QW(e,t){1&e&&(c.Vb(0),c.Yc(1," New invoices can import uninvoiced entries. "),c.Ub())}function JW(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",61),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit,n=c.nc();return n.invoiceMarkAs(n.markAsInvoiced),i.close()}))("close",(function(){return t.$implicit.close()})),c.Xb(1,"p",62),c.Wc(2,ZW,2,0,"ng-container",24),c.Wc(3,QW,2,0,"ng-container",24),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title",e.markAsInvoiced?"Mark as invoiced":"Mark as uninvoiced")("btnText",e.markAsInvoiced?"Invoice":"Uninvoice"),c.Cb(2),c.wc("ngIf",e.markAsInvoiced),c.Cb(1),c.wc("ngIf",!e.markAsInvoiced)}}let eC=(()=>{class e extends Ty{constructor(e,t,i,n,s,c,r,o,a,l,b,u,d,p,h,m,g,f,v,w){super(e,t,i,n,s,c,r,o,a,b,u,d,p,h,g,f,v),this.tagService=l,this.bulkEditDataService=m,this.invoiceService=w,this.TYPE=py.a.DETAILED,this.exportOptions={allOptions:[new Ay(jy.a.PROJECT,"Project"),new Ay(jy.a.CLIENT,"Client"),new Ay(jy.a.TASK,"Task"),new Ay(jy.a.DESCRIPTION,"Description"),new Ay(jy.a.USER,"User"),new Ay(jy.a.TAGS,"Tags"),new Ay(jy.a.START_DATE,"Start Date"),new Ay(jy.a.START_TIME,"Start Time"),new Ay(jy.a.END_TIME,"End Time"),new Ay(jy.a.DURATION,"Duration (h)")],csvXlsxOptions:[new Ay(jy.a.EMAIL,"Email"),new Ay(jy.a.BILLABLE,"Billable"),new Ay(jy.a.END_DATE,"End Date"),new Ay(jy.a.DECIMAL_DURATION,"Duration (decimal)")],pdfOptions:[]}}ngOnInit(){super.ngOnInit(),this.userId=this.authService.getUser().id,this.tagService.clearTagsSubject(),this.tagService.getAllTags(ni.a.ACTIVE),this.showAudit=this.audit.isDirty(),this.setExportOptions()}setExportOptions(){const e=!this.workspace.hasFeature(nr.a.CUSTOM_REPORTING)||!this.workspace.isCostRateActive;let t="";e&&(t="Upgrade to enable this feature"),this.workspace.hasFeature(nr.a.CUSTOM_REPORTING)&&!this.workspace.isCostRateActive&&(t="Enable cost rate in settings"),this.canSeeRates&&(this.exportOptions.csvXlsxOptions.push(new Ay(jy.a.BILLABLE_RATE,"Billable Rate")),this.exportOptions.csvXlsxOptions.push(new Ay(jy.a.COST_RATE,"Cost Rate",e,t)),this.exportOptions.allOptions.push(new Ay(jy.a.BILLABLE_AMOUNT,"Billable Amount")),this.exportOptions.allOptions.push(new Ay(jy.a.COST_AMOUNT,"Cost Amount",e,t)),this.exportOptions.allOptions.push(new Ay(jy.a.PROFIT,"Profit",e,t)));const i=!this.workspace.hasFeature(nr.a.CUSTOM_REPORTING)||!this.workspace.timeApprovalEnabled;this.exportOptions.csvXlsxOptions.push(new Ay(jy.a.APPROVAL,"Approval",i)),this.exportOptions.allOptions=this.exportOptions.allOptions.filter(e=>!e.disabled),this.exportOptions.pdfOptions=this.exportOptions.pdfOptions.filter(e=>!e.disabled),this.exportOptions.csvXlsxOptions=this.exportOptions.csvXlsxOptions.filter(e=>!e.disabled)}get timeEntriesSelected(){return this.timeEntries.filter(e=>e.bulkEdit)}get numberOfTimeEntriesSelected(){return this.bulkEditDataService.isSelectedAllGlobally?this.timeEntriesSelected.length+this.entriesOnOtherPages:this.timeEntriesSelected.length}get disableManualMode(){return this.workspace.disableManualMode}getBulkEditTitleCount(){return this.isAdminOrOwner||!this.bulkEditDataService.isSelectedAllGlobally?this.numberOfTimeEntriesSelected:"all my"}onAuditChange(e){this.audit=e,this.navigate()}onEdit(e,t){e?this.bulkEditGlobally(e,t):this.getReports()}getReports(e){this.loader.show("Loading...");const t=this.createReportQuery(),i=this.bulkEditDataService.isSelectedAllGlobally;this.reportService.getAllDetailedEntries(t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(({totals:t,timeentries:n})=>{if(this.totalInfo=t,this.entriesOnOtherPages=t.entriesCount-n.length,this.entriesCount=t.entriesCount,this.showPagination=this.entriesCount>=ei.j||this.entriesCount>=this.pagination.pageSize,this.timeEntries=n,this.calculateNumberOfSelected(),0===n.length&&1!==this.pagination.page)return this.pagination.page=1,void this.getReports();i&&e&&e.keepSelectedAllGlobally&&(this.cd.detectChanges(),this.setAllChange(!0),setTimeout(()=>{this.detailedHeader.selectAllGlobally()})),this.loader.hide()},()=>{this.loader.hide()})}getCustomFields(){this.customFieldService.get().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.customFields=e,this.generateCustomFieldFilters(),this.cd.detectChanges()})}generateCustomFieldFilters(){if(!this.customFields)return;const e=[];this.customFields.forEach(t=>{const i=Sy(t);i&&(i.setValuesFromParams(this.customFieldParams),e.push(i))}),this.customFieldFilters=e}expandAllRows(e){this.expandAll=e,this.cd.detectChanges()}addNewEntries(e){this.timeEntries=[...e,...this.timeEntries],this.updateTableInfoForAddedEntries(e)}updateTableInfoForAddedEntries(e){const t=new Bd.a;e.forEach(e=>{t.add(e.timeInterval.duration)});const i=e[0].billable;this.totalInfo.editDuration(t.asString(),i,!0),this.updateTotalEarned()}columnOrderChanged(e){this.sortData=e,this.navigate(),this.uiSettingsService.setSettings(hi.b.DETAILED_SORT,this.sortData)}removeEntry(e,t){this.timeEntries.splice(t,1),this.calculateNumberOfSelected(),this.updateTotalEarned(),this.totalInfo.editDuration(e.timeInterval.duration,e.billable,!1)}updateTotalEarned(){this.totalInfo.updatetotalAmountOnCurrentPage(this.timeEntries)}pushEntry(e,t){this.timeEntries.splice(t,0,e),this.updateTableInfoForAddedEntries([e])}setAllChange(e){this.detailedRows.forEach(t=>{t.setIsSelected(e)}),this.calculateNumberOfSelected()}calculateNumberOfSelected(){if(!this.timeEntries)return this.numberOfSelected=0,void(this.numberOfAvailableEntries=0);const e=this.timeEntries.filter(e=>e.bulkEdit).length;this.numberOfSelected=e,this.cd.detectChanges(),this.numberOfAvailableEntries=this.detailedRows.filter(e=>!e.disableEdit).length,this.workspace.invoicingEnabled&&(this.areAllCheckedEntriesInvoiced=this.timeEntries.filter(e=>e.bulkEdit).every(e=>e.hasInvoice))}invoiceMarkAs(e){const t=this.timeEntriesSelected.map(e=>e.id),i=this.bulkEditDataService.isSelectedAllGlobally;if(this.loader.showBar(),!i)return void this.bulkEntriesInvoiceStatus(t,e);const n=this.createReportQuery();this.reportService.getEntryIds(n).pipe(Object(De.a)(this.unsubscribe$)).subscribe(i=>{this.bulkEntriesInvoiceStatus([...t,...i],e)},()=>{this.loader.hide()})}bulkEntriesInvoiceStatus(e,t){const i=[...new Set(e)];this.invoiceService.bulkEntriesInvoiceStatus(i,t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.getReports(),this.detailedHeader.onBulkComplete(),this.loader.hide()},()=>this.loader.hide())}deleteManyConfirmed(e){this.isDeleteInProgress=!0;const t=this.timeEntriesSelected.map(e=>e.id);if(!this.bulkEditDataService.isSelectedAllGlobally)return void this.deleteTimeEntryMany(e,t);const i=this.createReportQuery();this.reportService.getEntryIds(i).pipe(Object(De.a)(this.unsubscribe$)).subscribe(i=>{this.deleteTimeEntryMany(e,[...t,...i])},()=>this.isDeleteInProgress=!1)}deleteTimeEntryMany(e,t){this.trackerService.deleteTimeEntryMany(t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.isDeleteInProgress=!1,e.close(),this.getReports(),this.detailedHeader.onBulkComplete()},()=>{this.isDeleteInProgress=!1})}bulkEditGlobally({ids:e,changeFields:t,timeEntry:i,customFieldValues:n},s){this.inProgressEditGlobally=!0;const c=this.createReportQuery();this.reportService.getEntryIds(c).pipe(Object(De.a)(this.unsubscribe$)).subscribe(c=>{const r=[...e,...c],o=[...new Set(r)];this.bulkEditMany(s,o,t,i,n)},()=>this.inProgressEditGlobally=!1)}bulkEditMany(e,t,i,n,s){this.trackerService.updateGroup(t,i,n,s).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.inProgressEditGlobally=!1,e.close(),this.getReports(),this.detailedHeader.onBulkComplete()},()=>this.inProgressEditGlobally=!1)}navigateToUpgrade(){this.router.navigate(["/upgrade"])}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(Ce.a),c.Rb(c.h),c.Rb(hi.a),c.Rb(W.c),c.Rb(by.a),c.Rb(W.a),c.Rb(ly.a),c.Rb(pi.a),c.Rb(Qt.a),c.Rb(wi.a),c.Rb($d.a),c.Rb(g.q),c.Rb(Lt.a),c.Rb(uy.a),c.Rb(Ry.a),c.Rb(qd.a),c.Rb(Ey.a),c.Rb(vs.a),c.Rb(ki))},e.\u0275cmp=c.Lb({type:e,selectors:[["detailed-reports"]],viewQuery:function(e,t){var i;1&e&&(c.ed(RW,!0),c.ed(AW,!0)),2&e&&(c.Kc(i=c.kc())&&(t.detailedHeader=i.first),c.Kc(i=c.kc())&&(t.detailedRows=i))},features:[c.zb],decls:14,vars:1,consts:[[1,"cl-page-wrapper"],["class","cl-container-fluid",4,"ngIf"],["delete",""],["shareModal",""],["customizeModal",""],["linkCreatedModal",""],["editModal",""],["invoiceBulkModal",""],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center","cl-justify-content-between"],[1,"cl-col-auto","cl-mb-3","cl-mb-md-0","cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-md-start"],[1,"cl-btn-group",3,"page"],[1,"cl-col-auto"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-sm-end"],[1,"cl-page-header-action","cl-w-100","cl-w-md-auto"],[3,"timeEntriesDateRange","dateRangeOut"],["class","cl-d-block",3,"hideMembers","hideUserGroupMembers","description","valuesData","withoutDescription","customFieldFilters","onApply","emitClearFilters",4,"ngIf"],[1,"cl-mb-3","cl-d-flex","cl-justify-content-between","cl-justify-content-md-start"],[1,"cl-btn","cl-btn-outline-light","cl-relative",3,"click"],["class","cl-badge cl-badge-filter",4,"ngIf"],["src","assets/images/ui-icons/chevron-down.svg",1,"cl-transition1","cl-ml-2","cl-mr-1",3,"ngClass"],["class","cl-btn cl-btn-outline-light cl-ml-2",3,"click",4,"ngIf"],["class","cl-collapse",4,"ngIf"],[4,"ngIf"],[1,"cl-card","cl-border-bottom-0","cl-mb-0",3,"amountOption","totalNumberOfEntries","isCostRateActive","isRounding","totalInfo","isAdminOrOwner","canSeeRates","shareReports","customizeReport","exportAsPdf","exportAsCsv","exportAsExcel","onRoundingChange","onAmountOptionChange"],[1,"cl-page-component-wrapper"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-responsive","cl-text-gray-6","cl-detailed-reports-table"],["detailed-header","",3,"invoicingEnabled","areAllCheckedEntriesInvoiced","numberOfEntries","numberOfAvailableEntries","numberOfSelected","entriesOnOtherPages","isAdminOrOwner","isDesktop","amountOption","sortOrder","sortColumn","bulkEdit","bulkDelete","onMarkAs","onSelectAllChange","onExpandAll","onChange"],["detailedHeader",""],[4,"ngFor","ngForOf"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],[1,"cl-d-block",3,"hideMembers","hideUserGroupMembers","description","valuesData","withoutDescription","customFieldFilters","onApply","emitClearFilters"],[1,"cl-badge","cl-badge-filter"],[1,"cl-btn","cl-btn-outline-light","cl-ml-2",3,"click"],[1,"cl-collapse"],[1,"cl-card","cl-border-bottom",3,"auditFilters","isAdminOrOwner","onChange"],[1,"cl-card","cl-border-bottom",3,"customFields","amountOption","onAdded"],[1,"cl-row-hover-shadow"],["detailed-row","",3,"onlyAdminsSeeBillableRates","totalInfo","hasAddTimeForOthersFeature","isAdminOrOwner","disableManualMode","timeEntry","expandAll","format","invoicingEnabled","disableEdit","ngClass","isRounding","amountOption","projectData","isDesktop","onDelete","onDuplicate","onEarnedChange","onSelectChange"],["detailedRows",""],[3,"ngClass",4,"ngIf"],[3,"ngClass"],["colspan","8",1,"cl-py-0","cl-border-top-0","cl-detailed-reports-custom-fields-row"],[3,"timeEntryId","customFields","isLocked","disableEdit","projectId","customFieldValues","entryChanged"],["ref",""],[3,"page","limit","total","pageChanged","limitChanged"],[3,"title","inProgress","btnText","onDelete","onClose"],[1,"cl-h2","cl-cut-text-wrap"],[4,"ngIf","ngIfElse"],["unknownNumberTemplate",""],[3,"title","onClose"],[3,"inProgress","dateRangeLabel","dateRangeType","isAdminOrOwner","onShare","onClose"],[3,"inProgress","reportType","canSeeRates","isAdminOrOwner","currentSettings","reportName","customFields","checkedCustomFields","isCostRateActive","options","onOpen","onSave","onClose"],[1,"cl-modal-body"],[3,"text","onClose"],[1,"form-text","text-gray-9"],["src","assets/images/ui-icons/info-9.svg","placement","top",1,"cl-mr-2",3,"ngbTooltip"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"keyup.space","keyup.enter","click"],[3,"hideDates","timeEntries","overrideEntiesLength","enableEditUser","isRounding","hideWorkspacesInPicker","autofillWithSameData","preventSendRequest","inProgress","customFields","onEdit","onUpdate","close"],[3,"title","btnText","confirmed","close"],[1,"cl-text-muted","cl-cut-text-wrap"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Wc(1,_W,27,30,"div",1),c.Wb(),c.Wc(2,VW,5,5,"ng-template",null,2,c.Xc),c.Wc(4,HW,2,5,"ng-template",null,3,c.Xc),c.Wc(6,zW,2,11,"ng-template",null,4,c.Xc),c.Wc(8,qW,9,3,"ng-template",null,5,c.Xc),c.Wc(10,KW,1,10,"ng-template",null,6,c.Xc),c.Wc(12,JW,4,4,"ng-template",null,7,c.Xc)),2&e&&(c.Cb(1),c.wc("ngIf",t.workspace))},directives:[s.u,xy,jn.a,s.r,Py.a,Oy.a,s.t,My.b,qy,rW,oW.a,nh.a,cn.a,yl.a,wl.a,aW.a,TW,DW.a,g.Z,Hm,Ui.a],encapsulation:2,data:{animation:[Object(Dy.m)("fade",[Object(Dy.l)(":leave",[Object(Dy.e)("140ms",Object(Dy.k)({opacity:0}))]),Object(Dy.l)(":enter",[Object(Dy.k)({opacity:0}),Object(Dy.e)("200ms",Object(Dy.k)({opacity:1}))])])]}}),e})();var tC=i("6gTr"),iC=i("t2hA"),nC=i("EBvn");function sC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"reports-filter",28),c.jc("onApply",(function(t){return c.Oc(e),c.nc(2).applyFilter(t)}))("activeFilterChanged",(function(t){return c.Oc(e),c.nc(2).activeFilterChanged(t.standard)}))("emitClearFilters",(function(){return c.Oc(e),c.nc(2).defaultFilter()})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("hideMembers",e.hideMembers)("hideUserGroupMembers",e.hideUserGroupMembers)("description",e.description)("valuesData",e.filterValuesData)("description",e.description)("withoutDescription",e.withoutDescription)("customFieldFilters",e.customFieldFilters)}}const cC=function(){return[]};function rC(e,t){if(1&e&&c.Sb(0,"bar-chart",29),2&e){const e=c.nc(2);c.wc("barChartLabels",e.chartData.dates)("barChartAllLabels",e.chartData.barChartAllLabels)("projectCountByDate",c.Ac(14,cC))("canSeeRates",e.canSeeRates)("isBillabilityType",e.isBillabilityType)("currency",e.workspace.hourlyRate.currency)("format",e.format)("chartDataDurationUnit","seconds")("tooltipConfig",e.tooltipConfig)("billableTimes",e.chartData.durationLabel)("barChartColors",e.chartData.colors)("barChartData",e.chartData.chartData)("barChartEarnings",e.chartData.earnings)("totalDurationByDate",e.chartData.totalDurationByDate)}}function oC(e,t){if(1&e&&c.Sb(0,"summary-group",30),2&e){const e=t.$implicit,i=c.nc(2);c.wc("currency",null==i.workspace?null:i.workspace.hourlyRate.currency)("format",i.format)("hideAmount",i.hideAmount)("showEstimate",i.showEstimate&&i.hideEstimateColumn)("filterGroups",i.summaryFilterGroupsClone)("isExpanded",i.isExpanded)("userFormat",i.userFormat)("enableLinks",!0)("dateRange",i.dateRange)("enabledStandardFilters",i.enabledStandardFilters)("group",e)}}function aC(e,t){if(1&e&&c.Sb(0,"doughnut-chart",31),2&e){const e=c.nc(2);c.wc("doughnutChart",e.doughnutChart)("doughnutChartColors",e.doughnutChartColors)("doughnutChartData",e.doughnutChartData)("totalTime",null==e.totalInfo?null:e.totalInfo.totalTime)("doughnutChartLabels",e.doughnutChartLabels)("format",e.format)("canSeeRates",e.canSeeRates)("isBillabilityType",!1)("tooltipToLeft",!0)}}function lC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",5),c.Xb(1,"div",6),c.Xb(2,"div",7),c.Xb(3,"div",8),c.Sb(4,"switch-reports",9),c.Wb(),c.Xb(5,"div",10),c.Xb(6,"div",11),c.Xb(7,"div",12),c.Xb(8,"datepicker-range",13),c.jc("dateRangeOut",(function(t){return c.Oc(e),c.nc().updateDateRange(t)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(9,sC,1,7,"reports-filter",14),c.Xb(10,"table-info",15),c.jc("shareReports",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(5);return t.openModal(i)}))("customizeReport",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(3);return t.openModal(i)}))("exportAsPdf",(function(){return c.Oc(e),c.nc().exportAsPdf()}))("exportAsCsv",(function(){return c.Oc(e),c.nc().exportAsCsv()}))("exportAsExcel",(function(){return c.Oc(e),c.nc().exportAsExcel()}))("onRoundingChange",(function(t){return c.Oc(e),c.nc().onRoundingChange(t)}))("onAmountOptionChange",(function(t){return c.Oc(e),c.nc().amountOptionChanged(t)})),c.Wb(),c.Xb(11,"div",16),c.Xb(12,"div",17),c.Xb(13,"div",18),c.Wc(14,rC,1,15,"bar-chart",19),c.Wb(),c.Wb(),c.Wb(),c.Xb(15,"div",20),c.Xb(16,"summary-group-header",21),c.jc("onGroupByChanged",(function(t){return c.Oc(e),c.nc().groupByChanged(t)}))("onShowEstimateChanged",(function(t){return c.Oc(e),c.nc().showEstimateChanged(t)}))("onHideEstimateChanged",(function(t){return c.Oc(e),c.nc().hideEstimate(t)})),c.Wb(),c.Xb(17,"div",22),c.Xb(18,"div",23),c.Xb(19,"summary-group-title",24),c.jc("onChange",(function(t){return c.Oc(e),c.nc().columnOrderChanged(t)}))("onExpand",(function(t){return c.Oc(e),c.nc().isExpanded=t})),c.Wb(),c.Wc(20,oC,1,11,"summary-group",25),c.Wb(),c.Xb(21,"div",26),c.Xb(22,"div",18),c.Wc(23,aC,1,9,"doughnut-chart",27),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(4),c.wc("page","SUMMARY"),c.Cb(4),c.wc("timeEntriesDateRange",e.dateRange),c.Cb(1),c.wc("ngIf",e.filterValuesData),c.Cb(1),c.wc("amountOption",e.amountOption)("totalNumberOfEntries",e.rowsCount)("limitLabel","Max 3,000 rows per PDF")("isCostRateActive",e.workspace.isCostRateActive)("isRounding",e.isRounding)("totalInfo",e.totalInfo)("isAdminOrOwner",e.isAdminOrOwner)("canSeeRates",e.canSeeRates),c.Cb(4),c.wc("ngIf",e.chartData),c.Cb(2),c.wc("filterGroups",e.summaryFilterGroups)("projectGroupingLabel",e.projectGroupingLabel)("showEstimate",e.showEstimate)("hasEstimateFeature",e.hasEstimateFeature)("isAdminOrOwner",e.isAdminOrOwner),c.Cb(3),c.wc("isExpanded",e.isExpanded)("sortOrder",e.sortData.sortOrder)("sortColumn",e.sortData.sortColumn)("summaryFilterGroups",e.summaryFilterGroupsClone)("showEstimate",e.showEstimate&&e.hideEstimateColumn)("amountOption",e.amountOption),c.Cb(1),c.wc("ngForOf",e.groups),c.Cb(3),c.wc("ngIf",e.doughnutChart)}}function bC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"modal-header",32),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"customize-report",33),c.jc("onOpen",(function(){return c.Oc(e),c.nc().getCustomizationSettings()}))("onSave",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().saveExportSettings(i,n)}))("onClose",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Summary export settings"),c.Cb(1),c.wc("inProgress",e.customizationInProgress)("reportType",e.TYPE)("canSeeRates",e.canSeeRates)("isAdminOrOwner",e.isAdminOrOwner)("currentSettings",e.currentSettings)("reportName",e.reportName)("customFields",e.customFields)("checkedCustomFields",e.currentCustomFieldSettings)("isCostRateActive",e.workspace.isCostRateActive)("options",e.exportOptions)}}function uC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"modal-header",32),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"share-report",34),c.jc("onShare",(function(i){c.Oc(e);const n=t.$implicit,s=c.nc(),r=c.Lc(7);return s.shareReport(i,n,r)}))("onClose",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Share report"),c.Cb(1),c.wc("inProgress",e.shareInProgress)("dateRangeLabel",e.getDateRangeValue())("dateRangeType",e.dateRangeType)("isAdminOrOwner",e.isAdminOrOwner)}}function dC(e,t){if(1&e&&(c.Xb(0,"modal-header",32),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"div",35),c.Xb(2,"text-copy",36),c.jc("onClose",(function(){return t.$implicit.close()})),c.Xb(3,"small",37),c.Sb(4,"img",38),c.Yc(5," You can see and update this link from your Shared reports page. "),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",39),c.Xb(7,"a",40),c.jc("keyup.space",(function(){return t.$implicit.close()}))("keyup.enter",(function(){return t.$implicit.close()}))("click",(function(){return t.$implicit.close()})),c.Yc(8,"Close"),c.Wb(),c.Wb()),2&e){const e=c.nc();c.wc("title","Link created"),c.Cb(2),c.wc("text",e.sharedLink),c.Cb(2),c.wc("ngbTooltip","Share link")}}let pC=(()=>{class e extends Ty{constructor(e,t,i,n,s,c,r,o,a,l,b,u,d,p,h,m,g,f,v){super(e,t,i,n,s,c,r,o,a,l,b,u,d,p,m,f,v),this.bulkEditDataService=h,this.userService=g,this.TYPE=py.a.SUMMARY,this.isExpanded=!1,this.exportOptions={allOptions:[new Ay(tC.a.DURATION,"Duration (h)")],csvXlsxOptions:[new Ay(tC.a.DECIMAL_DURATION,"Duration (decimal)")],pdfOptions:[new Ay(tC.a.BAR_CHART,"Bar Chart"),new Ay(tC.a.PIE_CHART_1,"Pie Chart (Group 1)"),new Ay(tC.a.PIE_CHART_2,"Pie Chart (Group 2)"),new Ay(tC.a.PIE_CHART_3,"Pie Chart (Group 3)")]}}ngOnInit(){super.ngOnInit(),this.userFormat=this.userService.getDateFormatForUser()||"DD.MM.YYYY",this.hasEstimateFeature=this.workspace.hasFeature(nr.a.SUMMARY_ESTIMATE)}afterWorkspaceSet(){this.projectGroupingLabel=this.workspace.projectGroupingLabel||"client"}getReports(){this.loader.show("Loading...");const e=this.createReportQuery(),t=this.amountOption,i=this.zoomLevel,n={start:e.dateRange.start.clone(),end:e.dateRange.end.clone()};this.reportService.getSummaryReportsData(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(({totals:e,chart:s,groups:c})=>{let r;this.hideAmount=t===hy.a.HIDE_AMOUNT,this.totalInfo=e,this.entriesCount=e.entriesCount,this.summaryFilterGroupsClone=this.summaryFilterGroups.slice(),this.summaryFilterGroups[0]!==Iy.a.PROJECT&&c.forEach(e=>{const t=Object(ws.d)(r);r=t.lastRandom,e.color=e.name?t.randomRgba:ei.p}),this.groups=c,this.rowsCount=Object(yi.a)(c),this.isBillabilityType=s[0]&&(!!s[0].totalAmount||0===s[0].totalAmount),s=Object(yi.h)(s,n,i),this.chartData=Object(yi.i)(s,i,t,this.format),this.tooltipConfig={hideTableBody:t!==hy.a.EARNED};const o=this.summaryFilterGroups[0],a=Object(yi.c)(this.groups,this.totalInfo.totalTime,o,this.userFormat);this.doughnutChart=a.doughnutChart,this.doughnutChartColors=a.doughnutChartColors,this.doughnutChartData=a.doughnutChartData,this.doughnutChartLabels=a.doughnutChartLabels,this.cd.detectChanges(),this.loader.hide()},()=>{this.loader.hide()})}columnOrderChanged(e){this.sortData=e,this.navigate(),this.uiSettingsService.setSettings(hi.b.SUMMARY_SORT,this.sortData)}groupByChanged(e){this.summaryFilterGroups=e,this.uiSettingsService.setSummaryGroupsBy(e,this.workspace.id),this.navigate()}showEstimateChanged(e){this.showEstimate=e,this.uiSettingsService.setSummaryShowEstimate(e,this.workspace.id)}hideEstimate(e){this.uiSettingsService.setSummaryShowEstimate(e&&this.hasEstimateFeature,this.workspace.id),this.hideEstimateColumn=this.uiSettingsService.getSummaryShowEstimate(this.workspace.id)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(Ce.a),c.Rb(c.h),c.Rb(hi.a),c.Rb(W.c),c.Rb(by.a),c.Rb(W.a),c.Rb(ly.a),c.Rb(pi.a),c.Rb(wi.a),c.Rb($d.a),c.Rb(g.q),c.Rb(Lt.a),c.Rb(uy.a),c.Rb(Ry.a),c.Rb(qd.a),c.Rb(ys.a),c.Rb(Ey.a),c.Rb(vs.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["summary-reports"]],features:[c.zb],decls:8,vars:1,consts:[[1,"cl-page-wrapper"],["class","cl-container-fluid",4,"ngIf"],["customizeModal",""],["shareModal",""],["linkCreatedModal",""],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center","cl-justify-content-between"],[1,"cl-col-auto","cl-mb-3","cl-mb-md-0","cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-md-start"],[1,"cl-btn-group",3,"page"],[1,"cl-col-auto"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-sm-end"],[1,"cl-page-header-action","cl-w-100","cl-w-md-auto"],[3,"timeEntriesDateRange","dateRangeOut"],[3,"hideMembers","hideUserGroupMembers","description","valuesData","withoutDescription","customFieldFilters","onApply","activeFilterChanged","emitClearFilters",4,"ngIf"],[1,"cl-card","cl-border-bottom-0","cl-mb-0",3,"amountOption","totalNumberOfEntries","limitLabel","isCostRateActive","isRounding","totalInfo","isAdminOrOwner","canSeeRates","shareReports","customizeReport","exportAsPdf","exportAsCsv","exportAsExcel","onRoundingChange","onAmountOptionChange"],[1,"cl-card"],[1,"cl-card-body","cl-p-0"],[1,"cl-main-chart-container"],[3,"barChartLabels","barChartAllLabels","projectCountByDate","canSeeRates","isBillabilityType","currency","format","chartDataDurationUnit","tooltipConfig","billableTimes","barChartColors","barChartData","barChartEarnings","totalDurationByDate",4,"ngIf"],[1,"cl-card","cl-reset-component-row-last-child"],[1,"cl-card-header","cl-pl-2","cl-pl-lg-3","cl-pr-0",3,"filterGroups","projectGroupingLabel","showEstimate","hasEstimateFeature","isAdminOrOwner","onGroupByChanged","onShowEstimateChanged","onHideEstimateChanged"],[1,"cl-row","cl-m-0"],[1,"cl-col-lg-custom-8","cl-p-0","cl-reports-summary-table-col"],[1,"cl-card-header","cl-bg-white","cl-d-lg-flex","small","cl-px-2","cl-px-lg-3",3,"isExpanded","sortOrder","sortColumn","summaryFilterGroups","showEstimate","amountOption","onChange","onExpand"],[3,"currency","format","hideAmount","showEstimate","filterGroups","isExpanded","userFormat","enableLinks","dateRange","enabledStandardFilters","group",4,"ngFor","ngForOf"],[1,"cl-col-lg-custom-4","p-0"],[3,"doughnutChart","doughnutChartColors","doughnutChartData","totalTime","doughnutChartLabels","currency","format","canSeeRates","isBillabilityType","tooltipToLeft",4,"ngIf"],[3,"hideMembers","hideUserGroupMembers","description","valuesData","withoutDescription","customFieldFilters","onApply","activeFilterChanged","emitClearFilters"],[3,"barChartLabels","barChartAllLabels","projectCountByDate","canSeeRates","isBillabilityType","currency","format","chartDataDurationUnit","tooltipConfig","billableTimes","barChartColors","barChartData","barChartEarnings","totalDurationByDate"],[3,"currency","format","hideAmount","showEstimate","filterGroups","isExpanded","userFormat","enableLinks","dateRange","enabledStandardFilters","group"],[3,"doughnutChart","doughnutChartColors","doughnutChartData","totalTime","doughnutChartLabels","currency","format","canSeeRates","isBillabilityType","tooltipToLeft"],[3,"title","onClose"],[3,"inProgress","reportType","canSeeRates","isAdminOrOwner","currentSettings","reportName","customFields","checkedCustomFields","isCostRateActive","options","onOpen","onSave","onClose"],[3,"inProgress","dateRangeLabel","dateRangeType","isAdminOrOwner","onShare","onClose"],[1,"cl-modal-body"],[3,"text","onClose"],[1,"form-text","text-gray-9"],["src","assets/images/ui-icons/info-9.svg","placement","top",1,"cl-mr-2",3,"ngbTooltip"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"keyup.space","keyup.enter","click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Wc(1,lC,24,25,"div",1),c.Wb(),c.Wc(2,bC,2,11,"ng-template",null,2,c.Xc),c.Wc(4,uC,2,5,"ng-template",null,3,c.Xc),c.Wc(6,dC,9,3,"ng-template",null,4,c.Xc)),2&e&&(c.Cb(1),c.wc("ngIf",t.workspace))},directives:[s.u,xy,jn.a,Py.a,iC.a,Iy.b,s.t,My.b,Cc.a,nC.a,kc.a,wl.a,TW,aW.a,DW.a,g.Z],encapsulation:2,changeDetection:0}),e})(),hC=(()=>{class e{constructor(e,t){this.subdomainService=e,this.router=t}canActivate(){return this.subdomainService.isSubdomainNotSelfhosted()&&this.router.navigate(["/tracker"]),!0}}return e.\u0275fac=function(t){return new(t||e)(c.fc(fa.a),c.fc(W.c))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var mC=i("8IBD"),gC=i("1Y3z"),fC=function(e){return e.MEMBERS="MEMBERS",e.GROUPS="GROUPS",e.REMINDERS="REMINDERS",e}({});function vC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",10),c.Xb(1,"a",3),c.jc("click",(function(){return c.Oc(e),c.nc(2).changeSort("hourlyRate")})),c.Yc(2),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(1),c.Hb("cl-up","hourlyRate"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","hourlyRate"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),c.Cb(1),c.ad("Billable Rate (",e.currency,")")}}function wC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",11),c.Xb(1,"a",3),c.jc("click",(function(){return c.Oc(e),c.nc(2).changeSort("costRate")})),c.Yc(2),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(1),c.Hb("cl-up","costRate"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","costRate"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),c.Cb(1),c.ad("Cost Rate (",e.currency,")")}}function yC(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"th",2),c.Xb(2,"a",3),c.jc("click",(function(){return c.Oc(e),c.nc().changeSort("name")})),c.Yc(3," Name"),c.Wb(),c.Wb(),c.Xb(4,"th"),c.Xb(5,"div",4),c.Xb(6,"a",3),c.jc("click",(function(){return c.Oc(e),c.nc().changeSort("email")})),c.Yc(7,"Email"),c.Wb(),c.Wb(),c.Wb(),c.Xb(8,"th"),c.Xb(9,"div",5),c.Wc(10,vC,3,5,"div",6),c.Wc(11,wC,3,5,"div",7),c.Wb(),c.Wb(),c.Xb(12,"th"),c.Xb(13,"div"),c.Xb(14,"a",8),c.Yc(15,"Role"),c.Wb(),c.Wb(),c.Wb(),c.Xb(16,"th",9),c.Xb(17,"div",4),c.Xb(18,"a",3),c.jc("click",(function(){return c.Oc(e),c.nc().changeSort("access")})),c.Yc(19,"Group"),c.Wb(),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(2),c.Hb("cl-up","name"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","name"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),c.Cb(4),c.Hb("cl-up","email"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","email"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),c.Cb(4),c.wc("ngIf",e.canSeeRates),c.Cb(1),c.wc("ngIf",e.canSeeRates&&e.hasLaborCostFeature&&e.isCostRateActive),c.Cb(7),c.Hb("cl-up","access"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","access"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING)}}function WC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"th",12),c.Xb(1,"div",13),c.Yc(2,"Name "),c.Xb(3,"div",14),c.Xb(4,"a",15),c.jc("click",(function(){return c.Oc(e),c.nc().expandAll()})),c.Xb(5,"span",16),c.Sb(6,"img",17),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(6),c.wc("src",e.isExpandAll?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",c.Qc)}}let CC=(()=>{class e{constructor(){this.onChangeSortOrder=new c.n,this.onChangeSortColumn=new c.n,this.onExpandAll=new c.n,this.isExpandAll=!1,this.SortOrder=Is.a,this.unsubscribe$=new Ee.a}ngOnInit(){}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}expandAll(){this.isExpandAll=!this.isExpandAll,this.onExpandAll.emit(this.isExpandAll)}changeSort(e){e!==this.sortColumn?this.onChangeSortColumn.emit(e):this.onChangeSortOrder.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["members-header"],["","members-header",""]],inputs:{isDesktop:"isDesktop",sortColumn:"sortColumn",sortOrder:"sortOrder",canSeeRates:"canSeeRates",hasLaborCostFeature:"hasLaborCostFeature",isCostRateActive:"isCostRateActive",currency:"currency"},outputs:{onChangeSortOrder:"onChangeSortOrder",onChangeSortColumn:"onChangeSortColumn",onExpandAll:"onExpandAll"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["mobileTemplate",""],[1,"cl-pl-lg-3"],[1,"cl-text-gray-6","cl-sort-by",3,"click"],[1,"cl-ml-lg-custom-n2"],[1,"cl-d-flex"],["class","cl-ml-lg-custom-n2 cl-team-table-members-billable-rate",4,"ngIf"],["class","cl-team-table-members-cost-rate",4,"ngIf"],[1,"cl-h5","cl-mb-0"],["colspan","2"],[1,"cl-ml-lg-custom-n2","cl-team-table-members-billable-rate"],[1,"cl-team-table-members-cost-rate"],["colspan","6",1,"cl-pl-lg-3"],[1,"cl-h5","cl-mb-0","cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-ml-auto",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"]],template:function(e,t){if(1&e&&(c.Wc(0,yC,20,14,"ng-container",0),c.Wc(1,WC,7,1,"ng-template",null,1,c.Xc)),2&e){const e=c.Lc(2);c.wc("ngIf",t.isDesktop)("ngIfElse",e)}},directives:[s.u],encapsulation:2}),e})();var kC=i("Oieg"),SC=i("sNAh"),IC=(i("k2Yt"),i("T+Hu")),OC=i("g7VG"),XC=i("5WIt"),EC=i("9ymm");let TC=(()=>{class e{constructor(e,t){this.workspaceService=e,this.formBuilder=t,this.onClose=new c.n}ngOnInit(){this.form=this.formBuilder.group({transfer:["",[p.G.required]],inProgress:[!1,[on.a.requiredFalse]]})}get transfer(){return this.form.get("transfer")}closeModal(){this.onClose.emit(!1)}textMatch(){return"transfer"!==this.transfer.value.toLowerCase()}confirm(){this.setInProgress(!0),"transfer"===this.transfer.value.trim().toLowerCase()&&(this.setInProgress(!1),this.workspaceService.transferOwnerRole(this.user.id),this.closeModal()),this.setInProgress(!1)}setInProgress(e){this.form.patchValue({inProgress:e})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(p.f))},e.\u0275cmp=c.Lb({type:e,selectors:[["transfer-owner-role"]],inputs:{user:"user"},outputs:{onClose:"onClose"},decls:17,vars:4,consts:[[3,"formGroup","ngSubmit"],[1,"cl-modal-body","cl-text-center","cl-py-4"],[1,"cl-mb-3"],["src","assets/images/illustrations/transfer-owner-role.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-mb-3","cl-text-gray-6"],[1,"cl-form-group","cl-mb-0","cl-text-left"],["formControlName","transfer","autofocus","",1,"cl-form-control",3,"type"],[1,"cl-modal-footer"],[3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"]],template:function(e,t){1&e&&(c.Xb(0,"form",0),c.jc("ngSubmit",(function(){return t.confirm()})),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Sb(3,"img",3),c.Wb(),c.Xb(4,"div",4),c.Yc(5,"Transfer owner role"),c.Wb(),c.Xb(6,"p",5),c.Yc(7),c.Wb(),c.Xb(8,"div",6),c.Xb(9,"label"),c.Yc(10,"Type TRANSFER to confirm"),c.Wb(),c.Sb(11,"input",7),c.Wb(),c.Wb(),c.Xb(12,"div",8),c.Xb(13,"a",9),c.jc("click",(function(){return t.closeModal()})),c.Yc(14,"Nevermind"),c.Wb(),c.Xb(15,"button",10),c.Yc(16," Transfer"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.wc("formGroup",t.form),c.Cb(7),c.ad("You'll be downgraded to admin and will no longer be in charge of the workspace. Are you sure you want to transfer your owner role to ",t.user.name,"?"),c.Cb(4),c.wc("type","text"),c.Cb(4),c.wc("disabled",t.form.invalid||t.textMatch()))},directives:[p.I,p.t,p.k,p.c,p.s,p.i],encapsulation:2}),e})(),DC=(()=>{class e{constructor(e){this.copyService=e,this.onClose=new c.n}ngOnInit(){}copyUrl(e){this.copyService.copyToClipboard(e)}closeModal(){this.onClose.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(J.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["invite-link"]],inputs:{url:"url"},outputs:{onClose:"onClose"},decls:16,vars:1,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-input-group","cl-mb-0"],["type","text","readonly","",1,"cl-form-control",3,"value"],["urlInput",""],[1,"cl-input-group-append"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-outline-light",3,"click"],[1,"cl-modal-footer"],[3,"click"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2,"Link created"),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.closeModal()})),c.Xb(4,"span"),c.Sb(5,"img",3),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",4),c.Xb(7,"div",5),c.Sb(8,"input",6,7),c.Xb(10,"div",8),c.Xb(11,"button",9),c.jc("click",(function(){c.Oc(e);const i=c.Lc(9);return t.copyUrl(i)})),c.Yc(12,"Copy"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(13,"div",10),c.Xb(14,"a",11),c.jc("click",(function(){return t.closeModal()})),c.Yc(15,"Close"),c.Wb(),c.Wb()}2&e&&(c.Cb(8),c.wc("value",t.url))},encapsulation:2}),e})();var RC=i("jpmO"),AC=i("nLyk"),jC=i("8v23");function xC(e,t){if(1&e&&(c.Xb(0,"h1",19),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad("",e.user.name,"'s role")}}function PC(e,t){1&e&&(c.Xb(0,"h1",19),c.Yc(1,"User role"),c.Wb())}function MC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",20),c.Xb(1,"info"),c.Yc(2," STANDARD feature "),c.Xb(3,"a",21),c.jc("click",(function(){return c.Oc(e),c.nc().navToUpgrade()})),c.Yc(4,"Upgrade"),c.Wb(),c.Wb(),c.Wb()}}function YC(e,t){if(1&e&&(c.Xb(0,"span",31),c.Yc(1),c.Wb()),2&e){const e=c.nc(3);c.Cb(1),c.ad(" ",e.numberOfSelected[e.ReportFilter.PROJECTS]," ")}}function LC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"dropdown-checkbox",32),c.jc("onSelectAllWithTextInput",(function(t){c.Oc(e);const i=c.nc(3);return i.selectAllProjectIds(t,i.ReportFilter.PROJECTS)}))("loadMore",(function(){return c.Oc(e),c.nc(3).getProjects()}))("onFilterOptionChange",(function(t){c.Oc(e);const i=c.nc(3);return i.clearOptionFilter(i.ReportFilter.PROJECTS,t),i.getProjects()}))("onSearchChange",(function(t){c.Oc(e);const i=c.nc(3);return i.onSearchChange(i.ReportFilter.PROJECTS,t),i.getProjects()}))("onCloseFilter",(function(t){c.Oc(e);const i=c.nc(3);return i.setIndicatorOf(i.ReportFilter.PROJECTS,t,!1)}))("onChange",(function(t){c.Oc(e);const i=c.nc(3);return i.valuesData[i.ReportFilter.PROJECTS]=t.checkboxValues,i.filterMaps[i.ReportFilter.PROJECTS]=t.selectableMaps,i.setIndicatorOf(i.ReportFilter.PROJECTS,t),i.checkIsChanged()})),c.Wb()}if(2&e){const e=c.nc(3);c.wc("placeholder","Find projects...")("filterName","projects")("countNumber",e.counts[e.ReportFilter.PROJECTS])("singleMapProperty",e.ReportFilter.PROJECTS)("checkboxValues",e.valuesData[e.ReportFilter.PROJECTS])("selectableMaps",e.filterMaps[e.ReportFilter.PROJECTS])("filterOptions",e.projectFilterOptions)("searchValue",e.query[e.ReportFilter.PROJECTS].name)("inProgressSelectAll",e.inProgressSelectAll[e.ReportFilter.PROJECTS])("inProgressLoading",e.inProgressLoading[e.ReportFilter.PROJECTS])}}function FC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",24),c.jc("onClose",(function(){c.Oc(e);const t=c.nc(2);return t.isOpenedMap[t.ReportFilter.PROJECTS]=!1}))("onOpen",(function(){c.Oc(e);const t=c.nc(2);return 1===t.query[t.ReportFilter.PROJECTS].page&&t.getProjects(),t.isOpenedMap[t.ReportFilter.PROJECTS]=!0})),c.Xb(1,"div",25),c.Xb(2,"div",26),c.Wc(3,YC,2,1,"span",27),c.Xb(4,"span",28),c.Yc(5),c.Wb(),c.Wb(),c.Sb(6,"div",29),c.Wb(),c.Wc(7,LC,1,10,"dropdown-checkbox",30),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(2),c.wc("ngbTooltip",e.labels[e.ReportFilter.PROJECTS]?e.labels[e.ReportFilter.PROJECTS]:""),c.Cb(1),c.wc("ngIf",e.numberOfSelected[e.ReportFilter.PROJECTS]),c.Cb(2),c.ad(" ",e.isProjectDirty?"Projects":"Select project"," ")}}function NC(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"div",22),c.Wc(2,FC,8,3,"div",23),c.Wb(),c.Ub()),2&e){const e=c.nc();c.Cb(2),c.wc("ngIf",!e.valuesData[e.ReportFilter.PROJECTS].isFilterDisabled)}}function UC(e,t){if(1&e&&(c.Xb(0,"span",31),c.Yc(1),c.Wb()),2&e){const e=c.nc(3);c.Cb(1),c.ad(" ",e.numberOfSelected[e.ReportFilter.USERS_AND_GROUP]," ")}}function $C(e,t){if(1&e){const e=c.Yb();c.Xb(0,"dropdown-checkbox",34),c.jc("loadMore",(function(){return c.Oc(e),c.nc(3).loadMoreUsers()}))("onSelectAllWithTextInput",(function(t){return c.Oc(e),c.nc(3).selectAllUserIds(t)}))("onSearchChange",(function(t){c.Oc(e);const i=c.nc(3);return i.onSearchChange(i.ReportFilter.USERS_AND_GROUP,t),i.getUsersAndUserGroups()}))("onFilterOptionChange",(function(t){c.Oc(e);const i=c.nc(3);return i.clearOptionFilter(i.ReportFilter.USERS_AND_GROUP,t),i.getUsersAndUserGroups()}))("onCloseFilter",(function(t){c.Oc(e);const i=c.nc(3);return i.setIndicatorOf(i.ReportFilter.USERS_AND_GROUP,t,!1)}))("onChange",(function(t){c.Oc(e);const i=c.nc(3);return i.valuesData[i.ReportFilter.USERS_AND_GROUP]=t.checkboxValues,i.filterMaps[i.ReportFilter.USERS_AND_GROUP]=t.selectableMaps,i.setIndicatorOf(i.ReportFilter.USERS_AND_GROUP,t),i.checkIsChanged()})),c.Wb()}if(2&e){const e=c.nc(3);c.wc("placeholder","Find member...")("showTitles",!1)("preventOfflineFiltering",!0)("singleMapProperty",e.ReportFilter.USERS_AND_GROUP)("checkboxValues",e.valuesData[e.ReportFilter.USERS_AND_GROUP])("selectableMaps",e.filterMaps[e.ReportFilter.USERS_AND_GROUP])("filterOptions",e.userFilterOptions)("countNumber",e.counts[e.ReportFilter.USERS_AND_GROUP])("searchValue",e.query[e.ReportFilter.USERS_AND_GROUP].name)("inProgressSelectAll",e.inProgressSelectAll[e.ReportFilter.USERS_AND_GROUP])("inProgressLoading",e.inProgressLoading[e.ReportFilter.USERS_AND_GROUP])}}function _C(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",24),c.jc("onClose",(function(){c.Oc(e);const t=c.nc(2);return t.isOpenedMap[t.ReportFilter.USERS_AND_GROUP]=!1}))("onOpen",(function(){c.Oc(e);const t=c.nc(2);return 1===t.query[t.ReportFilter.USERS_AND_GROUP].page&&t.getUsersAndUserGroups(),t.isOpenedMap[t.ReportFilter.USERS_AND_GROUP]=!0})),c.Xb(1,"div",25),c.Xb(2,"div",26),c.Wc(3,UC,2,1,"span",27),c.Xb(4,"span",28),c.Yc(5),c.Wb(),c.Wb(),c.Sb(6,"div",29),c.Wb(),c.Wc(7,$C,1,11,"dropdown-checkbox",33),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(2),c.wc("ngbTooltip",e.labels[e.ReportFilter.USERS_AND_GROUP]?e.labels[e.ReportFilter.USERS_AND_GROUP]:""),c.Cb(1),c.wc("ngIf",e.numberOfSelected[e.ReportFilter.USERS_AND_GROUP]),c.Cb(2),c.ad(" ",e.isUserDirty?"Users":"Select user"," ")}}function GC(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"div",22),c.Wc(2,_C,8,3,"div",23),c.Wb(),c.Ub()),2&e){const e=c.nc();c.Cb(2),c.wc("ngIf",!e.valuesData[e.ReportFilter.USERS_AND_GROUP].isFilterDisabled)}}let BC=(()=>{class e{constructor(e,t,i,n,s,r){this.router=e,this.projectService=t,this.workspaceService=i,this.userService=n,this.cd=s,this.roleService=r,this.valuesData={},this.onClose=new c.n,this.onSave=new c.n,this.onInProgress=new c.n,this.unsubscribe$=new Ee.a,this.initialEntities={},this.numberOfSelected={},this.inProgressSelectAll={},this.inProgressLoading={},this.query={},this.filterMaps={[dn.h.PROJECTS]:null,[dn.h.USERS_AND_GROUP]:null},this.isOpenedMap={},this.counts={[dn.h.PROJECTS]:null,[dn.h.USERS_AND_GROUP]:null},this.ReportFilter=dn.h,this.FilterGroup=My.a,this.projectFilterOptions=dn.p,this.userFilterOptions=dn.s,this.hasChanged=!1,this.backupValuesData={},this.backupRoleData={}}get isAdmin(){return this._isAdmin}set isAdmin(e){this._isAdmin=e,e&&(this.isTeamManager=!1,this.isProjectManager=!1)}set saveInProgress(e){const t=e!==this._saveInProgress;this._saveInProgress=e,t&&this.onInProgress.emit(e)}get saveInProgress(){return this._saveInProgress}ngOnInit(){this.resetQuery(),this.filterMaps[dn.h.PROJECTS]=new Jt.a([new dv.a(dn.h.PROJECTS)]),this.filterMaps[dn.h.USERS_AND_GROUP]=new Jt.a([new dv.a(dn.h.USERS_AND_GROUP)]),this.valuesData[dn.h.PROJECTS]=new ti.a,this.valuesData[dn.h.USERS_AND_GROUP]=new ti.a({options:Object(dn.o)()}),this.roleService.roles$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.user.roles=e,this.initValuesFromUser(),this.setAllIndicators(),this.setIsProjectDirty(),this.setIsUserDirty(),this.setBackupValues(),this.cd.detectChanges()}),this.roleService.getRolesForUser(this.user.id)}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setBackupValues(){this.backupRoleData.isAdmin=this.isAdmin,this.backupRoleData.isProjectManager=this.isProjectManager,this.backupRoleData.isTeamManager=this.isTeamManager;for(const e in this.valuesData)this.backupValuesData[e]=this.valuesData[e].getContainsFilter(e)}checkIsChanged(){this.hasChanged=this.calculateIsChange()}calculateIsChange(){if(this.backupRoleData.isAdmin!==this.isAdmin)return!0;if(this.backupRoleData.isProjectManager!==this.isProjectManager)return!0;if(this.backupRoleData.isTeamManager!==this.isTeamManager)return!0;for(const e in this.valuesData){const t=this.backupValuesData[e],i=this.valuesData[e].getContainsFilter(e);if(!ti.a.isContainsFiltersSame(i,t))return!0}return!1}initValuesFromUser(){if(this.user.refreshRoles(),this.isAdmin=this.user.isAdmin,this.isProjectManager=this.user.isProjectManager,this.isTeamManager=this.user.isTeamManager,this.isProjectManager){this.valuesData[dn.h.PROJECTS].options.status=ni.a.ALL;const e=jC.a.getRoleEntities(this.user.roles,cu.a.PROJECT_MANAGER);this.initialEntities[dn.h.PROJECTS]=e,this.valuesData[dn.h.PROJECTS].pushIds(dn.h.PROJECTS,e.map(e=>e.entityId))}if(this.isTeamManager){this.valuesData[dn.h.USERS_AND_GROUP].options.status=dn.k.ALL;const e=jC.a.getRoleEntities(this.user.roles,cu.a.TEAM_MANAGER);this.initialEntities[dn.h.USERS_AND_GROUP]=e,this.valuesData[dn.h.USERS_AND_GROUP].pushIds(dn.h.USERS_AND_GROUP,e.map(e=>e.entityId))}}setIsProjectDirty(){this.isProjectDirty=this.valuesData[dn.h.PROJECTS].isDirty()}setIsUserDirty(){this.isUserDirty=this.valuesData[dn.h.USERS_AND_GROUP].isDirty()}get isValid(){return!(this.isProjectManager&&!this.isProjectDirty||this.isTeamManager&&!this.isUserDirty)}getUsersAndUserGroups(){this.getUsers()}closeModal(){this.onClose.emit(!1)}save(){setTimeout(()=>{if(!this.isValid)return;const e=[];if(this.isAdmin){const t=new jC.a({role:cu.a.ADMIN});e.push(t)}if(this.isProjectManager){const t=new jC.a({role:cu.a.PROJECT_MANAGER,entity:this.valuesData[dn.h.PROJECTS].getContainsFilter(dn.h.PROJECTS)});e.push(t)}if(this.isTeamManager){const t=new jC.a({role:cu.a.TEAM_MANAGER,entity:this.valuesData[dn.h.USERS_AND_GROUP].getContainsFilter(dn.h.USERS_AND_GROUP)});e.push(t)}this.saveChanges(e)})}saveChanges(e){this.saveInProgress=!0,this.roleService.updateRoles(e,this.user.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.saveInProgress=!1,this.onSave.emit(e)},()=>this.saveInProgress=!1)}navToUpgrade(){this.closeModal(),this.router.navigate(["/upgrade"])}setAllIndicators(){if(this.valuesData)for(const e in this.filterMaps)this.generateIndicatorOf(e)}generateIndicatorOf(e){if(!this.initialEntities[e])return;const t=this.initialEntities[e];if(this.numberOfSelected[e]=t.length,t){const i=t.map(e=>e.name);this.labels[e]=i.join(", ")}}getProjects(e=this.query[dn.h.PROJECTS]){if(this.reachedLimit[dn.h.PROJECTS])return;const t=Object.assign({},e);t.status=this.valuesData[dn.h.PROJECTS].options.status,this.setInProgressLoading(dn.h.PROJECTS,!0),this.projectService.getProjects(t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{1===e.page&&this.filterMaps[dn.h.PROJECTS].resetAll(),this.query[dn.h.PROJECTS].page++;const i=this.transformResponse(t,"clientName","No client");for(const e in i)this.filterMaps[dn.h.PROJECTS].pushToMap(e,i[e]);const n=t.length<e.limit;this.reachedLimit[dn.h.PROJECTS]=n,n&&!e.name&&(this.counts[dn.h.PROJECTS]=this.filterMaps[dn.h.PROJECTS].count()),this.setInProgressLoading(dn.h.PROJECTS,!1)},()=>this.setInProgressLoading(dn.h.PROJECTS,!1))}loadMoreUsers(){this.getUsersAndUserGroups()}getUsers(e=this.query[dn.h.USERS_AND_GROUP]){this.reachedLimit[dn.h.USERS_AND_GROUP]||(e.statuses=this.valuesData[dn.h.USERS_AND_GROUP].options.status,e.email=e.name,this.setInProgressLoading(dn.h.USERS_AND_GROUP,!0),this.workspaceService.getUsers(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(({users:t})=>{1===e.page&&this.filterMaps[dn.h.USERS_AND_GROUP].resetAll(),this.query[dn.h.USERS_AND_GROUP].page++,this.filterMaps[dn.h.USERS_AND_GROUP].pushToMap(dn.h.USERS_AND_GROUP,t);const i=t.length<e.limit;this.reachedLimit[dn.h.USERS_AND_GROUP]=i,i&&!e.name&&(this.counts[dn.h.USERS_AND_GROUP]=this.filterMaps[dn.h.USERS_AND_GROUP].count()),this.setInProgressLoading(dn.h.USERS_AND_GROUP,!1)},()=>this.setInProgressLoading(dn.h.USERS_AND_GROUP,!1)))}transformResponse(e,t,i){const n={};return e.forEach(e=>{const s=e[t]||i;n[s]||(n[s]=[]),n[s].push(e)}),n}setInProgressLoading(e,t){this.inProgressLoading[e]=t,this.cd.markForCheck()}setInProgress(e,t=!1){this.inProgressSelectAll[e]=t,this.cd.markForCheck()}clearOptionFilter(e,t,i=!0){this.query[e].page=1,this.query[e].name=t.searchTerm,this.reachedLimit[e]=!1,i&&(this.counts[e]=null)}onSearchChange(e,t){this.clearOptionFilter(e,{searchTerm:t},!1)}setIndicatorOf(e,{numberOfSelected:t,numberOfSelectedApproximately:i,label:n}){e===dn.h.PROJECTS?this.setIsProjectDirty():this.setIsUserDirty(),this.numberOfSelected[e]=t||i,this.labels[e]=n,this.cd.markForCheck()}resetQuery(){this.query[dn.h.USERS_AND_GROUP]={page:1,limit:ei.f,name:""},this.query[dn.h.PROJECTS]={page:1,limit:ei.f,name:"",billable:RC.a.BOTH,sortColumn:AC.a.CLIENT_NAME},this.reachedLimit={},this.labels={}}selectAllUserIds(e){const t=dn.h.USERS_AND_GROUP,i={status:this.valuesData[t].options.status,name:e.searchTerm};this.setInProgress(t,!0),this.userService.getUserIds(i).pipe(Object(De.a)(this.unsubscribe$)).subscribe(i=>this.setFilterIds(e,t,i),()=>this.setInProgress(t))}selectAllProjectIds(e,t){const i={status:this.valuesData[t].options.status,name:e.searchTerm};this.setInProgress(t,!0),this.projectService.getProjectIds(i).pipe(Object(De.a)(this.unsubscribe$)).subscribe(i=>this.setFilterIds(e,t,i),()=>this.setInProgress(t))}setFilterIds(e,t,i){let n=e.isSelected;this.valuesData[t].exclude&&(n=!n),this.valuesData[t].toggleMultipleIds(t,i,n),this.isOpenedMap[t]||this.generateIndicatorOf(t),this.setInProgress(t),this.checkIsChanged()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.c),c.Rb(ci.a),c.Rb(U.a),c.Rb(ys.a),c.Rb(c.h),c.Rb(o.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["role-modal"]],inputs:{user:"user",hasManagerRoleFeature:"hasManagerRoleFeature"},outputs:{onClose:"onClose",onSave:"onSave",onInProgress:"onInProgress"},decls:35,vars:13,consts:[[1,"cl-modal-header"],["class","cl-modal-title",4,"ngIf"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-col-md-12"],[1,"cl-custom-control","cl-custom-checkbox"],["type","checkbox","ngbAutofocus","","id","role-admin","tabindex","0",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","role-admin",1,"cl-custom-control-label"],["class","cl-mb-2",4,"ngIf"],["type","checkbox","id","role-project-manager","tabindex","0",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange"],["for","role-project-manager",1,"cl-custom-control-label"],[1,"cl-text-gray-9"],[4,"ngIf"],["type","checkbox","id","role-team-manager","tabindex","0",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange"],["for","role-team-manager",1,"cl-custom-control-label"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["ngbAutofocus","","type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-modal-title"],[1,"cl-mb-2"],[1,"cl-btn",3,"click"],[1,"cl-d-report-filter-item"],["dropdownKey","","class","cl-dropdown cl-dropdown-large cl-d-flex cl-w-100",3,"onClose","onOpen",4,"ngIf"],["dropdownKey","",1,"cl-dropdown","cl-dropdown-large","cl-d-flex","cl-w-100",3,"onClose","onOpen"],[1,"cl-d-flex","cl-w-100"],["dropdownKeyButton","","tabindex","0","placement","bottom",1,"cl-dropdown",3,"ngbTooltip"],["class","cl-badge cl-badge-filter","style","z-index: 1;",4,"ngIf"],[1,"cl-dropdown-item-label","cl-btn","cl-btn-outline-light","cl-w-100","cl-text-left","cl-dropdown-toggle","cl-cut-text","pointer"],["clickCloseDropdown","",1,"cl-flex-grow-1"],[3,"placeholder","filterName","countNumber","singleMapProperty","checkboxValues","selectableMaps","filterOptions","searchValue","inProgressSelectAll","inProgressLoading","onSelectAllWithTextInput","loadMore","onFilterOptionChange","onSearchChange","onCloseFilter","onChange",4,"dropdownKeyContent"],[1,"cl-badge","cl-badge-filter",2,"z-index","1"],[3,"placeholder","filterName","countNumber","singleMapProperty","checkboxValues","selectableMaps","filterOptions","searchValue","inProgressSelectAll","inProgressLoading","onSelectAllWithTextInput","loadMore","onFilterOptionChange","onSearchChange","onCloseFilter","onChange"],["openUpAtBottom","",3,"placeholder","showTitles","preventOfflineFiltering","singleMapProperty","checkboxValues","selectableMaps","filterOptions","countNumber","searchValue","inProgressSelectAll","inProgressLoading","loadMore","onSelectAllWithTextInput","onSearchChange","onFilterOptionChange","onCloseFilter","onChange",4,"dropdownKeyContent"],["openUpAtBottom","",3,"placeholder","showTitles","preventOfflineFiltering","singleMapProperty","checkboxValues","selectableMaps","filterOptions","countNumber","searchValue","inProgressSelectAll","inProgressLoading","loadMore","onSelectAllWithTextInput","onSearchChange","onFilterOptionChange","onCloseFilter","onChange"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Wc(1,xC,2,1,"h1",1),c.Wc(2,PC,2,0,"h1",1),c.Xb(3,"button",2),c.jc("click",(function(){return t.closeModal()})),c.Xb(4,"span"),c.Sb(5,"img",3),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",4),c.Xb(7,"div",5),c.Xb(8,"div",6),c.Xb(9,"input",7),c.jc("ngModelChange",(function(e){return t.isAdmin=e}))("ngModelChange",(function(){return t.checkIsChanged()})),c.Wb(),c.Xb(10,"label",8),c.Yc(11," Admin "),c.Wb(),c.Wb(),c.Sb(12,"hr"),c.Wc(13,MC,5,0,"div",9),c.Xb(14,"div"),c.Xb(15,"div",6),c.Xb(16,"input",10),c.jc("ngModelChange",(function(e){return t.isProjectManager=e}))("ngModelChange",(function(){return t.checkIsChanged()})),c.Wb(),c.Xb(17,"label",11),c.Yc(18," Project manager "),c.Wb(),c.Xb(19,"p",12),c.Yc(20,"Can edit all projects they manage and see all time on those projects"),c.Wb(),c.Wc(21,NC,3,1,"ng-container",13),c.Wb(),c.Sb(22,"hr"),c.Xb(23,"div",6),c.Xb(24,"input",14),c.jc("ngModelChange",(function(e){return t.isTeamManager=e}))("ngModelChange",(function(){return t.checkIsChanged()})),c.Wb(),c.Xb(25,"label",15),c.Yc(26," Team manager "),c.Wb(),c.Xb(27,"p",12),c.Yc(28,"Can see all time of users they manage and approve their timesheets"),c.Wb(),c.Wc(29,GC,3,1,"ng-container",13),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(30,"div",16),c.Xb(31,"a",17),c.jc("click",(function(){return t.closeModal()})),c.Yc(32,"Cancel"),c.Wb(),c.Xb(33,"button",18),c.jc("click",(function(){return t.save()})),c.Yc(34," Save "),c.Wb(),c.Wb()),2&e&&(c.Cb(1),c.wc("ngIf",t.user.name),c.Cb(1),c.wc("ngIf",!t.user.name),c.Cb(7),c.wc("ngModel",t.isAdmin),c.Cb(4),c.wc("ngIf",!t.hasManagerRoleFeature),c.Cb(1),c.Hb("cl-disabled",!t.hasManagerRoleFeature),c.Cb(2),c.wc("ngModel",t.isProjectManager)("disabled",t.isAdmin||!t.hasManagerRoleFeature),c.Cb(5),c.wc("ngIf",t.isProjectManager),c.Cb(3),c.wc("ngModel",t.isTeamManager)("disabled",t.isAdmin||!t.hasManagerRoleFeature),c.Cb(5),c.wc("ngIf",t.isTeamManager),c.Cb(4),c.wc("disabled",t.saveInProgress||!t.isValid||!t.hasChanged))},directives:[s.u,p.a,p.s,p.v,fr.a,Si.a,Ii.a,g.Z,Oi.a,Ly.a],encapsulation:2,changeDetection:0}),e})();var VC=i("Fnfa");function HC(e,t){1&e&&c.Tb(0)}function zC(e,t){if(1&e&&(c.Xb(0,"div",16),c.Xb(1,"span",17),c.Yc(2),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Vc("text-decoration","INACTIVE"==e.membershipStatus?"line-through":""),c.Cb(1),c.xc("title",e.getUserName()),c.Cb(1),c.Zc(e.getUserName())}}function qC(e,t){if(1&e&&(c.Xb(0,"div",18),c.Xb(1,"span",17),c.Yc(2),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.xc("title",e.user.email),c.Cb(1),c.Zc(e.user.email)}}function KC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",27),c.Xb(1,"span",28),c.Xb(2,"a",29),c.jc("click",(function(){c.Oc(e);const t=c.nc(3),i=c.Lc(24);return t.openModal(i,"md")})),c.Yc(3,"Change"),c.Wb(),c.Wb(),c.Wb()}}function ZC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",22),c.Xb(1,"div",23),c.Xb(2,"input",24,25),c.jc("keyup.enter",(function(){return c.Oc(e),c.Lc(3).blur()})),c.Wb(),c.Wc(4,KC,4,0,"div",26),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(2),c.wc("ngModel",e.hourlyRatePlaceholder),c.Cb(2),c.wc("ngIf",e.isCurrentUserAdminOrOwner)}}function QC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",27),c.Xb(1,"span",28),c.Xb(2,"a",29),c.jc("click",(function(){c.Oc(e);const t=c.nc(3),i=c.Lc(26);return t.openModal(i,"md")})),c.Yc(3,"Change"),c.Wb(),c.Wb(),c.Wb()}}function JC(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",30),c.Xb(1,"div",23),c.Xb(2,"input",31,32),c.jc("keyup.enter",(function(){return c.Oc(e),c.Lc(3).blur()})),c.Wb(),c.Wc(4,QC,4,0,"div",26),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(2),c.wc("ngModel",e.costRatePlaceholder),c.Cb(2),c.wc("ngIf",e.isCurrentUserAdminOrOwner)}}function ek(e,t){if(1&e&&(c.Xb(0,"div",19),c.Wc(1,ZC,5,2,"div",20),c.Wc(2,JC,5,2,"div",21),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.canSeeRates),c.Cb(1),c.wc("ngIf",e.canSeeRates&&e.hasHistoricRatesFeature&&!!e.workspace&&e.workspace.isCostRateActive)}}function tk(e,t){1&e&&(c.Xb(0,"span",37),c.Yc(1,"Owner"),c.Wb())}function ik(e,t){1&e&&(c.Xb(0,"span",42),c.Yc(1,"Admin"),c.Wb())}function nk(e,t){1&e&&(c.Xb(0,"span",43),c.Yc(1,"Project Manager"),c.Wb())}function sk(e,t){1&e&&(c.Xb(0,"span",44),c.Yc(1,"Team Manager"),c.Wb())}function ck(e,t){1&e&&(c.Xb(0,"span",45),c.Sb(1,"img",46),c.Xb(2,"span",47),c.Yc(3,"Role"),c.Wb(),c.Wb())}function rk(e,t){if(1&e&&(c.Wc(0,ik,2,0,"span",38),c.Wc(1,nk,2,0,"span",39),c.Wc(2,sk,2,0,"span",40),c.Wc(3,ck,4,0,"span",41)),2&e){const e=c.nc(2);c.wc("ngIf",e.user.isAdmin),c.Cb(1),c.wc("ngIf",e.user.isProjectManager),c.Cb(1),c.wc("ngIf",e.user.isTeamManager),c.Cb(1),c.wc("ngIf",e.isCurrentUserAdminOrOwner&&e.user.isRegular)}}function ok(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",33),c.Xb(1,"span",34),c.jc("click",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(28);return t.openModalDecider(i)})),c.Wc(2,tk,2,0,"span",35),c.Wc(3,rk,4,4,"ng-template",null,36,c.Xc),c.Wb(),c.Wb()}if(2&e){const e=c.Lc(4),t=c.nc();c.Cb(1),c.Hb("pointer",t.isCurrentUserAdminOrOwner&&t.ownerId!==t.user.id),c.Cb(1),c.wc("ngIf",t.user.id==t.ownerId)("ngIfElse",e)}}function ak(e,t){1&e&&(c.Xb(0,"span"),c.Yc(1,"Everyone"),c.Wb())}function lk(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.oc(2,"displayNames"),c.Wb()),2&e){const e=c.nc(4);c.Cb(1),c.Zc(c.pc(2,1,e.userGroupNames))}}function bk(e,t){if(1&e&&c.Wc(0,lk,3,3,"span",56),2&e){const e=c.nc(3);c.wc("ngIf",e.userGroupNames.length>0)}}const uk=function(e){return{"cl-dropdown-toggle":e}};function dk(e,t){if(1&e&&(c.Xb(0,"span",53),c.oc(1,"displayNames"),c.Wc(2,ak,2,0,"span",54),c.Wc(3,bk,1,1,"ng-template",null,55,c.Xc),c.Wb()),2&e){const e=c.Lc(4),t=c.nc(2);c.xc("title",c.pc(1,4,t.userGroupNames)),c.wc("ngClass",c.Bc(6,uk,t.isCurrentUserAdminOrOwner)),c.Cb(2),c.wc("ngIf",t.userGroups.length>0&&t.userGroups.length==t.userGroupNames.length)("ngIfElse",e)}}function pk(e,t){if(1&e){const e=c.Yb();c.Xb(0,"dropdown-filter",57),c.jc("closeFilter",(function(t){return c.Oc(e),c.nc(2).closeEditTeamDropdown(t)})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("entityList",e.UGlist)("onlyCheckbox",!1)("placeholder","Find user groups...")("isReminder",!1)("selectedUsers",e.previousState)("everyoneSelected",e.userGroups.length>0&&e.userGroups.length==e.userGroupNames.length)("user",e.user)("isEditing",!0)("ownerId",e.ownerId)("currentUserId",e.currentUserId)("showSelectAll",!1)}}const hk=function(e){return{"cl-dropdown-toggle pointer":e}};function mk(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",48),c.Xb(1,"span",49),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.openEditTeamDropdown(t.user)})),c.Xb(2,"div",50),c.Wc(3,dk,5,8,"span",51),c.Wb(),c.Wb(),c.Wc(4,pk,1,11,"dropdown-filter",52),c.Wb()}if(2&e){const e=c.nc(),t=c.Lc(14);c.Cb(1),c.wc("ngClass",c.Bc(4,hk,e.isCurrentUserAdminOrOwner)),c.Cb(2),c.wc("ngIf",e.userGroupNames.length>0)("ngIfElse",t),c.Cb(1),c.wc("ngIf",e.shouldOpen&&e.isCurrentUserAdminOrOwner)}}function gk(e,t){1&e&&(c.Xb(0,"a",59),c.Sb(1,"img",46),c.Xb(2,"span",60),c.Yc(3,"Group"),c.Wb(),c.Wb())}function fk(e,t){if(1&e&&c.Wc(0,gk,4,0,"a",58),2&e){const e=c.nc();c.wc("ngIf",e.isCurrentUserAdminOrOwner)}}function vk(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",70),c.jc("click",(function(){c.Oc(e);const t=c.nc(4),i=c.Lc(18);return t.openModal(i)})),c.Yc(1," Transfer ownership "),c.Wb()}}function wk(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"button",70),c.jc("click",(function(){c.Oc(e);const t=c.nc(4);return t.resendInvite(t.user.id)})),c.Yc(2," Send an invite email "),c.Wb(),c.Ub()}}function yk(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",70),c.jc("click",(function(){c.Oc(e);const t=c.nc(4);return t.changeMembershipStatus(t.user)})),c.Yc(1),c.Wb()}if(2&e){const e=c.nc(4);c.Cb(1),c.ad(" ",e.changeStatusText," ")}}function Wk(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",71),c.jc("click",(function(){c.Oc(e);const t=c.nc(4),i=c.Lc(22);return!t.user.name&&t.getInviteLink(i)})),c.Yc(1," Copy invite link "),c.Wb()}if(2&e){const e=c.nc(4);c.wc("placement","left")("ngClass",e.user.name?"cl-opacity-5 cl-cursor-default":"")("ngbTooltip",e.user.name?"Already has an account. Ask them to log in and accept the invite.":""),c.Db("clickCloseDropdown",e.user.name?null:"")}}function Ck(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"button",72),c.jc("click",(function(){c.Oc(e);const t=c.nc(4),i=c.Lc(20);return t.openModal(i)})),c.Yc(2," Delete user "),c.Wb(),c.Ub()}}function kk(e,t){if(1&e&&(c.Xb(0,"div",66),c.Xb(1,"div",67),c.Wc(2,vk,2,0,"button",68),c.Wc(3,wk,3,0,"ng-container",56),c.Wc(4,yk,2,1,"button",68),c.Wc(5,Wk,2,4,"button",69),c.Wc(6,Ck,3,0,"ng-container",56),c.Wb(),c.Wb()),2&e){const e=c.nc(3);c.Cb(2),c.wc("ngIf","ACTIVE"==e.membershipStatus&&e.currentUserId===e.ownerId),c.Cb(1),c.wc("ngIf",e.ownerId!==e.user.id&&e.canResend),c.Cb(1),c.wc("ngIf","PENDING"!==e.membershipStatus&&(!e.user.isAdmin||e.currentUserId===e.ownerId)),c.Cb(1),c.wc("ngIf","PENDING"===e.membershipStatus),c.Cb(1),c.wc("ngIf",e.canDelete())}}function Sk(e,t){if(1&e&&(c.Xb(0,"div",62),c.Xb(1,"div",63),c.Sb(2,"img",64),c.Wb(),c.Wc(3,kk,7,5,"div",65),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngClass",c.Bc(1,uk,e.isCurrentUserAdminOrOwner))}}function Ik(e,t){if(1&e&&c.Wc(0,Sk,4,3,"div",61),2&e){const e=c.nc();c.wc("ngIf",e.showSettings())}}function Ok(e,t){if(1&e&&(c.Xb(0,"transfer-owner-role",73),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb()),2&e){const e=c.nc();c.wc("user",e.user)}}function Xk(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",74),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().removeConfirmed(i)}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Xb(1,"p",75),c.Yc(2,"The user will lose access to this workspace, but their tracked data will remain. This action can't be reversed. "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Remove user")("btnText","Remove")("isDanger",!0)("inProgress",e.inProgress)}}function Ek(e,t){if(1&e&&(c.Xb(0,"invite-link",76),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb()),2&e){const e=c.nc();c.wc("url",e.invitationCode)}}function Tk(e,t){if(1&e){const e=c.Yb();c.Xb(0,"hourly-rate",77),c.jc("onClose",(function(){return t.$implicit.close()}))("saveRate",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().updateHourlyRate(i),n.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("user",e.user)("type",e.rateType.WORKSPACE_MEMBER)("hourlyRate",e.hourlyRate)("hasHistoricRateFeature",e.hasHistoricRatesFeature)}}function Dk(e,t){if(1&e){const e=c.Yb();c.Xb(0,"cost-rate",78),c.jc("onClose",(function(){return t.$implicit.close()}))("saveRate",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().updateCostRate(i),n.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("user",e.user)("type",e.rateType.WORKSPACE_MEMBER)("costRate",e.costRate)("hasHistoricRateFeature",e.hasHistoricRatesFeature)}}function Rk(e,t){if(1&e){const e=c.Yb();c.Xb(0,"role-modal",79),c.jc("onInProgress",(function(t){return c.Oc(e),c.nc().inProgressRole=t}))("onSave",(function(i){c.Oc(e);const n=t.$implicit,s=c.nc();return s.user.roles=i,s.closeModal(n)}))("onClose",(function(){c.Oc(e);const i=t.$implicit;return c.nc().closeModal(i)})),c.Wb()}if(2&e){const e=c.nc();c.wc("user",e.user)("hasManagerRoleFeature",e.hasManagerRoleFeature)}}const Ak=function(e){return{labels:e}},jk=function(e,t,i,n,s,c){return[e,t,i,n,s,c]};let xk=(()=>{class e{constructor(e,t,i,n,s,r){this.modalService=e,this.accountsUsersService=t,this.cd=i,this.userGroupService=n,this.workspaceService=s,this.authService=r,this.onDeleted=new c.n,this.seatsTaken=new c.n,this.onGroupsSearchChange=new c.n,this.userGroupNames=[],this.memberships=[],this.canResend=!1,this.shouldOpen=!1,this.unsubscribe$=new Ee.a,this.allUserGroupIds=[],this.UGlist=[],this.selectedUgs=[],this.userGroupIds=[],this.userGroupsToRemove=[],this.userGroupsToAdd=[],this.allUserGroupNames=[],this.showRate=!1,this.focus=!1,this.rateType=sr.a,this.hourlyRate=new SC.a,this.costRate=new OC.a}ngOnInit(){this.cd.detectChanges(),this.createUGs(),this.previousState=this.userGroups.filter(e=>e.userIds.indexOf(this.user.id)>-1).map(e=>e.id),this.allUserGroupIds=this.userGroups.map(e=>e.id),this.allUserGroupNames=this.userGroups.map(e=>e.name),this.filterNames(),this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e}),this.getHourlyRateForTeamMember(),this.canResendInvite(),this.setCostRateLabel(),this.setHourlyRateLabel(),this.cd.detectChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getInviteLink(e){this.user.name||this.authService.getInvitationLink(this.user.id,this.workspace.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.invitationCode=JSON.parse(t).link,this.openModal(e)})}showSettings(){return(this.currentUserId===this.ownerId||!this.user.isAdmin)&&this.ownerId!==this.user.id&&this.isCurrentUserAdminOrOwner&&this.currentUserId!==this.user.id}canDelete(){return this.membershipStatus!=Xs.a.ACTIVE&&!(this.user.isAdmin&&this.ownerId!=this.currentUserId)}isCurrentUserOwner(){return this.currentUserId===this.ownerId}openModalDecider(e){(this.isCurrentUserOwner()||!this.user.isAdmin&&!this.isCurrentUserOwner())&&this.isCurrentUserAdminOrOwner&&this.user.id!==this.ownerId&&this.openModal(e,"md")}displayRate(){this.showRate=!0,this.focus=!0}setCostRateLabel(){this.costRatePlaceholder=Object(Pt.m)(this.costRate)}setHourlyRateLabel(){this.hourlyRatePlaceholder=Object(Pt.n)(this.hourlyRate)}getHourlyRateForTeamMember(){if(!this.user)return null;const e=this.user.memberships.filter(e=>e.targetId===this.workspace.id)[0];return this.hourlyRate.amount=null===e.hourlyRate?0:e.hourlyRate.amount/100,this.costRate.amount=e.costRate&&e.costRate.amount/100,this.costRate.currency=this.workspace.costRate.currency,this.hourlyRate.currency=this.workspace.hourlyRate.currency,this.cd.detectChanges(),null}filterNames(){this.userGroups.map(e=>this.selectedUgs.push(e)),this.userGroups.filter(e=>e.userIds.indexOf(this.user.id)>-1).forEach(e=>this.userGroupNames.push(e.name))}openModal(e,t="lg"){this.modalService.open(e,{beforeDismiss:()=>!this.inProgressRole,size:t,centered:!0})}closeModal(e){this.inProgressRole||(this.inProgressRole=!1,e.close())}updateHourlyRate(e){const t=new SC.a({amount:e.amount?e.amount:0,currency:this.workspace.hourlyRate.currency||"USD",since:e.since});this.user.id&&(this.hourlyRate.amount=t.amount,this.workspaceService.setHourlyRateForUserId(this.user.id,t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.setHourlyRateLabel(),this.cd.markForCheck()}))}updateCostRate(e){const t=new OC.a({amount:null!==e.amount?e.amount:null,currency:this.workspace.hourlyRate.currency||"USD",since:e.since});this.user.id&&(this.costRate.amount=t.amount,this.workspaceService.setCostRateForUser(this.user.id,t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.setCostRateLabel(),this.cd.markForCheck()}))}canResendInvite(){const e=this.user.memberships.filter(e=>e.targetId===this.workspace.id)[0];this.membershipStatus=e.membershipStatus,this.canResend=e.membershipStatus==Xs.a.PENDING,this.changeStatusText=e.membershipStatus==Xs.a.INACTIVE?"Activate":"Deactivate",this.cd.detectChanges()}changeMembershipStatus(e){if(this.membershipStatus==Xs.a.ACTIVE)this.workspaceService.setStatus(e.id,XC.a.INACTIVE),this.membershipStatus=Xs.a.INACTIVE,this.changeStatusText="Activate",this.user.memberships.filter(e=>e.targetId===this.workspace.id)[0].membershipStatus="3";else{if(this.isAllSeatsTaken&&this.workspace.featureSubscriptionType&&ku.a[this.workspace.featureSubscriptionType].bySeat)return void this.seatsTaken.emit(!0);this.workspaceService.setStatus(e.id,XC.a.ACTIVE),this.membershipStatus=Xs.a.ACTIVE,this.changeStatusText="Deactivate",this.user.memberships.filter(e=>e.targetId===this.workspace.id)[0].membershipStatus="1"}this.cd.detectChanges()}resendInvite(e){this.workspaceService.resendInvite(e)}removeConfirmed(e){this.inProgress||(this.inProgress=!0,this.accountsUsersService.removeUserAccount(this.user.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.onDeleted.emit(),this.inProgress=!1,this.workspaceService.getDefaultWorkspace(),e.close()},()=>{this.inProgress=!1,this.cd.detectChanges()}))}getUserName(){return this.membershipStatus==Xs.a.PENDING?this.doesHaveAName():this.isCurrentUser()}doesHaveAName(){return this.user.name?this.user.name+" (not joined yet)":"(not joined yet)"}isCurrentUser(){return this.user.id===this.currentUserId?this.user.name+" (you)":this.user.name}createUGs(){this.UGlist=new Array(Object(IC.a)("Groups",this.userGroups)),this.cd.detectChanges()}openEditTeamDropdown(e){this.shouldOpen=!!e.id}closeEditTeamDropdown(e){this.userGroupIds=this.userGroups.filter(e=>e.userIds.indexOf(this.user.id)>-1).map(e=>e.id),this.transformMapsToIdsUpdate(e),this.closeAllDropdowns()}transformMapsToIdsUpdate(e){e.forEach(e=>{"Groups"===e.key&&this.updateUserGroupIds(e.value),"Everyone"===e.key&&this.updateEveryone()})}updateEveryone(){this.userGroupIds=["everyone"],this.updateUserGroupIds([])}updateUserGroupIds(e){this.userGroupIds.indexOf("everyone")>-1?(this.userGroupsToAdd=this.allUserGroupIds.filter(e=>this.previousState.indexOf(e)<0),this.userGroupNames=this.allUserGroupNames,this.userGroupIds=this.allUserGroupIds):(this.userGroupIds=e.filter(e=>e.selected).map(e=>new kC.a(e.entity).id),this.userGroupNames=e.filter(e=>e.selected).map(e=>new kC.a(e.entity).name),this.userGroupsToAdd=this.userGroupIds.filter(e=>this.previousState.indexOf(e)<0),this.userGroupsToRemove=this.previousState.filter(e=>this.userGroupIds.indexOf(e)<0)),this.previousState=[...this.userGroupIds]}closeAllDropdowns(){const e=[];e.push(this.user.id),this.userGroupsToAdd.length>0&&this.userGroupService.addUserToUserGroup(this.userGroupsToAdd,e),this.userGroupsToRemove.length>0&&this.userGroupService.removeUserFromUserGroup(this.userGroupsToRemove,e),this.shouldOpen=!1}onSearchChange(e){this.onGroupsSearchChange.emit(e)}onScroll(){}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(g.q),c.Rb($),c.Rb(c.h),c.Rb(mg.a),c.Rb(U.a),c.Rb(Ce.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["members-row"],["","members-row",""]],inputs:{isCurrentUserAdminOrOwner:"isCurrentUserAdminOrOwner",isDesktop:"isDesktop",user:"user",labels:"labels",ownerId:"ownerId",showGroup:"showGroup",userGroups:"userGroups",isOwner:"isOwner",currentUserId:"currentUserId",expandAll:"expandAll",canSeeRates:"canSeeRates",hasManagerRoleFeature:"hasManagerRoleFeature",hasHistoricRatesFeature:"hasHistoricRatesFeature",isAllSeatsTaken:"isAllSeatsTaken"},outputs:{onDeleted:"onDeleted",seatsTaken:"seatsTaken",onGroupsSearchChange:"onGroupsSearchChange"},decls:29,vars:14,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-d-none",3,"isDesktop","templates","isExpanded"],["responsive",""],["col1",""],["col2",""],["col3",""],["col4",""],["col5",""],["noUserGroups",""],["col6",""],["transferOwnerRoleModal",""],["removeModal",""],["inviteLink",""],["hourlyRateModal",""],["costRateModal",""],["roleModal",""],[1,"cl-d-inline-flex","cl-cut-text-wrapper","cl-w-100","cl-py-0","cl-py-lg-custom-2","cl-pl-lg-2","cl-pl-lg-custom-0","cl-pr-2"],[1,"cl-cut-text",3,"title"],[1,"cl-component-divided-left","cl-cursor-default","cl-d-flex"],[1,"cl-d-flex","cl-flex-column","cl-flex-lg-row"],["class","cl-component-divided-left cl-team-table-members-billable-rate",4,"ngIf"],["class","cl-component-divided-left cl-team-table-members-cost-rate",4,"ngIf"],[1,"cl-component-divided-left","cl-team-table-members-billable-rate"],[1,"cl-input-group","cl-input-group-sm"],["type","text","name","hourlyRate","spellcheck","false","inputNumber","","autocomplete","off","readonly","",1,"cl-form-control","cl-text-lg-left","tr-reset-min-h","cl-cursor-disabled",3,"ngModel","keyup.enter"],["hourlyRateInput",""],["class","cl-input-group-append",4,"ngIf"],[1,"cl-input-group-append"],[1,"cl-input-group-text","cl-bg-white"],[1,"cl-color-blue",3,"click"],[1,"cl-component-divided-left","cl-team-table-members-cost-rate"],["type","text","name","costRate","spellcheck","false","inputNumber","","autocomplete","off","readonly","",1,"cl-form-control","cl-text-lg-left","tr-reset-min-h","cl-cursor-disabled",3,"ngModel","keyup.enter"],["costRateInput",""],[1,"cl-component-divided-left","cl-cut-text-wrapper","cl-w-100"],[1,"cl-w-100","cl-d-flex",3,"click"],["class","cl-badge cl-badge-tag cl-bg-primary cl-text-white cl-mr-1","title","Owner",4,"ngIf","ngIfElse"],["notOwnerTemplate",""],["title","Owner",1,"cl-badge","cl-badge-tag","cl-bg-primary","cl-text-white","cl-mr-1"],["class","cl-badge cl-badge-tag cl-bg-primary cl-text-white cl-mr-1","title","Admin",4,"ngIf"],["class","cl-badge cl-badge-tag cl-mr-1 cl-cut-text","title","Project Manager",4,"ngIf"],["class","cl-badge cl-badge-tag cl-mr-1 cl-cut-text","title","Team Manager",4,"ngIf"],["class","cl-d-flex cl-color-blue cl-align-items-center",4,"ngIf"],["title","Admin",1,"cl-badge","cl-badge-tag","cl-bg-primary","cl-text-white","cl-mr-1"],["title","Project Manager",1,"cl-badge","cl-badge-tag","cl-mr-1","cl-cut-text"],["title","Team Manager",1,"cl-badge","cl-badge-tag","cl-mr-1","cl-cut-text"],[1,"cl-d-flex","cl-color-blue","cl-align-items-center"],["src","assets/images/ui-icons/plus-blue.svg"],[1,"cl-ml-2"],[1,"cl-dropdown","cl-dropdown-large","cl-w-100","cl-d-inline-flex","cl-mt-lg-1"],[1,"cl-no-arrow","cl-component-divided-left","cl-d-flex","cl-w-100",3,"ngClass","click"],[1,"cl-cut-text-wrapper","cl-w-100","cl-d-flex","cl-justify-content-center","cl-justify-content-lg-start"],["class","cl-badge cl-badge-tag cl-cut-text",3,"title","ngClass",4,"ngIf","ngIfElse"],[3,"entityList","onlyCheckbox","placeholder","isReminder","selectedUsers","everyoneSelected","user","isEditing","ownerId","currentUserId","showSelectAll","closeFilter",4,"ngIf"],[1,"cl-badge","cl-badge-tag","cl-cut-text",3,"title","ngClass"],[4,"ngIf","ngIfElse"],["groupNamesTemplate",""],[4,"ngIf"],[3,"entityList","onlyCheckbox","placeholder","isReminder","selectedUsers","everyoneSelected","user","isEditing","ownerId","currentUserId","showSelectAll","closeFilter"],["class","cl-d-flex",4,"ngIf"],[1,"cl-d-flex"],[1,"cl-ml-2","cl-color-blue"],["class","cl-dropdown cl-d-flex cl-justify-content-end cl-w-100","dropdownKey","",4,"ngIf"],["dropdownKey","",1,"cl-dropdown","cl-d-flex","cl-justify-content-end","cl-w-100"],["dropdownKeyButton","","tabindex","0",1,"cl-component-divided-left","cl-d-flex","cl-no-arrow","pointer",3,"ngClass"],["src","assets/images/ui-icons/menu-dots-vertical.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right","openUpAtBottom","",4,"dropdownKeyContent"],["openUpAtBottom","",1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area"],["class","cl-dropdown-item","clickCloseDropdown","",3,"click",4,"ngIf"],["class","cl-dropdown-item",3,"placement","ngClass","ngbTooltip","click",4,"ngIf"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],[1,"cl-dropdown-item",3,"placement","ngClass","ngbTooltip","click"],["clickCloseDropdown","",1,"cl-dropdown-item","cl-text-danger",3,"click"],[3,"user","onClose"],[3,"title","btnText","isDanger","inProgress","confirmed","close"],[1,"cl-mb-0"],[3,"url","onClose"],[3,"user","type","hourlyRate","hasHistoricRateFeature","onClose","saveRate"],[3,"user","type","costRate","hasHistoricRateFeature","onClose","saveRate"],[3,"user","hasManagerRoleFeature","onInProgress","onSave","onClose"]],template:function(e,t){if(1&e&&(c.Wc(0,HC,1,0,"ng-container",0),c.Sb(1,"responsive-row",1,2),c.Wc(3,zC,3,4,"ng-template",null,3,c.Xc),c.Wc(5,qC,3,2,"ng-template",null,4,c.Xc),c.Wc(7,ek,3,2,"ng-template",null,5,c.Xc),c.Wc(9,ok,5,4,"ng-template",null,6,c.Xc),c.Wc(11,mk,5,6,"ng-template",null,7,c.Xc),c.Wc(13,fk,1,1,"ng-template",null,8,c.Xc),c.Wc(15,Ik,1,1,"ng-template",null,9,c.Xc),c.Wc(17,Ok,1,1,"ng-template",null,10,c.Xc),c.Wc(19,Xk,3,4,"ng-template",null,11,c.Xc),c.Wc(21,Ek,1,1,"ng-template",null,12,c.Xc),c.Wc(23,Tk,1,4,"ng-template",null,13,c.Xc),c.Wc(25,Dk,1,4,"ng-template",null,14,c.Xc),c.Wc(27,Rk,1,2,"ng-template",null,15,c.Xc)),2&e){const e=c.Lc(2),i=c.Lc(4),n=c.Lc(6),s=c.Lc(8),r=c.Lc(10),o=c.Lc(12),a=c.Lc(16);c.wc("ngTemplateOutlet",e.template)("ngTemplateOutletContext",c.Bc(5,Ak,t.labels)),c.Cb(1),c.wc("isDesktop",t.isDesktop)("templates",c.Gc(7,jk,i,n,s,r,o,a))("isExpanded",t.expandAll)}},directives:[s.B,Fi.a,s.u,p.c,Zr.a,p.s,p.v,s.r,EC.a,Si.a,Ii.a,Oi.a,g.Z,TC,Ui.a,DC,wr.a,yr.a,BC],pipes:[VC.a],encapsulation:2,changeDetection:0}),e})();const Pk=["captchaElem"];function Mk(e,t){1&e&&(c.Xb(0,"div",20),c.Yc(1," Please type a valid email address. "),c.Wb())}function Yk(e,t){if(1&e&&(c.Xb(0,"div",20),c.Xb(1,"strong"),c.Yc(2),c.Wb(),c.Yc(3," are not valid emails. "),c.Wb()),2&e){const e=c.nc(2);c.Cb(2),c.Zc(e.emails.errors.invalidEmails)}}function Lk(e,t){if(1&e&&(c.Xb(0,"div",20),c.Xb(1,"strong"),c.Yc(2),c.Wb(),c.Yc(3," is not a valid email. "),c.Wb()),2&e){const e=c.nc(2);c.Cb(2),c.Zc(e.emails.errors.invalidEmail)}}function Fk(e,t){if(1&e&&(c.Xb(0,"div",20),c.Xb(1,"strong"),c.Yc(2),c.Wb(),c.Yc(3," are already invited. "),c.Wb()),2&e){const e=c.nc(2);c.Cb(2),c.Zc(e.emails.errors.duplicatedEmails)}}function Nk(e,t){if(1&e&&(c.Xb(0,"div",20),c.Xb(1,"strong"),c.Yc(2),c.Wb(),c.Yc(3," is already invited. "),c.Wb()),2&e){const e=c.nc(2);c.Cb(2),c.Zc(e.emails.errors.duplicatedEmail)}}function Uk(e,t){if(1&e&&(c.Vb(0,18),c.Wc(1,Mk,2,0,"div",19),c.Wc(2,Yk,4,1,"div",19),c.Wc(3,Lk,4,1,"div",19),c.Wc(4,Fk,4,1,"div",19),c.Wc(5,Nk,4,1,"div",19),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.emails.errors.required),c.Cb(1),c.wc("ngIf",e.emails.errors.invalidEmails),c.Cb(1),c.wc("ngIf",e.emails.errors.invalidEmail),c.Cb(1),c.wc("ngIf",e.emails.errors.duplicatedEmails),c.Cb(1),c.wc("ngIf",e.emails.errors.duplicatedEmail)}}function $k(e,t){if(1&e&&(c.Xb(0,"small",21),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.captchaActive?"Add up to 5 members at once by separating emails with a comma":"Add multiple members at once by separating emails with a comma"," ")}}function _k(e,t){if(1&e){const e=c.Yb();c.Xb(0,"form",23),c.Xb(1,"ngx-recaptcha2",24,25),c.jc("reset",(function(){return c.Oc(e),c.nc(2).handleReset()}))("expire",(function(){return c.Oc(e),c.nc(2).handleExpire()}))("load",(function(){return c.Oc(e),c.nc(2).handleLoad()}))("success",(function(t){return c.Oc(e),c.nc(2).handleSuccess(t)})),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.wc("formGroup",e.aFormGroup),c.Cb(1),c.wc("siteKey",e.googleCaptchaSiteKey)}}function Gk(e,t){if(1&e&&(c.Xb(0,"div"),c.Wc(1,_k,3,2,"form",22),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.captchaActive&&e.googleCaptchaSiteKey)}}let Bk=(()=>{class e{constructor(e,t,i){this.formBuilder=e,this.workspaceService=t,this.systemSettingsService=i,this.emailsInvited=new c.n,this.onClose=new c.n,this.onAdded=new c.n,this.googleCaptchaSiteKey=tr.a.environment.googleCaptchaSiteKey,this.unsubscribe$=new mi.a,this.sendEmail=!0}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.aFormGroup=this.formBuilder.group({recaptcha:["",p.G.required]});const e=(this.autofillEmails||[]).join(", ")||"";var t;this.emailsFormGroup=this.formBuilder.group({emails:[e,[p.G.required]]},{validator:(t=this.filteredUsersToShow,e=>{const i=e.controls.emails;let n=i.value.replace(/,/g," ").split(" ");n=n.map(e=>e.trim().toLowerCase()).filter(e=>!!e),n=n.filter((e,t,i)=>i.indexOf(e)===t);const s=t?t.map(e=>e.email.toLowerCase()):[];let c=[],r=[];n.forEach(e=>{s.indexOf(e)>-1&&c.push(e),Object(Pt.A)(e)||r.push(e)}),c=c.map(e=>"'"+e+"'"),r=r.map(e=>"'"+e+"'");const o={};i.getError("required")&&(o.required=!0),1===c.length?o.duplicatedEmail=c[0]:c.length>1&&(o.duplicatedEmails=c.join(" ,")),1===r.length?o.invalidEmail=r[0]:r.length>1&&(o.invalidEmails=r.join(" ,")),i.setErrors(r.length||c.length||o.required?o:null)})}),this.workspaceService.payment.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.captchaActive=!e.paid,this.gotResponse=!0}),this.systemSettingsService.systemSettings.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{e.specialFeaturesActivated&&this.isAdmin?this.workspaceService.getPaymentDate():this.gotResponse=!0}),this.systemSettingsService.getSystemSettings()}get emails(){return this.emailsFormGroup.get("emails")}get emailsInvalid(){return this.emails.dirty&&this.emails.touched&&!!this.emails.errors}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}closeModal(){this.onClose.emit(!0)}handleReset(){this.captchaValue=""}handleExpire(){this.captchaValue=""}handleLoad(){}handleSuccess(e){this.captchaValue=e}get isCaptchaValid(){return!(this.captchaActive&&!this.captchaValue)}inviteUser(){if(!this.isCaptchaValid||this.emailsFormGroup.invalid||this.inProgress)return;let e=this.emails.value.replace(/,/g," ").split(" ");e=e.map(e=>e.trim().toLowerCase()).filter(e=>!!e),e=e.filter((e,t,i)=>i.indexOf(e)===t),this.inProgress=!0,this.workspaceService.inviteUsers(e,null,this.captchaValue,this.sendEmail).subscribe(()=>{this.onAdded.emit(),this.inProgress=!1,this.workspaceService.getDefaultWorkspace(),this.closeModal()},()=>{this.captchaElem&&this.captchaElem.resetCaptcha(),this.inProgress=!1})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(p.f),c.Rb(U.a),c.Rb(Lt.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["add-members"]],viewQuery:function(e,t){var i;1&e&&c.ed(Pk,!0),2&e&&c.Kc(i=c.kc())&&(t.captchaElem=i.first)},inputs:{filteredUsersToShow:"filteredUsersToShow",isAdmin:"isAdmin",autofillEmails:"autofillEmails"},outputs:{emailsInvited:"emailsInvited",onClose:"onClose",onAdded:"onAdded"},decls:22,vars:9,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-mb-0",3,"formGroup","ngSubmit"],["ngbAutofocus","","formControlName","emails","placeholder","Add new members by email address",1,"cl-form-control",3,"keyup.enter"],["input",""],["class","cl-mt-1",4,"ngIf"],["class","cl-form-text cl-text-gray-9 cl-mt-1",4,"ngIf"],[1,"cl-custom-control","cl-custom-checkbox","cl-mt-3"],["type","checkbox","id","sendEmail",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","sendEmail",1,"cl-custom-control-label","cl-color-gray"],[4,"ngIf"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","title","click"],[1,"cl-mt-1"],["class","cl-invalid-feedback",4,"ngIf"],[1,"cl-invalid-feedback"],[1,"cl-form-text","cl-text-gray-9","cl-mt-1"],["class","cl-mt-3",3,"formGroup",4,"ngIf"],[1,"cl-mt-3",3,"formGroup"],["formControlName","recaptcha",3,"siteKey","reset","expire","load","success"],["captchaElem",""]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2,"Add member by email"),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.closeModal()})),c.Xb(4,"span",3),c.Sb(5,"img",4),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",5),c.Xb(7,"form",6),c.jc("ngSubmit",(function(){return t.inviteUser()})),c.Xb(8,"input",7,8),c.jc("keyup.enter",(function(){c.Oc(e);const t=c.Lc(9);return t.blur(),t.focus()})),c.Wb(),c.Wc(10,Uk,6,5,"ng-container",9),c.Wc(11,$k,2,1,"small",10),c.Wb(),c.Xb(12,"div",11),c.Xb(13,"input",12),c.jc("ngModelChange",(function(e){return t.sendEmail=e})),c.Wb(),c.Xb(14,"label",13),c.Yc(15,"Send an invite email"),c.Wb(),c.Wb(),c.Wc(16,Gk,2,1,"div",14),c.Wb(),c.Xb(17,"div",15),c.Xb(18,"a",16),c.jc("click",(function(){return t.closeModal()})),c.Yc(19,"Cancel"),c.Wb(),c.Xb(20,"button",17),c.jc("click",(function(){return t.inviteUser()})),c.Yc(21," Add "),c.Wb(),c.Wb()}2&e&&(c.Cb(7),c.wc("formGroup",t.emailsFormGroup),c.Cb(1),c.Hb("cl-is-invalid",t.emailsInvalid),c.Cb(2),c.wc("ngIf",t.emailsInvalid),c.Cb(1),c.wc("ngIf",t.gotResponse),c.Cb(2),c.wc("ngModel",t.sendEmail),c.Cb(3),c.wc("ngIf",t.gotResponse),c.Cb(4),c.wc("disabled",!t.isCaptchaValid||t.emailsFormGroup.invalid||t.inProgress)("title",t.isCaptchaValid?"Submit":"You first need to click on the I'm not a robot checkbox"))},directives:[p.I,p.t,p.k,p.c,p.s,p.i,s.u,p.a,p.v,B.b],encapsulation:2}),e})();const Vk=["plusButton"];function Hk(e,t){1&e&&(c.Xb(0,"div",22),c.Yc(1,"Add more seats"),c.Wb())}function zk(e,t){if(1&e&&(c.Xb(0,"div"),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.ad("of ",e.unusedSeats,"")}}function qk(e,t){if(1&e&&(c.Xb(0,"div",23),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.bd("x $",e.amount?e.amount:e.currentType.fullPrice," per seat/",e.isMonthly(e.currentType.value)?"month":"year","")}}function Kk(e,t){1&e&&(c.Xb(0,"div",24),c.Yc(1," There are no refunds for removed seats "),c.Wb())}function Zk(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",9),c.Xb(1,"div",10),c.Wc(2,Hk,2,0,"div",11),c.Xb(3,"div",12),c.Xb(4,"div",13),c.Xb(5,"a",14,15),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.quantity=t.quantity==t.defaultQuantity?t.quantity:t.quantity-1})),c.Xb(7,"strong"),c.Yc(8,"-"),c.Wb(),c.Wb(),c.Wb(),c.Sb(9,"input",16),c.Xb(10,"div",17),c.Xb(11,"a",18),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.quantity=t.isAdd||t.quantity!=t.unusedSeats?t.quantity+1:t.quantity})),c.Xb(12,"strong"),c.Yc(13,"+"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(14,zk,2,1,"div",19),c.Wc(15,qk,2,2,"div",20),c.Wb(),c.Wc(16,Kk,2,0,"div",21),c.Wb()}if(2&e){const e=c.nc();c.Hb("cl-d-flex",e.isAdd),c.Cb(1),c.Hb("cl-mb-3",!e.isAdd),c.Cb(1),c.wc("ngIf",e.isAdd),c.Cb(7),c.wc("ngModel",e.quantity),c.Cb(5),c.wc("ngIf",!e.isAdd),c.Cb(1),c.wc("ngIf",e.isAdd),c.Cb(1),c.wc("ngIf",!e.isAdd)}}function Qk(e,t){1&e&&(c.Xb(0,"div",28),c.Yc(1," You will be immediately charged a prorated price for additional seats for the rest of the billing cycle. When a new billing cycle comes, they'll be charged according to their full price. "),c.Wb())}function Jk(e,t){if(1&e&&(c.Xb(0,"div"),c.Xb(1,"div",29),c.Yc(2," Number of additional seats: "),c.Xb(3,"span",30),c.Yc(4),c.Wb(),c.Wb(),c.Xb(5,"div",29),c.Yc(6," Estimated prorated price that will be applied: "),c.Xb(7,"span",30),c.Yc(8),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(4),c.ad("",e.quantity," seats"),c.Cb(4),c.ad("$",e.price,"")}}function eS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",31),c.Xb(1,"input",32),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc(2).agreement=t})),c.Wb(),c.Xb(2,"label",33),c.Xb(3,"span",34),c.Yc(4,"I have read and agree to the "),c.Xb(5,"a",35),c.Yc(6,"Terms of Use"),c.Wb(),c.Wb(),c.Xb(7,"span",36),c.Yc(8,"There are no refunds. Your subscription will renew automatically, and you will be charged in advance. You may cancel at any time. The cancellation goes into effect at the start of your following billing cycle."),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(1),c.wc("ngModel",e.agreement)}}function tS(e,t){if(1&e&&(c.Xb(0,"div",9),c.Wc(1,Qk,2,0,"div",25),c.Wc(2,Jk,9,2,"div",19),c.Xb(3,"div",26),c.Wc(4,eS,9,1,"div",27),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.isAdd&&e.confirm),c.Cb(1),c.wc("ngIf",e.confirm),c.Cb(2),c.wc("ngIf",e.isAdd&&e.confirm)}}function iS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",37),c.jc("click",(function(){return c.Oc(e),c.nc().previewPrice()})),c.Yc(1,"Next"),c.Wb()}if(2&e){const e=c.nc();c.wc("disabled",e.quantity<1||e.inProgress)}}function nS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",37),c.jc("click",(function(){return c.Oc(e),c.nc().save()})),c.Yc(1),c.Wb()}if(2&e){const e=c.nc();c.wc("disabled",e.quantity<1||e.inProgress||e.isAdd&&!e.agreement),c.Cb(1),c.Zc(e.isAdd?"Pay & save":"save")}}let sS=(()=>{class e{constructor(e,t){this.paymentService=e,this.loader=t,this.unusedSeats=0,this.currentQuantity=0,this.closeModal=new c.n,this.saveQuantity=new c.n,this.agreement=!1,this.unsubscribe$=new mi.a,this.isMonthly=ku.i,this.defaultQuantity=0,this.quantity=1}close(){this.closeModal.emit(!0)}save(){this.quantity>0&&this.saveQuantity.emit(this.quantity)}ngAfterViewInit(){setTimeout(()=>{this.plusButton.nativeElement.focus()})}ngOnInit(){this.activeUsers>this.currentQuantity&&(this.defaultQuantity=this.activeUsers-this.currentQuantity,this.quantity=this.defaultQuantity)}previewPrice(){this.loader.show(),this.paymentService.previewPrice(this.currentType.value,this.quantity+this.currentQuantity).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.loader.hide(),this.price=e.price,this.confirm=!0})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Cu.a),c.Rb(wi.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["user-seats-modal"]],viewQuery:function(e,t){var i;1&e&&c.ed(Vk,!0),2&e&&c.Kc(i=c.kc())&&(t.plusButton=i.first)},inputs:{isAdd:"isAdd",activeUsers:"activeUsers",unusedSeats:"unusedSeats",currentQuantity:"currentQuantity",currentType:"currentType",amount:"amount",inProgress:"inProgress"},outputs:{closeModal:"closeModal",saveQuantity:"saveQuantity"},decls:13,vars:5,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],["class","cl-modal-body",3,"cl-d-flex",4,"ngIf"],["class","cl-modal-body",4,"ngIf"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"click"],["type","button","class","cl-btn cl-btn-primary","tabindex","0",3,"disabled","click",4,"ngIf"],[1,"cl-modal-body"],[1,"cl-d-flex","cl-align-items-center","cl-flex-column","cl-flex-sm-row"],["class","cl-text-gray-3 cl-mr-2",4,"ngIf"],[1,"cl-input-group","cl-w-auto","cl-mr-2","cl-my-2","cl-my-sm-0"],[1,"cl-input-group-prepend"],["tabindex","0","ngbAutofocus","",1,"cl-btn","cl-btn-outline-light","cl-text-primary","cl-min-width-40",3,"click"],["plusButton",""],["readonly","","min","0",1,"cl-form-control","cl-input-seats","cl-cursor-disabled",3,"ngModel"],[1,"cl-input-group-append"],["tabindex","0",1,"cl-btn","cl-btn-outline-light","cl-text-primary","cl-min-width-40",3,"click"],[4,"ngIf"],["class","cl-text-gray-9",4,"ngIf"],["class","cl-alert cl-alert-warning cl-w-100 cl-mb-0",4,"ngIf"],[1,"cl-text-gray-3","cl-mr-2"],[1,"cl-text-gray-9"],[1,"cl-alert","cl-alert-warning","cl-w-100","cl-mb-0"],["class","cl-alert cl-alert-warning cl-w-100 cl-mb-0 cl-px-2",4,"ngIf"],[1,"cl-d-flex","cl-align-items-center","cl-mt-3","cl-flex-column","cl-flex-sm-row"],["class","cl-custom-control cl-custom-checkbox cl-custom-control-inline",4,"ngIf"],[1,"cl-alert","cl-alert-warning","cl-w-100","cl-mb-0","cl-px-2"],[1,"cl-mt-2","cl-text-gray-3"],[1,"cl-h2"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox","id","agreementCheckbox",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","agreementCheckbox",1,"cl-custom-control-label"],[1,"cl-font-weight-bold"],["href","https://clockify.me/terms","target","_blank","tabindex","0",1,"cl-color-blue"],[1,"cl-color-grey","cl-d-block"],["type","button","tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.close()})),c.Xb(4,"span"),c.Sb(5,"img",3),c.Wb(),c.Wb(),c.Wb(),c.Wc(6,Zk,17,9,"div",4),c.Wc(7,tS,5,3,"div",5),c.Xb(8,"div",6),c.Xb(9,"a",7),c.jc("click",(function(){return t.close()})),c.Yc(10,"Cancel"),c.Wb(),c.Wc(11,iS,2,1,"button",8),c.Wc(12,nS,2,2,"button",8),c.Wb()),2&e&&(c.Cb(2),c.Zc(t.isAdd?"Buy more seats":"Remove unused seats"),c.Cb(4),c.wc("ngIf",!t.confirm),c.Cb(1),c.wc("ngIf",t.confirm),c.Cb(4),c.wc("ngIf",!t.confirm&&t.isAdd),c.Cb(1),c.wc("ngIf",t.confirm||!t.isAdd))},directives:[s.u,p.c,p.s,p.v,p.a],encapsulation:2}),e})();const cS=["subscriptionFailedModal"],rS=["addMembersModal"],oS=["allSeatsTaken"];function aS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div"),c.Xb(1,"button",21),c.jc("click",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(21),n=c.Lc(23);return t.openAddMemberModal(i,n)})),c.Yc(2," Add "),c.Xb(3,"span",22),c.Yc(4,"new"),c.Wb(),c.Yc(5," member"),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.wc("disabled",!e.isLoaded)}}function lS(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"tr",23),c.jc("onDeleted",(function(){c.Oc(e);const i=t.index;return c.nc().onDeleted(i)}))("onGroupsSearchChange",(function(t){return c.Oc(e),c.nc().onGroupsSearchChange(t)}))("seatsTaken",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(21),n=c.Lc(23);return t.activatingMember=!0,t.openAddMemberModal(i,n)})),c.Wb(),c.Ub()}if(2&e){const e=t.$implicit,i=c.nc();c.Cb(1),c.wc("labels",i.labels)("user",e)("ownerId",i.ownerId)("isDesktop",i.isDesktop)("showGroup",i.groupToShow)("userGroups",i.userGroups)("isOwner",i.isOwner)("isCurrentUserAdminOrOwner",i.isAdminOrOwner)("canSeeRates",i.canSeeRates)("currentUserId",i.currentUserId)("expandAll",i.expandAll)("hasManagerRoleFeature",i.hasManagerRoleFeature)("hasHistoricRatesFeature",i.hasHistoricRatesFeature)("isAllSeatsTaken",i.quantity<=i.activeMembersLength)}}function bS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"pager",24,25),c.jc("pageChanged",(function(t){return c.Oc(e),c.nc().setPaginationUrl(t)}))("limitChanged",(function(t){return c.Oc(e),c.nc().setPaginationUrl(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("page",null==e.pagination?null:e.pagination.page)("limit",null==e.pagination?null:e.pagination.pageSize)("total",e.totalUserCount)}}function uS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"add-members",26),c.jc("onClose",(function(){c.Oc(e);const i=t.$implicit,n=c.nc();return i.close(),n.missingUsers=null}))("onAdded",(function(){c.Oc(e);const i=t.$implicit,n=c.nc();return n.getRouteParams(),i.close(),n.missingUsers=null})),c.Wb()}if(2&e){const e=c.nc();c.wc("filteredUsersToShow",e.users)("autofillEmails",e.missingUsers)("isAdmin",e.isAdminOrOwner)}}function dS(e,t){1&e&&(c.Xb(0,"p",35),c.Yc(1,"To add more users, you need to update your subscription and buy more user seats."),c.Wb())}function pS(e,t){1&e&&(c.Xb(0,"p",35),c.Yc(1,"To activate additional users, you need to update your subscription and buy more user seats."),c.Wb())}function hS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",27),c.Xb(1,"h1",28),c.Yc(2,"No available seats"),c.Wb(),c.Wb(),c.Xb(3,"div",29),c.Xb(4,"div",30),c.Wc(5,dS,2,0,"p",31),c.Wc(6,pS,2,0,"p",31),c.Wb(),c.Wb(),c.Xb(7,"div",32),c.Xb(8,"a",33),c.jc("click",(function(){return t.$implicit.close()})),c.Yc(9,"Close"),c.Wb(),c.Xb(10,"button",34),c.jc("click",(function(){c.Oc(e);const i=t.$implicit,n=c.nc(),s=c.Lc(25);return n.buySeats(s),i.close()})),c.Yc(11,"Buy seats"),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(5),c.wc("ngIf",!e.activatingMember),c.Cb(1),c.wc("ngIf",e.activatingMember)}}function mS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"user-seats-modal",36),c.jc("closeModal",(function(){return t.$implicit.close()}))("saveQuantity",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().saveQuantity(i,n)})),c.Wb()}if(2&e){const e=c.nc();c.wc("isAdd",!0)("inProgress",e.inProgress)("currentQuantity",e.quantity)("activeUsers",e.activeMembersLength)("currentType",e.getPlan(e.workspace.featureSubscriptionType))("amount",e.amount)}}function gS(e,t){1&e&&(c.Xb(0,"subscription-incomplete-modal",37),c.jc("close",(function(){return t.$implicit.close()})),c.Wb())}let fS=(()=>{class e{constructor(e,t,i,n,s,r,o,a,l,b,u,d,p){this.activatedRoute=e,this.browserService=t,this.router=i,this.teamsDataService=n,this.uiSettingsService=s,this.cd=r,this.modalService=o,this.workspaceService=a,this.userGroupService=l,this.userGroupV1Service=b,this.loader=u,this.paymentService=d,this.systemSettingsService=p,this.recalculateQuantity=new c.n,this.unsubscribe$=new Ee.a,this.pageDebouncer$=new Ee.a,this.labels=["Name","Email","Billable Rate","Role","Group","Edit"],this.userGroups=[],this.getPlan=ku.c,this.activatingMember=!1,this.groupToShow="Show All"}set isAdminOrOwner(e){this._isAdminOrOwner=e,this.setCanSeeRates()}get isAdminOrOwner(){return this._isAdminOrOwner}set isLoaded(e){this._isLoaded=e,e&&this.checkMissingUsers()}get isLoaded(){return this._isLoaded}ngOnInit(){this.loader.showBar(),this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,this.hasHistoricRatesFeature=e.hasFeature(nr.a.HISTORIC_RATES),this.hasManagerRoleFeature=e.hasFeature(nr.a.MANAGER_ROLE)}),this.setCanSeeRates(),this.statuses=[new di.a("ALL","Show all"),new di.a("ACTIVE","Show active"),new di.a("INACTIVE","Show inactive"),new di.a("PENDING","Show invited")],this.subscribeToResults(),this.initPagination(),this.setBrowserWidth(),this.getRouteParams(),this.setRouteDebouncer()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setCanSeeRates(){this.workspace&&(this.canSeeRates=!this.workspace.onlyAdminsSeeBillableRates||this.isAdminOrOwner)}expandAllRows(e){this.expandAll=e}changeGroupShow(e){this.pagination.status=e,this.pageDebouncer$.next()}openAddMemberModal(e,t){this.workspace.featureSubscriptionType&&ku.a[this.workspace.featureSubscriptionType].bySeat&&this.quantity<=this.activeMembersLength?this.modalService.open(t,{centered:!0}):this.modalService.open(e,{size:"lg",centered:!0})}changeSortColumn(e){this.pagination.sortColumn=e,this.pagination.sortOrder=Is.a.ASCENDING,this.pageDebouncer$.next()}changeSortOrder(){this.pagination.sortOrder=this.pagination.sortOrder===Is.a.ASCENDING?Is.a.DESCENDING:Is.a.ASCENDING,this.pageDebouncer$.next()}onSearchChange(){this.initPagination(),this.pageDebouncer$.next()}setPaginationUrl(e){this.pagination.page=e.page||this.pagination.page,this.pagination.pageSize=e.limit||this.pagination.pageSize,this.pageDebouncer$.next()}setLocalStorageSettings(){this.uiSettingsService.setSettings(hi.b.TEAMS_MEMBERS,{pageSize:this.pagination.pageSize,sortOrder:this.pagination.sortOrder,sortColumn:this.pagination.sortColumn,status:this.pagination.status})}onDeleted(e){this.users.splice(e,1),this.cd.detectChanges()}initPagination(){const e=this.uiSettingsService.getSettings(hi.b.TEAMS_MEMBERS)||{};this.pagination={page:1,pageSize:e.pageSize||ei.z,sortOrder:Is.a[e.sortOrder]||Is.a.ASCENDING,sortColumn:e.sortColumn||"name",status:e.status||"ALL"}}setRouteDebouncer(){this.pageDebouncer$.pipe(Object(Te.a)(250),Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.setLocalStorageSettings(),this.router.navigate([],{queryParams:Object.assign(Object.assign({},this.pagination),{searchEmail:this.searchEmail}),relativeTo:this.activatedRoute,fragment:fC.MEMBERS.toLowerCase()})})}getRouteParams(){this.activatedRoute.queryParams.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{const t=this.activatedRoute.snapshot.fragment;t&&t!==fC.MEMBERS.toLowerCase()||(this.searchEmail=e.searchEmail||"",e.status&&(this.pagination.status=this.findGroup(e.status)),Object(Pt.u)(e.page)&&e.page>0&&(this.pagination.page=Number(e.page)),Object(Pt.u)(e.pageSize)&&e.pageSize>0&&e.pageSize<=200&&(this.pagination.pageSize=Number(e.pageSize)),Is.a[e.sortOrder]&&(this.pagination.sortOrder=e.sortOrder),this.getEverything(),this.cd.detectChanges())}),this.cd.detectChanges()}findGroup(e){const t=this.statuses.filter(t=>t.value===e);return t.length?t[0].value:null}getEverything(){this.workspaceService.getUsers({page:this.pagination.page,limit:this.pagination.pageSize,sortColumn:this.pagination.sortColumn||"name",sortOrder:this.pagination.sortOrder||Is.a.ASCENDING,email:this.searchEmail,statuses:"ALL"===this.pagination.status?"":[this.pagination.status]}),this.userGroupService.getAllUserGroups()}subscribeToResults(){Object(la.a)(this.userGroupService.userGroups,this.workspaceService.allUsers$).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.userGroups=e[0].filter(e=>"Admins"!==e.name),this.users=e[1].users,this.totalUserCount=e[1].count,this.isMultiplePages=this.totalUserCount>ei.z||this.totalUserCount>this.pagination.pageSize,this.users&&0===this.users.length&&this.pagination.page>1&&(this.pagination.page=1,this.router.navigate([],{relativeTo:this.activatedRoute,fragment:fC.MEMBERS.toLowerCase()})),this.loader.hide(),this.cd.detectChanges()})}setBrowserWidth(){this.browserService.isBreakpointLgCustom$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.detectChanges()})}buySeats(e){this.modalService.open(e,{centered:!0})}saveQuantity(e,t){this.loader.show(),this.inProgress=!0,this.paymentService.updateQuantity(e+this.quantity,this.quantity).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspaceService.payment.next(e),this.inProgress=!1,t.close(),this.loader.hide()},e=>{e.error&&e.error.message&&e.error.message.includes("incomplete")&&this.modalService.open(this.subscriptionFailedModal),this.loader.hide(),this.inProgress=!1})}checkMissingUsers(){var e;this.missingUsers=this.teamsDataService.missingUsers,this.teamsDataService.missingUsers=null,(null===(e=this.missingUsers)||void 0===e?void 0:e.length)&&this.openAddMemberModal(this.addMembersModal,this.allSeatsTaken)}onGroupsSearchChange(e){this.userGroupV1Service.getUserGroups({name:e}).pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.userGroups=e.groups.filter(e=>"Admins"!==e.name),this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.a),c.Rb(pi.a),c.Rb(W.c),c.Rb(r),c.Rb(hi.a),c.Rb(c.h),c.Rb(g.q),c.Rb(U.a),c.Rb(mg.a),c.Rb(Ky.a),c.Rb(wi.a),c.Rb(Cu.a),c.Rb(Lt.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["members-tab"]],viewQuery:function(e,t){var i;1&e&&(c.ed(cS,!0),c.ed(rS,!0),c.ed(oS,!0)),2&e&&(c.Kc(i=c.kc())&&(t.subscriptionFailedModal=i.first),c.Kc(i=c.kc())&&(t.addMembersModal=i.first),c.Kc(i=c.kc())&&(t.allSeatsTaken=i.first))},inputs:{isAdminOrOwner:"isAdminOrOwner",currentUserId:"currentUserId",ownerId:"ownerId",isOwner:"isOwner",quantity:"quantity",amount:"amount",activeMembersLength:"activeMembersLength",isLoaded:"isLoaded"},outputs:{recalculateQuantity:"recalculateQuantity"},decls:28,vars:13,consts:[[1,"cl-relative"],[1,"cl-row","cl-align-items-center","cl-mb-2","cl-mb-lg-custom-3"],[1,"cl-col-12","cl-col-lg-custom-4"],[1,"cl-d-flex"],[1,"cl-d-inline-block",3,"list","value","onChanged"],[1,"cl-form-group","cl-mb-2","cl-mb-lg-custom-0","cl-ml-2","cl-w-100"],["type","text","placeholder","Search by name or email",1,"cl-form-control",3,"ngModel","ngModelChange"],[1,"cl-col-6","cl-col-lg-custom-4","cl-ml-auto","cl-text-right"],[4,"ngIf"],[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6","cl-team-table-members"],["members-header","",3,"sortOrder","sortColumn","isDesktop","canSeeRates","isCostRateActive","hasLaborCostFeature","currency","onChangeSortOrder","onChangeSortColumn","onExpandAll"],[4,"ngFor","ngForOf"],[1,"cl-mt-2","cl-mt-lg-3"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],["addMembersModal",""],["allSeatsTaken",""],["userSeatsModal",""],["subscriptionFailedModal",""],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-d-none","cl-d-md-inline"],["members-row","",3,"labels","user","ownerId","isDesktop","showGroup","userGroups","isOwner","isCurrentUserAdminOrOwner","canSeeRates","currentUserId","expandAll","hasManagerRoleFeature","hasHistoricRatesFeature","isAllSeatsTaken","onDeleted","onGroupsSearchChange","seatsTaken"],[3,"page","limit","total","pageChanged","limitChanged"],["pager",""],[3,"filteredUsersToShow","autofillEmails","isAdmin","onClose","onAdded"],[1,"cl-modal-header"],[1,"cl-modal-title"],[1,"cl-modal-body","cl-text-center","cl-pt-4"],[1,"cl-text-left"],["class","cl-mb-0",4,"ngIf"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-mb-0"],[3,"isAdd","inProgress","currentQuantity","activeUsers","currentType","amount","closeModal","saveQuantity"],[3,"close"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"dropdown-items",4),c.jc("onChanged",(function(e){return t.changeGroupShow(e)})),c.Wb(),c.Xb(5,"div",5),c.Xb(6,"input",6),c.jc("ngModelChange",(function(){return t.onSearchChange()}))("ngModelChange",(function(e){return t.searchEmail=e})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(7,"div",7),c.Wc(8,aS,6,1,"div",8),c.Wb(),c.Wb(),c.Xb(9,"div",9),c.Xb(10,"div",10),c.Xb(11,"span",11),c.Yc(12,"Members"),c.Wb(),c.Wb(),c.Wb(),c.Xb(13,"table",12),c.Xb(14,"thead"),c.Xb(15,"tr",13),c.jc("onChangeSortOrder",(function(){return t.changeSortOrder()}))("onChangeSortColumn",(function(e){return t.changeSortColumn(e)}))("onExpandAll",(function(e){return t.expandAllRows(e)})),c.Wb(),c.Wb(),c.Xb(16,"tbody"),c.Wc(17,lS,2,14,"ng-container",14),c.Wb(),c.Wb(),c.Xb(18,"div",15),c.Wc(19,bS,2,3,"pager",16),c.Wc(20,uS,1,3,"ng-template",null,17,c.Xc),c.Wc(22,hS,12,2,"ng-template",null,18,c.Xc),c.Wc(24,mS,1,6,"ng-template",null,19,c.Xc),c.Wb(),c.Wb(),c.Wc(26,gS,1,0,"ng-template",null,20,c.Xc)),2&e&&(c.Cb(4),c.wc("list",t.statuses)("value",t.pagination.status),c.Cb(2),c.wc("ngModel",t.searchEmail),c.Cb(2),c.wc("ngIf",t.isAdminOrOwner),c.Cb(7),c.wc("sortOrder",t.pagination.sortOrder)("sortColumn",t.pagination.sortColumn)("isDesktop",t.isDesktop)("canSeeRates",t.canSeeRates)("isCostRateActive",null==t.workspace?null:t.workspace.isCostRateActive)("hasLaborCostFeature",t.hasHistoricRatesFeature)("currency",null==t.workspace||null==t.workspace.hourlyRate?null:t.workspace.hourlyRate.currency),c.Cb(2),c.wc("ngForOf",t.users),c.Cb(2),c.wc("ngIf",t.isMultiplePages))},directives:[pn.a,p.c,p.s,p.v,s.u,CC,s.t,xk,cn.a,Bk,sS,Uu],encapsulation:2,changeDetection:0}),e})();function vS(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"th",2),c.Xb(2,"a",3),c.jc("click",(function(){return c.Oc(e),c.nc().changeSort("name")})),c.Yc(3,"Name"),c.Wb(),c.Wb(),c.Xb(4,"th",4),c.Xb(5,"div",5),c.Xb(6,"div",6),c.Yc(7,"Access"),c.Wb(),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(2),c.Hb("cl-up","name"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","name"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING)}}function wS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"th",7),c.Xb(1,"div",8),c.Yc(2,"Name "),c.Xb(3,"div",9),c.Xb(4,"a",10),c.jc("click",(function(){return c.Oc(e),c.nc().expandAll()})),c.Xb(5,"span",11),c.Sb(6,"img",12),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(6),c.wc("src",e.isExpandAll?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",c.Qc)}}let yS=(()=>{class e{constructor(){this.onChangeSortOrder=new c.n,this.onChangeSortColumn=new c.n,this.onExpandAll=new c.n,this.SortOrder=Is.a,this.unsubscribe$=new Ee.a,this.isExpandAll=!1}ngOnInit(){}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}expandAll(){this.isExpandAll=!this.isExpandAll,this.onExpandAll.emit(this.isExpandAll)}changeSort(e){e!==this.sortColumn?this.onChangeSortColumn.emit(e):this.onChangeSortOrder.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["groups-header"],["","groups-header",""]],inputs:{isDesktop:"isDesktop",sortColumn:"sortColumn",sortOrder:"sortOrder"},outputs:{onChangeSortOrder:"onChangeSortOrder",onChangeSortColumn:"onChangeSortColumn",onExpandAll:"onExpandAll"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["mobileTemplate",""],[1,"cl-pl-lg-3"],[1,"cl-text-gray-6","cl-sort-by",3,"click"],["colspan","3"],[1,"cl-ml-lg-custom-n2"],[1,"cl-h5","cl-mb-0"],["colspan","4",1,"cl-pl-lg-3"],[1,"cl-h5","cl-mb-0","cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-ml-auto",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"]],template:function(e,t){if(1&e&&(c.Wc(0,vS,8,4,"ng-container",0),c.Wc(1,wS,7,1,"ng-template",null,1,c.Xc)),2&e){const e=c.Lc(2);c.wc("ngIf",t.isDesktop)("ngIfElse",e)}},directives:[s.u],encapsulation:2}),e})();var WS=i("vrD5");let CS=(()=>{class e{constructor(){this.onClose=new c.n,this.onUpdate=new c.n,this.inProgress=!1}ngOnInit(){this.newName=Object(Pt.H)(this.currentName)}closeModal(){this.onClose.emit(!1)}update(){null==this.newName||this.newName.trim().length<1||(this.onUpdate.emit(Object(Pt.H)(this.newName)),this.onClose.emit(!1))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["edit-group"]],inputs:{inProgress:"inProgress",currentName:"currentName"},outputs:{onClose:"onClose",onUpdate:"onUpdate"},decls:17,vars:2,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-row","cl-mb-0"],[1,"cl-col-sm-3","cl-col-form-label","cl-mb-0"],[1,"cl-col-sm-9"],["type","text","inputString","","ngbAutofocus","","preventMultipleSpaces","",1,"cl-form-control",3,"ngModel","inputChange","keyup.enter"],[1,"cl-modal-footer"],[3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2,"Edit group"),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.closeModal()})),c.Xb(4,"span"),c.Sb(5,"img",3),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",4),c.Xb(7,"div",5),c.Xb(8,"label",6),c.Yc(9,"Change name"),c.Wb(),c.Xb(10,"div",7),c.Xb(11,"input",8),c.jc("inputChange",(function(e){return t.newName=e}))("keyup.enter",(function(){return t.update()})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(12,"div",9),c.Xb(13,"a",10),c.jc("click",(function(){return t.closeModal()})),c.Yc(14,"Cancel"),c.Wb(),c.Xb(15,"button",11),c.jc("click",(function(){return t.update()})),c.Yc(16,"Save"),c.Wb(),c.Wb()),2&e&&(c.Cb(11),c.wc("ngModel",t.newName),c.Cb(4),c.wc("disabled",t.inProgress))},directives:[p.c,gr,WS.a,p.s,p.v],encapsulation:2}),e})();function kS(e,t){1&e&&c.Tb(0)}function SS(e,t){if(1&e&&(c.Xb(0,"div",10),c.Xb(1,"span",11),c.Yc(2),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.xc("title",e.userGroup.name),c.Cb(1),c.Zc(e.userGroup.name)}}const IS=function(e){return{"cl-dropdown-toggle":e}};function OS(e,t){if(1&e&&(c.Xb(0,"span",17),c.Xb(1,"span",null,18),c.Yc(3),c.oc(4,"displayNames"),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.wc("ngClass",c.Bc(4,IS,e.isAdminOrOwner)),c.Cb(3),c.Zc(c.pc(4,2,e.userGroupNames))}}function XS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"dropdown-filter",19),c.jc("closeFilter",(function(t){return c.Oc(e),c.nc(2).closeEditTeamDropdown(t)}))("onOpen",(function(){return c.Oc(e),c.nc(2).resetEntityList()}))("onScroll",(function(){return c.Oc(e),c.nc(2).loadMore()}))("onSearchChange",(function(t){return c.Oc(e),c.nc(2).onSearchChange(t)})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("entityList",e.Ulist)("onlyCheckbox",!1)("placeholder","Find users...")("isReminder",!1)("selectedUsers",e.userIds)("everyoneSelected",e.userIds.length>0&&"Everyone"===e.userGroupNames[0])("isEditing",!0)("user",e.userGroup)("showSelectAll",!1)("ownerId",e.ownerId)("currentUserId",e.currentUserId)("isUserAdmin",e.isAdminOrOwner)("isExternalSearch",!0)}}function ES(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",12),c.Xb(1,"a",13),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.openEditTeamDropdown(t.userGroup)})),c.oc(2,"displayNames"),c.Xb(3,"div",14),c.Wc(4,OS,5,6,"span",15),c.Wb(),c.Wb(),c.Wc(5,XS,1,13,"dropdown-filter",16),c.Wb()}if(2&e){const e=c.nc(),t=c.Lc(8);c.Cb(1),c.xc("title",c.pc(2,5,e.userGroupNames)),c.wc("ngClass",c.Bc(7,IS,e.isAdminOrOwner)),c.Cb(3),c.wc("ngIf",e.userGroupNames.length>0)("ngIfElse",t),c.Cb(1),c.wc("ngIf",e.shouldOpen&&e.isAdminOrOwner)}}function TS(e,t){1&e&&(c.Xb(0,"a",20),c.Sb(1,"img",21),c.Xb(2,"span",22),c.Yc(3,"Access"),c.Wb(),c.Wb())}function DS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",24),c.Xb(1,"a",25),c.jc("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(14);return t.openModal(i,"lg")})),c.Sb(2,"img",26),c.Wb(),c.Wb()}}function RS(e,t){if(1&e&&c.Wc(0,DS,3,0,"div",23),2&e){const e=c.nc();c.wc("ngIf",e.isAdminOrOwner)}}function AS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",24),c.Xb(1,"a",25),c.jc("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(16);return t.openModal(i,"md")})),c.Sb(2,"img",27),c.Wb(),c.Wb()}}function jS(e,t){if(1&e&&c.Wc(0,AS,3,0,"div",23),2&e){const e=c.nc();c.wc("ngIf",e.isAdminOrOwner)}}function xS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"edit-group",28),c.jc("onClose",(function(){return t.$implicit.close()}))("onUpdate",(function(t){return c.Oc(e),c.nc().updateGroup(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("inProgress",e.inProgress)("currentName",e.userGroup.name)}}function PS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",29),c.jc("confirmed",(function(i){c.Oc(e);const n=t.$implicit,s=c.nc();return n.close(i),s.deleteGroup()}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Xb(1,"p",30),c.Yc(2),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Delete")("isDanger",!0)("btnText","Delete"),c.Cb(2),c.ad("\n","Are you sure you want to delete group "+e.userGroup.name+"?","\n")}}const MS=function(e){return{labels:e}},YS=function(e,t,i,n){return[e,t,i,n]};let LS=(()=>{class e{constructor(e,t,i,n){this.modalService=e,this.cd=t,this.userGroupService=i,this.workspaceService=n,this.onDeleted=new c.n,this.inProgress=!1,this.userGroupNames=[],this.memberships=[],this.shouldOpen=!1,this.unsubscribe$=new Ee.a,this.Ulist=[],this.userGroupIds=[],this.usersToRemove=[],this.usersToAdd=[],this.userIds=[],this.query={page:1,name:""}}get accessUsers(){return this._accessUsers}set accessUsers(e){e&&(this._accessUsers=e,this.userIds=this.accessUsers.map(e=>e.id),this.filterNames())}get dropDownUsers(){return this._dropDownUsers}set dropDownUsers(e){this._dropDownUsers=e,this.addToList(e,!1)}ngOnInit(){this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}deleteGroup(){this.inProgress=!0,this.userGroupService.delete(this.userGroup).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.inProgress=!1,this.onDeleted.emit()},()=>{this.inProgress=!1}),this.cd.detectChanges()}updateGroup(e){this.inProgress=!0;const t=kC.a.clone(this.userGroup);t.name=e,this.userGroupService.update(t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.userGroup.name=e,this.inProgress=!1,this.cd.detectChanges()},()=>{this.inProgress=!1}),this.cd.detectChanges()}filterNames(){if(this.accessUsers.length===this.totalUsers)this.userGroupNames=["Everyone"];else{const e=[];this.accessUsers.forEach(t=>e.push(t.name)),this.userGroupNames=e}}openModal(e,t){this.modalService.open(e,{size:t,centered:!0})}changeMembershipStatus(e){"1"==e.memberships.filter(e=>e.targetId===this.workspace.id)[0].membershipStatus?this.workspaceService.setStatus(e.id,XC.a.INACTIVE):this.workspaceService.setStatus(e.id,XC.a.ACTIVE)}resendInvite(e){this.workspaceService.resendInvite(e)}addToList(e,t){const i=t?this.Ulist[0].value.map(e=>e.entity):[];this.Ulist=new Array(Object(IC.a)("Users",[...e,...i])),this.cd.detectChanges()}openEditTeamDropdown(e){this.shouldOpen=!!e.id}closeEditTeamDropdown(e){this.transformMapsToIdsUpdate(e),this.closeAllDropdowns()}transformMapsToIdsUpdate(e){this.updateUserGroupIds(e.filter(e=>"Users"===e.key)[0].value),this.cd.detectChanges()}updateUserGroupIds(e){const t=[...this.userIds],i=e.filter(e=>!e.selected).map(e=>e.entity.id),n=this.userIds.filter(e=>!i.includes(e)),s=e.filter(e=>e.selected).map(e=>e.entity.id);this.userIds=[...new Set([...s,...n])],this.userIds.length===this.totalUsers?this.userGroupNames=["Everyone"]:this.loadUserForNameList(this.userIds),this.usersToAdd=this.userIds.filter(e=>!t.includes(e)),this.usersToRemove=t.filter(e=>!this.userIds.includes(e)),this.cd.detectChanges()}closeAllDropdowns(){const e=[];e.push(this.userGroup.id),this.usersToAdd.length>0&&this.userGroupService.addUserToUserGroup(e,this.usersToAdd),this.usersToRemove.length>0&&this.userGroupService.removeUserFromUserGroup(e,this.usersToRemove),this.shouldOpen=!1,this.cd.detectChanges()}onSearchChange(e){this.query.page=1,this.query.name=e,this.getUsers({page:this.query.page,limit:50,sortColumn:"name",sortOrder:Is.a.ASCENDING,name:this.query.name},!1)}resetEntityList(){""!==this.query.name&&(this.query={page:1,name:""},this.addToList(this.dropDownUsers,!1))}loadMore(){const e={page:++this.query.page,limit:50,sortColumn:"name",sortOrder:Is.a.ASCENDING,name:this.query.name};this.getUsers(e,!0)}getUsers(e,t){this.workspaceService.getUsersByIds(null,e).pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.addToList(e,t),this.cd.detectChanges()})}loadUserForNameList(e){e&&e.length?this.workspaceService.getUsersByIds(e).pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.userGroupNames=e.map(e=>e.name),this.cd.detectChanges()}):this.userGroupNames=[]}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(g.q),c.Rb(c.h),c.Rb(mg.a),c.Rb(U.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["groups-row"],["","groups-row",""]],inputs:{isDesktop:"isDesktop",accessUsers:"accessUsers",dropDownUsers:"dropDownUsers",labels:"labels",showGroup:"showGroup",userGroup:"userGroup",isAdminOrOwner:"isAdminOrOwner",ownerId:"ownerId",currentUserId:"currentUserId",expandAll:"expandAll",totalUsers:"totalUsers",index:"index"},outputs:{onDeleted:"onDeleted"},decls:17,vars:12,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-d-none",3,"isDesktop","templates","isExpanded"],["responsive",""],["col1",""],["col2",""],["noUserGroups",""],["col3",""],["col4",""],["editGroupModal",""],["deleteGroupModal",""],[1,"cl-d-inline-flex","cl-cut-text-wrapper","cl-w-100","cl-py-0","cl-py-lg-custom-2","cl-pr-3","cl-pl-lg-2","cl-pl-lg-custom-0"],[1,"cl-cut-text",3,"title"],[1,"cl-dropdown","cl-dropdown-large","cl-w-100","cl-d-flex"],[1,"cl-no-arrow","cl-component-divided-left","cl-d-flex","cl-w-100",3,"title","ngClass","click"],[1,"cl-cut-text-wrapper","cl-w-100","cl-d-flex","cl-justify-content-center","cl-justify-content-lg-start"],["class","cl-badge cl-badge-tag cl-cut-text",3,"ngClass",4,"ngIf","ngIfElse"],[3,"entityList","onlyCheckbox","placeholder","isReminder","selectedUsers","everyoneSelected","isEditing","user","showSelectAll","ownerId","currentUserId","isUserAdmin","isExternalSearch","closeFilter","onOpen","onScroll","onSearchChange",4,"ngIf"],[1,"cl-badge","cl-badge-tag","cl-cut-text",3,"ngClass"],["ugs",""],[3,"entityList","onlyCheckbox","placeholder","isReminder","selectedUsers","everyoneSelected","isEditing","user","showSelectAll","ownerId","currentUserId","isUserAdmin","isExternalSearch","closeFilter","onOpen","onScroll","onSearchChange"],[1,"cl-d-flex"],["src","assets/images/ui-icons/plus-blue.svg"],[1,"cl-ml-2"],["class","cl-d-flex cl-align-items-center cl-justify-content-end cl-min-height-40 cl-w-100 cl-w-lg-auto cl-ml-auto",4,"ngIf"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end","cl-min-height-40","cl-w-100","cl-w-lg-auto","cl-ml-auto"],[1,"cl-component-divided-left",3,"click"],["src","assets/images/ui-icons/edit.svg"],["src","assets/images/ui-icons/close.svg"],[3,"inProgress","currentName","onClose","onUpdate"],[3,"title","isDanger","btnText","confirmed","close"],[1,"cl-mb-0"]],template:function(e,t){if(1&e&&(c.Wc(0,kS,1,0,"ng-container",0),c.Sb(1,"responsive-row",1,2),c.Wc(3,SS,3,2,"ng-template",null,3,c.Xc),c.Wc(5,ES,6,9,"ng-template",null,4,c.Xc),c.Wc(7,TS,4,0,"ng-template",null,5,c.Xc),c.Wc(9,RS,1,1,"ng-template",null,6,c.Xc),c.Wc(11,jS,1,1,"ng-template",null,7,c.Xc),c.Wc(13,xS,1,2,"ng-template",null,8,c.Xc),c.Wc(15,PS,3,4,"ng-template",null,9,c.Xc)),2&e){const e=c.Lc(2),i=c.Lc(4),n=c.Lc(6),s=c.Lc(10),r=c.Lc(12);c.wc("ngTemplateOutlet",e.template)("ngTemplateOutletContext",c.Bc(5,MS,t.labels)),c.Cb(1),c.wc("isDesktop",t.isDesktop)("templates",c.Ec(7,YS,i,n,s,r))("isExpanded",t.expandAll)}},directives:[s.B,Fi.a,s.r,s.u,EC.a,CS,Ui.a],pipes:[VC.a],encapsulation:2,changeDetection:0}),e})();function FS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",16),c.Xb(1,"div",17),c.Xb(2,"input",18),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().newGroupName=t}))("keyup.enter",(function(){return c.Oc(e),c.nc().createUserGroup()})),c.Wb(),c.Wb(),c.Xb(3,"div",19),c.Xb(4,"button",20),c.jc("click",(function(){return c.Oc(e),c.nc().createUserGroup()})),c.Yc(5,"Add"),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.wc("ngModel",e.newGroupName)}}function NS(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"tr",22),c.jc("onDeleted",(function(){c.Oc(e);const i=t.$implicit;return c.nc(2).onDeleted(i.id)})),c.Wb(),c.Ub()}if(2&e){const e=t.$implicit,i=c.nc(2);c.Cb(1),c.wc("labels",i.labels)("accessUsers",i.userGroupsUsers.get(e.id))("dropDownUsers",i.initialDropdownUsers)("isDesktop",i.isDesktop)("showGroup",i.groupToShow)("userGroup",e)("isAdminOrOwner",i.isAdminOrOwner)("ownerId",i.ownerId)("currentUserId",i.currentUserId)("expandAll",i.expandAll)("totalUsers",i.totalUsers)}}function US(e,t){if(1&e&&(c.Vb(0),c.Wc(1,NS,2,11,"ng-container",21),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.wc("ngForOf",e.userGroups)}}function $S(e,t){if(1&e){const e=c.Yb();c.Xb(0,"pager",23,24),c.jc("pageChanged",(function(t){return c.Oc(e),c.nc().setPaginationUrl(t)}))("limitChanged",(function(t){return c.Oc(e),c.nc().setPaginationUrl(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("page",null==e.pagination?null:e.pagination.page)("limit",null==e.pagination?null:e.pagination.pageSize)("total",e.totalGroupCount)}}function _S(e,t){1&e&&(c.Xb(0,"add-members",25),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb())}let GS=(()=>{class e{constructor(e,t,i,n,s,c,r,o,a,l){this.activatedRoute=e,this.browserService=t,this.router=i,this.uiSettingsService=n,this.cd=s,this.modalService=c,this.workspaceService=r,this.userGroupService=o,this.groupsService=a,this.loader=l,this.unsubscribe$=new Ee.a,this.userGroupsUsers=new Map,this.pageDebouncer$=new Ee.a,this.labels=["Name","Members"],this.groupToShow="Show All",this.userGroups=[]}ngOnInit(){this.loader.showBar(),this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspaceId=e.id}),this.initPagination(),this.setBrowserWidth(),this.getRouteParams(),this.setRouteDebouncer()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}expandAllRows(e){this.expandAll=e}createUserGroup(){this.userGroupService.create(Object(Pt.H)(this.newGroupName),this.workspaceId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.newGroupName="",this.userGroups.unshift(e),this.userGroupsUsers.set(e.id,[]),this.cd.detectChanges()})}changeSortColumn(e){this.pagination.sortColumn=e,this.pagination.sortOrder=Is.a.ASCENDING,this.pageDebouncer$.next()}changeSortOrder(){this.pagination.sortOrder=this.pagination.sortOrder===Is.a.ASCENDING?Is.a.DESCENDING:Is.a.ASCENDING,this.pageDebouncer$.next()}setPaginationUrl(e){this.pagination.page=e.page||this.pagination.page,this.pagination.pageSize=e.limit||this.pagination.pageSize,this.pageDebouncer$.next()}onDeleted(e){this.userGroups=this.userGroups.filter(t=>t.id!==e),this.userGroupsUsers.delete(e),this.cd.detectChanges()}saveLocalStorageSetiings(){this.uiSettingsService.setSettings(hi.b.TEAM_GROUP,{pageSize:this.pagination.pageSize,sortOrder:this.pagination.sortOrder})}initPagination(){const e=this.uiSettingsService.getSettings(hi.b.TEAM_GROUP)||{};this.pagination={page:1,pageSize:e.pageSize||ei.z,sortOrder:Is.a[e.sortOrder]||Is.a.ASCENDING,sortColumn:e.sortColumn||"name"}}setRouteDebouncer(){this.pageDebouncer$.pipe(Object(Te.a)(250)).subscribe(()=>{this.saveLocalStorageSetiings(),this.router.navigate([],{queryParams:this.pagination,relativeTo:this.activatedRoute,fragment:fC.GROUPS.toLowerCase()})})}getRouteParams(){this.activatedRoute.queryParams.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.activatedRoute.snapshot.fragment===fC.GROUPS.toLowerCase()&&(Object(Pt.u)(e.page)&&e.page>0&&(this.pagination.page=Number(e.page)),Object(Pt.u)(e.pageSize)&&e.pageSize>0&&e.pageSize<=200&&(this.pagination.pageSize=Number(e.pageSize)),Is.a[e.sortOrder]&&(this.pagination.sortOrder=e.sortOrder),this.getEverything())})}getEverything(){const e={sortOrder:this.pagination.sortOrder?this.pagination.sortOrder:Is.a.ASCENDING,page:this.pagination.page,limit:this.pagination.pageSize};this.userGroups=[],this.groupsService.getUserGroups(e).pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.userGroups=e.groups.filter(e=>"Admins"!==e.name),this.cd.detectChanges(),this.totalGroupCount=e.count-1,this.isMultiplePages=this.totalGroupCount>ei.z||this.totalGroupCount>this.pagination.pageSize;const t=this.userGroups.some(e=>!!e.userIds)?[...new Set([].concat.apply([],this.userGroups.map(e=>e.userIds)))]:null;t&&t.length>0&&this.workspaceService.getUsersByIds(t).pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.userGroups.forEach(t=>{this.userGroupsUsers.set(t.id,e.filter(e=>t.userIds.includes(e.id.toString())))}),this.cd.detectChanges()}),this.loader.hide(),this.cd.detectChanges()}),this.getUsersForDropdown(),this.getUsersCount()}getUsersForDropdown(){this.workspaceService.getUsersByIds(null,{sortColumn:"name",sortOrder:Is.a.ASCENDING,page:1,limit:ei.z}).pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.initialDropdownUsers=e,this.cd.detectChanges()})}setBrowserWidth(){this.browserService.isBreakpointLgCustom$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.detectChanges()})}getUsersCount(){this.workspaceService.getUserCount().pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.totalUsers=e,this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.a),c.Rb(pi.a),c.Rb(W.c),c.Rb(hi.a),c.Rb(c.h),c.Rb(g.q),c.Rb(U.a),c.Rb(mg.a),c.Rb(Ky.a),c.Rb(wi.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["groups-tab"]],inputs:{isAdminOrOwner:"isAdminOrOwner",ownerId:"ownerId",currentUserId:"currentUserId"},decls:20,vars:6,consts:[[1,"cl-relative"],[1,"cl-tab-pane"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-row","cl-align-items-center"],[1,"cl-col-lg-custom-4","cl-ml-auto"],[1,"cl-form-group","cl-mb-0"],["class","cl-form-row",4,"ngIf"],[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6","cl-team-table-groups"],["groups-header","",3,"sortOrder","sortColumn","isDesktop","onChangeSortOrder","onChangeSortColumn","onExpandAll"],[4,"ngIf"],[1,"cl-mt-2","cl-mt-lg-3"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],["addMembersModal",""],[1,"cl-form-row"],[1,"cl-col"],["type","text","placeholder","Add new user group","preventMultipleSpaces","",1,"cl-form-control",3,"ngModel","ngModelChange","keyup.enter"],[1,"cl-col-auto"],[1,"cl-btn","cl-btn-primary",3,"click"],[4,"ngFor","ngForOf"],["groups-row","",3,"labels","accessUsers","dropDownUsers","isDesktop","showGroup","userGroup","isAdminOrOwner","ownerId","currentUserId","expandAll","totalUsers","onDeleted"],[3,"page","limit","total","pageChanged","limitChanged"],["pager",""],[3,"onClose"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"div",5),c.Wc(6,FS,6,1,"div",6),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(7,"div",7),c.Xb(8,"div",8),c.Xb(9,"span",9),c.Yc(10,"Groups"),c.Wb(),c.Wb(),c.Wb(),c.Xb(11,"table",10),c.Xb(12,"thead"),c.Xb(13,"tr",11),c.jc("onChangeSortOrder",(function(){return t.changeSortOrder()}))("onChangeSortColumn",(function(e){return t.changeSortColumn(e)}))("onExpandAll",(function(e){return t.expandAllRows(e)})),c.Wb(),c.Wb(),c.Xb(14,"tbody"),c.Wc(15,US,2,1,"ng-container",12),c.Wb(),c.Wb(),c.Xb(16,"div",13),c.Wc(17,$S,2,3,"pager",14),c.Wc(18,_S,1,0,"ng-template",null,15,c.Xc),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(6),c.wc("ngIf",t.isAdminOrOwner),c.Cb(7),c.wc("sortOrder",t.pagination.sortOrder)("sortColumn",t.pagination.sortColumn)("isDesktop",t.isDesktop),c.Cb(2),c.wc("ngIf",!!t.userGroups&&t.userGroups.length>0&&!!t.initialDropdownUsers&&!!t.userGroupsUsers),c.Cb(2),c.wc("ngIf",t.isMultiplePages))},directives:[s.u,yS,p.c,WS.a,p.s,p.v,s.t,LS,cn.a,Bk],encapsulation:2,changeDetection:0}),e})();var BS=i("FRqX"),VS=i("AmrI"),HS=i("4500");function zS(e,t){if(1&e&&(c.Vb(0),c.Yc(1),c.oc(2,"displayUserName"),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.ad(" ",c.rc(2,1,e.newReminder.users,e.users,e.userGroups)," ")}}function qS(e,t){1&e&&c.Yc(0," (select team members) ")}function KS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"dropdown-filter",19),c.jc("allSelectedReminder",(function(t){return c.Oc(e),c.nc().setAllSelectedReminder(t)}))("allSelected",(function(t){return c.Oc(e),c.nc().setAllSelected(t)}))("closeFilter",(function(t){return c.Oc(e),c.nc().closeTeamDropdown(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("entityList",e.teamMaps)("onlyCheckbox",!1)("placeholder","Find users and user groups...")("isReminder",!0)("everyoneSelected",e.allSelected)("reminderAllSelected",e.allSelectedReminder)("showSelectAll",!0)("isEditing",!1)("selectedUsers",e.newReminder.users)("totalEntities",e.totalTeamMaps)}}function ZS(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",20),c.Xb(1,"div",21),c.Xb(2,"input",22,23),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().newReminder.hours=t}))("keyup.enter",(function(){return c.Oc(e),c.Lc(3).blur()})),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.wc("ngModel",e.newReminder.hours)("minNumber",0)}}function QS(e,t){if(1&e&&(c.Vb(0),c.Yc(1),c.oc(2,"displayDayOfWeek"),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" ",c.pc(2,1,e.newReminder.days)," ")}}function JS(e,t){1&e&&c.Yc(0," (select days) ")}function eI(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",30),c.Xb(1,"div",31),c.jc("click",(function(){c.Oc(e);const i=t.index;return c.nc(3).toggleDay(i)})),c.Sb(2,"input",32),c.Xb(3,"label",33),c.Xb(4,"div",34),c.Yc(5),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit,i=t.index,n=c.nc(3);c.Cb(2),c.wc("checked",n.newReminder.days.indexOf(i)>-1),c.Cb(3),c.Zc(e)}}function tI(e,t){if(1&e&&(c.Xb(0,"div",27),c.Xb(1,"div",28),c.Wc(2,eI,6,2,"div",29),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(2),c.wc("ngForOf",e.days)}}function iI(e,t){if(1&e&&(c.Xb(0,"span",12),c.Xb(1,"span"),c.Yc(2,"on "),c.Wb(),c.Xb(3,"a",24),c.Wc(4,QS,3,3,"ng-container",8),c.Wc(5,JS,1,0,"ng-template",null,25,c.Xc),c.Wb(),c.Wc(7,tI,3,1,"div",26),c.Wb()),2&e){const e=c.Lc(6),t=c.nc();c.Cb(4),c.wc("ngIf",t.newReminder.days.length>0)("ngIfElse",e)}}let nI=(()=>{class e{constructor(e,t,i){this.reminderService=e,this.toaster=t,this.cd=i,this.unsubscribe$=new mi.a,this.isTeamDropdownOpen=!1,this.inProgress=!1,this.userGroupIds=[],this.userIds=[],this.allSelectedReminder=!1,this.allSelected=!1,this.createdReminder=new c.n,this.lessMore=[new di.a(!0,"Less"),new di.a(!1,"More")],this.dateRanges=[new di.a("day","Day"),new di.a("week","Week"),new di.a("month","Month")],this.days=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],this.receiverLabels=new Map([["Them",VS.a.USERS],["Their managers",VS.a.MANAGERS],["All admins",VS.a.ADMINS]])}get teamMaps(){return this._teamMaps}set teamMaps(e){e&&(this._teamMaps=e,this.totalTeamMaps=e[0].value.length+e[1].value.length)}ngOnInit(){this.isTeamDropdownOpen=!1,this.newReminder=new BS.a,this.newReminder.less=!0,this.initReceivers()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setAllSelectedReminder(e){this.allSelectedReminder=e}setAllSelected(e){this.allSelected=e}setLess(e){this.newReminder.less=e}setRange(e){this.newReminder.dateRange=e}openTeamDropdown(){this.isTeamDropdownOpen=!0}closeTeamDropdown(e){this.isTeamDropdownOpen=!1,this.transformMapsToIdsOfEntity(e)}transformMapsToIdsOfEntity(e){this.newReminder.users=[],e.forEach(e=>{"Groups"===e.key&&this.toUserGroupIds(e.value),"Users"===e.key&&this.toUserIds(e.value),"Everyone"===e.key&&this.toEveryone()})}toUserGroupIds(e){this.newReminder.users=[],this.userGroupIds=e.filter(e=>e.selected).map(e=>new kC.a(e.entity).id),this.newReminder.users=[...this.newReminder.users,...this.userGroupIds]}toUserIds(e){this.userIds=e.filter(e=>e.selected).map(e=>new hc.a(e.entity).id),this.newReminder.users=[...this.newReminder.users,...this.userIds]}toEveryone(){this.newReminder.users=["everyone"],this.allSelected=!0,this.cd.detectChanges()}addReminder(){if(this.inProgress=!0,"day"==this.newReminder.dateRange.toLowerCase()){if(0===this.newReminder.days.length)return this.reminderService.toastForEmptyDays(!0),void(this.inProgress=!1)}else this.newReminder.days=[0,1,2,3,4,5,6];if(0===this.newReminder.users.length)return this.toaster.pop("error","Can't create reminder without task assignees added."),void(this.inProgress=!1);this.reminderService.createReminder(this.newReminder,this.activeWorkspaceId).pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.resetReminder(),this.createdReminder.emit(e),this.inProgress=!1},()=>{this.inProgress=!1})}toggleDay(e){const t=this.newReminder.days.indexOf(e);-1!==t?this.newReminder.days.splice(t,1):this.newReminder.days.push(e),this.newReminder.days=[...this.newReminder.days]}resetReminder(){this.newReminder=new BS.a,this.newReminder.less=!0,this.allSelectedReminder=!1,this.allSelected=!1,this.teamMaps.forEach(e=>e.value.forEach(e=>e.selected=!1)),this.initReceivers()}initReceivers(){this.receiversDropdown=[new di.a(!0,"Them"),new di.a(!1,"Their managers"),new di.a(!1,"All admins")]}onStatusChange(e){this.newReminder.receivers=di.a.getLabelsOf(e,!0).map(e=>this.receiverLabels.get(e))}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(hg.a),c.Rb(M.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["new-reminder"]],inputs:{activeWorkspaceId:"activeWorkspaceId",teamMaps:"teamMaps",users:"users",userGroups:"userGroups"},outputs:{createdReminder:"createdReminder"},decls:37,vars:19,consts:[[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-row"],[1,"cl-col-12"],[1,"cl-form-group","cl-mb-0"],[1,"cl-form-row","cl-align-items-center","cl-justify-content-lg-end"],[1,"cl-col-auto"],[1,"cl-dropdown","cl-dropdown-large","cl-mx-1"],[3,"click"],[4,"ngIf","ngIfElse"],["selectTeams",""],[3,"entityList","onlyCheckbox","placeholder","isReminder","everyoneSelected","reminderAllSelected","showSelectAll","isEditing","selectedUsers","totalEntities","allSelectedReminder","allSelected","closeFilter",4,"ngIf"],[1,"cl-mx-1","cl-d-inline-block",3,"type","list","value","onChanged"],["dropdownKey","",1,"cl-dropdown","cl-mx-1"],["dropdownKeyButton","","tabindex","0","ngDefaultControl","",3,"ngModel","ngModelChange"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["dropdownClose","","tabindex","0",1,"cl-no-focus-tabindex"],["class","cl-dropdown cl-mx-1","dropdownKey","",4,"ngIf"],[1,"cl-mx-1","cl-d-inline-block",3,"type","verboseTitle","lowercaseTitle","disableFirst","list","showPlaceholder","onChange"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[3,"entityList","onlyCheckbox","placeholder","isReminder","everyoneSelected","reminderAllSelected","showSelectAll","isEditing","selectedUsers","totalEntities","allSelectedReminder","allSelected","closeFilter"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-p-3","cl-my-n1"],["type","number","name","hours","autocomplete","off","inputNumber","",1,"cl-form-control",3,"ngModel","minNumber","ngModelChange","keyup.enter"],["hours",""],["dropdownKeyButton",""],["selectDays",""],["class","cl-dropdown-menu cl-prevent-close",4,"dropdownKeyContent"],[1,"cl-dropdown-menu","cl-prevent-close"],[1,"cl-scroll-area"],["class","cl-dropdown-item cl-dropdown-item-checkbox cl-cut-text-wrapper",4,"ngFor","ngForOf"],[1,"cl-dropdown-item","cl-dropdown-item-checkbox","cl-cut-text-wrapper"],[1,"cl-custom-control","cl-custom-checkbox",3,"click"],["type","checkbox",1,"cl-custom-control-input",3,"checked"],[1,"cl-custom-control-label"],[1,"cl-cut-text"]],template:function(e,t){if(1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"div",5),c.Xb(6,"div"),c.Xb(7,"span"),c.Yc(8,"If"),c.Wb(),c.Xb(9,"span",6),c.Xb(10,"a",7),c.jc("click",(function(){return t.openTeamDropdown()})),c.Wc(11,zS,3,5,"ng-container",8),c.Wc(12,qS,1,0,"ng-template",null,9,c.Xc),c.Wb(),c.Wc(14,KS,1,10,"dropdown-filter",10),c.Wb(),c.Xb(15,"span"),c.Yc(16,"tracked"),c.Wb(),c.Xb(17,"dropdown-items",11),c.jc("onChanged",(function(e){return t.newReminder.less=e})),c.Wb(),c.Xb(18,"span"),c.Yc(19,"than"),c.Wb(),c.Xb(20,"span",12),c.Xb(21,"a",13),c.jc("ngModelChange",(function(e){return t.newReminder.hours=e})),c.Yc(22),c.Wb(),c.Wc(23,ZS,4,2,"div",14),c.Sb(24,"span",15),c.Wb(),c.Xb(25,"span"),c.Yc(26,"hours per"),c.Wb(),c.Xb(27,"dropdown-items",11),c.jc("onChanged",(function(e){return t.newReminder.dateRange=e})),c.Wb(),c.Wc(28,iI,8,2,"span",16),c.Xb(29,"span"),c.Yc(30,", send"),c.Wb(),c.Xb(31,"dropdown-checkbox-list",17),c.jc("onChange",(function(e){return t.onStatusChange(e)})),c.Wb(),c.Xb(32,"span"),c.Yc(33,"a reminder"),c.Wb(),c.Wb(),c.Wb(),c.Xb(34,"div",5),c.Xb(35,"button",18),c.jc("click",(function(){return t.addReminder()})),c.Yc(36,"Add"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.Lc(13);c.Cb(11),c.wc("ngIf",0!==t.newReminder.users.length)("ngIfElse",e),c.Cb(3),c.wc("ngIf",t.isTeamDropdownOpen),c.Cb(3),c.wc("type","TEXT")("list",t.lessMore)("value",t.newReminder.less?"Less":"More"),c.Cb(4),c.wc("ngModel",t.newReminder.hours),c.Cb(1),c.Zc(t.newReminder.hours),c.Cb(5),c.wc("type","TEXT")("list",t.dateRanges)("value",t.newReminder.dateRange),c.Cb(1),c.wc("ngIf","day"==t.newReminder.dateRange.toLowerCase()),c.Cb(3),c.wc("type","TEXT")("verboseTitle",!0)("lowercaseTitle",!1)("disableFirst",!0)("list",t.receiversDropdown)("showPlaceholder",!1),c.Cb(4),c.wc("disabled",t.inProgress)}},directives:[s.u,pn.a,Si.a,Ii.a,p.c,p.s,p.v,Oi.a,Di,EC.a,p.y,Zr.a,s.t],pipes:[Lg.a,HS.a],encapsulation:2,changeDetection:0}),e})();function sI(e,t){if(1&e){const e=c.Yb();c.Xb(0,"dropdown-filter",14),c.jc("allSelectedReminder",(function(t){return c.Oc(e),c.nc().setAllSelected(t)}))("closeFilter",(function(t){c.Oc(e);const i=c.nc();return i.closeEditTeamDropdown(t,i.reminder)})),c.Wb()}if(2&e){const e=c.nc();c.wc("entityList",e.editTeamMaps)("onlyCheckbox",!1)("placeholder","Find users and user groups...")("isReminder",!0)("showSelectAll",!0)("selectedUsers",e.reminder.users)("everyoneSelected",e.reminder.users.length>0&&"everyone"===e.reminder.users[0])("reminderAllSelected",e.allSelectedReminder)("isEditing",!0)("totalEntities",e.totalEditTeamMaps)}}function cI(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",15),c.Xb(1,"div",16),c.Xb(2,"input",17,18),c.jc("blur",(function(){return c.Oc(e),c.nc().editHours()}))("keyup.enter",(function(){return c.Oc(e),c.Lc(3).blur()}))("ngModelChange",(function(t){return c.Oc(e),c.nc().reminder.hours=t})),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.wc("ngModel",e.reminder.hours)("minNumber",0)}}function rI(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",25),c.Xb(1,"div",26),c.jc("click",(function(){c.Oc(e);const i=t.index;return c.nc(3).toggleDay(i)})),c.Sb(2,"input",27),c.Xb(3,"label",28),c.Xb(4,"div",29),c.Yc(5),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit,i=t.index,n=c.nc(3);c.Cb(2),c.wc("checked",n.reminder.days.indexOf(i)>-1),c.Cb(3),c.Zc(e)}}function oI(e,t){if(1&e&&(c.Xb(0,"div",22),c.Xb(1,"div",23),c.Wc(2,rI,6,2,"div",24),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(2),c.wc("ngForOf",e.days)}}function aI(e,t){if(1&e){const e=c.Yb();c.Xb(0,"span",19),c.jc("onClose",(function(){c.Oc(e);const t=c.nc();return t.updateReminder(t.reminder)})),c.Xb(1,"span"),c.Yc(2,"on "),c.Wb(),c.Xb(3,"a",20),c.Yc(4),c.oc(5,"displayDayOfWeek"),c.Wb(),c.Wc(6,oI,3,1,"div",21),c.Wb()}if(2&e){const e=c.nc();c.Cb(4),c.Zc(c.pc(5,1,e.reminder.days))}}function lI(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",30),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit,n=c.nc();return n.deleteReminder(n.reminder,i)}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Xb(1,"p",31),c.Yc(2,"Are you sure you want to delete reminder?"),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Delete reminder")("btnText","Delete")("isDanger",!0)("inProgress",e.inProgress)}}let bI=(()=>{class e{constructor(e,t){this.reminderService=e,this.modalService=t,this.userGroupIds=[],this.userIds=[],this.reminders=[],this.userGroups=[],this.users=[],this.deletedReminder=new c.n,this.unsubscribe$=new mi.a,this.lessMore=[new di.a(!0,"Less"),new di.a(!1,"More")],this.dateRanges=[new di.a("DAY","day"),new di.a("WEEK","week"),new di.a("MONTH","month")],this.receiverLabels=new Map([["Them",VS.a.USERS],["Their managers",VS.a.MANAGERS],["All admins",VS.a.ADMINS]]),this.receiversDropdown=[],this.days=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]}get editTeamMaps(){return this._editTeamMaps}set editTeamMaps(e){e&&(this._editTeamMaps=e,this.totalEditTeamMaps=e[0].value.length+e[1].value.length)}ngOnInit(){for(const[e,t]of this.receiverLabels)this.receiversDropdown.push(new di.a(this.reminder.receivers.includes(t),e))}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setAllSelected(e){this.allSelectedReminder=e}toggleDay(e){const t=this.reminder.days.indexOf(e);if(-1!==t){if(1===this.reminder.days.length)return;this.reminder.days.splice(t,1)}else this.reminder.days.push(e);this.reminder.days=[...this.reminder.days]}deleteReminder(e,t){this.inProgress=!0,this.reminderService.deleteReminder(e.id,this.activeWorkspaceId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.deletedReminder.emit(),this.inProgress=!1,t.close(),this.closeAllDropdowns()},()=>this.inProgress=!1)}openEditTeamDropdown(e){this.teamDropdown=e.id}editDateRange(e){this.reminderService.updateReminder(e,this.activeWorkspaceId),this.closeAllDropdowns()}editLess(e,t){e.less!==t?(e.less=t,this.reminderService.updateReminder(e,this.activeWorkspaceId),this.closeAllDropdowns()):this.closeAllDropdowns()}editHours(){this.reminderService.updateReminder(this.reminder,this.activeWorkspaceId)}editReceivers(e){this.reminderService.updateReminder(e,this.activeWorkspaceId)}closeEditTeamDropdown(e,t){this.transformMapsToIdsUpdate(e,t),this.closeAllDropdowns()}transformMapsToIdsUpdate(e,t){t.users=[];let i=0;e.forEach(n=>{"Groups"===n.key&&this.updateUserGroupIds(n.value),"Users"===n.key&&this.updateUserIds(n.value),"Everyone"===n.key&&this.updateEveryone(),i++,i===e.length&&this.updateTeamReminder(t)})}updateUserGroupIds(e){this.userGroupIds=e.filter(e=>e.selected).map(e=>new kC.a(e.entity).id)}updateUserIds(e){this.userIds=e.filter(e=>e.selected).map(e=>new hc.a(e.entity).id)}updateEveryone(){this.userIds=["everyone"],this.reminder.users=["everyone"]}updateTeamReminder(e){e.users=this.userIds.indexOf("everyone")>-1?["everyone"]:[...this.userIds,...this.userGroupIds],this.updateReminder(e)}updateReminder(e){this.reminderService.updateReminder(e,this.activeWorkspaceId)}closeAllDropdowns(){if(this.daysDropdown){const e=this.reminders.filter(e=>e.id==this.daysDropdown)[0];if(0==e.days.length)return void this.reminderService.toastForEmptyDays(!1);this.updateReminder(e)}}openDeleteModal(e){this.modalService.open(e,{centered:!0})}onStatusChange(e){this.reminder.receivers=di.a.getLabelsOf(e,!0).map(e=>this.receiverLabels.get(e)),this.reminderService.updateReminder(this.reminder,this.activeWorkspaceId)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(hg.a),c.Rb(g.q))},e.\u0275cmp=c.Lb({type:e,selectors:[["reminder-row"]],inputs:{reminder:"reminder",activeWorkspaceId:"activeWorkspaceId",editTeamMaps:"editTeamMaps",userGroupIds:"userGroupIds",userIds:"userIds",reminders:"reminders",userGroups:"userGroups",users:"users"},outputs:{deletedReminder:"deletedReminder"},decls:33,vars:26,consts:[[1,"cl-dropdown","cl-dropdown-large","cl-mx-1"],[3,"title","click"],[1,"overflowHidden"],[3,"entityList","onlyCheckbox","placeholder","isReminder","showSelectAll","selectedUsers","everyoneSelected","reminderAllSelected","isEditing","totalEntities","allSelectedReminder","closeFilter",4,"ngIf"],[1,"cl-mx-1","cl-d-inline-block",3,"type","list","value","onChanged"],["dropdownKey","",1,"cl-dropdown","cl-mx-1"],["dropdownKeyButton","","tabindex","0","ngDefaultControl","",3,"ngModel","ngModelChange"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["dropdownClose","","tabindex","0",1,"cl-no-focus-tabindex"],["class","cl-dropdown cl-mx-1","dropdownKey","",3,"onClose",4,"ngIf"],[1,"cl-mx-1","cl-d-inline-block",3,"type","disableFirst","verboseTitle","lowercaseTitle","list","showPlaceholder","onChange"],[1,"cl-component-divided-left","cl-d-flex","cl-w-auto",3,"click"],["src","assets/images/ui-icons/close.svg"],["deleteModal",""],[3,"entityList","onlyCheckbox","placeholder","isReminder","showSelectAll","selectedUsers","everyoneSelected","reminderAllSelected","isEditing","totalEntities","allSelectedReminder","closeFilter"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-p-3","cl-my-n1"],["type","number","name","hours","autocomplete","off","inputNumber","",1,"cl-form-control",3,"ngModel","minNumber","blur","keyup.enter","ngModelChange"],["hours",""],["dropdownKey","",1,"cl-dropdown","cl-mx-1",3,"onClose"],["dropdownKeyButton",""],["class","cl-dropdown-menu cl-prevent-close",4,"dropdownKeyContent"],[1,"cl-dropdown-menu","cl-prevent-close"],[1,"cl-scroll-area"],["class","cl-dropdown-item cl-dropdown-item-checkbox cl-cut-text-wrapper",4,"ngFor","ngForOf"],[1,"cl-dropdown-item","cl-dropdown-item-checkbox","cl-cut-text-wrapper"],[1,"cl-custom-control","cl-custom-checkbox",3,"click"],["type","checkbox",1,"cl-custom-control-input",3,"checked"],[1,"cl-custom-control-label"],[1,"cl-cut-text"],[3,"title","btnText","isDanger","inProgress","confirmed","close"],[1,"cl-mb-0"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div"),c.Xb(1,"span"),c.Yc(2,"If"),c.Wb(),c.Xb(3,"span",0),c.Xb(4,"a",1),c.jc("click",(function(){return t.openEditTeamDropdown(t.reminder)})),c.oc(5,"displayUserName"),c.Xb(6,"span",2),c.Yc(7),c.oc(8,"displayUserName"),c.Wb(),c.Wc(9,sI,1,10,"dropdown-filter",3),c.Wb(),c.Wb(),c.Xb(10,"span"),c.Yc(11,"tracked"),c.Wb(),c.Xb(12,"dropdown-items",4),c.jc("onChanged",(function(e){return t.editLess(t.reminder,e)})),c.Wb(),c.Xb(13,"span"),c.Yc(14,"than"),c.Wb(),c.Xb(15,"span",5),c.Xb(16,"a",6),c.jc("ngModelChange",(function(e){return t.reminder.hours=e})),c.Yc(17),c.Wb(),c.Wc(18,cI,4,2,"div",7),c.Wb(),c.Sb(19,"span",8),c.Xb(20,"span"),c.Yc(21,"hours per"),c.Wb(),c.Xb(22,"dropdown-items",4),c.jc("onChanged",(function(e){return t.reminder.dateRange=e,t.editDateRange(t.reminder)})),c.Wb(),c.Wc(23,aI,7,3,"span",9),c.Xb(24,"span"),c.Yc(25,", send"),c.Wb(),c.Xb(26,"dropdown-checkbox-list",10),c.jc("onChange",(function(e){return t.onStatusChange(e)})),c.Wb(),c.Xb(27,"span"),c.Yc(28,"a reminder"),c.Wb(),c.Wb(),c.Xb(29,"a",11),c.jc("click",(function(){c.Oc(e);const i=c.Lc(32);return t.openDeleteModal(i)})),c.Sb(30,"img",12),c.Wb(),c.Wc(31,lI,3,4,"ng-template",null,13,c.Xc)}2&e&&(c.Cb(4),c.xc("title",c.rc(5,18,t.reminder.users,t.users,t.userGroups)),c.Cb(3),c.ad(" ",c.rc(8,22,t.reminder.users,t.users,t.userGroups)," "),c.Cb(2),c.wc("ngIf",t.teamDropdown==t.reminder.id),c.Cb(3),c.wc("type","TEXT")("list",t.lessMore)("value",t.reminder.less),c.Cb(4),c.wc("ngModel",t.reminder.hours),c.Cb(1),c.Zc(t.reminder.hours),c.Cb(5),c.wc("type","TEXT")("list",t.dateRanges)("value",t.reminder.dateRange),c.Cb(1),c.wc("ngIf","day"==t.reminder.dateRange.toLowerCase()),c.Cb(3),c.wc("type","TEXT")("disableFirst",!0)("verboseTitle",!0)("lowercaseTitle",!1)("list",t.receiversDropdown)("showPlaceholder",!1))},directives:[s.u,pn.a,Si.a,Ii.a,p.c,p.s,p.v,Oi.a,Di,EC.a,p.y,Zr.a,s.t,Ui.a],pipes:[Lg.a,HS.a],encapsulation:2}),e})();const uI=function(){return["/upgrade"]};function dI(e,t){1&e&&(c.Xb(0,"div",8),c.Xb(1,"div",9),c.Yc(2," STANDARD feature "),c.Xb(3,"a",10),c.Yc(4,"Upgrade"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(3),c.wc("routerLink",c.Ac(1,uI)))}function pI(e,t){1&e&&c.Sb(0,"div",11)}function hI(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"new-reminder",12),c.jc("createdReminder",(function(t){return c.Oc(e),c.nc().addNewReminder(t)})),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(1),c.wc("activeWorkspaceId",e.activeWorkspaceId)("teamMaps",e.teamMaps)("users",e.users)("userGroups",e.userGroups)}}function mI(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"reminder-row",14),c.jc("deletedReminder",(function(){c.Oc(e);const i=t.index;return c.nc(2).deleteReminder(i)})),c.Wb(),c.Ub()}if(2&e){const e=t.$implicit,i=c.nc(2);c.Cb(1),c.wc("reminder",e)("activeWorkspaceId",i.activeWorkspaceId)("editTeamMaps",i.editTeamMaps)("userGroupIds",i.userGroupIds)("userIds",i.userIds)("reminders",i.reminders)("users",i.users)("userGroups",i.userGroups)}}function gI(e,t){if(1&e&&(c.Vb(0),c.Wc(1,mI,2,8,"ng-container",13),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.wc("ngForOf",e.reminders)}}let fI=(()=>{class e{constructor(e,t,i){this.userGroupService=e,this.workspaceService=t,this.reminderService=i,this.reminders=[],this.teamMaps=[],this.editTeamMaps=[],this.userGroups=[],this.users=[],this.unsubscribe$=new mi.a,this.userGroupIds=[],this.userIds=[]}ngOnInit(){const e=this.workspaceService.getLocalDefaultWorkspace();this.hasRemindersFeature=e.hasFeature(nr.a.TARGETS_AND_REMINDERS),this.initialize()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initialize(){this.hasRemindersFeature&&(this.activeWorkspaceId=this.workspaceService.getDefaultWorkspaceId(),this.userGroupService.userGroups.pipe(Object(dg.a)()).subscribe(e=>{this.userGroups=e.filter(e=>"Admins"!==e.name),this.userGroupIds=this.userGroups.map(e=>e.id),0!==this.userGroups.length?(this.teamMaps.push(Object(IC.a)("Groups",this.userGroups)),this.editTeamMaps.push(Object(IC.a)("Groups",this.userGroups))):(this.teamMaps.push(Object(IC.a)("Groups",[])),this.editTeamMaps.push(Object(IC.a)("Groups",[]))),this.workspaceService.getAllUsersForWorkspace(this.activeWorkspaceId)}),this.workspaceService.activeUsers.pipe(Object(dg.a)()).subscribe(e=>{this.users=e,this.userIds=this.users.map(e=>e.id),0!==this.users.length?(this.teamMaps.push(Object(IC.a)("Users",this.users)),this.editTeamMaps.push(Object(IC.a)("Users",this.users))):(this.teamMaps.push(Object(IC.a)("Users",[])),this.editTeamMaps.push(Object(IC.a)("Users",[])))}),this.reminderService.reminders.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.reminders=e}),this.userGroupService.getAllUserGroups(this.activeWorkspaceId),this.reminderService.getReminders(this.activeWorkspaceId))}addNewReminder(e){this.reminders.unshift(e)}deleteReminder(e){this.reminders.splice(e,1)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(mg.a),c.Rb(U.a),c.Rb(hg.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["reminders"]],decls:10,vars:4,consts:[[1,"cl-tab-pane","cl-fade","cl-show","cl-active"],["class","cl-form-group",4,"ngIf"],[1,"cl-relative"],["class","cl-blocker",4,"ngIf"],[4,"ngIf"],[1,"cl-card","cl-border-bottom"],[1,"cl-card-header","cl-px-2","cl-px-lg-3"],[1,"cl-h6","cl-mb-0"],[1,"cl-form-group"],[1,"cl-alert","cl-alert-info","cl-mb-0"],[1,"cl-btn",3,"routerLink"],[1,"cl-blocker"],[3,"activeWorkspaceId","teamMaps","users","userGroups","createdReminder"],[4,"ngFor","ngForOf"],[1,"cl-component-row","cl-pr-0","cl-d-flex","cl-w-100","cl-justify-content-between","cl-align-items-center",3,"reminder","activeWorkspaceId","editTeamMaps","userGroupIds","userIds","reminders","users","userGroups","deletedReminder"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Wc(1,dI,5,2,"div",1),c.Xb(2,"div",2),c.Wc(3,pI,1,0,"div",3),c.Wc(4,hI,2,4,"ng-container",4),c.Xb(5,"div",5),c.Xb(6,"div",6),c.Xb(7,"span",7),c.Yc(8,"Reminders"),c.Wb(),c.Wb(),c.Wc(9,gI,2,1,"ng-container",4),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(1),c.wc("ngIf",!1===t.hasRemindersFeature),c.Cb(2),c.wc("ngIf",!t.hasRemindersFeature),c.Cb(1),c.wc("ngIf",2===t.teamMaps.length),c.Cb(5),c.wc("ngIf",2===t.editTeamMaps.length))},directives:[s.u,W.f,nI,s.t,bI],encapsulation:2}),e})();const vI=function(){return["/subscription"]};function wI(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div"),c.Xb(1,"div",19),c.Xb(2,"span"),c.Yc(3,"User seats"),c.Wb(),c.Xb(4,"a",20),c.jc("click",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(26);return t.openFeaturesInfo(i)})),c.Sb(5,"img",21),c.Wb(),c.Xb(6,"a",22),c.Yc(7,"Manage"),c.Wb(),c.Wb(),c.Xb(8,"div",23),c.Sb(9,"div",24),c.Wb(),c.Xb(10,"p",25),c.Yc(11),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(6),c.wc("routerLink",c.Ac(9,vI)),c.Cb(3),c.Vc("width",e.percentage+"%"),c.Hb("cl-progress-bar-success-blue",!e.isUsedAllSeats)("cl-bg-danger",e.isUsedAllSeats),c.Cb(2),c.bd("",e.activeMembers," of ",e.quantity," used")}}const yI=function(){return["/teams"]};function WI(e,t){if(1&e&&(c.Xb(0,"li",7),c.Xb(1,"a",26),c.Yc(2," Reminders"),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.Hb("cl-active","REMINDERS"===e.activePill),c.wc("routerLink",c.Ac(3,yI))}}function CI(e,t){if(1&e){const e=c.Yb();c.Xb(0,"members-tab",27),c.jc("recalculateQuantity",(function(t){return c.Oc(e),c.nc().recalculateQuantity(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("isAdminOrOwner",e.isAdminOrOwner)("currentUserId",e.currentUserId)("quantity",e.quantity)("amount",e.amount)("isOwner",e.isOwner)("ownerId",e.ownerId)("activeMembersLength",e.activeMembers)("isLoaded",e.isPaymentDataLoaded)}}function kI(e,t){if(1&e&&c.Sb(0,"groups-tab",28),2&e){const e=c.nc();c.wc("isAdminOrOwner",e.isAdminOrOwner)("ownerId",e.ownerId)("currentUserId",e.currentUserId)}}function SI(e,t){1&e&&c.Sb(0,"reminders")}function II(e,t){1&e&&(c.Xb(0,"add-members",29),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb())}function OI(e,t){1&e&&(c.Xb(0,"transfer-owner-role",29),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb())}function XI(e,t){1&e&&(c.Xb(0,"features-info",30),c.jc("close",(function(){return t.$implicit.close()})),c.Wb()),2&e&&c.wc("type","user-seats")}let EI=(()=>{class e{constructor(e,t,i,n,s){this.activatedRoute=e,this.router=t,this.authService=i,this.modalService=n,this.workspaceService=s,this.unsubscribe$=new Ee.a,this.activePill="MEMBERS",this.activeMembers=0,this.quantity=0,this.PaymentType=ku.a}ngOnInit(){this.currentUserId=JSON.parse(localStorage.getItem("user")).id,this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.getOwnerId(),this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(({isAdminOrOwner:e})=>{this.isAdminOrOwner=e}),this.activatedRoute.fragment.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{const t=fC[(e||"").toUpperCase()];this.activePill=t||fC.MEMBERS,t||this.router.navigate([])}),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.featureType=this.workspace.featureSubscriptionType&&ku.a[this.workspace.featureSubscriptionType.replace("SPECIAL","PLUS")],this.workspaceService.payment.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.quantity=e.quantity,this.amount=e.amount,this.activeMembers=this.workspace.memberships.filter(e=>e.isActiveOrPending).length,this.percentage=e.quantity?100*this.activeMembers/e.quantity:0,this.isUsedAllSeats=this.percentage>=100,this.isPaymentDataLoaded=!0}),this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e;const t=e.memberships.filter(e=>e.isActiveOrPending);this.recalculateQuantity(t?t.length:0)}),this.featureType&&this.featureType.bySeat&&this.isAdminOrOwner?this.workspaceService.getPaymentDate(this.workspace.id):this.isPaymentDataLoaded=!0}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getOwnerId(){this.workspaceService.getWorkspaceOwner().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.ownerId=e.ownerId,this.isOwner=e.isOwner})}recalculateQuantity(e){this.percentage=this.quantity?100*e/this.quantity:0,this.activeMembers=e,this.isUsedAllSeats=this.percentage>=100}openFeaturesInfo(e){this.modalService.open(e,{size:"lg",centered:!0})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.a),c.Rb(W.c),c.Rb(Ce.a),c.Rb(g.q),c.Rb(U.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["teams2"]],decls:27,vars:13,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper","cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-h1"],[4,"ngIf"],[1,"cl-scroll-tabs-wrapper"],["tabs","",1,"cl-nav","cl-nav-tabs","cl-m-0","cl-scroll-tabs"],[1,"cl-nav-item"],["fragment","members",1,"cl-nav-link",3,"routerLink"],["fragment","groups",1,"cl-nav-link",3,"routerLink"],["class","cl-nav-item",4,"ngIf"],[1,"cl-card"],[1,"cl-card-body"],[1,"cl-tab-content"],[3,"isAdminOrOwner","currentUserId","quantity","amount","isOwner","ownerId","activeMembersLength","isLoaded","recalculateQuantity",4,"ngIf"],[3,"isAdminOrOwner","ownerId","currentUserId",4,"ngIf"],["addMembersModal",""],["transferOwnerRoleModal",""],["featuresInfoModal",""],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center","cl-mb-2"],[1,"cl-ml-1","cl-mr-5","cl-d-inline-flex",3,"click"],["src","assets/ui-icons/info-9.svg"],["fragment","payment",1,"cl-color-blue","cl-small",3,"routerLink"],[1,"cl-progress",2,"height","5px"],["role","progressbar",1,"cl-progress-bar"],[1,"cl-mt-1","cl-mb-0"],["fragment","reminders",1,"cl-nav-link",3,"routerLink"],[3,"isAdminOrOwner","currentUserId","quantity","amount","isOwner","ownerId","activeMembersLength","isLoaded","recalculateQuantity"],[3,"isAdminOrOwner","ownerId","currentUserId"],[3,"onClose"],[3,"type","close"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"h1",3),c.Yc(4,"Team"),c.Wb(),c.Wc(5,wI,12,10,"div",4),c.Wb(),c.Xb(6,"div",5),c.Xb(7,"ul",6),c.Xb(8,"li",7),c.Xb(9,"a",8),c.Yc(10," Members"),c.Wb(),c.Wb(),c.Xb(11,"li",7),c.Xb(12,"a",9),c.Yc(13," Groups"),c.Wb(),c.Wb(),c.Wc(14,WI,3,4,"li",10),c.Wb(),c.Wb(),c.Xb(15,"div",11),c.Xb(16,"div",12),c.Xb(17,"div",13),c.Wc(18,CI,1,8,"members-tab",14),c.Wc(19,kI,1,3,"groups-tab",15),c.Wc(20,SI,1,0,"reminders",4),c.Wb(),c.Wb(),c.Wb(),c.Wc(21,II,1,0,"ng-template",null,16,c.Xc),c.Wc(23,OI,1,0,"ng-template",null,17,c.Xc),c.Wb(),c.Wb(),c.Wc(25,XI,1,1,"ng-template",null,18,c.Xc)),2&e&&(c.Cb(5),c.wc("ngIf",t.featureType&&t.featureType.bySeat&&t.isAdminOrOwner),c.Cb(4),c.Hb("cl-active","MEMBERS"===t.activePill),c.wc("routerLink",c.Ac(11,yI)),c.Cb(3),c.Hb("cl-active","GROUPS"===t.activePill),c.wc("routerLink",c.Ac(12,yI)),c.Cb(2),c.wc("ngIf",t.isAdminOrOwner),c.Cb(4),c.wc("ngIf","MEMBERS"==t.activePill),c.Cb(1),c.wc("ngIf","GROUPS"==t.activePill),c.Cb(1),c.wc("ngIf","REMINDERS"==t.activePill&&t.isAdminOrOwner))},directives:[s.u,er.a,W.f,fS,GS,fI,Bk,TC,qu],encapsulation:2}),e})(),TI=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(){if(this.workspaceService.getLocalDefaultWorkspace().canSeeTracker)return!0;this.router.navigate(["timesheet"])}}return e.\u0275fac=function(t){return new(t||e)(c.fc(U.a),c.fc(W.c))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var DI=i("NTZZ"),RI=i("rnVd");class AI{constructor(e){var t,i;this._id=e&&e.id,this._name=e&&e.name,this._dateRangeStart=e&&e.dateRangeStart,this._dateRangeEnd=e&&e.dateRangeEnd,this._dateRangeType=RI.a[e&&e.dateRangeType],this._users=e&&e.users,this._userGroups=e&&e.userGroups,this._clients=e&&e.clients,this._projects=e&&e.projects,this._tasks=e&&e.tasks,this._tags=e&&e.tags,this._billable=e&&e.billable,this._description=e&&e.description,this._rounding=e&&e.rounding,this._amount=this.getAmount(e&&e.amountShown),this._customFields=e&&e.customFields,this._userAndGroupNames=this.getUserAndGroupNames(),this._clientNames=e&&e.clients.map(e=>e.name).join(", ")||"",this._projectNames=e&&e.projects.map(e=>e.name).join(", ")||"",this._taskNames=e&&e.tasks.map(e=>e.name).join(", ")||"",this._tagNames=e&&e.tags.map(e=>e.name).join(", ")||"",this._exportElements=e&&(null===(t=null==e?void 0:e.exportElements)||void 0===t?void 0:t.map(e=>jy.a[e]||tC.a[e]||Xy.a[e]).join(", "))||"",this._exportCustomFields=e&&(null===(i=null==e?void 0:e.exportCustomFields)||void 0===i?void 0:i.map(e=>e.name).join(", "))||""}getUserAndGroupNames(){const e=[];return this.userGroups&&this.userGroups.length&&e.push(this._userGroups.map(e=>e.name)),this.users&&this.users.length&&e.push(this._users.map(e=>e.name)),e.join(", ")}getAmount(e){switch(hy.a[e]){case hy.a.EARNED:return"Show amount";case hy.a.COST:return"Show cost";case hy.a.PROFIT:return"Show profit";case hy.a.HIDE_AMOUNT:return"Hide amount";default:return""}}get id(){return this._id}set id(e){this._id=e}get name(){return this._name}set name(e){this._name=e}get exportElements(){return this._exportElements}get formattedExportElements(){return this.exportElements.replace("RTL","Display text right-to-left").replace(/_/g," ").toLowerCase()+this.formattedCustomFieldsString}get formattedCustomFieldsString(){var e;return(null===(e=this.exportCustomFields)||void 0===e?void 0:e.length)>0?this.comma+this.exportCustomFields:""}get comma(){var e,t;return(null===(e=this.exportElements)||void 0===e?void 0:e.length)>0&&(null===(t=this.exportCustomFields)||void 0===t?void 0:t.length)>0?", ":""}set exportElements(e){this._exportElements=e}get exportCustomFields(){return this._exportCustomFields}get dateRangeStart(){return this._dateRangeStart}set dateRangeStart(e){this._dateRangeStart=e}get dateRangeEnd(){return this._dateRangeEnd}set dateRangeEnd(e){this._dateRangeEnd=e}get dateRangeType(){return this._dateRangeType}set dateRangeType(e){this._dateRangeType=e}get users(){return this._users}set users(e){this._users=e}get userGroups(){return this._userGroups}set userGroups(e){this._userGroups=e}get clients(){return this._clients}set clients(e){this._clients=e}get projects(){return this._projects}set projects(e){this._projects=e}get tasks(){return this._tasks}set tasks(e){this._tasks=e}get tags(){return this._tags}set tags(e){this._tags=e}get billable(){return this._billable}set billable(e){this._billable=e}get description(){return this._description}set description(e){this._description=e}get rounding(){return this._rounding}set rounding(e){this._rounding=e}get amount(){return this._amount}set amount(e){this._amount=e}get customFields(){return this._customFields}set customFields(e){this._customFields=e}get formattedRange(){return this._formattedRange}set formattedRange(e){this._formattedRange=e}get userAndGroupNames(){return this._userAndGroupNames}set userAndGroupNames(e){this._userAndGroupNames=e}get userNames(){return this._userNames}set userNames(e){this._userNames=e}get userGroupNames(){return this._userGroupNames}set userGroupNames(e){this._userGroupNames=e}get clientNames(){return this._clientNames}set clientNames(e){this._clientNames=e}get projectNames(){return this._projectNames}set projectNames(e){this._projectNames=e}get taskNames(){return this._taskNames}set taskNames(e){this._taskNames=e}get tagNames(){return this._tagNames}set tagNames(e){this._tagNames=e}}function jI(e,t){1&e&&c.Tb(0)}function xI(e,t){if(1&e&&(c.Xb(0,"div",7),c.Xb(1,"div",8),c.Xb(2,"a",9),c.Yc(3),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.wc("href",e.report.link,c.Qc),c.Cb(1),c.ad(" ",e.report.name," ")}}function PI(e,t){1&e&&(c.Xb(0,"div",12),c.Yc(1," Public "),c.Wb())}function MI(e,t){1&e&&(c.Xb(0,"div",12),c.Yc(1," Locked dates "),c.Wb())}function YI(e,t){1&e&&(c.Xb(0,"div",12),c.Yc(1," Scheduled "),c.Wb())}function LI(e,t){if(1&e&&(c.Xb(0,"div",10),c.Wc(1,PI,2,0,"div",11),c.Wc(2,MI,2,0,"div",11),c.Wc(3,YI,2,0,"div",11),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.report.isPublic),c.Cb(1),c.wc("ngIf",e.report.fixedDate),c.Cb(1),c.wc("ngIf",e.report.scheduledReport)}}function FI(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",13),c.Xb(1,"div",14),c.Sb(2,"input",15,16),c.Xb(4,"div",17),c.Xb(5,"button",18),c.jc("click",(function(){c.Oc(e);const t=c.Lc(3);return c.nc().copyInputUrl(t)})),c.Yc(6," Copy "),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.wc("ngModel",e.report.link)}}function NI(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",23),c.Xb(1,"div",24),c.Xb(2,"a",25),c.jc("click",(function(){return c.Oc(e),c.nc(2).openEditModal()})),c.Yc(3," Edit sharing settings "),c.Wb(),c.Xb(4,"a",25),c.jc("click",(function(){return c.Oc(e),c.nc(2).filterInfo()})),c.Yc(5," Filter info "),c.Wb(),c.Xb(6,"a",25),c.jc("click",(function(){return c.Oc(e),c.nc(2).deleteReport()})),c.Yc(7," Delete "),c.Wb(),c.Wb(),c.Wb()}}function UI(e,t){1&e&&(c.Xb(0,"div",19),c.Xb(1,"div",20),c.Sb(2,"img",21),c.Wb(),c.Wc(3,NI,8,0,"div",22),c.Wb())}const $I=function(e){return{labels:e}},_I=function(e,t,i,n){return[e,t,i,n]};let GI=(()=>{class e{constructor(e,t){this.toaster=e,this.cd=t,this.navigate=new c.n,this.edit=new c.n,this.reportFilterInfo=new c.n,this.delete=new c.n}ngAfterViewInit(){this.cd.detectChanges()}copyInputUrl(e){e.select(),document.execCommand("copy"),this.toaster.pop("success","Copied",e.value)}openEditModal(){this.edit.emit(this.report)}filterInfo(){this.reportFilterInfo.emit(this.report)}deleteReport(){this.delete.emit(this.report)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(M.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["shared-reports-row"],["","shared-reports-row",""]],inputs:{labels:"labels",isDesktop:"isDesktop",report:"report"},outputs:{navigate:"navigate",edit:"edit",reportFilterInfo:"reportFilterInfo",delete:"delete"},decls:11,vars:11,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-d-none",3,"isDesktop","templates"],["responsive",""],["col1",""],["col2",""],["col3",""],["col4",""],[1,"cl-d-inline-flex","cl-cut-text-wrapper","cl-w-100"],[1,"cl-cut-text"],["target","_blank",1,"cl-text-gray-6",3,"href"],[1,"cl-component-divided-left"],["class","cl-badge cl-badge-tag cl-no-hover cl-mr-2",4,"ngIf"],[1,"cl-badge","cl-badge-tag","cl-no-hover","cl-mr-2"],[1,"cl-component-divided-left","cl-w-100"],[1,"cl-input-group","cl-input-group-sm"],["type","text","readonly","",1,"cl-form-control","tr-reset-min-h",3,"ngModel"],["linkInput",""],[1,"cl-input-group-append"],["type","button",1,"cl-btn","cl-btn-outline-light",3,"click"],["dropdown","",1,"cl-dropdown","cl-d-flex","cl-justify-content-end"],["closeDropdown","",1,"cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow","cl-hover-pointer"],["src","assets/images/ui-icons/menu-dots-vertical.svg","closeDropdown",""],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownContent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area"],["closeDropdown","",1,"cl-dropdown-item",3,"click"]],template:function(e,t){if(1&e&&(c.Wc(0,jI,1,0,"ng-container",0),c.Sb(1,"responsive-row",1,2),c.Wc(3,xI,4,2,"ng-template",null,3,c.Xc),c.Wc(5,LI,4,3,"ng-template",null,4,c.Xc),c.Wc(7,FI,7,1,"ng-template",null,5,c.Xc),c.Wc(9,UI,4,0,"ng-template",null,6,c.Xc)),2&e){const e=c.Lc(2),i=c.Lc(4),n=c.Lc(6),s=c.Lc(8),r=c.Lc(10);c.wc("ngTemplateOutlet",e.template)("ngTemplateOutletContext",c.Bc(4,$I,t.labels)),c.Cb(1),c.wc("isDesktop",t.isDesktop)("templates",c.Ec(6,_I,i,n,s,r))}},directives:[s.B,Fi.a,s.u,p.c,p.s,p.v,Es.a,Ts.a],encapsulation:2,changeDetection:0}),e})();var BI=i("G7Sd");function VI(e,t){if(1&e&&(c.Xb(0,"div",6),c.Xb(1,"label",7),c.Yc(2,"Team"),c.Wb(),c.Xb(3,"div",8),c.Xb(4,"div",14),c.Yc(5),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(5),c.ad(" ",e.reportFilterInfo.userAndGroupNames," ")}}function HI(e,t){if(1&e&&(c.Xb(0,"div",6),c.Xb(1,"label",7),c.Yc(2,"Clients"),c.Wb(),c.Xb(3,"div",8),c.Xb(4,"div",14),c.Yc(5),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(5),c.ad(" ",e.reportFilterInfo.clientNames," ")}}function zI(e,t){if(1&e&&(c.Xb(0,"div",6),c.Xb(1,"label",7),c.Yc(2,"Project"),c.Wb(),c.Xb(3,"div",8),c.Xb(4,"div",14),c.Yc(5),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(5),c.ad(" ",e.reportFilterInfo.projectNames," ")}}function qI(e,t){if(1&e&&(c.Xb(0,"div",6),c.Xb(1,"label",7),c.Yc(2,"Task"),c.Wb(),c.Xb(3,"div",8),c.Xb(4,"span",14),c.Yc(5),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(5),c.ad(" ",e.reportFilterInfo.taskNames," ")}}function KI(e,t){if(1&e&&(c.Xb(0,"div",6),c.Xb(1,"label",7),c.Yc(2,"Tag"),c.Wb(),c.Xb(3,"div",8),c.Xb(4,"div",14),c.Yc(5),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(5),c.ad(" ",e.reportFilterInfo.tagNames," ")}}function ZI(e,t){if(1&e&&(c.Xb(0,"div",6),c.Xb(1,"label",7),c.Yc(2,"Billing"),c.Wb(),c.Xb(3,"div",8),c.Yc(4,"E "),c.Xb(5,"div",14),c.Yc(6),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(6),c.ad(" ",e.reportFilterInfo.billable?"Billable":"Non billable"," ")}}function QI(e,t){if(1&e&&(c.Xb(0,"div",6),c.Xb(1,"label",7),c.Yc(2,"Description"),c.Wb(),c.Xb(3,"div",8),c.Xb(4,"div",14),c.Yc(5),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(5),c.ad(" ",e.reportFilterInfo.description," ")}}function JI(e,t){if(1&e&&(c.Xb(0,"div",6),c.Xb(1,"label",7),c.Yc(2,"Custom fields"),c.Wb(),c.Xb(3,"div",8),c.Xb(4,"div",14),c.Yc(5),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(5),c.ad(" ",e.reportFilterInfo.customFields.toString()," ")}}function eO(e,t){if(1&e&&(c.Xb(0,"div",6),c.Xb(1,"label",7),c.Yc(2,"Rounding"),c.Wb(),c.Xb(3,"div",8),c.Xb(4,"div",9),c.Yc(5),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(5),c.ad(" ",e.reportFilterInfo.rounding," ")}}function tO(e,t){if(1&e&&(c.Xb(0,"div",6),c.Xb(1,"label",7),c.Yc(2,"Export"),c.Wb(),c.Xb(3,"div",8),c.Xb(4,"div",15),c.Yc(5),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(5),c.ad(" ",e.reportFilterInfo.formattedExportElements," ")}}let iO=(()=>{class e{constructor(){this.onClose=new c.n}closeModal(){this.onClose.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["filter-info"]],inputs:{reportFilterInfo:"reportFilterInfo",showExport:"showExport"},outputs:{onClose:"onClose"},decls:34,vars:12,consts:[[1,"cl-modal-content"],[1,"cl-modal-header"],["id","exampleModalLabel",1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-row","cl-align-items-center"],[1,"cl-col-sm-2","cl-col-form-label","cl-mb-0"],[1,"cl-col-sm-10"],[1,"cl-text-gray-9"],["class","cl-form-group cl-row cl-align-items-center",4,"ngIf"],["ngbAutofocus","",1,"cl-empty-element"],[1,"cl-modal-footer"],[3,"click"],[1,"cl-badge-tag","cl-d-inline-flex","cl-py-1","cl-px-2"],[1,"cl-text-gray-9","cl-text-capitalize"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"h1",2),c.Yc(3,"Filter info"),c.Wb(),c.Xb(4,"button",3),c.jc("click",(function(){return t.closeModal()})),c.Xb(5,"span"),c.Sb(6,"img",4),c.Wb(),c.Wb(),c.Wb(),c.Xb(7,"div",5),c.Xb(8,"div",6),c.Xb(9,"label",7),c.Yc(10,"Date"),c.Wb(),c.Xb(11,"div",8),c.Xb(12,"div",9),c.Yc(13),c.Wb(),c.Wb(),c.Wb(),c.Wc(14,VI,6,1,"div",10),c.Wc(15,HI,6,1,"div",10),c.Wc(16,zI,6,1,"div",10),c.Wc(17,qI,6,1,"div",10),c.Wc(18,KI,6,1,"div",10),c.Wc(19,ZI,7,1,"div",10),c.Wc(20,QI,6,1,"div",10),c.Wc(21,JI,6,1,"div",10),c.Wc(22,eO,6,1,"div",10),c.Xb(23,"div",6),c.Xb(24,"label",7),c.Yc(25,"Amount"),c.Wb(),c.Xb(26,"div",8),c.Xb(27,"div",9),c.Yc(28),c.Wb(),c.Wb(),c.Wb(),c.Wc(29,tO,6,1,"div",10),c.Wb(),c.Sb(30,"button",11),c.Xb(31,"div",12),c.Xb(32,"a",13),c.jc("click",(function(){return t.closeModal()})),c.Yc(33,"Close"),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(13),c.Zc(t.reportFilterInfo.formattedRange),c.Cb(1),c.wc("ngIf",t.reportFilterInfo.userAndGroupNames),c.Cb(1),c.wc("ngIf",t.reportFilterInfo.clientNames),c.Cb(1),c.wc("ngIf",t.reportFilterInfo.projectNames),c.Cb(1),c.wc("ngIf",t.reportFilterInfo.taskNames),c.Cb(1),c.wc("ngIf",t.reportFilterInfo.tagNames),c.Cb(1),c.wc("ngIf",null!=t.reportFilterInfo.billable),c.Cb(1),c.wc("ngIf",t.reportFilterInfo.description),c.Cb(1),c.wc("ngIf",t.reportFilterInfo.customFields&&t.reportFilterInfo.customFields.length),c.Cb(1),c.wc("ngIf",t.reportFilterInfo.rounding),c.Cb(6),c.ad(" ",t.reportFilterInfo.amount," "),c.Cb(1),c.wc("ngIf",t.showExport&&(null==t.reportFilterInfo.formattedExportElements?null:t.reportFilterInfo.formattedExportElements.length)>0))},directives:[s.u],encapsulation:2}),e})();function nO(e,t){1&e&&(c.Xb(0,"div",12),c.Xb(1,"div",13),c.Xb(2,"span",14),c.Yc(3,"My reports"),c.Wb(),c.Wb(),c.Wb())}function sO(e,t){1&e&&(c.Xb(0,"thead"),c.Xb(1,"tr"),c.Xb(2,"th",19),c.Yc(3,"Name"),c.Wb(),c.Xb(4,"th"),c.Xb(5,"span",20),c.Yc(6,"Label"),c.Wb(),c.Wb(),c.Xb(7,"th"),c.Xb(8,"span",20),c.Yc(9,"URL"),c.Wb(),c.Wb(),c.Xb(10,"th",21),c.Xb(11,"div",22),c.Yc(12,"Edit"),c.Wb(),c.Wb(),c.Wb(),c.Wb())}function cO(e,t){if(1&e){const e=c.Yb();c.Xb(0,"tr",23),c.jc("edit",(function(t){c.Oc(e);const i=c.nc(2),n=c.Lc(12);return i.openEditModal(t,n)}))("reportFilterInfo",(function(t){c.Oc(e);const i=c.nc(2),n=c.Lc(14);return i.filterInfo(t,n)}))("delete",(function(t){c.Oc(e);const i=c.nc(2),n=c.Lc(10);return i.deleteReport(t,n)})),c.Wb()}if(2&e){const e=t.$implicit,i=c.nc(2);c.wc("labels",i.labels)("isDesktop",i.isDesktop)("report",e)}}function rO(e,t){if(1&e&&(c.Xb(0,"div",15),c.Xb(1,"table",16),c.Wc(2,sO,13,0,"thead",17),c.Xb(3,"tbody"),c.Wc(4,cO,1,3,"tr",18),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.wc("ngIf",e.isDesktop),c.Cb(2),c.wc("ngForOf",e.reports)}}function oO(e,t){if(1&e){const e=c.Yb();c.Xb(0,"pager",24),c.jc("pageChanged",(function(t){return c.Oc(e),c.nc().setPaginationUrl(t)}))("limitChanged",(function(t){return c.Oc(e),c.nc().setPaginationUrl(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("page",e.page)("limit",e.limit)("total",e.reportsCount)}}function aO(e,t){1&e&&(c.Xb(0,"empty-shared-report",25),c.Xb(1,"h4"),c.Yc(2,"Apply filters to a report and click Share to get a link to the filtered report,"),c.Sb(3,"br"),c.Yc(4,"which you can send to others."),c.Wb(),c.Wb()),2&e&&c.wc("imagePath","assets/images/illustrations/shared_location.svg")("title","Links to your shared reports will appear here")("hideHeader",!0)}function lO(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",26),c.jc("confirmed",(function(i){c.Oc(e);const n=t.$implicit,s=c.nc();return n.close(i),s.confirmDelete()}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Xb(1,"p",27),c.Yc(2," You are about to delete "),c.Xb(3,"b"),c.Yc(4),c.Wb(),c.Yc(5," report. Once it's deleted, the link to it will stop working. "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Delete shared report")("inProgress",!1)("isDanger",!0)("btnText","Delete"),c.Cb(4),c.Zc(e.selectedReport.name)}}function bO(e,t){if(1&e){const e=c.Yb();c.Xb(0,"modal-header",28),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"share-report",29),c.jc("onShare",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().updateReport(i,n)}))("onClose",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Edit sharing report"),c.Cb(1),c.wc("reportName",e.selectedReport.name)("isSaved",!0)("isPublic",e.selectedReport.isPublic)("fixedDate",e.selectedReport.fixedDate)("dateRangeType",e.selectedReport.filters.dateRangeType)("visibleToUserGroup",e.selectedReport.visibleToUserGroups&&e.selectedReport.visibleToUserGroups.length>0?e.selectedReport.visibleToUserGroups[0].id:"")("scheduledReport",e.selectedReport.scheduledReport)("confirmButtonCopy","Update")("isAdminOrOwner",e.isAdminOrOwner)("inProgress",!1)}}function uO(e,t){if(1&e&&(c.Xb(0,"filter-info",30),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb()),2&e){const e=c.nc();c.wc("reportFilterInfo",e.reportFilterInfo)("showExport",e.showExport)}}let dO=(()=>{class e{constructor(e,t,i,n,s,c,r,o,a,l){this.reportService=e,this.authService=t,this.modalService=i,this.toaster=n,this.router=s,this.activatedRoute=c,this.browserService=r,this.cd=o,this.workspaceService=a,this.switchReportService=l,this.page=1,this.limit=ei.j,this.AmountOptions=hy.a,this.labels=["Name","Label","Url","Edit"],this.isMultiplePages=!1,this.unsubscribe$=new Ee.a}ngOnInit(){this.user=this.authService.getUser(),this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.showExport=this.workspace.hasFeature(nr.a.CUSTOM_REPORTING),this.getRouteParams(),this.setBrowserWidth()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setBrowserWidth(){this.browserService.isBreakpointLg$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e})}getReports(){this.reportService.getSharedReports(this.page,this.limit).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.reports=e.reports,this.reportsCount=e.count,this.isMultiplePages=this.reportsCount>ei.j||this.reportsCount>this.limit,this.cd.detectChanges()},()=>{this.reports=[]})}deleteReport(e,t){this.selectedReport=e,this.modalService.open(t,{centered:!0})}confirmDelete(){this.reportService.deleteReport(this.selectedReport.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.reports.splice(this.reports.indexOf(this.selectedReport),1),this.cd.detectChanges()})}openEditModal(e,t){this.selectedReport=e,this.modalService.open(t,{centered:!0})}updateReport(e,t){this.reportService.updateSavedReport(this.selectedReport.id,{name:e.name,isPublic:e.isPublic,fixedDate:e.fixedDate,visibleToUsers:[],visibleToUserGroups:e.visibleToUserGroup?[e.visibleToUserGroup]:[]}).pipe(Object(De.a)(this.unsubscribe$)).subscribe(i=>{this.reports[this.reports.indexOf(this.selectedReport)]=new DI.a(i),this.updateScheduled(e),t.close(),this.cd.detectChanges()})}filterInfo(e,t){this.selectedReport=e,this.reportService.getFilterInfo(e.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.reportFilterInfo=new AI(e),this.reportFilterInfo.formattedRange=this.setFormattedRange(this.reportFilterInfo.dateRangeStart,this.reportFilterInfo.dateRangeEnd,this.reportFilterInfo.dateRangeType,this.user.settings.dateFormat),this.modalService.open(t,{centered:!0})})}setFormattedRange(e,t,i,n){return i&&i!=RI.a.ABSOLUTE?i.label:Object(Se.utc)(e).format(n).concat(" - ").concat(Object(Se.utc)(t).format(n))}setPaginationUrl(e){this.pager.setPaginationManually(e),this.page=this.pager.page,this.limit=this.pager.limit,this.addParamsToRoute(),this.getReports()}addParamsToRoute(){this.router.navigate([],{queryParams:{page:this.page,limit:this.limit}})}getRouteParams(){this.activatedRoute.queryParams.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.page=Number(e.page)||1,this.limit=Number(e.limit)||ei.j,this.getReports()})}updateScheduled(e){if(!e.scheduledReport&&!this.selectedReport.scheduledReport)return;if(!e.scheduledReport)return void this.reportService.deleteScheduledReport(this.selectedReport.id);const t={scheduledReport:{type:e.scheduledReport.type,recipients:e.scheduledReport.recipients},visibleToUserGroups:e.visibleToUserGroup?[e.visibleToUserGroup]:[]},i=this.reports.filter(e=>e.id===this.selectedReport.id)[0];this.reportService.updateScheduledReport(this.selectedReport.id,t).subscribe(e=>{this.reports[this.reports.indexOf(i)]=new DI.a(e),this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(ly.a),c.Rb(Ce.a),c.Rb(g.q),c.Rb(M.a),c.Rb(W.c),c.Rb(W.a),c.Rb(pi.a),c.Rb(c.h),c.Rb(U.a),c.Rb(Ey.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["shared-reports"]],viewQuery:function(e,t){var i;1&e&&c.ed(cn.a,!0),2&e&&c.Kc(i=c.kc())&&(t.pager=i.first)},decls:15,vars:5,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-btn-group",3,"page"],["class","cl-card cl-border-bottom-0 cl-mb-0",4,"ngIf"],["class","cl-page-component-wrapper",4,"ngIf"],[1,"cl-mt-3"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],[3,"imagePath","title","hideHeader",4,"ngIf"],["deleteModal",""],["editModal",""],["filterInfoModal",""],[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-page-component-wrapper"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-shared-report-table"],[4,"ngIf"],["shared-reports-row","","class","cl-hover-shadow",3,"labels","isDesktop","report","edit","reportFilterInfo","delete",4,"ngFor","ngForOf"],[1,"cl-h5","cl-mb-0","cl-pl-lg-3","cl-w-50"],[1,"cl-h5","cl-ml-lg-custom-n2"],[2,"width","46px"],[1,"cl-h5","cl-mb-0","cl-text-lg-custom-right","cl-d-block","cl-d-lg-custom-none"],["shared-reports-row","",1,"cl-hover-shadow",3,"labels","isDesktop","report","edit","reportFilterInfo","delete"],[3,"page","limit","total","pageChanged","limitChanged"],[3,"imagePath","title","hideHeader"],[3,"title","inProgress","isDanger","btnText","confirmed","close"],[1,"cl-text-muted","cl-cut-text-wrap"],[3,"title","onClose"],[3,"reportName","isSaved","isPublic","fixedDate","dateRangeType","visibleToUserGroup","scheduledReport","confirmButtonCopy","isAdminOrOwner","inProgress","onShare","onClose"],[3,"reportFilterInfo","showExport","onClose"]],template:function(e,t){1&e&&(c.Xb(0,"main",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Sb(3,"switch-reports",3),c.Wb(),c.Wc(4,nO,4,0,"div",4),c.Wc(5,rO,5,2,"div",5),c.Xb(6,"div",6),c.Wc(7,oO,1,3,"pager",7),c.Wb(),c.Wc(8,aO,5,3,"empty-shared-report",8),c.Wb(),c.Wb(),c.Wc(9,lO,6,5,"ng-template",null,9,c.Xc),c.Wc(11,bO,2,11,"ng-template",null,10,c.Xc),c.Wc(13,uO,1,2,"ng-template",null,11,c.Xc)),2&e&&(c.Cb(3),c.wc("page","SHARED"),c.Cb(1),c.wc("ngIf",t.reports&&t.reports.length>0),c.Cb(1),c.wc("ngIf",t.reports&&t.reports.length>0),c.Cb(2),c.wc("ngIf",t.isMultiplePages),c.Cb(1),c.wc("ngIf",t.reports&&0==t.reports.length))},directives:[xy,s.u,s.t,GI,cn.a,BI.a,Ui.a,wl.a,aW.a,iO],encapsulation:2}),e})();var pO=i("uHlu"),hO=i("6Dzi"),mO=i("1+qu");function gO(e,t){if(1&e){const e=c.Yb();c.Xb(0,"reports-filter",22),c.jc("onApply",(function(t){return c.Oc(e),c.nc(2).applyFilter(t)}))("emitClearFilters",(function(){return c.Oc(e),c.nc(2).defaultFilter()})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("hideMembers",e.hideMembers)("hideUserGroupMembers",e.hideUserGroupMembers)("description",e.description)("valuesData",e.filterValuesData)("description",e.description)("withoutDescription",e.withoutDescription)("customFieldFilters",e.customFieldFilters)}}function fO(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"div",23),c.Sb(2,"tr",25),c.Wb(),c.Ub()),2&e){const e=t.$implicit,i=c.nc(4);c.Cb(2),c.wc("group",e)("labels",i.labels)("format",i.format)("currency",null==i.workspace?null:i.workspace.hourlyRate.currency)("showCurrency",i.amountOption!==i.AmountOptions.HIDE_AMOUNT)("isProject",!i.isGroupByProject)("showTime",i.showTime)("isExpandedMobileView",i.isExpandedMobileView)("isDesktop",i.isDesktop)}}function vO(e,t){if(1&e&&(c.Vb(0),c.Wc(1,fO,3,9,"ng-container",19),c.Ub()),2&e){const e=c.nc().$implicit;c.Cb(1),c.wc("ngForOf",e.children)}}function wO(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"div",23),c.Sb(2,"tr",24),c.Wb(),c.Wc(3,vO,2,1,"ng-container",21),c.Ub()),2&e){const e=t.$implicit,i=c.nc(2);c.Cb(2),c.wc("group",e)("level",1)("labels",i.labels)("format",i.format)("isProject",i.isGroupByProject)("showTime",i.showTime)("currency",null==i.workspace?null:i.workspace.hourlyRate.currency)("showCurrency",i.amountOption!==i.AmountOptions.HIDE_AMOUNT)("isDesktop",i.isDesktop)("isExpandedMobileView",i.isExpandedMobileView)("isExpanded",i.isExpanded),c.Cb(1),c.wc("ngIf",e.isExpanded)}}function yO(e,t){if(1&e&&c.Sb(0,"tr",26),2&e){const e=c.nc(2);c.wc("group",e.totalsByDay)("labels",e.labels)("currency",null==e.workspace?null:e.workspace.hourlyRate.currency)("showCurrency",e.amountOption!==e.AmountOptions.HIDE_AMOUNT)("format",e.format)("isProject",!1)("showTime",e.showTime)("isExpandedMobileView",e.isExpandedMobileView)("isDesktop",e.isDesktop)}}function WO(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",28),c.Xb(1,"span"),c.Xb(2,"button",29),c.jc("click",(function(){return c.Oc(e),c.nc(3).loadUsers()})),c.Yc(3," Show users without time "),c.Wb(),c.Wb(),c.Wb()}}function CO(e,t){if(1&e&&(c.Vb(0),c.Wc(1,WO,4,0,"div",27),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngIf",!e.allActiveUsers)}}function kO(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",5),c.Xb(1,"div",6),c.Xb(2,"div",7),c.Xb(3,"div",8),c.Sb(4,"switch-reports",9),c.Wb(),c.Xb(5,"div",10),c.Xb(6,"div",11),c.Xb(7,"div",12),c.Xb(8,"datepicker-range",13),c.jc("dateRangeOut",(function(t){return c.Oc(e),c.nc().updateDateRange(t)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(9,gO,1,7,"reports-filter",14),c.Xb(10,"table-info",15),c.jc("shareReports",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(3);return t.openModal(i)}))("customizeReport",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(5);return t.openModal(i)}))("exportAsPdf",(function(){return c.Oc(e),c.nc().exportAsPdf()}))("exportAsCsv",(function(){return c.Oc(e),c.nc().exportAsCsv()}))("exportAsExcel",(function(){return c.Oc(e),c.nc().exportAsExcel()}))("onRoundingChange",(function(t){return c.Oc(e),c.nc().onRoundingChange(t)}))("onWeeklyGroupChange",(function(t){return c.Oc(e),c.nc().onWeeklyGroupChange(t)}))("onAmountOptionChange",(function(t){return c.Oc(e),c.nc().amountOptionChanged(t)})),c.Wb(),c.Xb(11,"div",16),c.Xb(12,"table",17),c.Xb(13,"thead"),c.Xb(14,"tr",18),c.jc("onExpandMobileView",(function(t){return c.Oc(e),c.nc().isExpandedMobileView=t}))("onExpand",(function(t){return c.Oc(e),c.nc().isExpanded=t})),c.Wb(),c.Wb(),c.Xb(15,"tbody"),c.Wc(16,wO,4,12,"ng-container",19),c.Wc(17,yO,1,9,"tr",20),c.Wb(),c.Wb(),c.Wc(18,CO,2,1,"ng-container",21),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(4),c.wc("page","WEEKLY"),c.Cb(4),c.wc("isWeekly",!0)("timeEntriesDateRange",e.dateRange),c.Cb(1),c.wc("ngIf",e.filterValuesData),c.Cb(1),c.wc("amountOption",e.amountOption)("totalNumberOfEntries",e.entriesCount)("isWeekly",!0)("weeklyGroup",e.weeklyGroup)("isCostRateActive",e.workspace.isCostRateActive)("isRounding",e.isRounding)("totalInfo",e.totalInfo)("isAdminOrOwner",e.isAdminOrOwner)("canSeeRates",e.canSeeRates),c.Cb(4),c.wc("labels",e.labels)("mainLabel",e.isGroupByProject?"Project":"User")("isDesktop",e.isDesktop)("isExpanded",e.isExpanded)("isExpandedMobileView",e.isExpandedMobileView),c.Cb(2),c.wc("ngForOf",e.groups),c.Cb(1),c.wc("ngIf",e.totalsByDay),c.Cb(1),c.wc("ngIf",e.isUsersWithoutTimeEnabled)}}function SO(e,t){if(1&e){const e=c.Yb();c.Xb(0,"modal-header",30),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"share-report",31),c.jc("onShare",(function(i){c.Oc(e);const n=t.$implicit,s=c.nc(),r=c.Lc(7);return s.shareReport(i,n,r)}))("onClose",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Share report"),c.Cb(1),c.wc("inProgress",e.shareInProgress)("dateRangeLabel",e.getDateRangeValue())("dateRangeType",e.dateRangeType)("isAdminOrOwner",e.isAdminOrOwner)}}function IO(e,t){if(1&e){const e=c.Yb();c.Xb(0,"modal-header",30),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"customize-report",32),c.jc("onOpen",(function(){return c.Oc(e),c.nc().getCustomizationSettings()}))("onSave",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().saveExportSettings(i,n)}))("onClose",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Weekly export settings"),c.Cb(1),c.wc("inProgress",e.customizationInProgress)("reportType",e.TYPE)("canSeeRates",e.canSeeRates)("isAdminOrOwner",e.isAdminOrOwner)("currentSettings",e.currentSettings)("reportName",e.reportName)("customFields",e.customFields)("checkedCustomFields",e.currentCustomFieldSettings)("isCostRateActive",e.workspace.isCostRateActive)("options",e.exportOptions)}}function OO(e,t){if(1&e&&(c.Xb(0,"modal-header",30),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"div",33),c.Xb(2,"text-copy",34),c.jc("onClose",(function(){return t.$implicit.close()})),c.Xb(3,"small",35),c.Sb(4,"img",36),c.Yc(5," You can see and update this link from your Shared reports page. "),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",37),c.Xb(7,"a",38),c.jc("keyup.space",(function(){return t.$implicit.close()}))("keyup.enter",(function(){return t.$implicit.close()}))("click",(function(){return t.$implicit.close()})),c.Yc(8,"Close"),c.Wb(),c.Wb()),2&e){const e=c.nc();c.wc("title","Link created"),c.Cb(2),c.wc("text",e.sharedLink),c.Cb(2),c.wc("ngbTooltip","Share link")}}let XO=(()=>{class e extends Ty{constructor(e,t,i,n,s,c,r,o,a,l,b,u,d,p,h,m,g,f){super(e,t,i,n,s,c,r,o,a,l,b,u,d,p,m,g,f),this.bulkEditDataService=h,this.isExpanded=!1,this.TYPE=py.a.WEEKLY,this.exportOptions={allOptions:[new Ay(Xy.a.SUBGROUP,"Show subgroup")],csvXlsxOptions:[],pdfOptions:[]}}ngOnInit(){super.ngOnInit(),this.setExportOptions()}setExportOptions(){this.canSeeRates&&this.exportOptions.allOptions.unshift(new Ay(Xy.a.TOTAL,"Always show total amount"))}get isUsersWithoutTimeEnabled(){return!!this.isAdminOrOwner&&!this.isGroupByProject&&!this.isTeamFilterApplied}afterWorkspaceSet(){this.weeklyGroup=this.uiSettingsService.getWeeklyGroup(this.workspace.id)}getReports(){var e,t;this.loader.show("Loading...");const i=this.createReportQuery();this.isTeamFilterApplied=(null===(e=this.filterValuesData[dn.h.USERS_AND_GROUP])||void 0===e?void 0:e.isDirty())&&!(null===(t=this.filterValuesData[dn.h.USERS_AND_GROUP])||void 0===t?void 0:t.isSelectedAll()),this.amountOptionBackup=this.amountOption,this.reportService.getWeeklyReportsData(i).pipe(Object(De.a)(this.unsubscribe$)).subscribe(({totals:e,groups:t,totalsByDay:i})=>{i.name="Total:",this.totalsByDay=i,this.labels=Object(yi.d)(t,this.dateRange),this.groups=t,this.isGroupByProject="PROJECT"===this.weeklyGroup,this.showTime=this.amountOption===hy.a.HIDE_AMOUNT,this.totalInfo=e,this.entriesCount=e.entriesCount,this.addUsersWithoutTimeToGroup(),this.cd.detectChanges(),this.loader.hide()},()=>this.loader.hide())}loadUsers(){this.workspaceService.getUsers({limit:1e3,statuses:["ACTIVE"]}).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.allActiveUsers=e.users||[],this.addUsersWithoutTimeToGroup(),this.cd.detectChanges()})}addUsersWithoutTimeToGroup(){var e;if(!this.isUsersWithoutTimeEnabled)return;if(!(null===(e=this.allActiveUsers)||void 0===e?void 0:e.length))return;const t=Object(ws.a)(Wc.a.WEEK,this.dateRange),i=this.groups.map(e=>e.id);this.allActiveUsers.forEach(e=>{if(i.includes(e.id))return;const n={id:e.id,name:e.name,days:t.map(e=>({date:e}))},s=new pO.a(n);this.groups.push(s)})}onWeeklyGroupChange(e){this.weeklyGroup=e,this.uiSettingsService.setWeeklyGroup(e,this.workspace.id),this.navigate()}amountOptionChanged(e){this.amountOption=e,this.uiSettingsService.setWeeklyAmountOption(e,this.workspace.id),e===hy.a.HIDE_AMOUNT||e===this.amountOptionBackup?this.showTime=this.amountOption===hy.a.HIDE_AMOUNT:this.navigate()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(Ce.a),c.Rb(c.h),c.Rb(hi.a),c.Rb(W.c),c.Rb(by.a),c.Rb(W.a),c.Rb(ly.a),c.Rb(pi.a),c.Rb(wi.a),c.Rb($d.a),c.Rb(g.q),c.Rb(Lt.a),c.Rb(uy.a),c.Rb(Ry.a),c.Rb(qd.a),c.Rb(Ey.a),c.Rb(vs.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["weekly-reports"]],features:[c.zb],decls:8,vars:1,consts:[[1,"cl-page-wrapper"],["class","cl-container-fluid",4,"ngIf"],["shareModal",""],["customizeModal",""],["linkCreatedModal",""],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center","cl-justify-content-between"],[1,"cl-col-auto","cl-mb-3","cl-mb-md-0","cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-md-start"],[1,"cl-btn-group",3,"page"],[1,"cl-col-auto"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-sm-end"],[1,"cl-page-header-action","cl-w-100","cl-w-md-auto"],[3,"isWeekly","timeEntriesDateRange","dateRangeOut"],[3,"hideMembers","hideUserGroupMembers","description","valuesData","withoutDescription","customFieldFilters","onApply","emitClearFilters",4,"ngIf"],[1,"cl-card","cl-border-bottom-0","cl-mb-0",3,"amountOption","totalNumberOfEntries","isWeekly","weeklyGroup","isCostRateActive","isRounding","totalInfo","isAdminOrOwner","canSeeRates","shareReports","customizeReport","exportAsPdf","exportAsCsv","exportAsExcel","onRoundingChange","onWeeklyGroupChange","onAmountOptionChange"],[1,"cl-page-component-wrapper"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6","cl-table-weekly-report"],["weekly-group-header","",3,"labels","mainLabel","isDesktop","isExpanded","isExpandedMobileView","onExpandMobileView","onExpand"],[4,"ngFor","ngForOf"],["weekly-group","","class","cl-bg-light cl-table-footer",3,"group","labels","currency","showCurrency","format","isProject","showTime","isExpandedMobileView","isDesktop",4,"ngIf"],[4,"ngIf"],[3,"hideMembers","hideUserGroupMembers","description","valuesData","withoutDescription","customFieldFilters","onApply","emitClearFilters"],[1,"cl-row-hover-shadow"],["weekly-group","",3,"group","level","labels","format","isProject","showTime","currency","showCurrency","isDesktop","isExpandedMobileView","isExpanded"],["weekly-group","",1,"cl-component-row-colored",3,"group","labels","format","currency","showCurrency","isProject","showTime","isExpandedMobileView","isDesktop"],["weekly-group","",1,"cl-bg-light","cl-table-footer",3,"group","labels","currency","showCurrency","format","isProject","showTime","isExpandedMobileView","isDesktop"],["class","cl-or-divider cl-mt-3",4,"ngIf"],[1,"cl-or-divider","cl-mt-3"],[1,"cl-btn","cl-btn-sm","cl-btn-outline-light","cl-w-max-content",3,"click"],[3,"title","onClose"],[3,"inProgress","dateRangeLabel","dateRangeType","isAdminOrOwner","onShare","onClose"],[3,"inProgress","reportType","canSeeRates","isAdminOrOwner","currentSettings","reportName","customFields","checkedCustomFields","isCostRateActive","options","onOpen","onSave","onClose"],[1,"cl-modal-body"],[3,"text","onClose"],[1,"form-text","text-gray-9"],["src","assets/images/ui-icons/info-9.svg","placement","top",1,"cl-mr-2",3,"ngbTooltip"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"keyup.space","keyup.enter","click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Wc(1,kO,19,21,"div",1),c.Wb(),c.Wc(2,SO,2,5,"ng-template",null,2,c.Xc),c.Wc(4,IO,2,11,"ng-template",null,3,c.Xc),c.Wc(6,OO,9,3,"ng-template",null,4,c.Xc)),2&e&&(c.Cb(1),c.wc("ngIf",t.workspace))},directives:[s.u,xy,jn.a,Py.a,hO.a,s.t,My.b,mO.a,wl.a,aW.a,TW,DW.a,g.Z],encapsulation:2,changeDetection:0}),e})();var EO=i("uudg"),TO=i("24jK"),DO=i("TuVw"),RO=i("wN+/");class AO{constructor(e){this._copy=e&&e.copy||"",this._uri=e&&e.uri||""}get copy(){return this._copy}set copy(e){this._copy=e}get uri(){return this._uri}set uri(e){this._uri=e}}const jO=["approvalListModal"];function xO(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",8),c.jc("click",(function(){return c.Oc(e),c.nc().markAsReadAll()})),c.Yc(1," Clear all "),c.Wb()}}function PO(e,t){1&e&&(c.Xb(0,"span",9),c.Yc(1," No new notifications "),c.Wb())}function MO(e,t){if(1&e&&(c.Xb(0,"p",13),c.Xb(1,"strong"),c.Yc(2),c.Wb(),c.Yc(3," has invited you to track time on "),c.Xb(4,"strong"),c.Yc(5),c.Wb(),c.Yc(6," workspace. "),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(2),c.Zc(e.data.invitedBy),c.Cb(3),c.Zc(e.data.workspaceName)}}function YO(e,t){if(1&e&&(c.Xb(0,"p",13),c.Yc(1," You are invited to join "),c.Xb(2,"strong"),c.Yc(3),c.Wb(),c.Yc(4),c.Xb(5,"strong"),c.Yc(6," full access "),c.Wb(),c.Yc(7," to your account. "),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(3),c.Zc(e.data.workspaceName),c.Cb(1),c.ad(" workspace. Once you accept, ",e.data.workspaceName," administrator will have ")}}function LO(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",9),c.Xb(1,"div",10),c.Yc(2," Workspace invite "),c.Wb(),c.Wc(3,MO,7,2,"p",11),c.Wc(4,YO,8,2,"p",11),c.Xb(5,"button",12),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc().accept(i)})),c.Yc(6,"Accept "),c.Wb(),c.Xb(7,"a",8),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc().decline(i)})),c.Yc(8,"Decline"),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit;c.Cb(3),c.wc("ngIf",!e.data.isUsingFullAccess),c.Cb(1),c.wc("ngIf",e.data.isUsingFullAccess)}}function FO(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",9),c.Xb(1,"div",10),c.Yc(2),c.Xb(3,"a",14),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc().readNews(i.id)})),c.Sb(4,"img",15),c.Wb(),c.Wb(),c.Xb(5,"p",13),c.Yc(6),c.Wb(),c.Xb(7,"a",16),c.Yc(8),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit;c.Cb(2),c.ad(" ",e.title," "),c.Cb(4),c.ad(" ",e.message," "),c.Cb(1),c.xc("href",e.link,c.Qc),c.Cb(1),c.Zc(e.linkText)}}function NO(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",9),c.Xb(1,"div",10),c.Yc(2," Timezone mismatch "),c.Wb(),c.Xb(3,"p",13),c.Yc(4," Different timezones in "),c.Xb(5,"a",17),c.jc("click",(function(){return c.Oc(e),c.nc().goToSettings()})),c.Yc(6,"your profile"),c.Wb(),c.Yc(7," and browser might lead to incorrect reports. "),c.Wb(),c.Xb(8,"a",8),c.jc("click",(function(){return c.Oc(e),c.nc().changeTimeZone()})),c.Yc(9),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(9),c.ad("Change to ",e.suggestedTimeZone,"")}}function UO(e,t){1&e&&(c.Xb(0,"strong"),c.Yc(1,"full access"),c.Wb())}function $O(e,t){1&e&&(c.Xb(0,"a",22),c.Yc(1," Learn more "),c.Wb())}function _O(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",10),c.Yc(2),c.Xb(3,"a",14),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc().markAsRead(t.id)})),c.Sb(4,"img",15),c.Wb(),c.Wb(),c.Xb(5,"p",13),c.Yc(6),c.Wc(7,UO,2,0,"strong",20),c.Yc(8),c.Wb(),c.Wc(9,$O,2,0,"a",21),c.Ub()}if(2&e){const e=c.nc().$implicit;c.Cb(2),c.ad(" ",e.data.title?e.data.title:"Special features"," "),c.Cb(4),c.ad(" ",e.data.message.split("full access")[0]," "),c.Cb(1),c.wc("ngIf",e.data.message.includes("full access")),c.Cb(1),c.ad(" ",e.data.message.split("full access")[1]," "),c.Cb(1),c.wc("ngIf","Privacy notice"!==e.data.title)}}function GO(e,t){1&e&&(c.Xb(0,"a",25),c.Yc(1),c.Wb()),2&e&&(c.Cb(1),c.ad(" "," here."," "))}function BO(e,t){1&e&&(c.Xb(0,"a",26),c.Yc(1),c.Wb()),2&e&&(c.Cb(1),c.ad(" "," here."," "))}function VO(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",10),c.Yc(2),c.Xb(3,"a",14),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc().markAsRead(t.id)})),c.Sb(4,"img",15),c.Wb(),c.Wb(),c.Xb(5,"p",13),c.Yc(6),c.Wc(7,GO,2,1,"a",23),c.Wc(8,BO,2,1,"a",24),c.Wb(),c.Ub()}if(2&e){const e=c.nc().$implicit;c.Cb(2),c.ad(" ",e.data.title," "),c.Cb(4),c.ad(" ",e.data.message.replace(" here.","")," "),c.Cb(1),c.wc("ngIf",e.data.message.includes("enabled")&&e.data.title.includes("Screenshots")),c.Cb(1),c.wc("ngIf",e.data.message.includes("enabled")&&e.data.title.includes("GPS"))}}function HO(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",10),c.Yc(2," Verify email "),c.Wb(),c.Xb(3,"p",13),c.Yc(4,"You haven't verified your email yet."),c.Wb(),c.Xb(5,"a",8),c.jc("click",(function(){return c.Oc(e),c.nc(2).resendEmail()})),c.Yc(6,"Resend e-mail"),c.Wb(),c.Ub()}}function zO(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",10),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Xb(4,"a",14),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc().markAsRead(t.id)})),c.Sb(5,"img",15),c.Wb(),c.Wb(),c.Xb(6,"p",13),c.Yc(7),c.Wb(),c.Ub()}if(2&e){const e=c.nc().$implicit;c.Cb(3),c.Zc(e.data.title),c.Cb(4),c.Zc(e.data.message)}}function qO(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",10),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Xb(4,"a",14),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc().markAsRead(t.id)})),c.Sb(5,"img",15),c.Wb(),c.Wb(),c.Xb(6,"p",13),c.Yc(7),c.Wb(),c.Xb(8,"a",8),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit,i=c.nc();return i.receiveUpdates(),i.markAsRead(t.id)})),c.Yc(9,"Receive updates"),c.Wb(),c.Ub()}if(2&e){const e=c.nc().$implicit;c.Cb(3),c.Zc(e.data.title),c.Cb(4),c.Zc(e.data.message)}}function KO(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",10),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Wb(),c.Xb(4,"p",13),c.Yc(5),c.Wb(),c.Xb(6,"a",8),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc().goToSubscription(t.data.workspaceId)})),c.Yc(7," Go to subscription "),c.Wb(),c.Ub()}if(2&e){const e=c.nc().$implicit;c.Cb(3),c.Zc(e.data.title),c.Cb(2),c.Zc(e.data.message)}}function ZO(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"div",18),c.Wc(2,_O,10,5,"ng-container",19),c.Wc(3,VO,9,4,"ng-container",19),c.Wc(4,HO,7,0,"ng-container",19),c.Wc(5,zO,8,2,"ng-container",19),c.Wc(6,qO,10,2,"ng-container",19),c.Wc(7,KO,8,2,"ng-container",19),c.Wb(),c.Ub()),2&e){const e=t.$implicit;c.Cb(1),c.wc("ngSwitch",e.type),c.Cb(1),c.wc("ngSwitchCase","FEATURE_SUBSCRIPTION"),c.Cb(1),c.wc("ngSwitchCase","MONITORING"),c.Cb(1),c.wc("ngSwitchCase","ACCOUNT_VERIFICATION"),c.Cb(1),c.wc("ngSwitchCase","WORKSPACE_CHANGED"),c.Cb(1),c.wc("ngSwitchCase","USER_SETTINGS"),c.Cb(1),c.wc("ngSwitchCase","PAYMENT_FAILED")}}function QO(e,t){if(1&e&&(c.Xb(0,"li"),c.Yc(1),c.oc(2,"momentFormat"),c.oc(3,"momentFormat"),c.Wb()),2&e){const e=t.$implicit,i=c.nc(3);c.Cb(1),c.bd(" ",c.qc(2,2,e.start,i.user.settings.dateFormat)," - ",c.qc(3,5,e.end,i.user.settings.dateFormat)," ")}}function JO(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"div",29),c.Yc(2),c.Wb(),c.Xb(3,"ul",30),c.Wc(4,QO,4,8,"li",6),c.Wb(),c.Ub()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e.name),c.Cb(2),c.wc("ngForOf",e.ranges)}}function eX(e,t){if(1&e){const e=c.Yb();c.Xb(0,"delete-confirm-modal",27),c.jc("onDelete",(function(){c.Oc(e);const i=t.$implicit;return c.nc().confirmWithdrawnAll(i)}))("onClose",(function(){return t.$implicit.close(!1)})),c.Xb(1,"p",28),c.Yc(2," Before you can change time zone, you first have to unsubmit all your submitted time that's waiting for approval: "),c.Wb(),c.Wc(3,JO,5,2,"ng-container",6),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Change time zone")("btnText","Unsubmit")("showConfirmation",!0)("confirmationText","unsubmit")("inProgress",e.inProgress),c.Cb(3),c.wc("ngForOf",e.pendingApprovals)}}let tX=(()=>{class e{constructor(e,t,i,n,s,c,r,o,a){this.router=e,this.notificationService=t,this.authService=i,this.userService=n,this.loader=s,this.modalService=c,this.approvalService=r,this.cd=o,this.workspaceService=a,this.invitationNotifications=[],this.notificationsWithoutInvitation=[],this.newsNotifications=[],this.unsubscribe$=new Ee.a,this.allNotifications=[]}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.notificationService.newsNotifications$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.newsNotifications=e,this.calculateCount(this.allNotifications),this.cd.detectChanges()}),this.notificationService.unreadNotifications$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.allNotifications=e,this.invitationNotifications=e.filter(e=>e.type===TO.a.WORKSPACE_INVITATION),this.notificationsWithoutInvitation=e.filter(e=>e.type!==TO.a.WORKSPACE_INVITATION&&e.type!==TO.a.TIME_ZONE);const t=e.filter(e=>e.type===TO.a.TIME_ZONE)[0];this.suggestedTimeZone=this.generateSuggestedTimeZone(t),this.calculateCount(this.allNotifications),this.cd.detectChanges()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}calculateCount(e){const t=e.filter(e=>e.type!==TO.a.ACCOUNT_VERIFICATION&&e.type!==TO.a.TIME_ZONE).length+this.newsNotifications.length;this.clearBtnEnabled=t>0&&this.notificationsWithoutInvitation.length>0}changeTimeZone(){var e;(null===(e=this.user)||void 0===e?void 0:e.id)&&this.suggestedTimeZone&&(this.loader.showBar(),this.userService.updateTimeZone(this.suggestedTimeZone,this.user.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.loader.hide(),this.notificationService.removeTimezoneNotification()},e=>{this.loader.hide(),4007===e.error.code&&(this.modalService.open(this.approvalListModal,{centered:!0}),this.checkApprovalSubmittedStatus())}))}checkApprovalSubmittedStatus(){this.approvalService.getAllPendingRequestsForAllWorkspaces().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>this.pendingApprovals=e)}confirmWithdrawnAll(e){this.loader.showBar(),this.inProgress=!0,this.approvalService.withdrawAllRequestsForAllWorkspaces().pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.inProgress=!1,this.loader.hide(),this.changeTimeZone(),e.close()},e=>{this.inProgress=!1,this.loader.hide()})}accept(e){this.user&&this.userService.changeWorkspaceStatus(this.user,{status:1,notificationId:e.id,workspaceId:e.data.workspaceId})}decline(e){this.user&&this.userService.removeDeclinedUserFromWorkspace(this.user,{status:2,notificationId:e.id,workspaceId:e.data.workspaceId})}markAsReadAll(){0===this.notificationsWithoutInvitation.length&&0===this.newsNotifications.length||(this.notificationService.markAsReadMany(this.notificationsWithoutInvitation.filter(e=>e.type!==TO.a.ACCOUNT_VERIFICATION&&e.type!==TO.a.PAYMENT_FAILED).map(e=>e.id)),0!==this.newsNotifications.length&&this.notificationService.readNews(this.newsNotifications.map(e=>e.id)))}markAsRead(e){this.notificationService.markAsRead(e)}readNews(e){this.notificationService.readNews(new Array(e))}goToSettings(){this.router.navigate(["user/settings"])}resendEmail(){this.authService.resendVerifyEmail()}receiveUpdates(){this.user.settings.sendNewsletter=!0,this.userService.updateSettings(this.user).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{})}goToSubscription(e){e===this.workspace.id?this.router.navigate(["subscription"],{fragment:"payment"}):this.userService.setDefaultUserWorkspace(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>this.router.navigate(["subscription"],{fragment:"payment"}))}generateSuggestedTimeZone(e){const t=e&&jt.tz.guess();if(!t)return"";if(ei.x.indexOf(t)>-1){const e=jt.tz(t).format("Z"),i=jt.tz.names();for(let t=0;t<i.length;t++){const n=i[t];if(e===jt.tz(n).format("Z")&&-1===ei.x.indexOf(n))return n}}return t}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.c),c.Rb(D.a),c.Rb(Ce.a),c.Rb(ys.a),c.Rb(wi.a),c.Rb(g.q),c.Rb(Mt),c.Rb(c.h),c.Rb(U.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["notifications"],["","notifications",""]],viewQuery:function(e,t){var i;1&e&&c.Uc(jO,!0),2&e&&c.Kc(i=c.kc())&&(t.approvalListModal=i.first)},inputs:{user:"user"},decls:12,vars:6,consts:[[1,"cl-scroll-area"],[1,"cl-dropdown-notification-clear-all"],[1,"cl-h5","cl-mb-0"],["class","cl-small cl-color-blue",3,"click",4,"ngIf"],["class","cl-dropdown-item",4,"ngIf"],["class","cl-dropdown-item",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["approvalListModal",""],[1,"cl-small","cl-color-blue",3,"click"],[1,"cl-dropdown-item"],[1,"cl-dropdown-notification-item-title","cl-h2"],["class","cl-dropdown-notification-item-desc cl-small",4,"ngIf"],[1,"cl-btn","cl-btn-primary","cl-btn-sm","cl-mr-3",3,"click"],[1,"cl-dropdown-notification-item-desc","cl-small"],[3,"click"],["src","assets/ui-icons/close.svg"],["target","_blank","rel","noopener noreferrer",1,"cl-small","cl-color-blue",3,"href"],["clickCloseDropdown","",3,"click"],[1,"cl-dropdown-item",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngIf"],["href","https://clockify.me/help/category/extra-features","class","cl-small cl-color-blue","target","_blank",4,"ngIf"],["href","https://clockify.me/help/category/extra-features","target","_blank",1,"cl-small","cl-color-blue"],["href","https://clockify.me/help/extra-features/screenshots","target","_blank",4,"ngIf"],["href","https://clockify.me/help/extra-features/gps-tracking","target","_blank",4,"ngIf"],["href","https://clockify.me/help/extra-features/screenshots","target","_blank"],["href","https://clockify.me/help/extra-features/gps-tracking","target","_blank"],[3,"title","btnText","showConfirmation","confirmationText","inProgress","onDelete","onClose"],[1,"cl-text-dark"],[1,"cl-h2"],[1,"cl-list-unstyled","cl-ml-0"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"span",2),c.Yc(3," Notifications "),c.Wb(),c.Wc(4,xO,2,0,"a",3),c.Wb(),c.Wc(5,PO,2,0,"span",4),c.Wc(6,LO,9,2,"div",5),c.Wc(7,FO,9,4,"div",5),c.Wc(8,NO,10,1,"div",4),c.Wc(9,ZO,8,7,"ng-container",6),c.Wb(),c.Wc(10,eX,4,6,"ng-template",null,7,c.Xc)),2&e&&(c.Cb(4),c.wc("ngIf",t.clearBtnEnabled),c.Cb(1),c.wc("ngIf",0===(null==t.newsNotifications?null:t.newsNotifications.length)&&0===(null==t.invitationNotifications?null:t.invitationNotifications.length)&&0===(null==t.notificationsWithoutInvitation?null:t.notificationsWithoutInvitation.length)&&!t.suggestedTimeZone),c.Cb(1),c.wc("ngForOf",t.invitationNotifications),c.Cb(1),c.wc("ngForOf",t.newsNotifications),c.Cb(1),c.wc("ngIf",t.suggestedTimeZone),c.Cb(1),c.wc("ngForOf",t.notificationsWithoutInvitation))},directives:[s.u,s.t,s.y,s.z,yl.a],pipes:[$i.a],encapsulation:2,changeDetection:0}),e})(),iX=(()=>{class e{constructor(e,t){this.renderer=e,this.elementRef=t,this.toggleClass="cl-show"}clicked(e){const t=this.toggleElement||this.elementRef.nativeElement;t.classList.contains(this.toggleClass)?this.renderer.removeClass(t,this.toggleClass):this.renderer.addClass(t,this.toggleClass)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.F),c.Rb(c.l))},e.\u0275dir=c.Mb({type:e,selectors:[["","toggleClass",""]],hostBindings:function(e,t){1&e&&c.jc("click",(function(){return t.clicked()}))},inputs:{toggleClass:"toggleClass",toggleElement:"toggleElement"},exportAs:["toggleClass"]}),e})(),nX=(()=>{class e{constructor(e,t,i,n){this.renderer=e,this.activatedRoute=t,this.navigationService=i,this.element=n,this.activeClass="cl-active",this.activeFragments=[],this.paramsInUrl={fragment:"",urlParts:[]},this.unsubscribe$=new Ee.a}set routerLink(e){e&&(this.urlParts=e.map(e=>e.replace(/\//,"")))}ngOnInit(){this.activatedRoute.fragment.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.paramsInUrl.fragment=(e||"").toLowerCase(),this.isLinkActive()}),this.navigationService.routeParams$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.paramsInUrl=e,this.isLinkActive()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}isLinkActive(){const e=this.linkElement||this.element.nativeElement;if(this.renderer.removeClass(e,this.activeClass),!Object(Pt.c)(this.paramsInUrl.urlParts,this.urlParts))return;const t=!!this.activeFragments.length;t&&!this.activeFragments.includes(this.paramsInUrl.fragment)||!t&&this.paramsInUrl.fragment||this.renderer.addClass(e,this.activeClass)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.F),c.Rb(W.a),c.Rb(Zc.a),c.Rb(c.l))},e.\u0275dir=c.Mb({type:e,selectors:[["","activeLink",""]],inputs:{activeClass:"activeClass",activeFragments:"activeFragments",routerLink:"routerLink",linkElement:"linkElement"}}),e})();const sX=["topbarNotifications"],cX=["workspacePickerTooltip"],rX=["topbarDropdowns"];function oX(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",55),c.Xb(1,"a",56,57),c.jc("click",(function(){return c.Oc(e),c.Lc(2).blur()})),c.Yc(3,"Contact for demo"),c.Wb(),c.Xb(4,"button",58),c.jc("click",(function(){return c.Oc(e),c.nc(3).discardContactSalesNotification()})),c.Yc(5,"\xd7"),c.Wb(),c.Wb()}}function aX(e,t){if(1&e&&(c.Xb(0,"span"),c.Yc(1),c.Wb()),2&e){const e=c.nc(4);c.Cb(1),c.ad("Trial expires in ",e.remainingTrialDays," days.")}}function lX(e,t){1&e&&(c.Xb(0,"span"),c.Yc(1,"Trial expires today."),c.Wb())}function bX(e,t){if(1&e&&(c.Xb(0,"p",59),c.Wc(1,aX,2,1,"span",10),c.Wc(2,lX,2,0,"span",10),c.Xb(3,"a",60),c.Yc(4," Contact sales to extend "),c.Wb(),c.Wb()),2&e){const e=c.nc(3);c.Cb(1),c.wc("ngIf",e.remainingTrialDays),c.Cb(1),c.wc("ngIf",0===e.remainingTrialDays)}}function uX(e,t){if(1&e&&(c.Xb(0,"div",52),c.Wc(1,oX,6,0,"div",53),c.Wc(2,bX,5,2,"p",54),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngIf",!!e.constactSalesNotification),c.Cb(1),c.wc("ngIf",e.workspace.featureSubscriptionType===e.PaymentTypeEnum.TRIAL&&e.isAdmin)}}function dX(e,t){if(1&e&&(c.mc(),c.lc(),c.Vb(0),c.Wc(1,uX,3,2,"div",51),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",!!e.constactSalesNotification||e.workspace.featureSubscriptionType===e.PaymentTypeEnum.TRIAL&&e.isAdmin)}}const pX=function(e){return[e]};function hX(e,t){if(1&e&&c.Sb(0,"span",76),2&e){const e=c.nc().$implicit;c.wc("ngClass",c.Bc(1,pX,e.bgClass))}}function mX(e,t){1&e&&(c.Xb(0,"span",77),c.Sb(1,"img",78),c.Xb(2,"span",79),c.Yc(3," Active "),c.Wb(),c.Wb())}const gX=function(e){return{"cl-active":e}};function fX(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"a",72),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).changeDefaultWorkspace(i)})),c.Wc(2,hX,1,3,"span",73),c.Xb(3,"span",74),c.Yc(4),c.Wb(),c.Wc(5,mX,4,0,"span",75),c.Wb(),c.Ub()}if(2&e){const e=t.$implicit,i=c.nc(3);c.Cb(1),c.xc("title",e.name),c.wc("ngClass",c.Bc(5,gX,e.id===i.activeWorkspaceId)),c.Cb(1),c.wc("ngIf",!i.isSelfHosted&&"FREE"!==e.subscriptionPlanTitle.toUpperCase()),c.Cb(2),c.Zc(e.name),c.Cb(1),c.wc("ngIf",e.id===i.activeWorkspaceId)}}function vX(e,t){if(1&e&&(c.Xb(0,"div",64),c.Xb(1,"div",65),c.Xb(2,"div",66),c.Xb(3,"div",67),c.Yc(4,"Workspaces"),c.Wb(),c.Xb(5,"span",68),c.Xb(6,"a",69),c.Yc(7," Manage "),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(8,"div",70),c.Wc(9,fX,6,7,"ng-container",71),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(9),c.wc("ngForOf",e.workspaces)}}function wX(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",61,25),c.jc("onOpen",(function(){return c.Oc(e),c.Lc(3).close()})),c.Xb(2,"div",62,63),c.Yc(4),c.Wb(),c.Wc(5,vX,10,1,"div",23),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.wc("autoClose",!1),c.Cb(2),c.ad(" ",null==e.workspace?null:e.workspace.name," ")}}function yX(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",84,85),c.jc("click",(function(){return c.Oc(e),c.Lc(1).blur()})),c.Yc(2," Upgrade "),c.Wb()}}function WX(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div"),c.Xb(1,"a",87,85),c.jc("click",(function(){return c.Oc(e),c.Lc(2).blur()})),c.Yc(3," Upgrade "),c.Wb(),c.Wb()}}function CX(e,t){if(1&e&&c.Wc(0,WX,4,0,"div",86),2&e){c.nc();const e=c.Lc(6),t=c.nc();c.wc("ngIf",t.everHadPaidSubscription)("ngIfElse",e)}}function kX(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",88,89),c.jc("click",(function(){return c.Oc(e),c.Lc(1).blur()})),c.Yc(2," Invoices "),c.Wb()}}function SX(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"div",80),c.Wc(2,yX,3,0,"a",81),c.Wc(3,CX,1,2,"ng-template",null,82,c.Xc),c.Wc(5,kX,3,0,"ng-template",null,83,c.Xc),c.Wb(),c.Ub()),2&e){const e=c.Lc(4),t=c.nc();c.Cb(2),c.wc("ngIf",!t.everHadPaidSubscription&&!t.hasOpenInvoice&&!t.hasPaidInvoice)("ngIfElse",e)}}function IX(e,t){if(1&e&&(c.Xb(0,"a",90),c.Xb(1,"span",40),c.Sb(2,"img",91),c.Wb(),c.Wb()),2&e){const e=c.nc();c.wc("href",e.supportLinks[0].uri,c.Qc),c.Cb(2),c.wc("src","assets/nav-icons/help.svg",c.Qc)}}function OX(e,t){if(1&e&&(c.Xb(0,"a",95),c.Yc(1),c.Wb()),2&e){const e=t.$implicit;c.wc("href",e.uri,c.Qc),c.Cb(1),c.ad("",e.copy," ")}}function XX(e,t){if(1&e&&(c.Xb(0,"div",64),c.Xb(1,"div",70),c.Wc(2,OX,2,2,"a",94),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(2),c.wc("ngForOf",e.supportLinks)}}function EX(e,t){1&e&&(c.Xb(0,"div",92,25),c.Xb(2,"a",93),c.Sb(3,"img",91),c.Wb(),c.Wc(4,XX,3,1,"div",23),c.Wb()),2&e&&(c.Cb(3),c.wc("src","assets/nav-icons/help.svg",c.Qc))}function TX(e,t){if(1&e&&(c.Xb(0,"span",96),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.unreadNotifications+e.newsNotifications," ")}}function DX(e,t){if(1&e&&(c.Xb(0,"div",64),c.Sb(1,"div",97),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.wc("user",e.user)}}function RX(e,t){if(1&e&&c.Sb(0,"span",76),2&e){const e=c.nc().$implicit;c.wc("ngClass",c.Bc(1,pX,e.bgClass))}}function AX(e,t){1&e&&(c.Xb(0,"span",77),c.Sb(1,"img",78),c.Xb(2,"span",79),c.Yc(3," Active "),c.Wb(),c.Wb())}function jX(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"a",72),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc(5).changeDefaultWorkspace(i)})),c.Wc(2,RX,1,3,"span",73),c.Xb(3,"span",74),c.Yc(4),c.Wb(),c.Wc(5,AX,4,0,"span",75),c.Wb(),c.Ub()}if(2&e){const e=t.$implicit,i=c.nc(5);c.Cb(1),c.xc("title",e.name),c.wc("ngClass",c.Bc(5,gX,e.id===i.activeWorkspaceId)),c.Cb(1),c.wc("ngIf",!i.isSelfHosted&&"FREE"!==e.subscriptionPlanTitle.toUpperCase()),c.Cb(2),c.Zc(e.name),c.Cb(1),c.wc("ngIf",e.id===i.activeWorkspaceId)}}function xX(e,t){if(1&e&&(c.Xb(0,"div",64),c.Xb(1,"div",65),c.Xb(2,"div",66),c.Xb(3,"div",67),c.Yc(4,"Workspaces"),c.Wb(),c.Xb(5,"span",68),c.Xb(6,"a",69),c.Yc(7," Manage "),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(8,"div",70),c.Wc(9,jX,6,7,"ng-container",71),c.Wb(),c.Wb()),2&e){const e=c.nc(4);c.Cb(9),c.wc("ngForOf",e.workspaces)}}function PX(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",115),c.Xb(1,"div",116,25),c.jc("onOpen",(function(){return c.Oc(e),c.Lc(4).close()})),c.Xb(3,"div",117,63),c.Xb(5,"span",118),c.Yc(6),c.Wb(),c.Wb(),c.Wc(7,xX,10,1,"div",23),c.Wb(),c.Wb()}if(2&e){const e=c.nc(3);c.Cb(3),c.wc("autoClose",!1),c.Cb(3),c.Zc(null==e.workspace?null:e.workspace.name)}}function MX(e,t){1&e&&(c.Xb(0,"a",121),c.Yc(1," Upgrade "),c.Wb())}function YX(e,t){1&e&&(c.Xb(0,"a",122),c.Yc(1," Upgrade "),c.Wb())}function LX(e,t){if(1&e&&(c.Vb(0),c.Wc(1,MX,2,0,"a",119),c.Wc(2,YX,2,0,"ng-template",null,120,c.Xc),c.Ub()),2&e){const e=c.Lc(3),t=c.nc(3);c.Cb(1),c.wc("ngIf",!t.everHadPaidSubscription)("ngIfElse",e)}}function FX(e,t){if(1&e&&(c.Xb(0,"div",113),c.Xb(1,"div",65),c.Xb(2,"div",66),c.Wc(3,PX,8,2,"div",114),c.Wc(4,LX,4,2,"ng-container",10),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(3),c.wc("ngIf",!e.isSubdomain),c.Cb(1),c.wc("ngIf",e.showUpgradeLink)}}function NX(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",64),c.Xb(1,"div",65),c.Xb(2,"div",98),c.Xb(3,"div",99),c.Yc(4),c.Wb(),c.Xb(5,"div",100),c.Yc(6),c.Wb(),c.Wb(),c.Wb(),c.Wc(7,FX,5,2,"div",101),c.Xb(8,"a",102),c.Yc(9,"Profile settings"),c.Wb(),c.Xb(10,"div",103),c.Xb(11,"div",104),c.Xb(12,"input",105),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc().user.settings.darkTheme=t}))("ngModelChange",(function(){return c.Oc(e),c.nc().darkThemeDebouncer$.next()})),c.Wb(),c.Xb(13,"label",106),c.Yc(14," Dark theme "),c.Wb(),c.Wb(),c.Wb(),c.Xb(15,"a",107),c.Yc(16,"Download apps"),c.Wb(),c.Xb(17,"a",108),c.Xb(18,"span"),c.Yc(19,"Try chat app"),c.Wb(),c.Xb(20,"span",109),c.Yc(21,"NEW"),c.Wb(),c.Wb(),c.Xb(22,"a",110),c.Yc(23,"Help"),c.Wb(),c.Sb(24,"div",111),c.Xb(25,"a",112),c.jc("click",(function(){return c.Oc(e),c.nc().logout()})),c.Yc(26,"Log out"),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(4),c.Zc(null==e.user?null:e.user.name),c.Cb(2),c.Zc(null==e.user?null:e.user.email),c.Cb(1),c.wc("ngIf",!e.isSubdomain||e.showUpgradeLink),c.Cb(5),c.wc("ngModel",e.user.settings.darkTheme)}}function UX(e,t){1&e&&(c.Xb(0,"div",125),c.Xb(1,"a",126),c.Yc(2," Timesheet "),c.Wb(),c.Wb())}function $X(e,t){if(1&e&&(c.Xb(0,"li",38),c.Xb(1,"a",123),c.Xb(2,"span",40),c.Sb(3,"img",124),c.Wb(),c.Xb(4,"span",42),c.Yc(5,"Timesheet"),c.Wb(),c.Wb(),c.Wc(6,UX,3,0,"div",43),c.Wb()),2&e){const e=c.nc();c.Cb(6),c.wc("ngIf",e.isDesktop&&!e.isSidebarOpen)}}function _X(e,t){1&e&&c.Sb(0,"span",131)}function GX(e,t){1&e&&(c.Xb(0,"span"),c.Yc(1,"Time Tracker"),c.Wb())}function BX(e,t){1&e&&(c.Xb(0,"div",125),c.Xb(1,"a",132),c.Yc(2," Time Tracker "),c.Wb(),c.Wb())}function VX(e,t){if(1&e&&(c.Xb(0,"li",38),c.Xb(1,"a",127),c.Xb(2,"span",40),c.Sb(3,"img",128),c.Wb(),c.Xb(4,"span",42),c.Wc(5,_X,1,0,"span",129),c.Wc(6,GX,2,0,"ng-template",null,130,c.Xc),c.Wb(),c.Wb(),c.Wc(8,BX,3,0,"div",43),c.Wb()),2&e){const e=c.Lc(7),t=c.nc();c.Cb(5),c.wc("ngIf",!t.isTrackerPage&&t.timerIsRunning)("ngIfElse",e),c.Cb(3),c.wc("ngIf",t.isDesktop&&!t.isSidebarOpen)}}function HX(e,t){1&e&&(c.Xb(0,"div",125),c.Xb(1,"a",133),c.Yc(2," Calendar "),c.Wb(),c.Wb())}function zX(e,t){1&e&&(c.Xb(0,"div",125),c.Xb(1,"a",134),c.Yc(2," Dashboard "),c.Wb(),c.Wb())}function qX(e,t){1&e&&(c.Vb(0),c.Xb(1,"span",144),c.Yc(2," Reports "),c.Wb(),c.Sb(3,"hr",44),c.Ub())}function KX(e,t){if(1&e&&(c.Xb(0,"li",38,135),c.Xb(2,"span",136),c.Xb(3,"span",40),c.Sb(4,"img",137),c.Wb(),c.Yc(5,"Reports "),c.Wb(),c.Xb(6,"a",138),c.Xb(7,"span",40),c.Sb(8,"img",137),c.Wb(),c.Xb(9,"span",42),c.Yc(10,"Reports"),c.Wb(),c.Wb(),c.Xb(11,"div",139),c.Xb(12,"div",70),c.Wc(13,qX,4,0,"ng-container",10),c.Xb(14,"a",140),c.Yc(15,"Summary"),c.Wb(),c.Xb(16,"a",141),c.Yc(17,"Detailed"),c.Wb(),c.Xb(18,"a",142),c.Yc(19,"Weekly"),c.Wb(),c.Xb(20,"a",143),c.Yc(21,"Shared"),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.Lc(1),t=c.nc();c.Cb(2),c.wc("toggleElement",e),c.Cb(4),c.wc("queryParams",t.switchReportService.queryParams),c.Cb(7),c.wc("ngIf",t.isDesktop&&!t.isSidebarOpen),c.Cb(1),c.wc("queryParams",t.switchReportService.queryParams),c.Cb(2),c.wc("queryParams",t.switchReportService.queryParams),c.Cb(2),c.wc("queryParams",t.switchReportService.queryParams)}}const ZX=function(){return["/activity/screenshots"]},QX=function(){return["/activity/locations"]};function JX(e,t){if(1&e&&(c.Xb(0,"div",125),c.Xb(1,"a",147),c.Yc(2," Activity "),c.Wb(),c.Wb()),2&e){const e=c.nc(3);c.Cb(1),c.wc("routerLink",e.workspace.screenshotsEnabled?c.Ac(1,ZX):c.Ac(2,QX))}}function eE(e,t){if(1&e&&(c.Xb(0,"li",38),c.Xb(1,"a",145),c.Xb(2,"span",40),c.Sb(3,"img",146),c.Wb(),c.Xb(4,"span",42),c.Yc(5,"Activity"),c.Wb(),c.Wb(),c.Wc(6,JX,3,3,"div",43),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.wc("routerLink",e.workspace.screenshotsEnabled?c.Ac(2,ZX):c.Ac(3,QX)),c.Cb(5),c.wc("ngIf",e.isDesktop&&!e.isSidebarOpen)}}function tE(e,t){1&e&&(c.Vb(0),c.Xb(1,"span",144),c.Yc(2," Activity "),c.Wb(),c.Sb(3,"hr",44),c.Ub())}function iE(e,t){if(1&e&&(c.Xb(0,"li",38,148),c.Xb(2,"span",136),c.Xb(3,"span",40),c.Sb(4,"img",146),c.Wb(),c.Yc(5,"Activity "),c.Wb(),c.Xb(6,"a",149),c.Xb(7,"span",40),c.Sb(8,"img",146),c.Wb(),c.Xb(9,"span",42),c.Yc(10,"Activity"),c.Wb(),c.Wb(),c.Xb(11,"div",139),c.Xb(12,"div",70),c.Wc(13,tE,4,0,"ng-container",10),c.Xb(14,"a",150),c.Yc(15," Screenshots"),c.Wb(),c.Xb(16,"a",151),c.Yc(17," Locations"),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.Lc(1),t=c.nc(2);c.Cb(2),c.wc("toggleElement",e),c.Cb(4),c.wc("routerLink",t.workspace.screenshotsEnabled?c.Ac(3,ZX):c.Ac(4,QX)),c.Cb(7),c.wc("ngIf",t.isDesktop&&!t.isSidebarOpen)}}function nE(e,t){if(1&e&&(c.Vb(0),c.Wc(1,eE,7,4,"li",37),c.Wc(2,iE,18,5,"li",37),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",!e.workspace.screenshotsEnabled||!e.workspace.locationsEnabled),c.Cb(1),c.wc("ngIf",e.workspace.screenshotsEnabled&&e.workspace.locationsEnabled)}}function sE(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"li"),c.Sb(2,"hr",44),c.Wb(),c.Xb(3,"li",45),c.Xb(4,"span",46),c.Xb(5,"span",47),c.Yc(6,"Manage"),c.Wb(),c.Wb(),c.Wb(),c.Ub()),2&e){const e=c.nc();c.Cb(2),c.Hb("cl-d-none",e.isSidebarOpen),c.Cb(1),c.Hb("cl-d-none",!e.isSidebarOpen)}}function cE(e,t){1&e&&(c.Xb(0,"span",155),c.Yc(1,"\u2022"),c.Wb())}function rE(e,t){1&e&&(c.Xb(0,"div",125),c.Xb(1,"a",156),c.Yc(2," Approvals "),c.Wb(),c.Wb())}function oE(e,t){if(1&e&&(c.Xb(0,"li",38),c.Xb(1,"a",152),c.Xb(2,"span",40),c.Sb(3,"img",153),c.Wb(),c.Xb(4,"span",42),c.Yc(5,"Approvals"),c.Wb(),c.Wc(6,cE,2,0,"span",154),c.Wb(),c.Wc(7,rE,3,0,"div",43),c.Wb()),2&e){const e=c.nc();c.Cb(6),c.wc("ngIf",e.pendingCount>0),c.Cb(1),c.wc("ngIf",e.isDesktop&&!e.isSidebarOpen)}}function aE(e,t){1&e&&(c.Xb(0,"div",125),c.Xb(1,"a",159),c.Yc(2," Projects "),c.Wb(),c.Wb())}function lE(e,t){if(1&e&&(c.Xb(0,"li",38),c.Xb(1,"a",157),c.Xb(2,"span",40),c.Sb(3,"img",158),c.Wb(),c.Xb(4,"span",42),c.Yc(5,"Projects"),c.Wb(),c.Wb(),c.Wc(6,aE,3,0,"div",43),c.Wb()),2&e){const e=c.nc();c.Cb(6),c.wc("ngIf",e.isDesktop&&!e.isSidebarOpen)}}function bE(e,t){1&e&&(c.Xb(0,"div",125),c.Xb(1,"a",162),c.Yc(2," Teams "),c.Wb(),c.Wb())}function uE(e,t){if(1&e&&(c.Xb(0,"li",38),c.Xb(1,"a",160),c.Xb(2,"span",40),c.Sb(3,"img",161),c.Wb(),c.Xb(4,"span",42),c.Yc(5,"Team"),c.Wb(),c.Wb(),c.Wc(6,bE,3,0,"div",43),c.Wb()),2&e){const e=c.nc();c.Cb(6),c.wc("ngIf",e.isDesktop&&!e.isSidebarOpen)}}const dE=function(){return["/clients"]};function pE(e,t){if(1&e&&(c.Xb(0,"div",125),c.Xb(1,"a",147),c.Yc(2),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.wc("routerLink",c.Ac(2,dE)),c.Cb(1),c.ad(" ",e.projectGroupingLabel," ")}}const hE=function(){return["/tags"]};function mE(e,t){1&e&&(c.Xb(0,"div",125),c.Xb(1,"a",147),c.Yc(2," Tags "),c.Wb(),c.Wb()),2&e&&(c.Cb(1),c.wc("routerLink",c.Ac(1,hE)))}function gE(e,t){1&e&&(c.Xb(0,"div",125),c.Xb(1,"a",174),c.Yc(2," Invoices "),c.Wb(),c.Wb())}function fE(e,t){if(1&e&&(c.Xb(0,"li",38),c.Xb(1,"a",172),c.Xb(2,"span",40),c.Sb(3,"img",173),c.Wb(),c.Xb(4,"span",42),c.Yc(5,"Invoices"),c.Wb(),c.Wb(),c.Wc(6,gE,3,0,"div",43),c.Wb()),2&e){const e=c.nc(2);c.Cb(6),c.wc("ngIf",e.isDesktop&&!e.isSidebarOpen)}}const vE=function(){return["/subscription"]};function wE(e,t){1&e&&(c.Xb(0,"div",125),c.Xb(1,"a",178),c.Yc(2," Subscription "),c.Wb(),c.Wb()),2&e&&(c.Cb(1),c.wc("routerLink",c.Ac(1,vE)))}const yE=function(){return["","payment","invoices","plans"]};function WE(e,t){if(1&e&&(c.Xb(0,"li",168,175),c.Xb(2,"a",176),c.Xb(3,"span",40),c.Sb(4,"img",177),c.Wb(),c.Xb(5,"span",42),c.Yc(6,"Subscription"),c.Wb(),c.Wb(),c.Wc(7,wE,3,2,"div",43),c.Wb()),2&e){const e=c.Lc(1),t=c.nc(2);c.Cb(2),c.wc("linkElement",e)("activeFragments",c.Ac(4,yE))("routerLink",c.Ac(5,vE)),c.Cb(5),c.wc("ngIf",t.isDesktop&&!t.isSidebarOpen)}}const CE=function(e){return["/workspaces",e,"settings"]};function kE(e,t){if(1&e&&(c.Xb(0,"div",125),c.Xb(1,"a",179),c.Yc(2," Settings "),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.wc("routerLink",c.Bc(1,CE,e.activeWorkspaceId))}}const SE=function(){return["","general","permissions","alerts","accounts","auth","custom_fields"]};function IE(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"li",38),c.Xb(2,"a",163),c.Xb(3,"span",40),c.Sb(4,"img",164),c.Wb(),c.Xb(5,"span",42),c.Yc(6),c.Wb(),c.Wb(),c.Wc(7,pE,3,3,"div",43),c.Wb(),c.Xb(8,"li",38),c.Xb(9,"a",165),c.Xb(10,"span",40),c.Sb(11,"img",166),c.Wb(),c.Xb(12,"span",42),c.Yc(13,"Tags"),c.Wb(),c.Wb(),c.Wc(14,mE,3,2,"div",43),c.Wb(),c.Wc(15,fE,7,1,"li",37),c.Wc(16,WE,8,6,"li",167),c.Xb(17,"li",168,169),c.Xb(19,"a",170),c.Xb(20,"span",40),c.Sb(21,"img",171),c.Wb(),c.Xb(22,"span",42),c.Yc(23,"Settings"),c.Wb(),c.Wb(),c.Wc(24,kE,3,3,"div",43),c.Wb(),c.Ub()),2&e){const e=c.Lc(18),t=c.nc();c.Cb(2),c.wc("routerLink",c.Ac(11,dE)),c.Cb(4),c.Zc(t.projectGroupingLabel),c.Cb(1),c.wc("ngIf",t.isDesktop&&!t.isSidebarOpen),c.Cb(2),c.wc("routerLink",c.Ac(12,hE)),c.Cb(5),c.wc("ngIf",t.isDesktop&&!t.isSidebarOpen),c.Cb(1),c.wc("ngIf",t.hasInvoiceFeature&&t.workspace.invoicingEnabled),c.Cb(1),c.wc("ngIf",!t.isSelfHosted&&t.everHadPaidSubscription),c.Cb(3),c.wc("linkElement",e)("activeFragments",c.Ac(13,SE))("routerLink",c.Bc(14,CE,t.activeWorkspaceId)),c.Cb(5),c.wc("ngIf",t.isDesktop&&!t.isSidebarOpen)}}let OE=(()=>{class e{constructor(e,t,i,n,s,c,r,o,a,l,b,u,d,p,h,m,g){this.authService=e,this.router=t,this.notificationService=i,this.workspaceService=n,this.userService=s,this.stopwatchService=c,this.systemSettingsService=r,this.trackerService=o,this.paymentService=a,this.browserService=l,this.synchronizationService=b,this.subdomainService=u,this.uiSettingsService=d,this.cd=p,this.sidebarStateService=h,this.approvalService=m,this.switchReportService=g,this.PaymentTypeEnum=ku.b,this.notifications=[],this.projectGroupingLabel="",this.supportLinks=[],this.unsubscribe$=new mi.a,this.unreadNotifications=0,this.newsNotifications=0,this.darkThemeDebouncer$=new Ee.a,this.isSelfHosted=tr.a.environment.selfHosted}ngOnInit(){this.isForbiddenZone=ei.g.includes(Se.tz.guess()),this.isAdmin=this.authService.isAdminOrOwner(),this.isSubdomain=this.subdomainService.isSubdomainNotSelfhosted(),this.subscribeToRoute(),this.subscribeToTrackerTime(),this.user=this.authService.getUser(),this.paymentService.onTrialStart$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.remainingTrialDays=7,this.cd.markForCheck()}),this.browserService.isBreakpointLg$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(e=>this.isDesktop=e),this.systemSettingsService.systemSettings.pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.systemSettings=e}),this.systemSettingsService.getSystemSettings(),this.workspaceService.createdWorkspace$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.pendingCount=0,this.setWorkspace(e),this.newWorkspaceId=e.id}),this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(It.a)(()=>{const e=!this.newWorkspaceId;return this.newWorkspaceId=null,e}),Object(De.a)(this.unsubscribe$)).subscribe(e=>{const t=(this.workspace&&this.workspace.id)!==e.id;this.setWorkspace(e),t&&this.checkEntriesInProgress()}),this.authService.user.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.user=e,this.cd.detectChanges()}),this.systemSettingsService.customLinkSettings.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{if(this.supportLinks=[],this.hasCustomLinks=!1,this.standardLinks=!e||e&&!e.enabled,this.standardLinks){const e=[new AO({uri:"https://clockify.me/help/",copy:"Documentation"}),new AO({uri:"https://clockify.me/tutorials",copy:"Tutorials"}),new AO({uri:"https://clockify.me/help/contact",copy:"Contact"})];this.supportLinks=[...this.supportLinks,...e]}e&&e.enabled&&e.customLinks&&(this.hasCustomLinks=!0,this.supportLinks=[...this.supportLinks,...e.customLinks]),this.cd.detectChanges()}),this.subscribeToUpgradePlan(),this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(({isAdminOrOwner:e,isTeamManager:t,isProjectManager:i})=>{this.isAdmin=e,this.isTeamManager=t,this.isProjectManager=i,this.setFeatures(),this.checkSubscription(),(e||t)&&this.checkApprovalCount(),this.cd.detectChanges()}),this.userService.membershipForUser.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{e.userId===this.user.id&&(this.user.memberships.push(new DO.a(e)),this.notificationService.getNotification(),this.workspaceService.getAllWorkspaces())}),this.notificationService.newsNotifications$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.newsNotifications=e.length,this.cd.detectChanges()}),this.notificationService.unreadNotifications$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(({length:e})=>{const t=e||0;t>this.unreadNotifications&&t>0&&this.topbarNotifications&&this.topbarNotifications.showDropdown(),this.unreadNotifications=t,this.cd.detectChanges()}),this.notificationService.contactSalesNotifications$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.constactSalesNotification=(e||[]).find(e=>e.type===TO.a.CONTACT_SALES&&e.data.workspaceId===this.workspace.id&&!Object(ku.f)(this.workspace.featureSubscriptionType)&&!Object(ku.g)(this.workspace.featureSubscriptionType)),this.cd.detectChanges()}),this.approvalService.pendingCount$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.pendingCount=e,this.cd.markForCheck()}),this.systemSettingsService.getCustomLinksSettings(),this.isSubdomain||(this.subscribeToWorkspaces(),this.workspaceService.getAllWorkspaces()),this.checkWorkspceTooltip(),this.setTimerIndicator(),this.subscribeToDarkThemeChanges(),this.subscribeToSidebarState()}get showUpgradeLink(){var e;return!this.isSelfHosted&&this.isAdmin&&(!this.everHadPaidSubscription||Object(ku.h)(null===(e=this.workspace)||void 0===e?void 0:e.featureSubscriptionType))}subscribeToSidebarState(){this.sidebarStateService.sidebarState$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isSidebarOpen=e,this.cd.markForCheck()})}checkWorkspceTooltip(){this.uiSettingsService.getSettings(hi.b.SHOW_WORKSPACE_TOOLTIP)&&!this.isSubdomain&&(this.workspacePickerTooltip&&this.workspacePickerTooltip.open(),this.uiSettingsService.setSettings(hi.b.SHOW_WORKSPACE_TOOLTIP,!1))}subscribeToDarkThemeChanges(){this.darkThemeDebouncer$.pipe(Object(Te.a)(500),Object(De.a)(this.unsubscribe$)).subscribe(()=>this.updateUser())}updateUser(){this.userService.updateSettings(this.user).pipe(Object(De.a)(this.unsubscribe$)).subscribe()}checkApprovalCount(){this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(({isAdmin:e,isTeamManager:t})=>{this.workspace.timeApprovalEnabled&&(e||t)?this.approvalService.getApprovalCount(Ot.PENDING):this.approvalService.setPendingCount(0)})}subscribeToUpgradePlan(){this.paymentService.onChargeCard$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.everHadPaidSubscription||this.checkSubscription()})}checkSubscription(){this.isAdmin&&!this.isSelfHosted&&(this.paymentService.trialSubscription$.pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{if(e){const t=e.endDate,i=Se.tz().startOf("D").toISOString();this.remainingTrialDays=Se(t).diff(Se(i),"days")}else this.remainingTrialDays=null;this.cd.markForCheck()}),this.paymentService.everHadPaidSubscription.pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.everHadPaidSubscription=e,this.cd.markForCheck()}),this.paymentService.trialSubscription$.pipe(Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{if(e){const t=e.endDate,i=Se.tz().startOf("D").toISOString();this.remainingTrialDays=Se(t).diff(Se(i),"days")}else this.remainingTrialDays=null;this.cd.markForCheck()}),this.paymentService.invoices$.pipe(Object(De.a)(this.unsubscribe$),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.hasOpenInvoice=e&&e.some(e=>"open"===e.status),this.hasPaidInvoice=e&&e.some(e=>"paid"===e.status),this.cd.markForCheck()}),this.paymentService.getEverHadSubscription(),this.paymentService.getInvoices())}discardContactSalesNotification(){this.notificationService.markAsRead(this.constactSalesNotification.id),this.constactSalesNotification=null}setWorkspace(e){var t;const i=(null===(t=this.workspace)||void 0===t?void 0:t.id)!==e.id;this.workspace=e,this.setFeatures(),this.projectGroupingLabel=Object(Pt.l)(e.projectGroupingLabel),this.addSupportLink(),i&&this.notificationService.getNotification(),this.cd.detectChanges()}setFeatures(){var e,t;this.hasInvoiceFeature=this.workspace.hasFeature(nr.a.INVOICING),this.hasApprovalFeature=this.workspace.hasFeature(nr.a.APPROVAL),this.hasScreenshotsFeature=this.workspace.hasFeature(nr.a.SCREENSHOTS),this.hasLocationsFeature=this.workspace.hasFeature(nr.a.LOCATIONS),this.showApprovalLink=this.workspace.timeApprovalEnabled&&this.hasApprovalFeature&&(this.isAdmin||this.isTeamManager),this.showActivityLink=(this.workspace.screenshotsEnabled||this.workspace.locationsEnabled)&&(this.hasScreenshotsFeature||this.hasLocationsFeature),this.showProjectLink=-1==(null===(e=this.workspace)||void 0===e?void 0:e.adminOnlyPages.indexOf("PROJECT"))||this.isAdmin||this.isProjectManager,this.showTeamLink=-1==(null===(t=this.workspace)||void 0===t?void 0:t.adminOnlyPages.indexOf("TEAM"))||this.isAdmin}setTimerIndicator(){this.checkEntriesInProgress(),this.synchronizationService.onStompEntryChange$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.router.url.startsWith("/tracker")||(e!==RO.a.TIME_ENTRY_STOPPED?e!==RO.a.TIME_ENTRY_STARTED&&e!==RO.a.TIME_ENTRY_DELETED||this.trackerService.getTimeEntryInProgress(!0).subscribe():this.stopwatchService.stop())})}checkEntriesInProgress(){this.router.url.startsWith("/tracker")||this.trackerService.getTimeEntryInProgress(!0).subscribe()}subscribeToRoute(){let e=this.router.url.replace("/","");e=e.split("?")[0],this.isTrackerPage="tracker"===e,this.router.events.pipe(Object(It.a)(e=>e instanceof W.b),Object(De.a)(this.unsubscribe$)).subscribe(({url:e})=>{this.isDesktop||this.setSidebarState(!1);let t=e.replace("/","");t=t.split("?")[0],this.isTrackerPage="tracker"===t,this.cd.detectChanges()})}addSupportLink(){if(!this.standardLinks)return;if(this.isForbiddenZone)return;this.supportLinks=this.supportLinks.filter(e=>"https://calendly.com/clockify-support/call"!=e.uri);const e=[new AO({uri:"https://calendly.com/clockify-support/call",copy:"Call support"})];this.supportLinks=[...this.supportLinks,...e],this.cd.detectChanges()}subscribeToTrackerTime(){this.stopwatchService.stateChanged.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>this.timerIsRunning=e===mc.b.STARTED)}navigateToHome(){this.isTrackerPage?this.browserService.scrollToTop():this.router.navigate(["tracker"])}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}get activeWorkspaceId(){return this.workspace&&this.workspace.id||""}subscribeToWorkspaces(){this.workspaceService.workspaces$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspaces=e,this.cd.detectChanges()},e=>{this.workspaces&&1===this.workspaces.length&&this.userService.setDefaultUserWorkspace(this.workspaces[0].id,this.workspaces[0])})}changeDefaultWorkspace(e){e.id===this.workspace.id||this.userService.setDefaultUserWorkspace(e.id,e)}setSidebarStateOnMobile(e){this.isDesktop||this.setSidebarState(e)}setSidebarState(e){this.sidebarStateService.setSidebar(e)}logout(){this.authService.logout()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Ce.a),c.Rb(W.c),c.Rb(D.a),c.Rb(U.a),c.Rb(ys.a),c.Rb(mc.a),c.Rb(Lt.a),c.Rb($d.a),c.Rb(Cu.a),c.Rb(pi.a),c.Rb(Hd.a),c.Rb(fa.a),c.Rb(hi.a),c.Rb(c.h),c.Rb(Qd),c.Rb(Mt),c.Rb(Ey.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["sidebar-and-topbar"],["","sidebar-and-topbar",""]],viewQuery:function(e,t){var i;1&e&&(c.ed(sX,!0),c.ed(cX,!0),c.ed(rX,!0)),2&e&&(c.Kc(i=c.kc())&&(t.topbarNotifications=i.first),c.Kc(i=c.kc())&&(t.workspacePickerTooltip=i.first),c.Kc(i=c.kc())&&(t.topbarDropdowns=i))},decls:76,vars:30,consts:[["id","topbar-menu",1,"cl-navbar","cl-pl-0","cl-pr-lg-3","cl-d-flex","cl-align-items-center","cl-border-bottom","cl-top-bar","cl-new-layer"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center","cl-w-100"],[1,"cl-d-flex","cl-align-items-center","top-bar-nav-align"],["type","button",1,"cl-navbar-toggler",3,"click"],["hamburgerBtn",""],[1,"cl-navbar-toggler-icon"],[1,"cl-logo-mob"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 134 33","fill","none",1,"pointer",3,"click"],["d","M14.4 9.79995L20 4.19995L21.6 5.79995L16 11.4L14.4 9.79995ZM12.1 15.6C11 15.6 10.1 14.7 10.1 13.6C10.1 12.5 11 11.6 12.1 11.6C13.2 11.6 14.1 12.5 14.1 13.6C14.1 14.7 13.2 15.6 12.1 15.6ZM21.7 21.4L20.1 23L14.5 17.4L16.1 15.7999L21.7 21.4Z","fill","#222222",1,"cl-logo-hands"],["d","M124.7 29.1C124.2 30.3 123.4 31.2 122.5 31.9C121.5 32.6 120.5 32.9 119.3 32.9C117.7 32.9 116.2 32.3 114.8 31.1L116.5 28C117.3 28.7 118.1 29.1 119 29.1C119.8 29.1 120.5 28.8 121.1 28.2C121.6 27.6 121.9 26.9 121.9 26.2C121.9 25.9 119.5 19.7 114.6 7.7H118.7L124.1 21L129.5 7.7H133.6L124.7 29.1ZM110.8 3.4C110 3.4 109.4 3.7 108.9 4.2C108.4 4.7 108.2 5.4 108.2 6.2V7.7H112.9V10.7H108.2V25.7H104.4V10.7H102.1V7.7H104.4V6.3C104.4 4.4 105 2.9 106.1 1.8C107.2 0.699999 108.6 0.100002 110.2 0.100002C111.8 0.100002 113.3 0.700001 114.6 1.9L113 4.6C112.3 3.8 111.6 3.4 110.8 3.4ZM96.2 4.8C95.5 4.8 95 4.6 94.5 4.1C94 3.6 93.8 3.1 93.8 2.4C93.8 1.7 94 1.2 94.5 0.700001C95 0.200001 95.5 0 96.2 0C96.9 0 97.4 0.200001 97.9 0.700001C98.4 1.2 98.6 1.7 98.6 2.4C98.6 3.1 98.4 3.6 97.9 4.1C97.5 4.6 96.9 4.8 96.2 4.8ZM86.4 25.7L81.1 17.8L78.4 20.6V25.7H74.6V0.600002H78.4V15.3L85.7 7.7H90.6L83.8 14.8L91.1 25.7H86.4V25.7ZM65.4 22.5C66.3 22.5 67.2 22.3 68 21.8L70.4 24.2C68.7 25.3 66.8 25.9 64.8 25.9C62.3 25.9 60.1 25 58.3 23.3C56.5 21.6 55.6 19.4 55.6 16.6C55.6 13.8 56.5 11.6 58.4 9.9C60.3 8.2 62.6 7.3 65.3 7.3C67.1 7.3 68.8 7.7 70.2 8.6L67.5 11.3C66.7 11 66 10.8 65.2 10.8C63.6 10.8 62.3 11.3 61.1 12.4C59.9 13.4 59.4 14.8 59.4 16.5C59.4 18.2 60 19.6 61.1 20.7C62.3 21.9 63.7 22.5 65.4 22.5ZM43.1 26C40.4 26 38.1 25.1 36.3 23.3C34.5 21.5 33.6 19.3 33.6 16.7C33.6 14.1 34.5 11.9 36.3 10.1C38.1 8.3 40.4 7.4 43.1 7.4C45.8 7.4 48.1 8.3 49.9 10.1C51.7 11.9 52.6 14.1 52.6 16.7C52.6 19.3 51.7 21.5 49.9 23.3C48.1 25.1 45.8 26 43.1 26ZM47.2 12.4C46.1 11.3 44.8 10.8 43.1 10.8C41.5 10.8 40.1 11.3 39 12.4C37.9 13.5 37.4 14.9 37.4 16.6C37.4 18.3 37.9 19.8 39 20.8C40.1 21.9 41.4 22.4 43.1 22.4C44.7 22.4 46.1 21.9 47.2 20.8C48.3 19.7 48.8 18.3 48.8 16.6C48.8 15 48.3 13.5 47.2 12.4ZM25.9 0.600002H29.7V25.7H25.9V0.600002ZM12.2 22.2C13.3 22.2 14.4 22 15.4 21.6L18.2 24.4C16.4 25.4 14.4 25.9 12.3 25.9C5.5 25.9 0 20.4 0 13.6C0 6.8 5.5 1.3 12.3 1.3C14.5 1.3 16.5 1.9 18.2 2.8L15.5 5.5C14.5 5.1 13.4 4.9 12.3 4.9C7.5 4.9 3.7 8.8 3.7 13.5C3.6 18.3 7.4 22.2 12.2 22.2ZM98.1 25.7H94.3V7.7H98.1V25.7Z","fill","#03A9F4"],[4,"ngIf"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end","cl-cut-text-wrapper"],[1,"cl-d-none","cl-d-lg-inline-flex","cl-cut-text-wrapper"],["dropdownKey","","class","cl-dropdown cl-dropdown-top-bar-ws cl-d-flex cl-justify-content-end cl-cut-text-wrapper",3,"onOpen",4,"ngIf"],[1,"cl-d-none","cl-d-lg-inline-flex"],["target","_blank",3,"href",4,"ngIf"],["dropdownKey","","class","cl-dropdown cl-d-flex cl-ml-3",4,"ngIf"],[1,"cl-d-flex","cl-align-items-center"],["dropdownKey","",1,"cl-dropdown","cl-dropdown-large"],["topbarNotifications","dropdownKey","topbarDropdowns","dropdownKey"],["tabindex","0","dropdownKeyButton","",1,"cl-dropdown-toggle","cl-no-arrow","cl-d-flex","cl-component-divided-left"],["src","assets/nav-icons/notification.svg"],["class","cl-badge cl-badge-pill cl-notification-badge",4,"ngIf"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["dropdownKey","",1,"cl-dropdown","cl-component-divided-left","cl-pr-0"],["topbarDropdowns","dropdownKey"],["tabindex","0","dropdownKeyButton","",1,"cl-p-0","cl-dropdown-toggle","cl-no-arrow","cl-d-flex"],[3,"classSize","src","name"],["id","sidebar-menu",1,"cl-layout-aside"],[1,"cl-navbar","cl-navbar-expand-lg","cl-navbar-light"],[1,"cl-navbar-collapse","cl-offcanvas-collapse"],[1,"cl-sidebar-wrapper"],[1,"cl-sidebar-header"],["type","button",1,"cl-navbar-toggler","cl-d-block",3,"click"],[1,"cl-sidebar-container"],[1,"cl-navbar-container"],[1,"cl-navbar-nav"],["class","cl-nav-item cl-dropdown","routerLinkActive","cl-active",4,"ngIf"],["routerLinkActive","cl-active",1,"cl-nav-item","cl-dropdown"],["routerLink","/calendar",1,"cl-nav-link","cl-indigo"],[1,"cl-nav-icon-wrapper"],["src","assets/nav-icons/calendar.svg"],[1,"cl-nav-link-copy"],["class","cl-dropdown-menu cl-dropdown-menu-nav",4,"ngIf"],[1,"cl-m-0"],[1,"cl-pl-3"],[1,"cl-nav-link","cl-ml-1"],[1,"cl-h5","cl-mb-0"],["routerLink","/dashboard",1,"cl-nav-link","cl-light-green"],["src","assets/nav-icons/dashboard.svg"],[1,"cl-offcanvas-collapse-bg",3,"click"],["class","cl-d-none cl-d-lg-inline-flex cl-align-items-center cl-contact-wrapper cl-cut-text-wrapper",4,"ngIf"],[1,"cl-d-none","cl-d-lg-inline-flex","cl-align-items-center","cl-contact-wrapper","cl-cut-text-wrapper"],["class","cl-btn-group cl-mr-2",4,"ngIf"],["class","cl-alert cl-alert-primary cl-d-inline-flex cl-p-1 cl-border-0 cl-mb-0 cl-px-2 cl-topbar-alert cl-cut-text",4,"ngIf"],[1,"cl-btn-group","cl-mr-2"],["type","button","href","https://clockify.me/help/contact/sales","target","_blank",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-transform-none","no-wrap",3,"click"],["contactLink",""],["type","button",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-border-left-0","cl-lh-0","cl-font-size-lg",2,"font-size","20px",3,"click"],[1,"cl-alert","cl-alert-primary","cl-d-inline-flex","cl-p-1","cl-border-0","cl-mb-0","cl-px-2","cl-topbar-alert","cl-cut-text"],["href","https://clockify.me/help/contact/sales","target","_blank",1,"cl-ml-1","cl-font-weight-bold"],["dropdownKey","",1,"cl-dropdown","cl-dropdown-top-bar-ws","cl-d-flex","cl-justify-content-end","cl-cut-text-wrapper",3,"onOpen"],["dropdownKeyButton","","ngbTooltip","You can switch between your workspaces here!","triggers","manual","placement","bottom","tabindex","0",1,"cl-dropdown-toggle","pointer","cl-cut-text",3,"autoClose"],["workspacePickerTooltip","ngbTooltip"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-dropdown-menu-header"],[1,"cl-item-between","cl-w-100"],[1,"cl-dropdown-header","cl-h5","cl-pl-2"],[1,"cl-dropdown-item-workspace-right","cl-mr-2"],["routerLink","/workspaces","clickCloseDropdown","",1,"cl-ml-2","cl-d-inline"],[1,"cl-scroll-area"],[4,"ngFor","ngForOf"],["clickCloseDropdown","",1,"cl-dropdown-item","cl-dropdown-item-workspace","cl-cut-text-wrapper","cl-relative",3,"title","ngClass","click"],["class","cl-ws-plan-border",3,"ngClass",4,"ngIf"],[1,"cl-cut-text"],["class","cl-dropdown-item-workspace-right",4,"ngIf"],[1,"cl-ws-plan-border",3,"ngClass"],[1,"cl-dropdown-item-workspace-right"],["src","assets/ui-icons/checkmark-green.svg"],[1,"cl-dropdown-active-workspace-label","cl-d-none","cl-d-lg-inline"],[1,"cl-d-none","cl-d-lg-inline-flex","cl-no-outline"],["routerLink","/upgrade","class","cl-btn cl-btn-sm cl-btn-outline-primary cl-ml-3","clickCloseDropdown","",3,"click",4,"ngIf","ngIfElse"],["FreePlanDesktopTempl",""],["OnlyInvoices",""],["routerLink","/upgrade","clickCloseDropdown","",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-ml-3",3,"click"],["upgrade",""],[4,"ngIf","ngIfElse"],["routerLink","/subscription","fragment","plans","clickCloseDropdown","",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-ml-3",3,"click"],["routerLink","/subscription","fragment","invoices","clickCloseDropdown","",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-ml-3",3,"click"],["invoices",""],["target","_blank",3,"href"],[3,"src"],["dropdownKey","",1,"cl-dropdown","cl-d-flex","cl-ml-3"],["dropdownKeyButton","","tabindex","0",1,"cl-dropdown-toggle","cl-no-arrow","cl-component-divided-left"],["class","cl-dropdown-item","target","_blank",3,"href",4,"ngFor","ngForOf"],["target","_blank",1,"cl-dropdown-item",3,"href"],[1,"cl-badge","cl-badge-pill","cl-notification-badge"],["notifications","",3,"user"],[1,"cl-dropdown-header","cl-pl-2","cl-cut-text-wrapper"],[1,"cl-cut-text","cl-h4","cl-mb-2","cl-text-dark"],[1,"cl-cut-text","cl-text-gray-9","cl-small"],["class","cl-d-lg-none",4,"ngIf"],["routerLink","/user/settings","clickCloseDropdown","",1,"cl-dropdown-item"],[1,"cl-dropdown-item"],[1,"cl-custom-control","cl-custom-switch","cl-custom-switch-right"],["type","checkbox","id","darkThemeTopbar",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","darkThemeTopbar",1,"cl-custom-control-label","cl-w-100"],["href","https://clockify.me/apps","target","_blank",1,"cl-dropdown-item"],["href","https://pumble.com/","target","_blank",1,"cl-dropdown-item","cl-item-between"],[1,"cl-badge","cl-badge-success","cl-ml-3","cl-mr-n1"],["href","https://clockify.me/help","target","_blank",1,"cl-dropdown-item","cl-d-lg-none"],[1,"cl-dropdown-divider","cl-border-light"],[1,"cl-dropdown-item",3,"click"],[1,"cl-d-lg-none"],["class","cl-cut-text-wrapper",4,"ngIf"],[1,"cl-cut-text-wrapper"],["dropdownKey","",1,"cl-dropdown",3,"onOpen"],["dropdownKeyButton","","ngbTooltip","You can switch between your workspaces here!","triggers","manual","placement","bottom","tabindex","0",1,"cl-dropdown-toggle","cl-pl-2","pointer","cl-cut-text","cl-w-100",3,"autoClose"],[1,"cl-pr-1"],["routerLink","/upgrade","class","cl-btn cl-btn-sm cl-btn-outline-primary cl-ml-1 cl-mr-2","clickCloseDropdown","",4,"ngIf","ngIfElse"],["FreePlanMobTempl",""],["routerLink","/upgrade","clickCloseDropdown","",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-ml-1","cl-mr-2"],["routerLink","/subscription","fragment","plans","clickCloseDropdown","",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-ml-1","cl-mr-2"],["routerLink","/timesheet",1,"cl-nav-link","cl-blue"],["src","assets/nav-icons/timesheet.svg"],[1,"cl-dropdown-menu","cl-dropdown-menu-nav"],["routerLink","/timesheet",1,"cl-dropdown-item","cl-text-uppercase"],["routerLink","/tracker",1,"cl-nav-link","cl-orange"],["src","assets/nav-icons/time-tracker.svg"],["stopwatch-seconds","",4,"ngIf","ngIfElse"],["trackerTemplate",""],["stopwatch-seconds",""],["routerLink","/tracker",1,"cl-dropdown-item","cl-text-uppercase"],["routerLink","/calendar",1,"cl-dropdown-item","cl-text-uppercase"],["routerLink","/dashboard",1,"cl-dropdown-item","cl-text-uppercase"],["reportsLi",""],[1,"cl-z0","cl-nav-link","cl-dropdown-toggle","cl-pink","cl-d-lg-none","pointer",3,"toggleClass","toggleElement"],["src","assets/nav-icons/reports.svg"],["routerLink","/reports/summary",1,"cl-nav-link","cl-dropdown-toggle","cl-pink","cl-d-none","cl-d-lg-flex",3,"queryParams"],[1,"cl-dropdown-menu","cl-pink","cl-dropdown-menu-nav"],["routerLinkActive","cl-active","routerLink","/reports/summary",1,"cl-dropdown-item",3,"queryParams"],["routerLinkActive","cl-active","routerLink","/reports/detailed",1,"cl-dropdown-item",3,"queryParams"],["routerLinkActive","cl-active","routerLink","/reports/weekly",1,"cl-dropdown-item",3,"queryParams"],["routerLinkActive","cl-active","routerLink","/reports/shared",1,"cl-dropdown-item"],[1,"cl-px-3","cl-py-2","cl-d-inline-block","cl-text-uppercase"],[1,"cl-nav-link","cl-pink",3,"routerLink"],["src","assets/nav-icons/activity.svg"],[1,"cl-dropdown-item","cl-text-uppercase",3,"routerLink"],["activityLi",""],[1,"cl-nav-link","cl-dropdown-toggle","cl-pink","cl-d-none","cl-d-lg-flex",3,"routerLink"],["routerLinkActive","cl-active","routerLink","/activity/screenshots",1,"cl-dropdown-item"],["routerLinkActive","cl-active","routerLink","/activity/locations",1,"cl-dropdown-item"],["routerLink","/approvals",1,"cl-nav-link","cl-light-green"],["src","assets/nav-icons/approvals.svg"],["class","cl-text-warning cl-ml-auto cl-mr-3 cl-h1 cl-mb-0 cl-approval-bullet",4,"ngIf"],[1,"cl-text-warning","cl-ml-auto","cl-mr-3","cl-h1","cl-mb-0","cl-approval-bullet"],["routerLink","/approvals",1,"cl-dropdown-item","cl-text-uppercase"],["routerLink","/projects",1,"cl-nav-link","cl-yellow"],["src","assets/nav-icons/projects.svg"],["routerLink","/projects",1,"cl-dropdown-item","cl-text-uppercase"],["routerLink","/teams",1,"cl-nav-link","cl-purple"],["src","assets/nav-icons/teams.svg"],["routerLink","/teams",1,"cl-dropdown-item","cl-text-uppercase"],[1,"cl-nav-link","cl-deep-orange",3,"routerLink"],["src","assets/nav-icons/clients.svg"],[1,"cl-nav-link","cl-deep-purple",3,"routerLink"],["src","assets/nav-icons/tags.svg"],["class","cl-nav-item cl-dropdown",4,"ngIf"],[1,"cl-nav-item","cl-dropdown"],["settingsLi",""],["activeLink","","fragment","settings",1,"cl-nav-link","cl-teal",3,"linkElement","activeFragments","routerLink"],["src","assets/nav-icons/settings.svg"],["routerLink","/invoices",1,"cl-nav-link","cl-green"],["src","assets/nav-icons/invoices"],["routerLink","/invoices",1,"cl-dropdown-item","cl-text-uppercase"],["subscriptionLi",""],["activeLink","","fragment","payment",1,"cl-nav-link","cl-teal",3,"linkElement","activeFragments","routerLink"],["src","assets/nav-icons/subscription.svg"],["fragment","payment",1,"cl-dropdown-item","cl-text-uppercase",3,"routerLink"],["fragment","settings",1,"cl-dropdown-item","cl-text-uppercase",3,"routerLink"]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"button",3,4),c.jc("click",(function(){c.Oc(e);const i=c.Lc(4);return t.setSidebarState(!t.isSidebarOpen),i.blur()})),c.Sb(5,"span",5),c.Wb(),c.Xb(6,"div",6),c.mc(),c.Xb(7,"svg",7),c.jc("click",(function(){return t.navigateToHome()})),c.Sb(8,"path",8),c.Sb(9,"path",9),c.Wb(),c.Wb(),c.Wc(10,dX,2,1,"ng-container",10),c.Wb(),c.lc(),c.Xb(11,"div",11),c.Xb(12,"div",12),c.Wc(13,wX,6,2,"div",13),c.Wb(),c.Wc(14,SX,7,2,"ng-container",10),c.Xb(15,"div",14),c.Wc(16,IX,3,2,"a",15),c.Wc(17,EX,5,1,"div",16),c.Wb(),c.Xb(18,"div",17),c.Xb(19,"div",18,19),c.Xb(22,"a",20),c.Sb(23,"img",21),c.Wc(24,TX,2,1,"span",22),c.Wb(),c.Wc(25,DX,2,1,"div",23),c.Wb(),c.Xb(26,"div",24,25),c.Xb(28,"a",26),c.Sb(29,"avatar",27),c.Wb(),c.Wc(30,NX,27,4,"div",23),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(31,"aside",28),c.Xb(32,"nav",29),c.Xb(33,"div",30),c.Xb(34,"div",31),c.Xb(35,"div",32),c.Xb(36,"button",33,4),c.jc("click",(function(){c.Oc(e);const i=c.Lc(4);return t.setSidebarState(!t.isSidebarOpen),i.blur()})),c.Sb(38,"span",5),c.Wb(),c.Xb(39,"div",6),c.mc(),c.Xb(40,"svg",7),c.jc("click",(function(){return t.navigateToHome()})),c.Sb(41,"path",8),c.Sb(42,"path",9),c.Wb(),c.Wb(),c.Wb(),c.lc(),c.Xb(43,"div",34),c.Xb(44,"div",35),c.Xb(45,"ul",36),c.Wc(46,$X,7,1,"li",37),c.Wc(47,VX,9,3,"li",37),c.Xb(48,"li",38),c.Xb(49,"a",39),c.Xb(50,"span",40),c.Sb(51,"img",41),c.Wb(),c.Xb(52,"span",42),c.Yc(53,"Calendar"),c.Wb(),c.Wb(),c.Wc(54,HX,3,0,"div",43),c.Wb(),c.Xb(55,"li"),c.Sb(56,"hr",44),c.Wb(),c.Xb(57,"li",45),c.Xb(58,"span",46),c.Xb(59,"span",47),c.Yc(60,"Analyze"),c.Wb(),c.Wb(),c.Wb(),c.Xb(61,"li",38),c.Xb(62,"a",48),c.Xb(63,"span",40),c.Sb(64,"img",49),c.Wb(),c.Xb(65,"span",42),c.Yc(66,"Dashboard"),c.Wb(),c.Wb(),c.Wc(67,zX,3,0,"div",43),c.Wb(),c.Wc(68,KX,22,6,"li",37),c.Wc(69,nE,3,2,"ng-container",10),c.Wc(70,sE,7,4,"ng-container",10),c.Wc(71,oE,8,2,"li",37),c.Wc(72,lE,7,1,"li",37),c.Wc(73,uE,7,1,"li",37),c.Wc(74,IE,25,16,"ng-container",10),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(75,"div",50),c.jc("click",(function(){return t.setSidebarState(!1)})),c.Wb(),c.Wb(),c.Wb()}2&e&&(c.Cb(10),c.wc("ngIf",!t.isSelfHosted&&!t.isForbiddenZone),c.Cb(3),c.wc("ngIf",!t.isSubdomain),c.Cb(1),c.wc("ngIf",t.showUpgradeLink),c.Cb(2),c.wc("ngIf",1===(null==t.supportLinks?null:t.supportLinks.length)),c.Cb(1),c.wc("ngIf",(null==t.supportLinks?null:t.supportLinks.length)>1),c.Cb(7),c.wc("ngIf",t.unreadNotifications||t.newsNotifications),c.Cb(5),c.wc("classSize","cl-no-image-wrapper-sm")("src",null==t.user?null:t.user.profilePicture)("name",null==t.user?null:t.user.name),c.Cb(2),c.Hb("cl-get-out",!t.isSidebarOpen),c.Cb(2),c.Hb("cl-open",t.isSidebarOpen),c.Cb(13),c.wc("ngIf",null==t.workspace?null:t.workspace.canSeeTimeSheet),c.Cb(1),c.wc("ngIf",null==t.workspace?null:t.workspace.canSeeTracker),c.Cb(7),c.wc("ngIf",t.isDesktop&&!t.isSidebarOpen),c.Cb(2),c.Hb("cl-d-none",t.isSidebarOpen),c.Cb(1),c.Hb("cl-d-none",!t.isSidebarOpen),c.Cb(10),c.wc("ngIf",t.isDesktop&&!t.isSidebarOpen),c.Cb(1),c.wc("ngIf",-1==(null==t.workspace?null:t.workspace.adminOnlyPages.indexOf("REPORTS"))||t.isAdmin||t.isTeamManager||t.isProjectManager),c.Cb(1),c.wc("ngIf",t.showActivityLink),c.Cb(1),c.wc("ngIf",t.isAdmin||t.showApprovalLink||t.showProjectLink||t.showTeamLink),c.Cb(1),c.wc("ngIf",t.showApprovalLink),c.Cb(1),c.wc("ngIf",t.showProjectLink),c.Cb(1),c.wc("ngIf",t.showTeamLink),c.Cb(1),c.wc("ngIf",t.isAdmin),c.Cb(1),c.Hb("cl-open",t.isSidebarOpen))},directives:[s.u,Si.a,Ii.a,Oi.a,Ds.a,W.e,W.f,g.Z,s.t,s.r,tX,p.a,p.s,p.v,ip,iX,nX],encapsulation:2,changeDetection:0}),e})();function XE(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",4),c.Xb(1,"div",5),c.Yc(2),c.Xb(3,"a",6),c.jc("click",(function(){return c.Oc(e),c.nc().switchBack()})),c.Yc(4,"Log out"),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.ad(" You're currently logged in as ",e.loggedInAsUsername," ")}}let EE=(()=>{class e{constructor(e,t,i,s,c,r,o,a,l,b){this.router=e,this.browserService=t,this.navigationService=i,this.viewportScroller=s,this.authService=c,this.cd=r,this.syncService=o,this.sidebarStateService=a,this.originalOwnerService=l,this.sidebarScrollService=b,this.unsubscribe$=new Ee.a,this.toasterConfig=new n.a({positionClass:"toast-bottom-right",showCloseButton:!0,iconClasses:{success:"cl2-d-lg-none",error:"d-lg-none",warning:"d-lg-none"}})}ngOnInit(){this.syncService.start(),this.browserService.isBreakpointLg$.pipe(Object(Cp.a)(),Object(De.a)(this.unsubscribe$)).subscribe(e=>{const t=this.isDesktop&&!e;this.isDesktop=e,t&&this.sidebarStateService.setSidebar(!1),this.setBodyScroll(),this.calculateHeight()}),this.browserService.onHeightResize$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.calculateHeight()}),this.navigationService.currentRoute.pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>this.viewportScroller.scrollToPosition([0,0])),this.checkLoggedInUser(),this.subscribeToSidebarState(),this.sidebarScrollService.addScrollListener()}ngOnDestroy(){this.sidebarScrollService.removeScrollListener(),this.sidebarScrollService.enableBodyScroll(),this.syncService.stop(),this.unsubscribe$.next(!0),this.unsubscribe$.complete()}checkLoggedInUser(){this.originalOwnerService.getOwner()&&(this.loggedInAsUsername=this.authService.getUser().name)}subscribeToSidebarState(){this.sidebarStateService.sidebarState$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isSidebarOpen=e,this.cd.markForCheck(),this.setBodyScroll()})}switchBack(){this.authService.switchBackToAccount()}setBodyScroll(){this.isSidebarOpen&&!this.isDesktop?this.sidebarScrollService.disableBodyScroll():this.sidebarScrollService.enableBodyScroll()}calculateHeight(){if(!this.isDesktop)return void(this.minHeight="100vh");const e=window.innerHeight;this.minHeight=e<750?"750px":"100vh"}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.c),c.Rb(pi.a),c.Rb(Zc.a),c.Rb(s.J),c.Rb(Ce.a),c.Rb(c.h),c.Rb(Hd.a),c.Rb(Qd),c.Rb(EO.a),c.Rb(Zd))},e.\u0275cmp=c.Lb({type:e,selectors:[["default-layout"]],decls:6,vars:6,consts:[[1,"cl-main-wrapper"],["id","layout-main",1,"cl-layout-main"],["class","cl-fixed-bottom",4,"ngIf"],[3,"toasterconfig"],[1,"cl-fixed-bottom"],[1,"cl-alert","cl-alert-info","cl-mb-0"],[1,"cl-btn",3,"click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Sb(1,"sidebar-and-topbar"),c.Xb(2,"main",1),c.Wc(3,XE,5,1,"div",2),c.Sb(4,"router-outlet"),c.Wb(),c.Wb(),c.Sb(5,"toaster-container",3)),2&e&&(c.Cb(2),c.Vc("min-height",t.minHeight),c.Hb("cl-sidebar-layout-open",!t.isSidebarOpen),c.Cb(1),c.wc("ngIf",t.loggedInAsUsername),c.Cb(2),c.wc("toasterconfig",t.toasterConfig))},directives:[OE,s.u,W.h,n.b],encapsulation:2}),e})();function TE(e,t){1&e&&c.Tb(0)}function DE(e,t){if(1&e&&(c.Xb(0,"a",12),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.zc("routerLink","/workspaces/",e.webhook.workspaceId,"/webhooks/",e.webhook.id,""),c.Cb(1),c.ad(" ",e.webhook.name," ")}}function RE(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"span",13),c.Yc(2," Inactive "),c.Wb(),c.Xb(3,"span",14),c.Yc(4),c.Wb(),c.Ub()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngbTooltip","Only workspace admins can have active webhooks."),c.Cb(3),c.ad(" ",e.webhook.name," ")}}function AE(e,t){if(1&e&&(c.Xb(0,"div",8),c.Xb(1,"div",9),c.Wc(2,DE,2,3,"a",10),c.Wc(3,RE,5,2,"ng-container",11),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.wc("ngIf",e.webhook.enabled),c.Cb(1),c.wc("ngIf",!e.webhook.enabled)}}function jE(e,t){if(1&e&&(c.Xb(0,"div",15),c.Xb(1,"div",16),c.Xb(2,"div",9),c.Yc(3),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(3),c.Zc(e.webhook.webhookEventLabel)}}function xE(e,t){if(1&e&&(c.Xb(0,"div",15),c.Xb(1,"div",16),c.Xb(2,"div",9),c.Yc(3),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(3),c.Zc(e.webhook.url)}}function PE(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",17),c.Xb(1,"div",15),c.Xb(2,"div",18),c.Sb(3,"input",19),c.Xb(4,"div",20),c.Xb(5,"button",21),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.authInputType="password"==t.authInputType?"text":"password"})),c.Sb(6,"img",22),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.xc("type",e.authInputType),c.xc("value",e.webhook.authToken)}}function ME(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"a",31),c.jc("click",(function(){return c.Oc(e),c.nc(3).emitEdit()})),c.Yc(2,"Edit"),c.Wb(),c.Sb(3,"div",32),c.Ub()}}function YE(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",28),c.Xb(1,"div",29),c.Wc(2,ME,4,0,"ng-container",11),c.Xb(3,"a",30),c.jc("click",(function(){return c.Oc(e),c.nc(2).emitDelete()})),c.Yc(4,"Delete"),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(2),c.wc("ngIf",e.webhook.enabled)}}function LE(e,t){1&e&&(c.Xb(0,"div",23),c.Xb(1,"div",24),c.Xb(2,"div",25),c.Sb(3,"img",26),c.Wb(),c.Wc(4,YE,5,1,"div",27),c.Wb(),c.Wb())}const FE=function(){return["Name","Event","URL","Siging secret",""]},NE=function(e){return{labels:e}},UE=function(e,t,i,n,s){return[e,t,i,n,s]};let $E=(()=>{class e{constructor(e){this.cd=e,this.authInputType="password",this.edit=new c.n,this.delete=new c.n}ngAfterViewInit(){this.cd.detectChanges()}emitEdit(){this.edit.emit()}emitDelete(){this.delete.emit()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["webhook-row"],["","webhook-row",""]],inputs:{webhook:"webhook",isDesktop:"isDesktop"},outputs:{edit:"edit",delete:"delete"},decls:13,vars:14,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-d-none",3,"isDesktop","isExpanded","templates"],["responsive",""],["col1",""],["col2",""],["col3",""],["col4",""],["col5",""],[1,"cl-py-0","cl-py-lg-custom-2","cl-pl-lg-2","cl-pl-lg-custom-0","cl-pr-2","cl-cut-text-wrapper","cl-responsive-table-main-item"],[1,"cl-cut-text"],["class","cl-text-dark",3,"routerLink",4,"ngIf"],[4,"ngIf"],[1,"cl-text-dark",3,"routerLink"],[1,"cl-badge","cl-badge-danger","cl-cursor-default","cl-no-hover","cl-mr-2",3,"ngbTooltip"],[1,"cl-text-dark"],[1,"cl-component-divided-left","cl-w-100"],[1,"cl-cut-text-wrapper"],[1,"cl-p-0","cl-lh-0"],[1,"cl-input-group","cl-input-group-sm"],["readonly","",1,"cl-form-control","tr-reset-min-h",3,"type","value"],[1,"cl-input-group-append"],["type","button",1,"cl-btn","cl-btn-outline-light",3,"click"],["src","assets/images/ui-icons/eye.svg"],[1,"cl-p-0"],["dropdownKey","",1,"cl-dropdown","cl-d-flex","cl-justify-content-end"],["role","button","dropdownKeyButton","",1,"cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow","pointer"],["src","assets/images/ui-icons/menu-dots-vertical.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area"],["clickCloseDropdown","",1,"cl-dropdown-item","cl-text-danger",3,"click"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],[1,"cl-dropdown-divider"]],template:function(e,t){if(1&e&&(c.Wc(0,TE,1,0,"ng-container",0),c.Sb(1,"responsive-row",1,2),c.Wc(3,AE,4,2,"ng-template",null,3,c.Xc),c.Wc(5,jE,4,1,"ng-template",null,4,c.Xc),c.Wc(7,xE,4,1,"ng-template",null,5,c.Xc),c.Wc(9,PE,7,2,"ng-template",null,6,c.Xc),c.Wc(11,LE,5,0,"ng-template",null,7,c.Xc)),2&e){const e=c.Lc(2),i=c.Lc(4),n=c.Lc(6),s=c.Lc(8),r=c.Lc(10),o=c.Lc(12);c.wc("ngTemplateOutlet",e.template)("ngTemplateOutletContext",c.Bc(6,NE,c.Ac(5,FE))),c.Cb(1),c.wc("isDesktop",t.isDesktop)("isExpanded",!1)("templates",c.Fc(8,UE,i,n,s,r,o))}},directives:[s.B,Fi.a,s.u,W.f,g.Z,Si.a,Ii.a,Oi.a],encapsulation:2,changeDetection:0}),e})();class _E{constructor(e,t,i,n,s=[]){this.name=e,this.url=t,this.webhookEvent=i,this.triggerSourceType=n,this.triggerSource=s}}function GE(e,t){if(1&e&&(c.Xb(0,"label"),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.Zc(e.title)}}function BE(e,t){if(1&e&&(c.Xb(0,"div",11),c.Yc(1),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(1),c.ad(" ",e.label," ")}}function VE(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",12),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).setSelected(i.entity)})),c.Yc(1),c.Wb()}if(2&e){const e=t.$implicit;c.Cb(1),c.ad(" ",(null==e.entity?null:e.entity.label)||e.entity," ")}}const HE=function(e){return{"cl-dropdown-section":e}};function zE(e,t){if(1&e&&(c.Xb(0,"div",7),c.Xb(1,"div",8),c.Wc(2,BE,2,1,"div",9),c.Wc(3,VE,2,1,"a",10),c.Wb(),c.Wb()),2&e){const e=t.$implicit;c.Cb(1),c.wc("ngClass",c.Bc(3,HE,!e.hideTitle)),c.Cb(1),c.wc("ngIf",!e.hideTitle),c.Cb(1),c.wc("ngForOf",e.value)}}function qE(e,t){if(1&e&&(c.Xb(0,"div",4),c.Xb(1,"div",5),c.Wc(2,zE,4,5,"div",6),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Hb("cl-dropdown-menu-right",e.positionRight),c.Cb(2),c.wc("ngForOf",null==e.groupsOfSelectables?null:e.groupsOfSelectables.maps)}}var KE=function(e){return e.STANDARD="STANDARD",e.SMALL="SMALL",e.TEXT="TEXT",e.DROPDOWN="DROPDOWN",e}({});let ZE=(()=>{class e{constructor(e){this.cd=e,this.type=KE.STANDARD,this.isDisabled=!1,this.configClasses={[KE.STANDARD]:"cl-btn cl-btn-outline-light cl-w-100 cl-text-left cl-dropdown-toggle cl-cut-text pointer",[KE.SMALL]:"cl-btn cl-btn-sm cl-btn-outline-light cl-dropdown-toggle pointer",[KE.TEXT]:"cl-dropdown-link-text",[KE.DROPDOWN]:"cl-w-100 cl-text-left pointer cl-dropdown-toggle cl-cut-text"},this.onChange=()=>{},this.onTouched=()=>{}}set groupsOfSelectables(e){this._groupsOfSelectables=e}get groupsOfSelectables(){return this._groupsOfSelectables}set value(e){this._value=e,this.onChange(e),this.onTouched()}get value(){return this._value}ngOnInit(){this.selectedLabel=this.value?this.value.label:this.initLabel,this.classes=this.configClasses[this.type]||""}setSelected(e){this.value=e.id,this.selectedLabel=e.label}writeValue(e){e&&(this.value=e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["dropdown-item-groups"]],inputs:{groupsOfSelectables:"groupsOfSelectables",value:"value",initLabel:"initLabel",type:"type",title:"title",isDisabled:"isDisabled"},features:[c.Bb([{provide:p.q,useExisting:Object(c.U)(()=>e),multi:!0}])],decls:5,vars:4,consts:[[4,"ngIf"],[1,"cl-dropdown",3,"dropdownKey"],["tabindex","0","dropdownKeyButton","",3,"ngClass","click"],["class","cl-dropdown-menu","openUpAtBottom","",3,"cl-dropdown-menu-right",4,"dropdownKeyContent"],["openUpAtBottom","",1,"cl-dropdown-menu"],[1,"cl-scroll-area"],["class","cl-dropdown-section-wrapper",4,"ngFor","ngForOf"],[1,"cl-dropdown-section-wrapper"],[3,"ngClass"],["class","cl-dropdown-header cl-h5",4,"ngIf"],["class","cl-dropdown-item cl-cut-text","clickCloseDropdown","",3,"click",4,"ngFor","ngForOf"],[1,"cl-dropdown-header","cl-h5"],["clickCloseDropdown","",1,"cl-dropdown-item","cl-cut-text",3,"click"]],template:function(e,t){1&e&&(c.Wc(0,GE,2,1,"label",0),c.Xb(1,"div",1),c.Xb(2,"span",2),c.jc("click",(function(){return t.onTouched()})),c.Yc(3),c.Wb(),c.Wc(4,qE,3,3,"div",3),c.Wb()),2&e&&(c.wc("ngIf",t.title),c.Cb(1),c.wc("dropdownKey",t.isDisabled),c.Cb(1),c.wc("ngClass",t.classes),c.Cb(1),c.Zc(t.selectedLabel))},directives:[s.u,Si.a,Ii.a,s.r,Oi.a,s.t],encapsulation:2,changeDetection:0}),e})();function QE(e,t){1&e&&(c.Xb(0,"small",18),c.Yc(1," Name must be between 2 and 30 characters. "),c.Wb())}function JE(e,t){1&e&&(c.Xb(0,"small",18),c.Yc(1," Enter a valid URL. "),c.Wb())}function eT(e,t){1&e&&(c.Xb(0,"small",18),c.Yc(1," Event must be selected. "),c.Wb())}function tT(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",7),c.Xb(1,"div",19),c.Xb(2,"label"),c.Yc(3,"Signing secret"),c.Wb(),c.Xb(4,"a",20),c.jc("click",(function(){return c.Oc(e),c.nc().generateNewToken()})),c.Yc(5,"Reset signing secret"),c.Wb(),c.Wb(),c.Xb(6,"div",21),c.Sb(7,"input",22),c.Xb(8,"div",23),c.Xb(9,"button",24),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.tokenFieldType="password"==t.tokenFieldType?"text":"password"})),c.Sb(10,"img",25),c.Wb(),c.Wb(),c.Wb(),c.Xb(11,"small",26),c.Yc(12,"Signing secret changed"),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(7),c.xc("type",e.tokenFieldType),c.xc("value",null==e.webhook?null:e.webhook.authToken),c.Cb(4),c.wc("hidden",!e.signingCopyVisible)}}let iT=(()=>{class e{constructor(e,t){this.webhookService=e,this.dropdownCheckboxParamBuilder=t,this.close=new c.n,this.signingSecretChanged=new c.n,this.tokenFieldType="password",this.signingCopyVisible=!1,this.waitingForResponse=!1,this.unsubscribe$=new Ee.a}get name(){return this.webhookForm.get("name")}get url(){return this.webhookForm.get("url")}get event(){return this.webhookForm.get("event")}ngOnInit(){this.webhookEvents=this.getSelectableMapOfEvents(),this.webhookForm=new p.j({name:new p.g(this.webhook&&this.webhook.name||"",[on.a.required,on.a.maxLength(30),on.a.minLength(2)]),url:new p.g(this.webhook&&this.webhook.url||"",[on.a.required]),event:new p.g(this.webhook&&{event:this.webhook.webhookEvent,triggerSourceType:this.webhook.triggerSourceType}||"",p.G.required)}),this.webhookForm.get("event").valueChanges.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>this.onEventChanged(e))}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}closeModalWindow(){this.close.emit(!1)}createOrModifyWebhook(){this.waitingForResponse=!0;const e=this.webhookForm.value,t=new _E(e.name.trim(),e.url.trim(),e.event.event,e.event.triggerSourceType);this.webhook?this.webhookService.update(this.workspace.id,this.webhook.id,t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>this.close.emit(e)):this.webhookService.create(this.workspace.id,t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>this.close.emit(e)),this.waitingForResponse=!1}getSelectableMapOfEvents(){return new Jt.a([{webhookEvent:$t.NEW_TIMER_STARTED,triggerSourceType:Vt.USER_ID},{webhookEvent:$t.NEW_TIMER_STARTED,triggerSourceType:Vt.WORKSPACE_ID},{webhookEvent:$t.TIMER_STOPPED,triggerSourceType:Vt.USER_ID},{webhookEvent:$t.TIMER_STOPPED,triggerSourceType:Vt.WORKSPACE_ID},{webhookEvent:$t.NEW_TIME_ENTRY,triggerSourceType:Vt.USER_ID},{webhookEvent:$t.NEW_TIME_ENTRY,triggerSourceType:Vt.WORKSPACE_ID},{webhookEvent:$t.TIME_ENTRY_UPDATED,triggerSourceType:Vt.USER_ID},{webhookEvent:$t.TIME_ENTRY_UPDATED,triggerSourceType:Vt.WORKSPACE_ID},{webhookEvent:$t.TIME_ENTRY_DELETED,triggerSourceType:Vt.USER_ID},{webhookEvent:$t.TIME_ENTRY_DELETED,triggerSourceType:Vt.WORKSPACE_ID},{webhookEvent:$t.NEW_CLIENT,triggerSourceType:Vt.WORKSPACE_ID},{webhookEvent:$t.NEW_PROJECT,triggerSourceType:Vt.WORKSPACE_ID},{webhookEvent:$t.NEW_TASK,triggerSourceType:Vt.WORKSPACE_ID},{webhookEvent:$t.NEW_TAG,triggerSourceType:Vt.WORKSPACE_ID}].map(({webhookEvent:e,triggerSourceType:t})=>{const i={id:{event:e,triggerSourceType:t},label:""+Bt(e,t)};return new dv.a(i.label,[i],{hideTitle:!0})}))}onEventChanged(e){}generateNewToken(){this.webhookService.generateNewToken(this.workspace.id,this.webhook.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.webhook=e,this.signingCopyVisible=!0,this.signingSecretChanged.emit({id:this.webhook.id,authToken:this.webhook.authToken}),setTimeout(()=>this.signingCopyVisible=!1,2e3)})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Zt),c.Rb(li))},e.\u0275cmp=c.Lb({type:e,selectors:[["new-webhook"]],inputs:{workspace:"workspace",webhook:"webhook",isAdminOrOwner:"isAdminOrOwner"},outputs:{close:"close",signingSecretChanged:"signingSecretChanged"},decls:29,vars:11,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[3,"formGroup","ngSubmit"],[1,"cl-modal-body"],[1,"cl-form-group"],["for","name"],["formControlName","name","id","name","name","name","type","text","placeholder","Enter webhook name","ngbAutofocus","","autocomplete","off",1,"cl-form-control"],["class","cl-form-text cl-text-danger",4,"ngIf"],["for","url"],["formControlName","url","id","url","name","url","type","url","placeholder","https://example.com/endpoint","autocomplete","off",1,"cl-form-control"],["formControlName","event",3,"groupsOfSelectables","initLabel"],["class","cl-form-group",4,"ngIf"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-form-text","cl-text-danger"],[1,"cl-d-flex","cl-justify-content-between"],[1,"cl-small",3,"click"],[1,"cl-input-group"],["readonly","",1,"cl-form-control",3,"type","value"],[1,"cl-input-group-append"],["type","button",1,"cl-btn","cl-btn-outline-light",3,"click"],["src","assets/images/ui-icons/eye.svg"],[1,"cl-form-text","cl-text-success",3,"hidden"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.closeModalWindow()})),c.Xb(4,"span",3),c.Sb(5,"img",4),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"form",5),c.jc("ngSubmit",(function(){return t.createOrModifyWebhook()})),c.Xb(7,"div",6),c.Xb(8,"div",7),c.Xb(9,"label",8),c.Yc(10,"Name"),c.Wb(),c.Sb(11,"input",9),c.Wc(12,QE,2,0,"small",10),c.Wb(),c.Xb(13,"div",7),c.Xb(14,"label",11),c.Yc(15,"Endpoint URL"),c.Wb(),c.Sb(16,"input",12),c.Wc(17,JE,2,0,"small",10),c.Wb(),c.Xb(18,"div",7),c.Xb(19,"label"),c.Yc(20,"Event"),c.Wb(),c.Sb(21,"dropdown-item-groups",13),c.Wc(22,eT,2,0,"small",10),c.Wb(),c.Wc(23,tT,13,3,"div",14),c.Wb(),c.Xb(24,"div",15),c.Xb(25,"a",16),c.jc("click",(function(){return t.closeModalWindow()})),c.Yc(26,"Cancel"),c.Wb(),c.Xb(27,"button",17),c.Yc(28),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(2),c.bd("",t.webhook?"Edit":"Create"," webhook on ",t.workspace.name,""),c.Cb(4),c.wc("formGroup",t.webhookForm),c.Cb(6),c.wc("ngIf",t.name.invalid&&(t.name.dirty||t.name.touched)),c.Cb(5),c.wc("ngIf",t.url.invalid&&(t.url.dirty||t.url.touched)),c.Cb(4),c.wc("groupsOfSelectables",t.webhookEvents)("initLabel",(null==t.webhook?null:t.webhook.webhookEventLabel)||"Select event..."),c.Cb(1),c.wc("ngIf",t.event.invalid&&(t.event.dirty||t.event.touched)),c.Cb(1),c.wc("ngIf",t.webhook),c.Cb(4),c.wc("disabled",t.webhookForm.invalid||t.waitingForResponse),c.Cb(1),c.Zc(t.webhook?"Save":"Create"))},directives:[p.I,p.t,p.k,p.c,p.s,p.i,s.u,ZE],encapsulation:2}),e})();function nT(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",36),c.Xb(2,"tr",37),c.jc("edit",(function(){c.Oc(e);const i=t.$implicit,n=c.nc(),s=c.Lc(57);return n.openModal(s,i)}))("delete",(function(){c.Oc(e);const i=t.$implicit,n=c.nc(),s=c.Lc(59);return n.openModal(s,i)})),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=t.$implicit,i=c.nc();c.Cb(2),c.wc("isDesktop",i.isDesktop)("webhook",e)}}function sT(e,t){if(1&e){const e=c.Yb();c.Xb(0,"new-webhook",38),c.jc("signingSecretChanged",(function(t){return c.Oc(e),c.nc().updateSigningSecret(t)}))("close",(function(i){c.Oc(e);const n=t.$implicit,s=c.nc();return n.close(i),s.createOrModifyWebhookClosed(i)})),c.Wb()}if(2&e){const e=c.nc();c.wc("isAdminOrOwner",e.adminOrOwnerWorkspaces.has(e.selectedWorkspace.id))("workspace",e.selectedWorkspace)("webhook",e.selectedWebhook)}}function cT(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",39),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().delete(i)}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Xb(1,"p",40),c.Yc(2),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Delete")("isDanger",!0)("btnText","Delete")("inProgress",e.isDeleting),c.Cb(2),c.bd(" Are you sure you want to delete '",null==e.selectedWebhook?null:e.selectedWebhook.webhookEvent," ",null==e.selectedWebhook?null:e.selectedWebhook.triggerSourceType,"' webhook? ")}}function rT(e,t){1&e&&(c.Vb(0),c.Yc(1," Only workspace admins can create webhooks. "),c.Ub())}function oT(e,t){1&e&&c.Yc(0," Limit is reached. ")}function aT(e,t){if(1&e&&(c.Wc(0,rT,2,0,"ng-container",41),c.Wc(1,oT,1,0,"ng-template",null,42,c.Xc)),2&e){const e=c.Lc(2),t=c.nc();c.wc("ngIf",!t.adminOrOwnerWorkspaces.has(t.selectedWorkspace.id))("ngIfElse",e)}}const lT=function(){return["/user/settings"]};let bT=(()=>{class e{constructor(e,t,i,n,s,c){this.webhookService=e,this.workspaceService=t,this.modalService=i,this.browserService=n,this.subdomainService=s,this.cd=c,this.unsubscribe$=new mi.a,this.webhooks=[],this.workspacesForDropdown=[],this.adminOrOwnerWorkspaces=new Set,this.isDesktop=!1}ngOnInit(){this.subdomainService.isSubdomainNotSelfhosted()&&this.workspaceService.getPermissionsForUserOnWorkspaces([this.workspaceService.getDefaultWorkspaceId()]),this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.selectedWorkspace=e,this.getForWorkspace(this.selectedWorkspace.id)}),this.workspaceService.workspaces$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspaces=e,this.workspacesForDropdown=e.map(e=>new di.a(e.id,e.name)),this.workspaceService.getPermissionsForUserOnWorkspaces(e.map(e=>e.id))}),this.workspaceService.workspacesPermissionsForUser.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{e.forEach(e=>{e.hasAdminPermission()&&this.adminOrOwnerWorkspaces.add(e.objectId)})}),this.browserService.isBreakpointLgCustom$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.detectChanges()})}get canCreate(){return!(!this.adminOrOwnerWorkspaces.has(this.selectedWorkspace.id)||this.webhooks.length>=10||this.workspaceWebhookCount>=100)}getForWorkspace(e){this.inProgress=!0,this.webhookService.getForWorkspace(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(({webhooks:e,workspaceWebhookCount:t})=>{this.webhooks=e,this.workspaceWebhookCount=t,this.inProgress=!1,this.cd.detectChanges()},()=>this.inProgress=!1)}openModal(e,t){this.selectedWebhook=t,this.modalService.open(e,{centered:!0})}showAdminTooltip(e){e.open()}createOrModifyWebhookClosed(e){if(e){if(this.selectedWebhook){const t=this.webhooks.findIndex(t=>t.id==e.id);return this.webhooks[t]=e,this.cd.detectChanges(),void(this.selectedWebhook=void 0)}this.webhooks.unshift(e),this.cd.detectChanges()}}workspaceChange({value:e}){this.selectedWorkspace=this.workspaces.find(t=>t.id==e),this.getForWorkspace(this.selectedWorkspace.id)}delete(e){this.isDeleting=!0,this.webhookService.delete(this.selectedWorkspace.id,this.selectedWebhook.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{const i=this.webhooks.find(e=>e.id==this.selectedWebhook.id);this.webhooks.splice(this.webhooks.indexOf(i),1),e.close(),this.isDeleting=!1,this.cd.detectChanges()},()=>{this.isDeleting=!1,this.cd.detectChanges()})}updateSigningSecret(e){const t=this.webhooks.findIndex(t=>t.id==e.id);this.webhooks[t].authToken=e.authToken,this.cd.detectChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Zt),c.Rb(U.a),c.Rb(g.q),c.Rb(pi.a),c.Rb(fa.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["webhooks"]],decls:62,vars:11,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-end"],[1,"cl-col-auto"],[1,"cl-breadcrumb","cl-p-0","cl-mb-2","cl-bg-transparent","cl-ml-0"],[1,"cl-breadcrumb-item"],[3,"routerLink"],[1,"cl-mb-2","cl-mb-lg-0"],[1,"cl-col"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end"],["triggers","manual","placement","left",1,"cl-btn","cl-btn-outline-primary",3,"disabled","ngbPopover","click"],["createPopupPopover","ngbPopover"],[1,"cl-card"],[1,"cl-card-body"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-d-flex","cl-align-items-center"],[3,"list","placeholder","value","onChangedDropdown"],[1,"cl-pl-2"],[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-text-dark"],[1,"cl-d-inline-block","cl-mx-1"],["data-toggle-column","last",1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6"],[3,"hidden"],[1,"cl-pl-lg-3",2,"width","30%"],[1,"cl-h5","cl-mb-0"],[2,"width","20%"],[1,"cl-ml-lg-custom-n2"],[2,"width","46px"],[1,"cl-h5","cl-mb-0","cl-text-lg-custom-right","cl-d-block","cl-d-lg-custom-none"],[4,"ngFor","ngForOf"],["modalCreateOrModifyWebhook",""],["modalDeleteWebhook",""],["createPopupTemplate",""],[1,"cl-row-hover-shadow"],["webhook-row","",3,"isDesktop","webhook","edit","delete"],[3,"isAdminOrOwner","workspace","webhook","signingSecretChanged","close"],[3,"title","isDanger","btnText","inProgress","confirmed","close"],[1,"cl-cut-text-wrap"],[4,"ngIf","ngIfElse"],["limitTemplate",""]],template:function(e,t){if(1&e){const e=c.Yb();c.Xb(0,"main",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"nav"),c.Xb(6,"ol",5),c.Xb(7,"li",6),c.Xb(8,"a",7),c.Yc(9,"Profile settings"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(10,"h1",8),c.Yc(11,"Webhooks"),c.Wb(),c.Wb(),c.Xb(12,"div",9),c.Xb(13,"div",10),c.Xb(14,"button",11,12),c.jc("click",(function(){c.Oc(e);const i=c.Lc(15),n=c.Lc(57);return!t.canCreate&&t.showAdminTooltip(i),t.canCreate&&t.openModal(n)})),c.Yc(16,"Create new"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(17,"div",13),c.Xb(18,"div",14),c.Xb(19,"div",15),c.Xb(20,"div",16),c.Xb(21,"dropdown-items",17),c.jc("onChangedDropdown",(function(e){return t.workspaceChange(e)})),c.Wb(),c.Xb(22,"span",18),c.Yc(23),c.Wb(),c.Wb(),c.Wb(),c.Xb(24,"div",19),c.Xb(25,"div",20),c.Xb(26,"div",21),c.Xb(27,"span",22),c.Yc(28,"Your webhooks"),c.Wb(),c.Xb(29,"span",23),c.Yc(30,"-"),c.Wb(),c.Xb(31,"span"),c.Yc(32),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(33,"table",24),c.Xb(34,"thead",25),c.Xb(35,"tr"),c.Xb(36,"th",26),c.Xb(37,"div",27),c.Yc(38,"Name"),c.Wb(),c.Wb(),c.Xb(39,"th",28),c.Xb(40,"div",29),c.Xb(41,"div",27),c.Yc(42,"Event"),c.Wb(),c.Wb(),c.Wb(),c.Xb(43,"th",28),c.Xb(44,"div",29),c.Xb(45,"div",27),c.Yc(46,"URL"),c.Wb(),c.Wb(),c.Wb(),c.Xb(47,"th"),c.Xb(48,"div",29),c.Xb(49,"div",27),c.Yc(50,"Signing secret"),c.Wb(),c.Wb(),c.Wb(),c.Xb(51,"th",30),c.Xb(52,"div",31),c.Yc(53,"Edit"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(54,"tbody"),c.Wc(55,nT,3,2,"ng-container",32),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(56,sT,1,3,"ng-template",null,33,c.Xc),c.Wc(58,cT,3,6,"ng-template",null,34,c.Xc),c.Wc(60,aT,3,2,"ng-template",null,35,c.Xc)}if(2&e){const e=c.Lc(61);c.Cb(8),c.wc("routerLink",c.Ac(10,lT)),c.Cb(6),c.wc("disabled",t.inProgress)("ngbPopover",e),c.Cb(7),c.wc("list",t.workspacesForDropdown)("placeholder","Search workspace...")("value",t.selectedWorkspace.name),c.Cb(2),c.ad(" (",t.workspaceWebhookCount," out of 100) "),c.Cb(9),c.ad("",t.webhooks.length," out of 10"),c.Cb(2),c.wc("hidden",!t.isDesktop),c.Cb(21),c.wc("ngForOf",t.webhooks)}},directives:[W.f,g.L,pn.a,s.t,$E,iT,Ui.a,s.u],encapsulation:2,changeDetection:0}),e})();var uT=i("yUBi");function dT(e,t){if(1&e&&(c.Xb(0,"textarea",19),c.Yc(1),c.oc(2,"prettyJson"),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.Zc(c.pc(2,1,e.log.responseBody))}}function pT(e,t){1&e&&(c.Xb(0,"span"),c.Yc(1,"No response body"),c.Wb())}function hT(e,t){if(1&e&&(c.Xb(0,"div",10),c.Xb(1,"div",11),c.Xb(2,"div",1),c.Xb(3,"div",2),c.Xb(4,"span",12),c.Yc(5,"Https status"),c.Wb(),c.Wb(),c.Xb(6,"div",6),c.Xb(7,"span"),c.Yc(8),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(9,"div",11),c.Xb(10,"div",13),c.Xb(11,"div",14),c.Xb(12,"span",12),c.Yc(13,"Response"),c.Wb(),c.Wb(),c.Xb(14,"div",15),c.Wc(15,dT,3,3,"textarea",16),c.Wc(16,pT,2,0,"span",17),c.Wb(),c.Wb(),c.Wb(),c.Xb(17,"div",18),c.Xb(18,"div",13),c.Xb(19,"div",14),c.Xb(20,"span",12),c.Yc(21,"Request to your endpoint"),c.Wb(),c.Wb(),c.Xb(22,"div",15),c.Xb(23,"textarea",19),c.Yc(24),c.oc(25,"prettyJson"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(8),c.Zc(e.log.statusCode),c.Cb(7),c.wc("ngIf",e.log.responseBody),c.Cb(1),c.wc("ngIf",!e.log.responseBody),c.Cb(8),c.Zc(c.pc(25,4,e.log.requestBody))}}let mT=(()=>{class e{constructor(e){this.cd=e,this.isExpanded=!1,this.resend=new c.n}ngAfterViewInit(){this.cd.detectChanges()}emitResend(){this.resend.emit()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["webhook-log-row"],["","webhook-log-row",""]],inputs:{log:"log"},outputs:{resend:"resend"},decls:15,vars:6,consts:[[1,"cl-component-row","cl-border-bottom","cl-pr-0"],[1,"cl-row","cl-w-100"],[1,"cl-col-6","cl-col-lg-4","cl-d-flex","cl-align-items-center"],[1,"cl-badge-same-entries-wrapper"],[1,"cl-badge","cl-badge-same-entries","cl-ml-0",3,"click"],["src","assets/images/ui-icons/chevron-down.svg"],[1,"cl-col-auto","cl-d-flex","cl-align-items-center"],[1,"cl-col-auto","cl-ml-auto","cl-mr-n2","cl-mr-lg-0","cl-d-flex","cl-align-items-center"],[1,"cl-btn","cl-btn-sm","cl-btn-outline-light",3,"click"],["class","cl-bg-light cl-border-bottom",4,"ngIf"],[1,"cl-bg-light","cl-border-bottom"],[1,"cl-component-row","cl-border-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-text-gray-9","cl-text-uppercase"],[1,"cl-row","cl-w-100","cl-align-items-start"],[1,"cl-col-12","cl-col-lg-4","cl-d-flex","cl-align-items-center","cl-mb-2","cl-mb-lg-0"],[1,"cl-col-12","cl-col-lg-8","cl-d-flex","cl-align-items-center","cl-pr-0","cl-pr-lg-2"],["class","cl-form-control cl-bg-white","rows","6","readonly","",4,"ngIf"],[4,"ngIf"],[1,"cl-component-row","cl-border-0","cl-pl-2","cl-pl-lg-3","cl-pr-0","cl-py-3"],["rows","6","readonly","",1,"cl-form-control","cl-bg-white"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"a",3),c.Xb(4,"span",4),c.jc("click",(function(){return t.isExpanded=!t.isExpanded})),c.Sb(5,"img",5),c.Wb(),c.Wb(),c.Xb(6,"span"),c.Yc(7),c.Wb(),c.Wb(),c.Xb(8,"div",6),c.Xb(9,"span"),c.Yc(10),c.Wb(),c.Wb(),c.Xb(11,"div",7),c.Xb(12,"a",8),c.jc("click",(function(){return t.emitResend()})),c.Yc(13,"Resend"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(14,hT,26,6,"div",9)),2&e&&(c.Cb(7),c.Zc(t.log.respondedAt),c.Cb(2),c.Eb(t.log.statusCode>199&&t.log.statusCode<300?"cl-text":"cl-text-danger"),c.Cb(1),c.ad(" ",t.log.statusCode>199&&t.log.statusCode<300?"Succeeded":"Failed"," "),c.Cb(4),c.wc("ngIf",t.isExpanded))},directives:[s.u],pipes:[uT.a],encapsulation:2,changeDetection:0}),e})();function gT(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",29),c.Xb(1,"a",30),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.filterByStatus(t.webhookLogStatus.ALL)})),c.Yc(2,"Show all"),c.Wb(),c.Xb(3,"a",30),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.filterByStatus(t.webhookLogStatus.FAILED)})),c.Yc(4,"Failed"),c.Wb(),c.Xb(5,"a",30),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.filterByStatus(t.webhookLogStatus.SUCCEEDED)})),c.Yc(6,"Succeeded"),c.Wb(),c.Wb()}}function fT(e,t){if(1&e){const e=c.Yb();c.Xb(0,"webhook-log-row",31),c.jc("resend",(function(){c.Oc(e);const i=t.$implicit;return c.nc().resend(i.id)})),c.Wb()}2&e&&c.wc("log",t.$implicit)}const vT=function(){return["/user/settings"]},wT=function(){return["/webhooks"]};let yT=(()=>{class e{constructor(e,t,i){this.route=e,this.webhooksService=t,this.cd=i,this.unsubscribe$=new mi.a,this.page=1,this.pageSize=50,this.status=qt.ALL,this.webhookLogStatus=qt}ngOnInit(){this.selectedWorkspaceId=this.route.snapshot.params.workspaceId,this.webhookId=this.route.snapshot.params.webhookId,this.intiWebhook(),this.getLogCount(),this.getLogs()}intiWebhook(){this.webhooksService.getById(this.selectedWorkspaceId,this.webhookId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.webhook=e,this.cd.detectChanges()})}sendTest(){this.webhooksService.test(this.selectedWorkspaceId,this.webhookId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>this.reloadLogsWithWait())}resend(e){this.webhooksService.resend(this.selectedWorkspaceId,this.webhookId,e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>this.reloadLogsWithWait())}getLogCount(){this.webhooksService.getLogCount(this.selectedWorkspaceId,this.webhookId,this.status).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.logCount=e,this.cd.detectChanges()})}getLogs(){this.webhooksService.getLogs(this.selectedWorkspaceId,this.webhookId,this.page,this.pageSize,this.status).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.logs=e,this.cd.detectChanges()})}filterByStatus(e){this.page=1,this.status=e,this.getLogCount(),this.getLogs()}changePage(e){this.page=e.page,this.getLogs()}changePageSize(e){this.pageSize=e.limit,this.page=e.page,this.getLogs()}reloadLogsWithWait(){setTimeout(()=>{this.getLogCount(),this.getLogs()},2e3)}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.a),c.Rb(Zt),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["webhook"]],decls:42,vars:13,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-end"],[1,"cl-col-auto"],[1,"cl-breadcrumb","cl-p-0","cl-mb-2","cl-bg-transparent","cl-ml-0"],[1,"cl-breadcrumb-item"],[3,"routerLink"],[1,"cl-mb-2","cl-mb-lg-0"],[1,"cl-mb-3","cl-mb-lg-0","cl-text-gray-6"],[1,"cl-col"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end"],[1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-alert","cl-alert-info"],[1,"cl-card"],[1,"cl-card-body"],[1,"cl-pb-2","cl-pb-lg-3"],["dropdownKey","",1,"cl-dropdown"],["type","button","dropdownKeyButton","",1,"cl-btn","cl-btn-outline-light","cl-dropdown-toggle"],["class","cl-dropdown-menu",4,"dropdownKeyContent"],[1,"cl-card","cl-border-bottom","cl-mb-0"],[1,"cl-card-header","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-row","cl-w-100"],[1,"cl-col-6","cl-col-lg-4","cl-d-flex","cl-align-items-center"],[1,"cl-h6","cl-mb-0"],[1,"cl-col-auto","cl-d-flex","cl-align-items-center"],[3,"log","resend",4,"ngFor","ngForOf"],[1,"cl-mt-3","cl-mb-n2"],[3,"visible","page","limit","total","pageChanged","limitChanged"],[1,"cl-dropdown-menu"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],[3,"log","resend"]],template:function(e,t){1&e&&(c.Xb(0,"main",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"nav"),c.Xb(6,"ol",5),c.Xb(7,"li",6),c.Xb(8,"a",7),c.Yc(9,"Profile settings"),c.Wb(),c.Wb(),c.Xb(10,"li",6),c.Xb(11,"a",7),c.Yc(12,"Webhooks"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(13,"h1",8),c.Yc(14),c.Wb(),c.Xb(15,"p",9),c.Yc(16),c.Wb(),c.Wb(),c.Xb(17,"div",10),c.Xb(18,"div",11),c.Xb(19,"a",12),c.jc("click",(function(){return t.sendTest()})),c.Yc(20,"Send test"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(21,"div",13),c.Yc(22," Logs older than 7 days are deleted "),c.Wb(),c.Xb(23,"div",14),c.Xb(24,"div",15),c.Xb(25,"div",16),c.Xb(26,"div",17),c.Xb(27,"button",18),c.Yc(28),c.Wb(),c.Wc(29,gT,7,0,"div",19),c.Wb(),c.Wb(),c.Xb(30,"div",20),c.Xb(31,"div",21),c.Xb(32,"div",22),c.Xb(33,"div",23),c.Xb(34,"span",24),c.Yc(35,"Attempt date"),c.Wb(),c.Wb(),c.Xb(36,"div",25),c.Xb(37,"span",24),c.Yc(38,"Status"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(39,fT,1,1,"webhook-log-row",26),c.Wb(),c.Xb(40,"div",27),c.Xb(41,"pager",28),c.jc("pageChanged",(function(e){return t.changePage(e)}))("limitChanged",(function(e){return t.changePageSize(e)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(8),c.wc("routerLink",c.Ac(11,vT)),c.Cb(3),c.wc("routerLink",c.Ac(12,wT)),c.Cb(3),c.Zc(null==t.webhook?null:t.webhook.name),c.Cb(2),c.ad(" ",null==t.webhook?null:t.webhook.webhookEventLabel,""),c.Cb(12),c.bd("Show ",t.status.toLowerCase()," (",t.logCount,")"),c.Cb(11),c.wc("ngForOf",t.logs),c.Cb(2),c.wc("visible",t.logCount>0)("page",t.page)("limit",t.pageSize)("total",t.logCount))},directives:[W.f,Si.a,Ii.a,Oi.a,s.t,cn.a,mT],encapsulation:2,changeDetection:0}),e})();const WT=function(e){return["/approvals",e]};function CT(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"div",3),c.Xb(2,"div"),c.Xb(3,"a",4),c.Yc(4),c.Wb(),c.Wb(),c.Xb(5,"div",5),c.Yc(6),c.oc(7,"timeFormat"),c.Wb(),c.Wb(),c.Ub()),2&e){const e=t.$implicit,i=c.nc();c.Cb(3),c.wc("routerLink",c.Bc(6,WT,e.id)),c.Cb(1),c.ad(" ",e.label," "),c.Cb(2),c.ad(" ",c.qc(7,3,e.total,i.format)," ")}}let kT=(()=>{class e{constructor(){this.unsubscribe$=new Ee.a}ngOnInit(){"WEEK"===this.groupBy?this.approvalGroup.title=this.formatDateRange(this.approvalGroup.title):this.approvalGroup.items=this.approvalGroup.items.map(e=>(e.label=this.formatDateRange(e.label),e))}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}formatDateRange(e){return e.split(" - ").map(e=>Se.utc(e.trim()).startOf("day").format("MMM D")).join(" - ")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["approval-group"]],inputs:{approvalGroup:"approvalGroup",format:"format",groupBy:"groupBy"},decls:6,vars:2,consts:[[1,"cl-card-header","cl-px-2","cl-px-lg-3"],[1,"cl-h6","cl-mb-0"],[4,"ngFor","ngForOf"],[1,"cl-hover-shadow","cl-component-row","cl-pr-0","cl-d-flex","cl-w-100","cl-justify-content-between","cl-align-items-center"],[1,"cl-text-dark",3,"routerLink"],[1,"cl-px-2","cl-px-lg-3"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div"),c.Yc(2),c.Wb(),c.Xb(3,"div",1),c.Yc(4,"Time"),c.Wb(),c.Wb(),c.Wc(5,CT,8,8,"ng-container",2)),2&e&&(c.Cb(2),c.Zc(t.approvalGroup.title),c.Cb(3),c.wc("ngForOf",t.approvalGroup.items))},directives:[s.t,W.f],pipes:[yh.a],encapsulation:2,changeDetection:0}),e})();function ST(e,t){if(1&e){const e=c.Yb();c.Xb(0,"button",22),c.jc("click",(function(){c.Oc(e);const t=c.nc(),i=c.Lc(28);return t.openModal(i)})),c.Yc(1," Approve all "),c.Wb()}if(2&e){const e=c.nc();c.wc("disabled",e.inProgress||!(null!=e.approvalGroups&&e.approvalGroups.length))}}function IT(e,t){if(1&e&&(c.Xb(0,"div",23),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" No ",e.label," timesheets ")}}function OT(e,t){if(1&e&&c.Sb(0,"approval-group",24),2&e){const e=t.$implicit,i=c.nc();c.wc("format",i.durationFormat)("approvalGroup",e)("groupBy",i.groupBy)}}function XT(e,t){if(1&e){const e=c.Yb();c.Xb(0,"pager",25),c.jc("pageChanged",(function(t){return c.Oc(e),c.nc().paginationChanged(t)}))("limitChanged",(function(t){return c.Oc(e),c.nc().paginationChanged(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("page",e.page)("limit",e.pageSize)("total",e.totalCount)}}function ET(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",26),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().approveAll(i)}))("close",(function(i){return c.Oc(e),t.$implicit.close(i)})),c.Xb(1,"p",27),c.Yc(2," Once everything is approved, time will be locked and no one will be able to edit it anymore. "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Approve all")("btnText","Approve all")("inProgress",e.inProgress)}}const TT=function(){return["/approvals"]},DT={[Ot.PENDING]:"pending",[Ot.APPROVED]:"approved",[Ot.WITHDRAWN_APPROVAL]:"withdrawn"};let RT=(()=>{class e{constructor(e,t,i,n,s,c,r,o){this.activatedRoute=e,this.router=t,this.approvalService=i,this.uiSettings=n,this.cd=s,this.modalService=c,this.workspaceService=r,this.loader=o,this.ApprovalStatus=Ot,this.unsubscribe$=new Ee.a}ngOnInit(){this.groupByOptions=[new di.a("WEEK","Sort by: Week"),new di.a("PEOPLE","Sort by: People")];const e=this.uiSettings.getSettings(hi.b.APPROVALS_PAGE)||{};this.groupBy=e.groupBy||"WEEK",this.resetPagination(),this.subscribeToFragment(),this.setWorkspace()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}get label(){return DT[this.activePill]}resetPagination(){this.page=1;const e=this.uiSettings.getSettings(hi.b.APPROVALS_PAGE)||{};this.pageSize=e.pageSize||ei.j}setWorkspace(){this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.durationFormat=e.getTimeFormat()})}changeGroupBy(e){this.groupBy=e,this.page=1,this.getApprovals(),this.setDataToLocalStorage()}subscribeToFragment(){this.activatedRoute.fragment.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{const t=Ot[(e=e||Ot.PENDING).toUpperCase()];this.activePill=t||Ot.PENDING,t?(this.page=1,this.checkCount(),this.getApprovals()):this.router.navigate([])})}paginationChanged(e){this.page=e.page||this.page,this.pageSize=e.limit||this.pageSize,this.getApprovals(),this.setDataToLocalStorage()}setDataToLocalStorage(){this.uiSettings.setSettings(hi.b.APPROVALS_PAGE,{pageSize:this.pageSize,groupBy:this.groupBy})}approveAll(e){this.inProgress=!0,this.loader.show("Approving timesheets..."),this.approvalService.approveAll().pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.activePill===Ot.PENDING&&(this.approvalGroups=[],this.resetPagination()),e.close(),this.loader.hide(),this.inProgress=!1,this.cd.markForCheck()},()=>{this.inProgress=!1,this.loader.hide()})}openModal(e){this.modalService.open(e,{centered:!0})}getApprovals(){const e={page:this.page,pageSize:this.pageSize,groupBy:this.groupBy,state:this.activePill};this.approvalGroups=[],this.inProgress=!0,this.approvalService.getAllApprovalGroups(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.approvalGroups=e,this.inProgress=!1,this.cd.markForCheck()},()=>this.inProgress=!1)}checkCount(){this.totalCount=0,this.isMultiplePages=!1,this.approvalService.getApprovalCount(this.activePill).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.totalCount=e,this.isMultiplePages=e>ei.j||e>this.pageSize,this.cd.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.a),c.Rb(W.c),c.Rb(Mt),c.Rb(hi.a),c.Rb(c.h),c.Rb(g.q),c.Rb(U.a),c.Rb(wi.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["approvals-page"]],decls:29,vars:18,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-h1"],[1,"cl-scroll-tabs-wrapper"],["tabs","",1,"cl-nav","cl-nav-tabs","cl-m-0","cl-scroll-tabs"],[1,"cl-nav-item"],["fragment","pending",1,"cl-nav-link",3,"routerLink"],["fragment","approved",1,"cl-nav-link",3,"routerLink"],["fragment","withdrawn_approval",1,"cl-nav-link",3,"routerLink"],[1,"cl-card"],[1,"cl-card-body","cl-pb-0"],[1,"cl-tab-content"],[1,"cl-tab-pane","cl-fade","cl-active","cl-show"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-d-flex","cl-justify-content-between"],[1,"cl-d-inline-block",3,"list","value","onChanged"],["class","cl-btn cl-btn-primary",3,"disabled","click",4,"ngIf"],["class","cl-h2 cl-mb-0 cl-border cl-p-5 cl-text-center cl-mb-3",4,"ngIf"],["class","cl-card cl-d-block",3,"format","approvalGroup","groupBy",4,"ngFor","ngForOf"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],["approveAllModal",""],[1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-h2","cl-mb-0","cl-border","cl-p-5","cl-text-center","cl-mb-3"],[1,"cl-card","cl-d-block",3,"format","approvalGroup","groupBy"],[3,"page","limit","total","pageChanged","limitChanged"],[3,"title","btnText","inProgress","confirmed","close"],[1,"cl-text-dark","cl-mb-0"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"h1",3),c.Yc(4,"Approvals"),c.Wb(),c.Wb(),c.Xb(5,"div",4),c.Xb(6,"ul",5),c.Xb(7,"li",6),c.Xb(8,"a",7),c.Yc(9," Pending"),c.Wb(),c.Wb(),c.Xb(10,"li",6),c.Xb(11,"a",8),c.Yc(12," Approved"),c.Wb(),c.Wb(),c.Xb(13,"li",6),c.Xb(14,"a",9),c.Yc(15," Withdrawn"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(16,"div",10),c.Xb(17,"div",11),c.Xb(18,"div",12),c.Xb(19,"div",13),c.Xb(20,"div",14),c.Xb(21,"div",15),c.Xb(22,"dropdown-items",16),c.jc("onChanged",(function(e){return t.changeGroupBy(e)})),c.Wb(),c.Wc(23,ST,2,1,"button",17),c.Wb(),c.Wb(),c.Wc(24,IT,2,1,"div",18),c.Wc(25,OT,1,3,"approval-group",19),c.Wc(26,XT,1,3,"pager",20),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(27,ET,3,3,"ng-template",null,21,c.Xc)),2&e&&(c.Cb(8),c.Hb("cl-active",t.activePill===t.ApprovalStatus.PENDING),c.wc("routerLink",c.Ac(15,TT)),c.Cb(3),c.Hb("cl-active",t.activePill===t.ApprovalStatus.APPROVED),c.wc("routerLink",c.Ac(16,TT)),c.Cb(3),c.Hb("cl-active",t.activePill===t.ApprovalStatus.WITHDRAWN_APPROVAL),c.wc("routerLink",c.Ac(17,TT)),c.Cb(8),c.wc("list",t.groupByOptions)("value",t.groupBy),c.Cb(1),c.wc("ngIf",t.activePill===t.ApprovalStatus.PENDING),c.Cb(1),c.wc("ngIf",!t.inProgress&&0===(null==t.approvalGroups?null:t.approvalGroups.length)),c.Cb(1),c.wc("ngForOf",t.approvalGroups),c.Cb(1),c.wc("ngIf",(null==t.approvalGroups?null:t.approvalGroups.length)&&t.isMultiplePages))},directives:[W.f,pn.a,s.u,s.t,kT,cn.a,Ui.a],encapsulation:2,changeDetection:0}),e})(),AT=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(){const e=this.workspaceService.getLocalDefaultWorkspace();if(e&&e.timeApprovalEnabled)return!0;this.router.navigate(["tracker"])}}return e.\u0275fac=function(t){return new(t||e)(c.fc(U.a),c.fc(W.c))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})(),jT=(()=>{class e{constructor(e,t){this.router=e,this.authService=t}canActivate(){let e;const t=this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(Yt.a)(1));t.subscribe(()=>e=!0);const i=t.pipe(iu(this.authService.permissionFailed$),Object(Yt.a)(1));return e||this.authService.getPermissionsForUser(),i.pipe(Object(Y.a)(e=>{const t=e&&e.isAdmin||e.isTeamManager;return t||this.router.navigate(["/tracker"]),t}))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(W.c),c.fc(Ce.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})(),xT=(()=>{class e{constructor(e,t){this.authService=e,this.router=t,this.redirects=new Map([["1","clockify://"],["2","clockify-activity://"],["3","https://pmjeegjhjdlccodhacdgbgfagbpmccpe.chromiumapp.org?"],["4","https://f8d29a2fbdeb4a19892b293b70f4219ed117b1f7.extensions.allizom.org/?"]])}canActivate(e,t){if(!this.authService.isLoggedIn())return this.authService.logout(),Zc.a.setRedirectUrl(t.url),!1;const i=this.redirects.get(e.params.id),n=localStorage.getItem("token"),s=localStorage.getItem("refreshToken");!!n&&!!s&&!!i&&(window.location.href=`${i}accessToken=${n}&refreshToken=${s}`),this.router.navigate(["tracker"])}}return e.\u0275fac=function(t){return new(t||e)(c.fc(Ce.a),c.fc(W.c))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})(),PT=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(e){const t=this.workspaceService.getLocalDefaultWorkspace(),i=e.data.feature;if(i||console.warn("FeatureGuard: missing feature parameter!"),t.hasFeature(i))return!0;this.router.navigate(["tracker"])}}return e.\u0275fac=function(t){return new(t||e)(c.fc(U.a),c.fc(W.c))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();class MT{constructor(e,t){if(this.label=e.label,this.backgroundColor=e.backgroundColor||e.color,this.hoverBackgroundColor=e.hoverBackgroundColor||e.backgroundColor,this.clientName=e.clientName,this.duration=e.duration,e.hasOwnProperty("percentage")){const t=(""+(e.percentage||0)).replace(/%/gi,"");this.percentage=+t}else if(t){const e=new Bd.a(this.duration).asSeconds(),i=new Bd.a(t).asSeconds();this.percentage=e?+(e/i*100).toFixed(2):0}else this.percentage=0;const i=e.data?e.data.slice():[];this.data=i.map(e=>Object(Pt.u)(e)?e:new Bd.a(e).asSeconds())}}function YT(e,t){if(1&e&&(c.Xb(0,"div",2),c.Xb(1,"div",3),c.Yc(2,"Submitted"),c.Wb(),c.Xb(3,"div",4),c.Yc(4),c.oc(5,"timeFormat"),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(4),c.Zc(c.qc(5,1,null==e.tableInfo?null:e.tableInfo.pendingTime,e.durationFormat))}}function LT(e,t){if(1&e&&(c.Xb(0,"div",2),c.Xb(1,"div",3),c.Yc(2,"Approved"),c.Wb(),c.Xb(3,"div",4),c.Yc(4),c.oc(5,"timeFormat"),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(4),c.Zc(c.qc(5,1,null==e.tableInfo?null:e.tableInfo.approvedTime,e.durationFormat))}}function FT(e,t){if(1&e&&(c.Xb(0,"div",2),c.Xb(1,"div",3),c.Yc(2,"Cost"),c.Wb(),c.Xb(3,"div",4),c.Yc(4),c.oc(5,"roundIfWholeNumber"),c.oc(6,"centsToDollars"),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(4),c.bd("",c.pc(5,2,c.pc(6,4,null==e.tableInfo?null:e.tableInfo.costAmount))," ",e.currency,"")}}let NT=(()=>{class e{constructor(){this.ApprovalStatus=Ot}ngOnInit(){}get hasApprovedTime(){return!!this.tableInfo&&!!Object(Se.duration)(this.tableInfo.approvedTime).asMilliseconds()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["approval-table-header"]],inputs:{tableInfo:"tableInfo",durationFormat:"durationFormat",currency:"currency",isCostRateActive:"isCostRateActive",status:"status"},decls:17,vars:13,consts:[[1,"cl-d-flex","cl-flex-column","cl-flex-md-row","cl-w-100","cl-align-items-md-end","cl-justify-content-between"],["class","cl-dashboard-card-header-item cl-flex-fill cl-col-xl-auto",4,"ngIf"],[1,"cl-dashboard-card-header-item","cl-flex-fill","cl-col-xl-auto"],[1,"cl-h4","cl-mb-0"],[1,"cl-h1"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Wc(1,YT,6,4,"div",1),c.Wc(2,LT,6,4,"div",1),c.Xb(3,"div",2),c.Xb(4,"div",3),c.Yc(5,"Billable"),c.Wb(),c.Xb(6,"div",4),c.Yc(7),c.oc(8,"timeFormat"),c.Wb(),c.Wb(),c.Xb(9,"div",2),c.Xb(10,"div",3),c.Yc(11,"Amount"),c.Wb(),c.Xb(12,"div",4),c.Yc(13),c.oc(14,"roundIfWholeNumber"),c.oc(15,"centsToDollars"),c.Wb(),c.Wb(),c.Wc(16,FT,7,6,"div",1),c.Wb()),2&e&&(c.Cb(1),c.wc("ngIf",t.status===t.ApprovalStatus.PENDING),c.Cb(1),c.wc("ngIf",t.hasApprovedTime||t.status===t.ApprovalStatus.APPROVED||t.status===t.ApprovalStatus.WITHDRAWN_APPROVAL),c.Cb(5),c.Zc(c.qc(8,6,null==t.tableInfo?null:t.tableInfo.billableTime,t.durationFormat)),c.Cb(6),c.bd("",c.pc(14,9,c.pc(15,11,null==t.tableInfo?null:t.tableInfo.billableAmount))," ",t.currency,""),c.Cb(3),c.wc("ngIf",t.isCostRateActive))},directives:[s.u],pipes:[yh.a,_i.a,Gi.a],encapsulation:2,changeDetection:0}),e})();function UT(e,t){if(1&e&&(c.Xb(0,"label",7),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.Zc(e.label)}}let $T=(()=>{class e{constructor(){this.label="Add note",this.minLength=1,this.onClose=new c.n,this.onSubmit=new c.n,this.note=""}ngOnInit(){}get isValid(){return this.note.trim().length>=(this.minLength||0)}submit(){this.isValid&&this.onSubmit.emit(this.note)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["note-modal"]],inputs:{inProgress:"inProgress",btnText:"btnText",label:"label",minLength:"minLength"},outputs:{onClose:"onClose",onSubmit:"onSubmit"},decls:11,vars:4,consts:[[1,"cl-modal-body"],[1,"cl-form-group","cl-mb-2"],["for","add-note",4,"ngIf"],["ngbAutofocus","","id","add-note","rows","5",1,"cl-form-control",3,"ngModel","ngModelChange"],[1,"cl-modal-footer"],["tabindex","0",3,"click","keyup.enter","keyup.space"],["type","button","tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled","click","keyup.enter","keyup.space"],["for","add-note"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div"),c.Xb(2,"div",1),c.Wc(3,UT,2,1,"label",2),c.Xb(4,"textarea",3),c.jc("ngModelChange",(function(e){return t.note=e})),c.Yc(5,"            "),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",4),c.Xb(7,"a",5),c.jc("click",(function(){return t.onClose.emit()}))("keyup.enter",(function(){return t.onClose.emit()}))("keyup.space",(function(){return t.onClose.emit()})),c.Yc(8,"Cancel"),c.Wb(),c.Xb(9,"button",6),c.jc("click",(function(){return t.submit()}))("keyup.enter",(function(){return t.submit()}))("keyup.space",(function(){return t.submit()})),c.Yc(10),c.Wb(),c.Wb()),2&e&&(c.Cb(3),c.wc("ngIf",t.label),c.Cb(1),c.wc("ngModel",t.note),c.Cb(5),c.wc("disabled",!t.isValid||t.inProgress),c.Cb(1),c.Zc(t.btnText))},directives:[s.u,p.c,p.s,p.v],encapsulation:2,changeDetection:0}),e})();function _T(e,t){1&e&&(c.Xb(0,"div",18),c.Xb(1,"span",19),c.Yc(2," Approved "),c.Wb(),c.Wb())}function GT(e,t){1&e&&(c.Xb(0,"div",18),c.Xb(1,"span",20),c.Yc(2," Withdrawn "),c.Wb(),c.Wb())}function BT(e,t){if(1&e&&(c.Xb(0,"div",15),c.Xb(1,"h1",16),c.Yc(2),c.oc(3,"dateFormat"),c.oc(4,"dateFormat"),c.Wb(),c.Wc(5,_T,3,0,"div",17),c.Wc(6,GT,3,0,"div",17),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.cd(" ",e.details.owner.userName,", ",c.qc(3,5,e.details.dateRange.start,e.details.owner.timeZone)," - ",c.qc(4,8,e.details.dateRange.end,e.details.owner.timeZone)," "),c.Cb(3),c.wc("ngIf",e.details.status.state===e.ApprovalStatus.APPROVED),c.Cb(1),c.wc("ngIf",e.details.status.state===e.ApprovalStatus.WITHDRAWN_APPROVAL)}}function VT(e,t){if(1&e&&(c.Xb(0,"div",5),c.Xb(1,"span",6),c.Yc(2,"Timezone: "),c.Wb(),c.Xb(3,"span",7),c.Yc(4),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(4),c.bd("(UTC ",e.offset,") ",e.details.owner.timeZone,"")}}function HT(e,t){if(1&e&&(c.Vb(0),c.Yc(1),c.oc(2,"dateFormat"),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.ad(" (",c.qc(2,1,e.details.date,e.details.owner.timeZone),") ")}}function zT(e,t){1&e&&(c.Vb(0),c.Yc(1," Approved by: "),c.Ub())}function qT(e,t){1&e&&(c.Vb(0),c.Yc(1," Withdrawn by: "),c.Ub())}function KT(e,t){if(1&e&&(c.Xb(0,"div",5),c.Xb(1,"span",6),c.Wc(2,zT,2,0,"ng-container",8),c.Wc(3,qT,2,0,"ng-container",8),c.Wb(),c.Xb(4,"span",7),c.Yc(5),c.oc(6,"dateFormat"),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.wc("ngIf",(null==e.details?null:e.details.status.state)===e.ApprovalStatus.APPROVED),c.Cb(1),c.wc("ngIf",(null==e.details?null:e.details.status.state)===e.ApprovalStatus.WITHDRAWN_APPROVAL),c.Cb(2),c.bd(" ",null==e.details?null:e.details.status.updatedByUserName," (",c.qc(6,4,null==e.details?null:e.details.status.updatedAt,e.details.owner.timeZone),") ")}}function ZT(e,t){if(1&e&&(c.Xb(0,"div",21),c.Xb(1,"div",22),c.Yc(2,"Note:"),c.Wb(),c.Xb(3,"p",23),c.Yc(4),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(4),c.Zc(null==e.details?null:e.details.status.note)}}function QT(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",24),c.Xb(2,"button",25,26),c.jc("click",(function(){c.Oc(e);const t=c.Lc(3),i=c.nc(),n=c.Lc(21);return t.blur(),i.openModal(n)})),c.Yc(4," Reject "),c.Wb(),c.Wb(),c.Xb(5,"div",24),c.Xb(6,"button",27,28),c.jc("click",(function(){c.Oc(e);const t=c.Lc(7),i=c.nc(),n=c.Lc(19);return t.blur(),i.openModal(n)})),c.Yc(8," Approve "),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(2),c.wc("disabled",e.inProgress),c.Cb(4),c.wc("disabled",e.inProgress)}}function JT(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"div",24),c.Xb(2,"button",25,29),c.jc("click",(function(){c.Oc(e);const t=c.Lc(3),i=c.nc(),n=c.Lc(23);return t.blur(),i.openModal(n)})),c.Yc(4," Withdraw Approval "),c.Wb(),c.Wb(),c.Ub()}if(2&e){const e=c.nc();c.Cb(2),c.wc("disabled",e.inProgress)}}function eD(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",30),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().approve(i)}))("close",(function(){return t.$implicit.close()})),c.Xb(1,"p",31),c.Yc(2," Once approved, time will be locked and no one will be able to edit it anymore. "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Confirm approval")("btnText","Approve")("inProgress",e.inProgress)}}function tD(e,t){if(1&e){const e=c.Yb();c.Xb(0,"modal-header",32),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"note-modal",33),c.jc("onSubmit",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().reject(i,n)}))("onClose",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Reject timesheet"),c.Cb(1),c.wc("label","Send note to user")("btnText","Reject")("inProgress",e.inProgress)}}function iD(e,t){if(1&e){const e=c.Yb();c.Xb(0,"modal-header",32),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Xb(1,"note-modal",33),c.jc("onSubmit",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().withdraw(i,n)}))("onClose",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Withdraw approval"),c.Cb(1),c.wc("label","Add note")("btnText","Withdraw")("inProgress",e.inProgress)}}const nD=function(){return["/approvals"]};let sD=(()=>{class e{constructor(e,t,i,n,s){this.approvalService=e,this.modalService=t,this.userService=i,this.cd=n,this.router=s,this.ApprovalStatus=Ot,this.unsubscribe$=new Ee.a}ngOnInit(){this.offset=Se.tz(this.details.owner.timeZone).format("Z");const e=this.userService.getTimeZone();this.adminOffset=Se.tz(e).format("Z"),this.fragment=this.details.status.state.toLowerCase()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}openModal(e){this.modalService.open(e,{centered:!0})}approve(e){this.inProgress=!0,this.approvalService.approve(this.details.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{this.details=t,this.inProgress=!1,e.close(),this.navigateBack()},()=>{this.inProgress=!1,this.cd.markForCheck()})}reject(e,t){this.inProgress=!0,this.approvalService.reject(this.details.id,e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.inProgress=!1,this.details=e,t.close(),this.navigateBack()},()=>{this.inProgress=!1,this.cd.markForCheck()})}withdraw(e,t){this.inProgress=!0,this.approvalService.withdrawApproval(this.details.id,e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.details=e,this.inProgress=!1,this.cd.detectChanges(),t.close(),this.navigateBack()},()=>{this.inProgress=!1,this.cd.markForCheck()})}navigateBack(){this.router.navigate(["approvals"],{fragment:this.fragment})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Mt),c.Rb(g.q),c.Rb(ys.a),c.Rb(c.h),c.Rb(W.c))},e.\u0275cmp=c.Lb({type:e,selectors:[["approval-detail-info"]],inputs:{details:"details"},decls:24,vars:11,consts:[[1,"cl-col-lg-8"],[1,"cl-d-inline-block","cl-mb-2",3,"routerLink","fragment"],["class","cl-d-flex cl-align-items-center cl-mb-2",4,"ngIf"],[1,"cl-d-flex","cl-mb-3","cl-mb-lg-0"],["class","cl-mr-3",4,"ngIf"],[1,"cl-mr-3"],[1,"cl-text-gray-9"],[1,"cl-text-gray-6"],[4,"ngIf"],["class","cl-mb-3 cl-mb-lg-0",4,"ngIf"],[1,"cl-col-lg-4"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-lg-end"],["approveModal",""],["rejectModal",""],["withdrawModal",""],[1,"cl-d-flex","cl-align-items-center","cl-mb-2"],[1,"cl-mb-0"],["class","cl-ml-3",4,"ngIf"],[1,"cl-ml-3"],[1,"cl-badge-approve","cl-approve-status-approved"],[1,"cl-badge-approve","cl-approve-status-pending"],[1,"cl-mb-3","cl-mb-lg-0"],[1,"cl-mt-3","cl-text-gray-9"],[1,"cl-text-gray-6","cl-mb-0"],[1,"cl-page-header-action"],["type","button",1,"cl-btn","cl-btn-outline-primary",3,"disabled","click"],["rejectBtn",""],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"],["approveBtn",""],["withdrawBtn",""],[3,"title","btnText","inProgress","confirmed","close"],[1,"cl-text-dark","cl-mb-0"],[3,"title","onClose"],[3,"label","btnText","inProgress","onSubmit","onClose"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"a",1),c.Yc(2," Approvals "),c.Wb(),c.Wc(3,BT,7,11,"div",2),c.Xb(4,"div",3),c.Wc(5,VT,5,2,"div",4),c.Xb(6,"div",5),c.Xb(7,"span",6),c.Yc(8,"Submitted by: "),c.Wb(),c.Xb(9,"span",7),c.Yc(10),c.Wc(11,HT,3,4,"ng-container",8),c.Wb(),c.Wb(),c.Wc(12,KT,7,7,"div",4),c.Wb(),c.Wc(13,ZT,5,1,"div",9),c.Wb(),c.Xb(14,"div",10),c.Xb(15,"div",11),c.Wc(16,QT,9,2,"ng-container",8),c.Wc(17,JT,5,1,"ng-container",8),c.Wb(),c.Wb(),c.Wc(18,eD,3,3,"ng-template",null,12,c.Xc),c.Wc(20,tD,2,4,"ng-template",null,13,c.Xc),c.Wc(22,iD,2,4,"ng-template",null,14,c.Xc)),2&e&&(c.Cb(1),c.wc("routerLink",c.Ac(10,nD))("fragment",t.fragment),c.Cb(2),c.wc("ngIf",t.details),c.Cb(2),c.wc("ngIf",t.offset!==t.adminOffset),c.Cb(5),c.ad(" ",null==t.details?null:t.details.owner.userName," "),c.Cb(1),c.wc("ngIf",null==t.details?null:t.details.date),c.Cb(1),c.wc("ngIf",(null==t.details?null:t.details.status.state)===t.ApprovalStatus.APPROVED||(null==t.details?null:t.details.status.state)===t.ApprovalStatus.WITHDRAWN_APPROVAL),c.Cb(1),c.wc("ngIf",null==t.details?null:t.details.status.note),c.Cb(3),c.wc("ngIf",(null==t.details?null:t.details.status.state)===t.ApprovalStatus.PENDING),c.Cb(1),c.wc("ngIf",(null==t.details?null:t.details.status.state)===t.ApprovalStatus.APPROVED))},directives:[W.f,s.u,Ui.a,wl.a,$T],pipes:[wh.a],encapsulation:2,changeDetection:0}),e})();const cD=function(e,t){return{"background-color":e,width:t}};let rD=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["chart-horizontal-line"]],inputs:{backgroundColor:"backgroundColor",percentage:"percentage"},decls:2,vars:4,consts:[[1,"cl-horizontal-chart--progress",2,"width","100%"],[1,"cl-horizontal-chart--progress--item",3,"ngStyle"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Sb(1,"div",1),c.Wb()),2&e&&(c.Cb(1),c.wc("ngStyle",c.Cc(1,cD,t.backgroundColor,t.percentage+"%")))},directives:[s.x],encapsulation:2,changeDetection:0}),e})();function oD(e,t){if(1&e&&(c.Xb(0,"span",11),c.Yc(1),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(1),c.ad(" - ",e.clientName," ")}}const aD=function(e){return{data:e}};function lD(e,t){if(1&e&&c.Tb(0,12),2&e){const e=c.nc().$implicit;c.nc();const t=c.Lc(4);c.wc("ngTemplateOutlet",t)("ngTemplateOutletContext",c.Bc(2,aD,e))}}function bD(e,t){if(1&e&&(c.Xb(0,"tr"),c.Xb(1,"td",4),c.Xb(2,"span"),c.Yc(3),c.Wc(4,oD,2,1,"span",5),c.Wb(),c.Wb(),c.Xb(5,"td",6),c.Yc(6),c.oc(7,"timeFormat"),c.Wb(),c.Xb(8,"td",7),c.Sb(9,"chart-horizontal-line",8),c.Wc(10,lD,1,4,"ng-template",null,9,c.Xc),c.Wb(),c.Xb(12,"td",10),c.Yc(13),c.Wb(),c.Wb()),2&e){const e=t.$implicit,i=c.Lc(11),n=c.nc();c.Cb(2),c.Db("title",e.clientName?e.label+" - "+e.clientName:e.label),c.Cb(1),c.ad(" ",e.label," "),c.Cb(1),c.wc("ngIf",e.clientName),c.Cb(2),c.ad(" ",c.qc(7,8,e.duration,n.durationFormat)," "),c.Cb(3),c.wc("ngbTooltip",i)("percentage",e.percentage)("backgroundColor",e.backgroundColor),c.Cb(4),c.ad(" ",e.percentage,"% ")}}function uD(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",13),c.Xb(1,"span"),c.Xb(2,"button",14),c.jc("click",(function(){return c.Oc(e),c.nc().onLoadMore.emit()})),c.Yc(3),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.ad(" Load more (",e.totalLength-e.chartData.length," left) ")}}function dD(e,t){if(1&e&&(c.Xb(0,"div",15),c.Sb(1,"i",16),c.Xb(2,"span"),c.Yc(3),c.Wb(),c.Wb(),c.Xb(4,"span",17),c.Yc(5),c.oc(6,"timeFormat"),c.Wb(),c.Xb(7,"span",18),c.Yc(8),c.Wb()),2&e){const e=t.data,i=c.nc();c.Cb(1),c.Vc("background",e.backgroundColor,c.Kb),c.Cb(2),c.ad("",e.label,":"),c.Cb(2),c.ad(" ",c.qc(6,5,e.duration,i.durationFormat)," "),c.Cb(3),c.ad(" ",e.percentage,"% ")}}let pD=(()=>{class e{constructor(e){this.cd=e,this.onLoadMore=new c.n}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["chart-horizontal"]],inputs:{chartData:"chartData",totalLength:"totalLength",durationFormat:"durationFormat"},outputs:{onLoadMore:"onLoadMore"},decls:5,vars:2,consts:[[1,"cl-main-horizontal-chart-container"],[4,"ngFor","ngForOf"],["class","cl-or-divider cl-mt-3",4,"ngIf"],["tooltipContent",""],[1,"cl-text-truncate","cl-main-horizontal-chart-container--label"],["class","cl-listing-client",4,"ngIf"],[1,"cl-w-10","cl-text-right"],[1,"cl-w-50","cl-main-horizontal-chart-container--progress"],["placement","bottom-left",1,"cl-main-horizontal-chart-container--progress--bar",3,"ngbTooltip","percentage","backgroundColor"],["tooltip",""],[1,"cl-w-10","cl-text-nowrap","cl-text-gray-9","cl-text-right"],[1,"cl-listing-client"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-or-divider","cl-mt-3"],[1,"cl-btn","cl-btn-sm","cl-btn-outline-light","cl-w-max-content",3,"click"],[1,"cl-tooltip-label","cl-text-truncate","cl-text-left"],[1,"cl-entry__project__dot"],[1,"cl-tooltip-duration",2,"white-space","nowrap"],[1,"cl-text-right","cl-text-gray-9"]],template:function(e,t){1&e&&(c.Xb(0,"table",0),c.Wc(1,bD,14,11,"tr",1),c.Wb(),c.Wc(2,uD,4,1,"div",2),c.Wc(3,dD,9,8,"ng-template",null,3,c.Xc)),2&e&&(c.Cb(1),c.wc("ngForOf",t.chartData),c.Cb(1),c.wc("ngIf",t.totalLength>t.chartData.length))},directives:[s.t,s.u,rD,g.Z,s.B],pipes:[yh.a],encapsulation:2,changeDetection:0}),e})();var hD=i("a+PT");function mD(e,t){if(1&e&&(c.Xb(0,"span",16),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.wc("title",e.timeEntry.description),c.Cb(1),c.ad(" ",e.timeEntry.description," ")}}function gD(e,t){1&e&&(c.Xb(0,"span",17),c.Yc(1," No description "),c.Wb())}function fD(e,t){if(1&e&&(c.Vb(0),c.Sb(1,"span",11),c.Xb(2,"span",23),c.Yc(3),c.Wb(),c.Ub()),2&e){const e=c.nc(2);c.Cb(3),c.ad(" ",e.timeEntry.project.clientName," ")}}function vD(e,t){if(1&e&&(c.Xb(0,"div",18),c.Xb(1,"div",19),c.Xb(2,"span",20),c.Sb(3,"i",21),c.Yc(4),c.Wb(),c.Wc(5,fD,4,1,"ng-container",22),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.Vc("color",e.timeEntry.project.color),c.Cb(1),c.Vc("background-color",e.timeEntry.project.color),c.Cb(1),c.bd(" ",e.timeEntry.project.name,"",null!=e.timeEntry.task&&e.timeEntry.task.name?": "+e.timeEntry.task.name:""," "),c.Cb(1),c.wc("ngIf",e.timeEntry.project.clientName)}}function wD(e,t){if(1&e&&(c.Xb(0,"div",24),c.Xb(1,"span",25),c.Yc(2),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.ad(" ",e.tagsLabel," ")}}function yD(e,t){if(1&e&&(c.Xb(0,"div",26),c.Sb(1,"img",27),c.Wb()),2&e){const e=c.nc();c.wc("title",e.timeEntry.approvalRequestId?"Approved":"Pending"),c.Cb(1),c.wc("src",e.timeEntry.approvalRequestId?"assets/ui-icons/checkmark-green-circle.svg":"assets/ui-icons/icon-pending.svg",c.Qc)}}function WD(e,t){if(1&e&&c.Sb(0,"custom-fields-values",28),2&e){const e=c.nc();c.wc("timeEntryId",e.timeEntry.id)("projectId",null==e.timeEntry.project?null:e.timeEntry.project.id)("customFields",e.customFields)("disableEdit",!0)("customFieldValues",e.timeEntry.customFieldValues)}}let CD=(()=>{class e{constructor(){}ngOnInit(){this.tagsLabel=this.timeEntry.tags.map(e=>e.name).join(", ")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["approval-entry"]],inputs:{timeEntry:"timeEntry",customFields:"customFields",durationFormat:"durationFormat",ownerTimeZone:"ownerTimeZone",showApprovalStatus:"showApprovalStatus"},decls:24,vars:20,consts:[[1,"cl-component-row","cl-border-0","cl-p-0"],[1,"cl-d-flex","cl-flex-column","cl-flex-lg-row","cl-w-100","cl-pt-2","cl-pt-lg-0"],[1,"cl-component-divided-left","cl-justify-content-start","cl-cut-text","cl-no-divider-border","cl-my-1","cl-my-lg-0","cl-mx-n1","cl-mx-lg-0"],["class","cl-cut-text",3,"title",4,"ngIf","ngIfElse"],["noDescriptionTemplate",""],["class","cl-component-divided-left cl-justify-content-start cl-cut-text cl-remove-divider-mob cl-my-1 cl-my-lg-0 cl-mx-n1 cl-mx-lg-0",4,"ngIf"],["class","cl-component-divided-left cl-justify-content-start cl-remove-divider-mob cl-cut-text cl-my-1 cl-my-lg-0 cl-mx-n1 cl-mx-lg-0",4,"ngIf"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end","cl-template-separator-mob","cl-min-height-40","cl-w-100","cl-w-lg-auto","cl-ml-auto","cl-mt-2","cl-mt-lg-0"],[1,"cl-component-divided-left","cl-remove-divider-mob","cl-disable-pointer",3,"disableEdit","billable"],[1,"cl-component-divided-left"],[1,"cl-input-time-picker","cl-text-right","cl-bg-white"],[1,"cl-h-line-divider"],[1,"cl-input-time-picker","cl-bg-white"],[1,"cl-input-time-picker-sum","cl-bg-white","cl-text-right"],["class","cl-component-divided-left",3,"title",4,"ngIf"],["class","cl-disabled",3,"timeEntryId","projectId","customFields","disableEdit","customFieldValues",4,"ngIf"],[1,"cl-cut-text",3,"title"],[1,"cl-text-gray-9","cl-cut-text"],[1,"cl-component-divided-left","cl-justify-content-start","cl-cut-text","cl-remove-divider-mob","cl-my-1","cl-my-lg-0","cl-mx-n1","cl-mx-lg-0"],[1,"cl-project-name","cl-project-name-colored","cl-listing-project-client","cl-cut-text"],[1,"cl-locked-no-underline"],[1,"cl-entry__project__dot"],[4,"ngIf"],[1,"cl-listing-client","cl-locked-no-underline"],[1,"cl-component-divided-left","cl-justify-content-start","cl-remove-divider-mob","cl-cut-text","cl-my-1","cl-my-lg-0","cl-mx-n1","cl-mx-lg-0"],[1,"cl-badge","cl-badge-tag","cl-cut-text"],[1,"cl-component-divided-left",3,"title"],[3,"src"],[1,"cl-disabled",3,"timeEntryId","projectId","customFields","disableEdit","customFieldValues"]],template:function(e,t){if(1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Wc(3,mD,2,2,"span",3),c.Wc(4,gD,2,0,"ng-template",null,4,c.Xc),c.Wb(),c.Wc(6,vD,6,7,"div",5),c.Wc(7,wD,3,1,"div",6),c.Xb(8,"div",7),c.Sb(9,"billable-icon",8),c.Xb(10,"div",9),c.Xb(11,"span",10),c.Yc(12),c.oc(13,"hourFormat"),c.Wb(),c.Sb(14,"span",11),c.Xb(15,"span",12),c.Yc(16),c.oc(17,"hourFormat"),c.Wb(),c.Wb(),c.Xb(18,"div",9),c.Xb(19,"span",13),c.Yc(20),c.oc(21,"timeFormat"),c.Wb(),c.Wb(),c.Wc(22,yD,2,2,"div",14),c.Wb(),c.Wb(),c.Wb(),c.Wc(23,WD,1,5,"custom-fields-values",15)),2&e){const e=c.Lc(5);c.Cb(3),c.wc("ngIf",t.timeEntry.description)("ngIfElse",e),c.Cb(3),c.wc("ngIf",null==t.timeEntry.project?null:t.timeEntry.project.id),c.Cb(1),c.wc("ngIf",t.tagsLabel),c.Cb(2),c.wc("disableEdit",!0)("billable",t.timeEntry.billable),c.Cb(3),c.ad(" ",c.qc(13,11,t.timeEntry.timeInterval.start,t.ownerTimeZone)," "),c.Cb(4),c.ad(" ",c.qc(17,14,t.timeEntry.timeInterval.end,t.ownerTimeZone)," "),c.Cb(4),c.ad(" ",c.qc(21,17,t.timeEntry.timeInterval.duration,t.durationFormat)," "),c.Cb(2),c.wc("ngIf",t.showApprovalStatus||t.timeEntry.approvalRequestId),c.Cb(1),c.wc("ngIf",(null==t.customFields?null:t.customFields.length)>0)}},directives:[s.u,Bp.a,nh.a],pipes:[hD.a,yh.a],encapsulation:2,changeDetection:0}),e})();function kD(e,t){if(1&e&&c.Sb(0,"approval-entry",5),2&e){const e=t.$implicit,i=c.nc();c.wc("durationFormat",i.durationFormat)("timeEntry",e)("ownerTimeZone",i.ownerTimeZone)("customFields",i.customFields)("showApprovalStatus",i.showApprovalStatus)}}let SD=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["approval-entry-group"]],inputs:{entryGroup:"entryGroup",customFields:"customFields",durationFormat:"durationFormat",ownerTimeZone:"ownerTimeZone",showApprovalStatus:"showApprovalStatus"},decls:11,vars:8,consts:[[1,"cl-card-header","cl-px-2","cl-px-lg-3"],[1,"cl-d-flex","cl-align-items-end"],[1,"cl-h6","cl-mb-0","cl-lh-1"],[1,"cl-h2","cl-mb-0","cl-ml-2","cl-lh-1"],["class","cl-d-block cl-px-0 cl-hover-shadow cl-border-bottom",3,"durationFormat","timeEntry","ownerTimeZone","customFields","showApprovalStatus",4,"ngFor","ngForOf"],[1,"cl-d-block","cl-px-0","cl-hover-shadow","cl-border-bottom",3,"durationFormat","timeEntry","ownerTimeZone","customFields","showApprovalStatus"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div"),c.Yc(2),c.oc(3,"dateFormat"),c.Wb(),c.Xb(4,"div",1),c.Xb(5,"div",2),c.Yc(6,"Total: "),c.Wb(),c.Xb(7,"div",3),c.Yc(8),c.oc(9,"timeFormat"),c.Wb(),c.Wb(),c.Wb(),c.Wc(10,kD,1,5,"approval-entry",4)),2&e&&(c.Cb(2),c.Zc(c.pc(3,3,t.entryGroup.date)),c.Cb(6),c.ad(" ",c.qc(9,5,t.entryGroup.time,t.durationFormat)," "),c.Cb(2),c.wc("ngForOf",t.entryGroup.timeEntries))},directives:[s.t,CD],pipes:[wh.a,yh.a],encapsulation:2,changeDetection:0}),e})();const ID=["titleLabel"];function OD(e,t){if(1&e&&(c.Xb(0,"span",10),c.Yc(1),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(1),c.ad(" - ",e.clientName,"")}}function XD(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"tr"),c.Xb(2,"td"),c.Xb(3,"span",6),c.Sb(4,"i",7),c.Xb(5,"span"),c.Yc(6),c.Wb(),c.Wc(7,OD,2,1,"span",8),c.Wb(),c.Wb(),c.Xb(8,"td",4),c.Yc(9),c.oc(10,"timeFormat"),c.Wb(),c.Xb(11,"td",9),c.Yc(12),c.Wb(),c.Wb(),c.Ub()),2&e){const e=t.$implicit,i=c.nc();c.Cb(4),c.Vc("background",e.backgroundColor,c.Kb),c.Cb(2),c.Zc(e.label?e.label:"Without project"),c.Cb(1),c.wc("ngIf",e.clientName),c.Cb(2),c.Zc(c.qc(10,6,e.duration,i.durationFormat)),c.Cb(3),c.ad("",e.percentage,"%")}}let ED=(()=>{class e{constructor(){}ngOnInit(){this.barChartDataWithPercentage=this.barChartData.map(e=>{const t=e.duration,i=new Bd.a(t).asSeconds();return e.percentage=t?Number((i/this.totalDuration*100).toFixed(2)):0,e}),this.barChartDataWithPercentage.sort((e,t)=>{const i=e.percentage,n=t.percentage;return i>n?-1:i<n?1:0})}ngAfterViewInit(){this.titleLabel&&this.titleLabel.nativeElement.focus()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["chart-details-modal"]],viewQuery:function(e,t){var i;1&e&&c.ed(ID,!0),2&e&&c.Kc(i=c.kc())&&(t.titleLabel=i.first)},inputs:{barChartData:"barChartData",title:"title",durationFormat:"durationFormat",totalDuration:"totalDuration"},decls:13,vars:5,consts:[[1,"cl-modal-body","cl-overflow-auto"],[1,"cl-m-0","tr-table-reset"],[1,"cl-pb-2"],["titleLabel",""],[1,"cl-text-right","cl-px-2"],[4,"ngFor","ngForOf"],[1,"cl-project-name"],[1,"cl-entry__project__dot"],["class","cl-text-gray-9",4,"ngIf"],[1,"cl-text-gray-9","cl-text-right"],[1,"cl-text-gray-9"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"table",1),c.Xb(2,"tr"),c.Xb(3,"th",2,3),c.Xb(5,"b"),c.Yc(6,"Projects"),c.Wb(),c.Wb(),c.Xb(7,"th",4),c.Xb(8,"b"),c.Yc(9),c.oc(10,"timeFormat"),c.Wb(),c.Wb(),c.Sb(11,"th",4),c.Wb(),c.Wc(12,XD,13,9,"ng-container",5),c.Wb(),c.Wb()),2&e&&(c.Cb(9),c.Zc(c.qc(10,2,t.totalDuration,t.durationFormat)),c.Cb(3),c.wc("ngForOf",t.barChartDataWithPercentage))},directives:[s.t,s.u],pipes:[yh.a],encapsulation:2,changeDetection:0}),e})();function TD(e,t){if(1&e&&c.Sb(0,"approval-detail-info",15),2&e){const e=c.nc();c.wc("details",e.approvalRequest)}}function DD(e,t){if(1&e){const e=c.Yb();c.Xb(0,"bar-chart",16),c.jc("showAllBarValues",(function(t){c.Oc(e);const i=c.nc(),n=c.Lc(16);return i.openModalForBar(t,n)})),c.Wb()}if(2&e){const e=c.nc();c.wc("barChartData",e.barChartData)("barChartLabels",e.barChartLabels)("totalDurationByDate",e.totalDurationByDate)("projectCountByDate",e.projectCountByDate)("isBillabilityType",!1)("updateDataOnChartChange",!0)("canSeeRates",!0)("format",e.durationFormat)("currency",e.currency)("chartDataDurationUnit","seconds")}}function RD(e,t){if(1&e&&c.Sb(0,"doughnut-chart",17),2&e){const e=c.nc();c.wc("currency",e.currency)("format",e.durationFormat)("canSeeRates",!0)("tooltipToLeft",!1)("isBillabilityType",!1)("updateDataOnChartChange",!0)("doughnutChart",e.doughnutChart)("totalTime",e.totalTime)}}function AD(e,t){if(1&e){const e=c.Yb();c.Xb(0,"chart-horizontal",18),c.jc("onLoadMore",(function(){return c.Oc(e),c.nc().loadMore()})),c.Wb()}if(2&e){const e=c.nc();c.wc("durationFormat",e.durationFormat)("totalLength",null==e.doughnutChartAll?null:e.doughnutChartAll.length)("chartData",e.doughnutChart)}}function jD(e,t){if(1&e&&(c.Vb(0),c.Sb(1,"approval-entry-group",19),c.Ub()),2&e){const e=t.$implicit,i=c.nc();c.Cb(1),c.wc("durationFormat",i.durationFormat)("entryGroup",e)("ownerTimeZone",i.approvalRequest.owner.timeZone)("customFields",i.customFields)("showApprovalStatus",!i.equalStatus&&i.approvalRequest.status.state===i.ApprovalStatus.PENDING)}}function xD(e,t){if(1&e&&(c.Xb(0,"modal-header",20),c.jc("onClose",(function(){return t.$implicit.close()})),c.Wb(),c.Sb(1,"chart-details-modal",21)),2&e){const e=c.nc();c.wc("title",e.barChartLabels[e.selectedIndex]),c.Cb(1),c.wc("durationFormat",e.durationFormat)("totalDuration",e.totalDurationByDate[e.selectedIndex])("barChartData",e.selectedBarChartsData)}}let PD=(()=>{class e{constructor(e,t,i,n,s,c,r){this.workspaceService=e,this.approvalService=t,this.route=i,this.customFieldService=n,this.cd=s,this.systemSettingsService=c,this.modalService=r,this.ApprovalStatus=Ot,this.unsubscribe$=new Ee.a}ngOnInit(){this.id=this.route.snapshot.params.id,this.setWorkspace(),this.getDetailsData(),this.getDashboardData()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setWorkspace(){this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.durationFormat=e.getTimeFormat(),this.currency=e.hourlyRate.currency,this.workspace=e,e.hasFeature(nr.a.CUSTOM_FIELDS)&&this.getCustomFields()})}getDetailsData(){this.approvalService.getApprovalDetails(this.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.approvalRequest=e.approvalRequest,this.entryGroups=e.entryGroups,this.tableInfo=e.tableInfo,this.equalStatus=e.equalStatus,this.cd.markForCheck()})}getDashboardData(){this.approvalService.getApprovalDashboard(this.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.dates=e.dates,this.totalTime=e.totalTime;const t=e.barChartData.map(e=>new MT(e,this.totalTime));t.sort((e,t)=>e.percentage>t.percentage?-1:e.percentage<t.percentage||e.label>t.label?1:e.label<t.label?-1:void 0),this.doughnutChartAll=t,this.doughnutChart=this.doughnutChartAll.slice(0,10),this.barChartData=t.length?t:[new MT({})],this.barChartLabels=this.dates.map(e=>Se(e).format("ddd, MMM D")),this.totalDurationByDate=e.totalDurationByDate.map(e=>new Bd.a(e).asSeconds()),this.projectCountByDate=e.projectCountByDate,this.dateAndTotalTime=e.dateAndTotalTime,this.cd.detectChanges()})}openModalForBar(e,t){this.selectedIndex=e,this.selectedBarChartsData=this.dateAndTotalTime[this.dates[e]].map(e=>new MT(e,this.totalTime)),this.modalService.open(t,{centered:!0})}loadMore(){this.doughnutChart=this.doughnutChartAll.slice(0,this.doughnutChart.length+10),this.cd.detectChanges()}getCustomFields(){this.customFieldService.get().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.customFields=e,this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(Mt),c.Rb(W.a),c.Rb(qd.a),c.Rb(c.h),c.Rb(Lt.a),c.Rb(g.q))},e.\u0275cmp=c.Lb({type:e,selectors:[["approval-details-page"]],decls:17,vars:10,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],["class","cl-row cl-align-items-end",3,"details",4,"ngIf"],[1,"cl-card","cl-border-bottom"],[1,"cl-card-header","cl-px-0",3,"tableInfo","isCostRateActive","durationFormat","status","currency"],[1,"cl-card-body","cl-p-0"],[1,"cl-main-chart-wrapper"],["class","cl-main-chart-container cl-d-block",3,"barChartData","barChartLabels","totalDurationByDate","projectCountByDate","isBillabilityType","updateDataOnChartChange","canSeeRates","format","currency","chartDataDurationUnit","showAllBarValues",4,"ngIf"],[1,"cl-main-chart-container"],[1,"cl-row"],["class","cl-col-md-4 cl-mb-3 cl-mb-md-0",3,"currency","format","canSeeRates","tooltipToLeft","isBillabilityType","updateDataOnChartChange","doughnutChart","totalTime",4,"ngIf"],["class","cl-col-md-8",3,"durationFormat","totalLength","chartData","onLoadMore",4,"ngIf"],[4,"ngFor","ngForOf"],["chartModal",""],[1,"cl-row","cl-align-items-end",3,"details"],[1,"cl-main-chart-container","cl-d-block",3,"barChartData","barChartLabels","totalDurationByDate","projectCountByDate","isBillabilityType","updateDataOnChartChange","canSeeRates","format","currency","chartDataDurationUnit","showAllBarValues"],[1,"cl-col-md-4","cl-mb-3","cl-mb-md-0",3,"currency","format","canSeeRates","tooltipToLeft","isBillabilityType","updateDataOnChartChange","doughnutChart","totalTime"],[1,"cl-col-md-8",3,"durationFormat","totalLength","chartData","onLoadMore"],[1,"cl-d-block","cl-card","cl-border-bottom",3,"durationFormat","entryGroup","ownerTimeZone","customFields","showApprovalStatus"],[3,"title","onClose"],[3,"durationFormat","totalDuration","barChartData"]],template:function(e,t){1&e&&(c.Xb(0,"main",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Wc(3,TD,1,1,"approval-detail-info",3),c.Wb(),c.Xb(4,"div",4),c.Sb(5,"approval-table-header",5),c.Xb(6,"div",6),c.Xb(7,"div",7),c.Wc(8,DD,1,10,"bar-chart",8),c.Wb(),c.Xb(9,"div",7),c.Xb(10,"div",9),c.Xb(11,"div",10),c.Wc(12,RD,1,8,"doughnut-chart",11),c.Wc(13,AD,1,3,"chart-horizontal",12),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(14,jD,2,5,"ng-container",13),c.Wb(),c.Wb(),c.Wc(15,xD,2,4,"ng-template",null,14,c.Xc)),2&e&&(c.Cb(3),c.wc("ngIf",t.approvalRequest),c.Cb(2),c.wc("tableInfo",t.tableInfo)("isCostRateActive",null==t.workspace?null:t.workspace.isCostRateActive)("durationFormat",t.durationFormat)("status",null==t.approvalRequest||null==t.approvalRequest.status?null:t.approvalRequest.status.state)("currency",t.currency),c.Cb(3),c.wc("ngIf",t.barChartData),c.Cb(4),c.wc("ngIf",t.doughnutChart),c.Cb(1),c.wc("ngIf",t.doughnutChart),c.Cb(1),c.wc("ngForOf",t.entryGroups))},directives:[s.u,NT,s.t,sD,Cc.a,kc.a,pD,SD,wl.a,ED],encapsulation:2,changeDetection:0}),e})();var MD=function(e){return e.PAYMENT="PAYMENT",e.INVOICES="INVOICES",e.PLANS="PLANS",e}({});function YD(e,t){1&e&&(c.Xb(0,"div",20),c.Xb(1,"div",21),c.Xb(2,"span"),c.Yc(3," You are currently using legacy pricing plan. Once you cancel the subscription, it's impossible to go back to your old pricing plan. "),c.Wb(),c.Wb(),c.Wb())}function LD(e,t){if(1&e&&(c.Xb(0,"button",22),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.Zc(e.reason.name)}}function FD(e,t){1&e&&(c.Xb(0,"button",23),c.Yc(1,"Select reason "),c.Wb())}function ND(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",27),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).selectReason(i)})),c.Yc(1),c.Wb()}if(2&e){const e=t.$implicit;c.Cb(1),c.Zc(e.name)}}function UD(e,t){if(1&e&&(c.Xb(0,"div",24),c.Xb(1,"div",25),c.Wc(2,ND,2,1,"a",26),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(2),c.wc("ngForOf",e.cancellationReasons)}}function $D(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",8),c.Xb(1,"div",28),c.Xb(2,"textarea",29),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc(2).reasonMessage=t})),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(2),c.Hb("cl-is-invalid",e.alert),c.wc("placeholder",e.reason.placeholder)("ngModel",e.reasonMessage)}}function _D(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div"),c.Xb(1,"div",1),c.Xb(2,"h1",2),c.Yc(3,"Cancel subscription"),c.Wb(),c.Xb(4,"button",3),c.jc("click",(function(){return c.Oc(e),c.nc().close()})),c.Xb(5,"span",4),c.Sb(6,"img",5),c.Wb(),c.Wb(),c.Wb(),c.Xb(7,"div",6),c.Wc(8,YD,4,0,"div",7),c.Xb(9,"div"),c.Xb(10,"form"),c.Xb(11,"div",8),c.Xb(12,"div",9),c.Xb(13,"h3",10),c.Yc(14,"I\u2019m canceling because"),c.Wb(),c.Xb(15,"div",11),c.Wc(16,LD,2,1,"button",12),c.Wc(17,FD,2,0,"button",13),c.Wc(18,UD,3,1,"div",14),c.Wb(),c.Wb(),c.Wb(),c.Wc(19,$D,3,4,"div",15),c.Wb(),c.Wb(),c.Wb(),c.Xb(20,"div",16),c.Xb(21,"a",17),c.jc("click",(function(){return c.Oc(e),c.nc().close()})),c.Yc(22,"Nevermind"),c.Wb(),c.Xb(23,"div",18),c.jc("mouseenter",(function(){return c.Oc(e),c.nc().alert=!0}))("mouseleave",(function(){return c.Oc(e),c.nc().alert=!1})),c.Xb(24,"button",19),c.jc("click",(function(){return c.Oc(e),c.nc().cancelPaymentSubscription()})),c.Yc(25,"Cancel subscription "),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(8),c.wc("ngIf",e.isLegacy),c.Cb(8),c.wc("ngIf",e.reason),c.Cb(1),c.wc("ngIf",!e.reason),c.Cb(2),c.wc("ngIf",e.reason),c.Cb(5),c.wc("disabled",!e.reasonMessage||""===e.reasonMessage||e.disableButton)("title","Please leave a comment first")}}function GD(e,t){1&e&&(c.Xb(0,"div",36),c.Xb(1,"span"),c.Yc(2,"Need help? "),c.Wb(),c.Xb(3,"a",37),c.Yc(4,"Call support "),c.Wb(),c.Xb(5,"span"),c.Yc(6,"or "),c.Wb(),c.Xb(7,"a",38),c.Yc(8,"schedule demo"),c.Wb(),c.Wb())}function BD(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div"),c.Xb(1,"div",30),c.Wc(2,GD,9,0,"div",31),c.Xb(3,"div",20),c.Sb(4,"img",32),c.Wb(),c.Xb(5,"div",33),c.Yc(6,"Cancel subscription"),c.Wb(),c.Xb(7,"ul",34),c.Xb(8,"li"),c.Yc(9,"You will lose access to all the extra features once the subscription ends."),c.Wb(),c.Wb(),c.Wb(),c.Xb(10,"div",16),c.Xb(11,"a",17),c.jc("click",(function(){return c.Oc(e),c.nc().close()})),c.Yc(12,"Keep subscription"),c.Wb(),c.Xb(13,"button",35),c.jc("click",(function(){return c.Oc(e),c.nc().continue()})),c.Yc(14,"Continue "),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(2),c.wc("ngIf",!e.isForbiddenZone)}}let VD=(()=>{class e{constructor(){this.closeModal=new c.n,this.cancelSubscription=new c.n,this.cancellationReasons=[{name:"Downgrading but still using Clockify",id:1,placeholder:"I'm downgrading because..."},{name:"Decided to use another tool ",id:2,placeholder:"I'm switching to... because.."},{name:"Not what I expected",id:3,placeholder:"I expected..."},{name:"Other",id:4,placeholder:"I'm canceling because..."}],this.warning=!0}ngOnInit(){this.isForbiddenZone=ei.g.includes(Se.tz.guess())}close(){this.closeModal.emit(!0)}continue(){this.warning=!1}cancelPaymentSubscription(){this.reasonMessage&&""!=this.reasonMessage&&this.cancelSubscription.emit(this.reason.name+", "+this.reasonMessage)}selectReason(e){this.reason=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["cancel-subscription"]],inputs:{disableButton:"disableButton",isLegacy:"isLegacy"},outputs:{closeModal:"closeModal",cancelSubscription:"cancelSubscription"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],["class","cl-mb-3",4,"ngIf"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-lg-custom-12"],[1,"cl-font-weight-bold"],["dropdownKey","",1,"cl-dropdown"],["class","cl-btn cl-w-100 cl-text-left cl-btn-outline-light cl-dropdown-toggle","dropdownKeyButton","","type","button",4,"ngIf"],["class","cl-btn cl-w-100 cl-text-left cl-btn-outline-light cl-dropdown-toggle","dropdownKeyButton","","type","button","ngbAutofocus","",4,"ngIf"],["class","cl-dropdown-menu",4,"dropdownKeyContent"],["class","cl-form-row",4,"ngIf"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],[3,"mouseenter","mouseleave"],[1,"cl-btn","cl-btn-primary",3,"disabled","title","click"],[1,"cl-mb-3"],[1,"cl-alert","cl-alert-warning","cl-fade","cl-show","cl-mb-2","cl-text-left","cl-p-2"],["dropdownKeyButton","","type","button",1,"cl-btn","cl-w-100","cl-text-left","cl-btn-outline-light","cl-dropdown-toggle"],["dropdownKeyButton","","type","button","ngbAutofocus","",1,"cl-btn","cl-w-100","cl-text-left","cl-btn-outline-light","cl-dropdown-toggle"],[1,"cl-dropdown-menu"],[1,"cl-scroll-area"],["clickCloseDropdown","","class","cl-dropdown-item",3,"click",4,"ngFor","ngForOf"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],[1,"cl-form-group","cl-mb-0","cl-col-lg-custom-12"],["rows","4","name","reason",1,"cl-form-control",3,"placeholder","ngModel","ngModelChange"],[1,"cl-modal-body","cl-text-center","cl-py-4"],["class","cl-d-block cl-alert cl-alert-primary cl-alert-reset-main cl-fade cl-show cl-mb-2 cl-text-left cl-p-2",4,"ngIf"],["src","assets/images/illustrations/cancel-subscription.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-list-unstyled","cl-ml-0","cl-mb-0","cl-text-gray-6"],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-d-block","cl-alert","cl-alert-primary","cl-alert-reset-main","cl-fade","cl-show","cl-mb-2","cl-text-left","cl-p-2"],["href","https://calendly.com/clockify-support/call","target","_blank",1,"cl-font-weight-bold"],["href","https://clockify.me/help/contact/sales","target","_blank",1,"cl-font-weight-bold"]],template:function(e,t){1&e&&(c.Wc(0,_D,26,6,"div",0),c.Wc(1,BD,15,1,"div",0)),2&e&&(c.wc("ngIf",!t.warning),c.Cb(1),c.wc("ngIf",t.warning))},directives:[s.u,p.I,p.t,p.u,Si.a,Oi.a,Ii.a,s.t,p.c,p.s,p.v],encapsulation:2}),e})();const HD=["successModal"],zD=["featuresInfoModal"],qD=["upgradeModal"],KD=["userSeatsModal"],ZD=["subscriptionFailedModal"];function QD(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",38),c.Yc(1),c.Xb(2,"a",39),c.jc("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(8);return t.cancelSubscription(i)})),c.Yc(3,"Cancel"),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(1),c.cd(" ",null==e.nextSubscriptionType?null:e.nextSubscriptionType.title," ",-1===(null==e.nextSubscriptionType?null:e.nextSubscriptionType.value.indexOf("YEAR"))?"(monthly)":"(annual)"," will start on ",e.nextBillingDate,". ")}}function JD(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",39),c.jc("click",(function(){c.Oc(e);const t=c.nc(3),i=c.Lc(10);return t.openReactivateDialog(i)})),c.Yc(1,"Reactivate"),c.Wb()}}function eR(e,t){if(1&e&&(c.Xb(0,"div",40),c.Yc(1," Subscription canceled."),c.Wc(2,JD,2,0,"a",41),c.Wb()),2&e){const e=c.nc(2);c.Cb(2),c.wc("ngIf",!e.currentPaymentType.legacy)}}function tR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",40),c.Yc(1," Payment failed. "),c.Xb(2,"a",39),c.jc("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(6);return t.openEditPaymentInfo(i)})),c.Yc(3,"Retry payment"),c.Wb(),c.Wb()}}function iR(e,t){1&e&&(c.Xb(0,"span"),c.Yc(1,"(cancelled)"),c.Wb())}function nR(e,t){1&e&&(c.Xb(0,"span",42),c.Yc(1,"(legacy plan)"),c.Wb())}function sR(e,t){if(1&e&&(c.Xb(0,"span",43),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" (",e.isMonthly?"monthly":"annual"," billing) ")}}function cR(e,t){1&e&&(c.Xb(0,"span",43),c.Yc(1," (forever) "),c.Wb())}function rR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"span"),c.Xb(1,"a",44),c.jc("click",(function(){return c.Oc(e),c.nc(2).upgradeYearly()})),c.Yc(2,"Pay annually and save 20%"),c.Wb(),c.Wb()}}function oR(e,t){if(1&e&&(c.Xb(0,"span",45),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.Zc("."+(e.payment.amount?e.payment.amount.toString().split(".")[1]?e.payment.amount.toString().split(".")[1]:"00":e.currentPaymentType.fullPrice.toString().split(".")[1]))}}function aR(e,t){if(1&e&&(c.Xb(0,"div",46),c.Xb(1,"div"),c.Yc(2),c.Wb(),c.Xb(3,"div"),c.Yc(4),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.Cb(2),c.Zc(e.payment.paid?"Next billing date:":"Expiration date:"),c.Cb(2),c.Zc(e.nextBillingDate)}}const lR=function(e){return{"cl-disabled cl-text-dark":e}};function bR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div"),c.Sb(1,"hr"),c.Xb(2,"div",47),c.Xb(3,"span"),c.Xb(4,"span"),c.Yc(5,"User seats"),c.Wb(),c.Xb(6,"a",48),c.jc("click",(function(){return c.Oc(e),c.nc(2).openFeaturesInfo("user-seats")})),c.Sb(7,"img",49),c.Wb(),c.Wb(),c.Xb(8,"span"),c.Xb(9,"span",50),c.Xb(10,"a",51),c.jc("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(16);return t.isAddingSeats=!1,t.openModal(i)})),c.Yc(11,"Remove"),c.Wb(),c.Wb(),c.Yc(12," / "),c.Xb(13,"a",52),c.jc("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(16);return t.isAddingSeats=!0,t.openModal(i)})),c.Yc(14,"Add"),c.Wb(),c.Wb(),c.Wb(),c.Xb(15,"div",53),c.Sb(16,"div",54),c.Wb(),c.Xb(17,"p",55),c.Yc(18),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(9),c.xc("title",e.isUsedAllSeats?"Delete or deactivate some users first":""),c.Cb(1),c.wc("ngClass",c.Bc(10,lR,e.isUsedAllSeats)),c.Cb(6),c.Vc("width",e.percentage+"%"),c.Hb("cl-progress-bar-success-blue",!e.isUsedAllSeats)("cl-bg-danger",e.isUsedAllSeats),c.Cb(2),c.bd("",e.activeMembers," of ",e.payment.quantity," used")}}function uR(e,t){1&e&&(c.Xb(0,"ul",56),c.Xb(1,"li"),c.mc(),c.Xb(2,"svg",57),c.Sb(3,"path",58),c.Wb(),c.lc(),c.Xb(4,"span"),c.Yc(5,"Unlimited time tracking"),c.Wb(),c.Wb(),c.Xb(6,"li"),c.mc(),c.Xb(7,"svg",57),c.Sb(8,"path",58),c.Wb(),c.lc(),c.Xb(9,"span"),c.Yc(10,"Unlimited users"),c.Wb(),c.Wb(),c.Xb(11,"li"),c.mc(),c.Xb(12,"svg",57),c.Sb(13,"path",58),c.Wb(),c.lc(),c.Xb(14,"span"),c.Yc(15,"Unlimited projects"),c.Wb(),c.Wb(),c.Xb(16,"li"),c.mc(),c.Xb(17,"svg",57),c.Sb(18,"path",58),c.Wb(),c.lc(),c.Xb(19,"span"),c.Yc(20,"Unlimited reports"),c.Wb(),c.Wb(),c.Xb(21,"li"),c.mc(),c.Xb(22,"svg",57),c.Sb(23,"path",58),c.Wb(),c.lc(),c.Xb(24,"span"),c.Yc(25,"Apps & Integrations"),c.Wb(),c.Wb(),c.Xb(26,"li"),c.mc(),c.Xb(27,"svg",57),c.Sb(28,"path",58),c.Wb(),c.lc(),c.Xb(29,"span"),c.Yc(30,"API"),c.Wb(),c.Wb(),c.Wb())}function dR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",48),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(4).openFeaturesInfo(t.type)})),c.Sb(1,"img",49),c.Wb()}}function pR(e,t){if(1&e&&(c.Xb(0,"li"),c.mc(),c.Xb(1,"svg",57),c.Sb(2,"path",58),c.Wb(),c.lc(),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wc(5,dR,2,0,"a",60),c.Wb()),2&e){const e=t.$implicit;c.Cb(4),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function hR(e,t){if(1&e&&(c.Vb(0),c.Wc(1,pR,6,2,"li",59),c.Ub()),2&e){const e=c.nc(3);c.Cb(1),c.wc("ngForOf",e.PLUS_FEATURES_TYPES)}}function mR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",48),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(4).openFeaturesInfo(t.type)})),c.Sb(1,"img",49),c.Wb()}}function gR(e,t){if(1&e&&(c.Xb(0,"li"),c.mc(),c.Xb(1,"svg",57),c.Sb(2,"path",58),c.Wb(),c.lc(),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wc(5,mR,2,0,"a",60),c.Wb()),2&e){const e=t.$implicit;c.Cb(4),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function fR(e,t){if(1&e&&(c.Vb(0),c.Wc(1,gR,6,2,"li",59),c.Ub()),2&e){const e=c.nc(3);c.Cb(1),c.wc("ngForOf",e.PREMIUM_FEATURES_TYPES)}}function vR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",48),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(4).openFeaturesInfo(t.type)})),c.Sb(1,"img",49),c.Wb()}}function wR(e,t){if(1&e&&(c.Xb(0,"li"),c.mc(),c.Xb(1,"svg",57),c.Sb(2,"path",58),c.Wb(),c.lc(),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wc(5,vR,2,0,"a",60),c.Wb()),2&e){const e=t.$implicit;c.Cb(4),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function yR(e,t){if(1&e&&(c.Vb(0),c.Wc(1,wR,6,2,"li",59),c.Ub()),2&e){const e=c.nc(3);c.Cb(1),c.wc("ngForOf",e.ENTERPRISE_FEATURES_TYPES)}}function WR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",48),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(4).openFeaturesInfo(t.type)})),c.Sb(1,"img",49),c.Wb()}}function CR(e,t){if(1&e&&(c.Xb(0,"li"),c.mc(),c.Xb(1,"svg",57),c.Sb(2,"path",58),c.Wb(),c.lc(),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wc(5,WR,2,0,"a",60),c.Wb()),2&e){const e=t.$implicit;c.Cb(4),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function kR(e,t){if(1&e&&(c.Vb(0),c.Wc(1,CR,6,2,"li",59),c.Ub()),2&e){const e=c.nc(3);c.Cb(1),c.wc("ngForOf",e.BASIC_2021_FEATURE_TYPES)}}function SR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",48),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(4).openFeaturesInfo(t.type)})),c.Sb(1,"img",49),c.Wb()}}function IR(e,t){if(1&e&&(c.Xb(0,"li"),c.mc(),c.Xb(1,"svg",57),c.Sb(2,"path",58),c.Wb(),c.lc(),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wc(5,SR,2,0,"a",60),c.Wb()),2&e){const e=t.$implicit;c.Cb(4),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function OR(e,t){if(1&e&&(c.Vb(0),c.Wc(1,IR,6,2,"li",59),c.Ub()),2&e){const e=c.nc(3);c.Cb(1),c.wc("ngForOf",e.STANDARD_2021_FEATURE_TYPES)}}function XR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",48),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(4).openFeaturesInfo(t.type)})),c.Sb(1,"img",49),c.Wb()}}function ER(e,t){if(1&e&&(c.Xb(0,"li"),c.mc(),c.Xb(1,"svg",57),c.Sb(2,"path",58),c.Wb(),c.lc(),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wc(5,XR,2,0,"a",60),c.Wb()),2&e){const e=t.$implicit;c.Cb(4),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function TR(e,t){if(1&e&&(c.Vb(0),c.Wc(1,ER,6,2,"li",59),c.Ub()),2&e){const e=c.nc(3);c.Cb(1),c.wc("ngForOf",e.PRO_2021_FEATURE_TYPES)}}function DR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",48),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(4).openFeaturesInfo(t.type)})),c.Sb(1,"img",49),c.Wb()}}function RR(e,t){if(1&e&&(c.Xb(0,"li"),c.mc(),c.Xb(1,"svg",57),c.Sb(2,"path",58),c.Wb(),c.lc(),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wc(5,DR,2,0,"a",60),c.Wb()),2&e){const e=t.$implicit;c.Cb(4),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function AR(e,t){if(1&e&&(c.Vb(0),c.Wc(1,RR,6,2,"li",59),c.Ub()),2&e){const e=c.nc(3);c.Cb(1),c.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function jR(e,t){if(1&e&&(c.Xb(0,"ul",56),c.Wc(1,hR,2,1,"ng-container",0),c.Wc(2,fR,2,1,"ng-container",0),c.Wc(3,yR,2,1,"ng-container",0),c.Wc(4,kR,2,1,"ng-container",0),c.Wc(5,OR,2,1,"ng-container",0),c.Wc(6,TR,2,1,"ng-container",0),c.Wc(7,AR,2,1,"ng-container",0),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.wc("ngIf",e.isPlus(e.currentPaymentType.value)||e.isPremium(e.currentPaymentType.value)||e.isEnterprise(e.currentPaymentType.value)),c.Cb(1),c.wc("ngIf",e.isPremium(e.currentPaymentType.value)||e.isEnterprise(e.currentPaymentType.value)),c.Cb(1),c.wc("ngIf",e.isEnterprise(e.currentPaymentType.value)),c.Cb(1),c.wc("ngIf",e.isBasic(e.currentPaymentType.value)||e.isStandard(e.currentPaymentType.value)||e.isPro(e.currentPaymentType.value)||e.isEnterprise2021(e.currentPaymentType.value)),c.Cb(1),c.wc("ngIf",e.isStandard(e.currentPaymentType.value)||e.isPro(e.currentPaymentType.value)||e.isEnterprise2021(e.currentPaymentType.value)),c.Cb(1),c.wc("ngIf",e.isPro(e.currentPaymentType.value)||e.isEnterprise2021(e.currentPaymentType.value)),c.Cb(1),c.wc("ngIf",e.isEnterprise2021(e.currentPaymentType.value))}}function xR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",48),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(4).openFeaturesInfo(t.type)})),c.Sb(1,"img",49),c.Wb()}}function PR(e,t){if(1&e&&(c.Xb(0,"li"),c.Xb(1,"span"),c.Yc(2),c.Wb(),c.Wc(3,xR,2,0,"a",60),c.Wb()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function MR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",48),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(4).openFeaturesInfo(t.type)})),c.Sb(1,"img",49),c.Wb()}}function YR(e,t){if(1&e&&(c.Xb(0,"li"),c.Xb(1,"span"),c.Yc(2),c.Wb(),c.Wc(3,MR,2,0,"a",60),c.Wb()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function LR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",48),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(4).openFeaturesInfo(t.type)})),c.Sb(1,"img",49),c.Wb()}}function FR(e,t){if(1&e&&(c.Xb(0,"li"),c.Xb(1,"span"),c.Yc(2),c.Wb(),c.Wc(3,LR,2,0,"a",60),c.Wb()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function NR(e,t){if(1&e&&(c.Vb(0),c.Wc(1,PR,4,2,"li",59),c.Xb(2,"div",63),c.Wc(3,YR,4,2,"li",59),c.Wb(),c.Xb(4,"div",63),c.Wc(5,FR,4,2,"li",59),c.Wb(),c.Ub()),2&e){const e=c.nc(3);c.Cb(1),c.wc("ngForOf",e.STANDARD_2021_FEATURE_TYPES),c.Cb(2),c.wc("ngForOf",e.PRO_2021_FEATURE_TYPES),c.Cb(2),c.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function UR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",48),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(4).openFeaturesInfo(t.type)})),c.Sb(1,"img",49),c.Wb()}}function $R(e,t){if(1&e&&(c.Xb(0,"li"),c.Xb(1,"span"),c.Yc(2),c.Wb(),c.Wc(3,UR,2,0,"a",60),c.Wb()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function _R(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",48),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(4).openFeaturesInfo(t.type)})),c.Sb(1,"img",49),c.Wb()}}function GR(e,t){if(1&e&&(c.Xb(0,"li"),c.Xb(1,"span"),c.Yc(2),c.Wb(),c.Wc(3,_R,2,0,"a",60),c.Wb()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function BR(e,t){if(1&e&&(c.Vb(0),c.Wc(1,$R,4,2,"li",59),c.Xb(2,"div",63),c.Wc(3,GR,4,2,"li",59),c.Wb(),c.Ub()),2&e){const e=c.nc(3);c.Cb(1),c.wc("ngForOf",e.PRO_2021_FEATURE_TYPES),c.Cb(2),c.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function VR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",48),c.jc("click",(function(){c.Oc(e);const t=c.nc().$implicit;return c.nc(4).openFeaturesInfo(t.type)})),c.Sb(1,"img",49),c.Wb()}}function HR(e,t){if(1&e&&(c.Xb(0,"li"),c.Xb(1,"span"),c.Yc(2),c.Wb(),c.Wc(3,VR,2,0,"a",60),c.Wb()),2&e){const e=t.$implicit;c.Cb(2),c.Zc(e.title),c.Cb(1),c.wc("ngIf",e.text)}}function zR(e,t){if(1&e&&(c.Vb(0),c.Wc(1,HR,4,2,"li",59),c.Ub()),2&e){const e=c.nc(3);c.Cb(1),c.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}const qR=function(){return["/subscription"]};function KR(e,t){if(1&e&&(c.Vb(0),c.Sb(1,"hr"),c.Xb(2,"div",61),c.Xb(3,"a",62),c.Yc(4,"Upgrade"),c.Wb(),c.Yc(5," to get more features"),c.Wb(),c.Xb(6,"ul",56),c.Wc(7,NR,6,3,"ng-container",0),c.Wc(8,BR,4,2,"ng-container",0),c.Wc(9,zR,2,1,"ng-container",0),c.Wb(),c.Ub()),2&e){const e=c.nc(2);c.Cb(3),c.wc("routerLink",c.Ac(4,qR)),c.Cb(4),c.wc("ngIf",e.isBasic(e.currentPaymentType.value)),c.Cb(1),c.wc("ngIf",e.isStandard(e.currentPaymentType.value)),c.Cb(1),c.wc("ngIf",e.isPro(e.currentPaymentType.value))}}function ZR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",64),c.Xb(1,"div",65),c.Xb(2,"div",66),c.Xb(3,"div",67),c.Xb(4,"div",68),c.Xb(5,"span",69),c.Yc(6,"Invoice information"),c.Wb(),c.Xb(7,"a",70),c.jc("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(4);return t.openEditInvoiceInfo(i)})),c.Yc(8,"Edit"),c.Wb(),c.Wb(),c.Xb(9,"div",71),c.Yc(10,"Company name"),c.Wb(),c.Xb(11,"div",16),c.Yc(12),c.Wb(),c.Xb(13,"div",71),c.Yc(14,"Send emails to"),c.Wb(),c.Xb(15,"div",16),c.Yc(16),c.Wb(),c.Xb(17,"div",71),c.Yc(18,"Country"),c.Wb(),c.Xb(19,"div",16),c.Yc(20),c.Wb(),c.Xb(21,"div",71),c.Yc(22,"Address"),c.Wb(),c.Xb(23,"div",16),c.Yc(24),c.Wb(),c.Xb(25,"div",71),c.Yc(26,"City"),c.Wb(),c.Xb(27,"div",16),c.Yc(28),c.Wb(),c.Xb(29,"div",71),c.Yc(30,"State / Province"),c.Wb(),c.Xb(31,"div",16),c.Yc(32),c.Wb(),c.Xb(33,"div",71),c.Yc(34,"ZIP / Postal code"),c.Wb(),c.Xb(35,"div",16),c.Yc(36),c.Wb(),c.Xb(37,"div",71),c.Yc(38,"Tax ID"),c.Wb(),c.Xb(39,"div",16),c.Yc(40),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(41,"div",72),c.Xb(42,"div",66),c.Xb(43,"div",67),c.Xb(44,"div",68),c.Xb(45,"span",69),c.Yc(46,"Payment information"),c.Wb(),c.Xb(47,"a",70),c.jc("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(6);return t.openEditPaymentInfo(i)})),c.Yc(48,"Edit"),c.Wb(),c.Wb(),c.Xb(49,"div",71),c.Yc(50,"Visa"),c.Wb(),c.Xb(51,"div",16),c.Yc(52),c.Wb(),c.Xb(53,"div",71),c.Yc(54,"Expiration date"),c.Wb(),c.Xb(55,"div",16),c.Yc(56),c.Wb(),c.Xb(57,"div",71),c.Yc(58,"Card holder"),c.Wb(),c.Xb(59,"div",16),c.Yc(60),c.Wb(),c.Xb(61,"div",71),c.Yc(62,"Street"),c.Wb(),c.Xb(63,"div",16),c.Yc(64),c.Wb(),c.Xb(65,"div",71),c.Yc(66,"ZIP / Postal code"),c.Wb(),c.Xb(67,"div",16),c.Yc(68),c.Wb(),c.Xb(69,"div",71),c.Yc(70,"State / Province"),c.Wb(),c.Xb(71,"div",16),c.Yc(72),c.Wb(),c.Xb(73,"div",71),c.Yc(74,"Country"),c.Wb(),c.Xb(75,"div",16),c.Yc(76),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(12),c.Zc((null==e.invoiceInformation?null:e.invoiceInformation.companyName)||"(no data)"),c.Cb(4),c.Zc((null==e.invoiceInformation?null:e.invoiceInformation.email)||"(no data)"),c.Cb(4),c.Zc((null==e.invoiceInformation?null:e.invoiceInformation.country)||"(no data)"),c.Cb(4),c.Zc((null==e.invoiceInformation?null:e.invoiceInformation.address1)||"(no data)"),c.Cb(4),c.Zc((null==e.invoiceInformation?null:e.invoiceInformation.city)||"(no data)"),c.Cb(4),c.Zc((null==e.invoiceInformation?null:e.invoiceInformation.state)||"(no data)"),c.Cb(4),c.Zc((null==e.invoiceInformation?null:e.invoiceInformation.zip)||"(no data)"),c.Cb(4),c.Zc((null==e.invoiceInformation?null:e.invoiceInformation.vatNumber)||"(no data)"),c.Cb(12),c.ad("************",null==e.paymentInformation?null:e.paymentInformation.last4,""),c.Cb(4),c.bd("",null==e.paymentInformation?null:e.paymentInformation.cardExpMonth,"/",null==e.paymentInformation?null:e.paymentInformation.cardExpYear,""),c.Cb(4),c.Zc(null==e.paymentInformation?null:e.paymentInformation.cardHolder),c.Cb(4),c.Zc(null==e.paymentInformation?null:e.paymentInformation.street),c.Cb(4),c.Zc(null==e.paymentInformation?null:e.paymentInformation.zip),c.Cb(4),c.Zc(null==e.paymentInformation?null:e.paymentInformation.state),c.Cb(4),c.Zc(null==e.paymentInformation?null:e.paymentInformation.country)}}function QR(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",73),c.jc("click",(function(){c.Oc(e);const t=c.nc(2),i=c.Lc(8);return t.cancelSubscription(i)})),c.Yc(1," Cancel subscription "),c.Wb()}}function JR(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"div",10),c.Xb(2,"div",11),c.Xb(3,"div",12),c.Xb(4,"div",13),c.Wc(5,QD,4,3,"div",14),c.Wc(6,eR,3,1,"div",15),c.Wc(7,tR,4,0,"div",15),c.Xb(8,"div",16),c.Yc(9,"Current plan "),c.Wc(10,iR,2,0,"span",0),c.Wc(11,nR,2,0,"span",17),c.Wb(),c.Xb(12,"div",18),c.Xb(13,"span"),c.Yc(14),c.Wc(15,sR,2,1,"span",19),c.Wc(16,cR,2,0,"span",19),c.Wb(),c.Wc(17,rR,3,0,"span",0),c.Wb(),c.Wb(),c.Xb(18,"div",20),c.Xb(19,"div",21),c.Xb(20,"div",22),c.Xb(21,"div",23),c.Xb(22,"span",24),c.Yc(23,"$"),c.Wb(),c.Xb(24,"span",25),c.Yc(25),c.Wb(),c.Wc(26,oR,2,1,"span",26),c.Wb(),c.Xb(27,"div"),c.Xb(28,"div",27),c.Yc(29),c.Wb(),c.Wb(),c.Wb(),c.Wc(30,aR,5,2,"div",28),c.Wb(),c.Wc(31,bR,19,12,"div",0),c.Sb(32,"hr"),c.Xb(33,"div",21),c.Xb(34,"div",16),c.Yc(35),c.Wb(),c.Xb(36,"div",16),c.Yc(37),c.oc(38,"number"),c.Wb(),c.Wb(),c.Xb(39,"div",29),c.Sb(40,"hr"),c.Wc(41,uR,31,0,"ul",30),c.Wc(42,jR,8,7,"ul",30),c.Wc(43,KR,10,5,"ng-container",0),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(44,"div",31),c.Wc(45,ZR,77,16,"div",32),c.Wb(),c.Wb(),c.Xb(46,"div",33),c.Xb(47,"p",34),c.Yc(48," For any questions visit our "),c.Xb(49,"a",35),c.Yc(50,"Help center"),c.Wb(),c.Yc(51,", or contact us at "),c.Xb(52,"a",36),c.Yc(53),c.Wb(),c.Wb(),c.Wc(54,QR,2,0,"a",37),c.Wb(),c.Ub()),2&e){const e=c.nc();c.Cb(2),c.wc("ngClass",e.currentPaymentType.colorParent),c.Cb(3),c.wc("ngIf",e.nextSubscriptionType&&e.nextSubscriptionType.value!=e.currentPaymentType.value),c.Cb(1),c.wc("ngIf",!(e.payment.paid||e.nextSubscriptionType&&e.nextSubscriptionType.value!=e.currentPaymentType.value||"FREE"===e.currentPaymentType.value)),c.Cb(1),c.wc("ngIf",e.paymentFailed),c.Cb(3),c.wc("ngIf",(null==e.nextSubscriptionType?null:e.nextSubscriptionType.value)!=e.currentPaymentType.value&&e.payment.paid),c.Cb(1),c.wc("ngIf",e.currentPaymentType.legacy),c.Cb(3),c.ad("",e.currentPaymentType.title.toUpperCase()," "),c.Cb(1),c.wc("ngIf","FREE"!==e.currentPaymentType.value),c.Cb(1),c.wc("ngIf","FREE"===e.currentPaymentType.value),c.Cb(1),c.wc("ngIf",!e.currentPaymentType.legacy&&-1===e.currentPaymentType.label.indexOf("YEAR")&&(null==e.nextSubscriptionType?null:e.nextSubscriptionType.value)===e.currentPaymentType.value&&e.payment.paid),c.Cb(8),c.Zc(e.payment.amount?e.payment.amount.toString().split(".")[0]:e.currentPaymentType.price),c.Cb(1),c.wc("ngIf","FREE"!==e.currentPaymentType.value),c.Cb(3),c.bd("",null!=e.currentPaymentType&&e.currentPaymentType.bySeat?"per seat/":"per ","",e.isMonthly?"month":"year",""),c.Cb(1),c.wc("ngIf",e.nextBillingDate),c.Cb(1),c.wc("ngIf",null==e.currentPaymentType?null:e.currentPaymentType.bySeat),c.Cb(4),c.ad("Total ",e.isMonthly?"monthly":"yearly"," price"),c.Cb(2),c.ad("$",c.qc(38,25,e.payment.quantity*e.payment.amount,"1.2-2"),""),c.Cb(4),c.wc("ngIf","FREE"===e.currentPaymentType.value),c.Cb(1),c.wc("ngIf","FREE"!==e.currentPaymentType.value),c.Cb(1),c.wc("ngIf",!e.currentPaymentType.legacy&&!e.isEnterprise2021(e.currentPaymentType.value)),c.Cb(2),c.wc("ngIf","FREE"!==e.currentPaymentType.value),c.Cb(7),c.wc("href","mailto:"+e.supportEmail,c.Qc),c.Cb(1),c.Zc(e.supportEmail),c.Cb(1),c.wc("ngIf",e.payment.paid&&(null==e.nextSubscriptionType?null:e.nextSubscriptionType.value)===e.currentPaymentType.value)}}function eA(e,t){if(1&e&&(c.Xb(0,"features-info",74),c.jc("close",(function(){return t.$implicit.close()})),c.Wb()),2&e){const e=c.nc();c.wc("type",e.featuresInfoType)}}function tA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",75),c.Xb(1,"h1",76),c.Yc(2,"Invoice information"),c.Wb(),c.Xb(3,"button",77),c.jc("click",(function(){return t.$implicit.close()})),c.Xb(4,"span",78),c.Sb(5,"img",79),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",80),c.Xb(7,"stripe-invoice",81),c.jc("turnAddress",(function(t){return c.Oc(e),c.nc().addressOn=t})),c.Wb(),c.Wb(),c.Xb(8,"div",82),c.Xb(9,"a",83),c.jc("click",(function(){return t.$implicit.close()})),c.Yc(10,"Cancel"),c.Wb(),c.Xb(11,"button",84),c.jc("click",(function(){return c.Oc(e),c.nc().getInvoiceInformation()})),c.Yc(12,"Save"),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(7),c.wc("editInvoiceInformation",e.invoiceInformationCopy)("workspaceName",e.workspace.name)("mode","edit"),c.Cb(4),c.wc("disabled",e.buttonDisabled)}}function iA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",75),c.Xb(1,"h1",76),c.Yc(2,"Payment information"),c.Wb(),c.Xb(3,"button",77),c.jc("click",(function(){return t.$implicit.close()})),c.Xb(4,"span",78),c.Sb(5,"img",79),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",80),c.Xb(7,"stripe",85,86),c.jc("closeDialog",(function(){return t.$implicit.close()}))("paymentInformation",(function(t){return c.Oc(e),c.nc().getPaymentInformation(t)})),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(7),c.wc("editPaymentInformation",e.paymentInformationCopy)("invoiceInformation",e.invoiceInformation)("mode","edit")("isMonthly",e.isMonthly)("paymentFailedMessage",e.failMessage)}}function nA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"cancel-subscription",87),c.jc("closeModal",(function(){return t.$implicit.close()}))("cancelSubscription",(function(t){return c.Oc(e),c.nc().cancelPaymentSubscription(t)})),c.Wb()}if(2&e){const e=c.nc();c.wc("disableButton",e.buttonDisabled)("isLegacy",e.currentPaymentType.legacy)}}function sA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",88),c.Xb(1,"div",89),c.Sb(2,"img",90),c.Wb(),c.Xb(3,"div",91),c.Yc(4,"Reactivate subscription"),c.Wb(),c.Xb(5,"p",92),c.Yc(6),c.Wb(),c.Wb(),c.Xb(7,"div",82),c.Xb(8,"a",83),c.jc("click",(function(){return t.$implicit.close()})),c.Yc(9,"Nevermind"),c.Wb(),c.Xb(10,"button",93),c.jc("click",(function(){return c.Oc(e),c.nc().reactivate()})),c.Yc(11,"Reactivate"),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(6),c.bd("Once you reactivate your ",e.currentPaymentType.title," subscription, ",e.isMonthly?"monthly":"annual"," payments will continue and you'll be able to continue using the extra features.")}}function cA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"switching-plan",94),c.jc("pay",(function(t){return c.Oc(e),c.nc().pay(t)}))("closeModal",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("disableButton",e.buttonDisabled)("workspace",e.workspace)("type",e.plan)("price",e.price)}}function rA(e,t){if(1&e&&(c.Xb(0,"div",88),c.Xb(1,"div",89),c.Sb(2,"img",95),c.Wb(),c.Xb(3,"div",91),c.Yc(4,"Success!"),c.Wb(),c.Xb(5,"p",92),c.Yc(6),c.Wb(),c.Wb(),c.Xb(7,"div",82),c.Xb(8,"a",96),c.jc("click",(function(){return t.$implicit.close()})),c.Yc(9,"Close"),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(6),c.ad("You can now start using all the extra features on ",e.workspace.name," workspace, without any limitation.")}}function oA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"user-seats-modal",97),c.jc("closeModal",(function(){return t.$implicit.close()}))("saveQuantity",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().saveQuantity(i,n)})),c.Wb()}if(2&e){const e=c.nc();c.wc("activeUsers",e.activeMembers)("currentQuantity",e.payment.quantity)("unusedSeats",e.payment.quantity-e.activeMembers)("isAdd",e.isAddingSeats)("inProgress",e.inProgress)("currentType",e.currentPaymentType)("amount",e.payment.amount)}}function aA(e,t){1&e&&(c.Xb(0,"subscription-incomplete-modal",98),c.jc("close",(function(){return t.$implicit.close()})),c.Wb())}let lA=(()=>{class e{constructor(e,t,i,n,s,c,r,o,a){this.authService=e,this.workspaceService=t,this.paymentService=i,this.loader=n,this.toaster=s,this.systemSettingsService=c,this.modalService=r,this.notificationService=o,this.cd=a,this.unsubscribe$=new mi.a,this.isFree=ku.h,this.isPlus=ku.j,this.isPremium=ku.k,this.isEnterprise=ku.f,this.isBasic=ku.e,this.isStandard=ku.m,this.isPro=ku.l,this.isEnterprise2021=ku.g,this.BASIC_2021_FEATURE_TYPES=Eu,this.STANDARD_2021_FEATURE_TYPES=Du,this.PRO_2021_FEATURE_TYPES=Au,this.ENTERPRISE_2021_FEATURE_TYPES=xu,this.PLUS_FEATURES_TYPES=Mu,this.PREMIUM_FEATURES_TYPES=Lu,this.ENTERPRISE_FEATURES_TYPES=Nu}ngOnInit(){this.subscribeToWorkspace(),this.notificationService.paymentFailedNotification$.pipe(Object(It.a)(e=>null!=e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.paymentFailed=e&&e.filter(e=>e.data.workspaceId==this.workspace.id).length>0}),this.workspaceService.payment$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.payment=e,this.payment.nextSubscriptionType?(this.nextSubscriptionType=Object(ku.c)(e.nextSubscriptionType),this.nextBillingDate=Se(e.billingDate).format(this.profile.settings.dateFormat)):this.nextSubscriptionType=ku.a.FREE,this.percentage=this.payment.quantity?100*this.activeMembers/this.payment.quantity:0,this.isUsedAllSeats=this.percentage>=100,this.cd.detectChanges()}),this.systemSettingsService.customEmailsSettings.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.supportEmail=e.supportEmail}),this.systemSettingsService.getCustomEmailsSettings(),this.paymentService.getPaymentInformation(this.workspace.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.paymentInformation=e}),this.paymentService.getInvoiceInformation(this.workspace.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.invoiceInformation=e}),this.workspaceService.getPaymentDate()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}subscribeToWorkspace(){this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,this.activeMembers=this.workspace.memberships.filter(e=>e.isActiveOrPending).length,this.currentPaymentType=Object(ku.c)(this.workspace.featureSubscriptionType),this.profile=this.authService.getUser(),this.isMonthly=Object(ku.i)(this.currentPaymentType.value),this.cd.detectChanges()})}cancelSubscription(e){this.modalService.open(e,{centered:!0})}reactivate(){this.buttonDisabled=!0,this.loader.show("Processing payment"),this.paymentService.reactivateSubscription(this.workspace.id).subscribe(()=>{this.workspaceService.getPaymentDate(this.workspace.id),this.buttonDisabled=!1,this.loader.hide(),this.modalService.dismissAll()},()=>{this.loader.hide(),this.buttonDisabled=!1})}openEditInvoiceInfo(e){this.invoiceInformationCopy=new lf.a(this.invoiceInformation),this.modalService.open(e,{centered:!0})}openReactivateDialog(e){this.modalService.open(e,{centered:!0})}openEditPaymentInfo(e){this.paymentInformationCopy=new bf.a(this.paymentInformation),this.modalService.open(e,{centered:!0})}getInvoiceInformation(){this.invoiceInformationCopy.isCompanyNameEmpty()?this.toaster.pop("error","Company name is mandatory"):this.invoiceInformationCopy.isAddressEmpty(this.addressOn)?this.toaster.pop("error","All address fields are mandatory"):this.invoiceInformationCopy.isVatEmpty()?this.toaster.pop("error","Missing vat information"):(this.buttonDisabled=!0,this.loader.show("Updating"),this.paymentService.editInvoiceInformation(this.workspace.id,new lf.a(this.invoiceInformationCopy)).subscribe(e=>{this.invoiceInformation=e,this.modalService.dismissAll(),this.buttonDisabled=!1,this.loader.hide(),this.toaster.pop("success","Invoice information changed","This new information will be applied on all your future receipts")},e=>{var t;this.modalService.dismissAll(),this.buttonDisabled=!1,this.loader.hide(),this.toaster.pop("error",null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)}))}getPaymentInformation(e){this.buttonDisabled=!0,this.loader.show(),this.paymentService.editPaymentInformation(this.workspace.id,new bf.a(e)).subscribe(e=>{this.paymentInformation=e,this.modalService.dismissAll(),this.loader.hide(),this.buttonDisabled=!1,this.toaster.pop("success","Billing information changed","This new information will be applied on all your future receipts"),this.paymentFailed&&location.reload()},e=>{var t;this.buttonDisabled=!1,this.loader.hide(),this.failMessage=e.error.message,this.toaster.pop("error",null===(t=e.error)||void 0===t?void 0:t.message)})}pay(e){this.buttonDisabled=!0,this.loader.show("Processing payment"),this.paymentService.chargeCard(this.paymentInformation,e.quantity,e.value,this.workspace.id).subscribe(()=>{this.workspaceService.getPaymentDate(this.workspace.id),this.modalService.dismissAll(),this.workspaceService.getDefaultWorkspace(),this.buttonDisabled=!1,this.loader.hide(),this.modalService.open(this.successModal,{centered:!0})},e=>{var t;e.error&&e.error.message&&e.error.message.includes("incomplete")?this.modalService.open(this.subscriptionFailedModal):this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||"Processing failed"),this.failMessage=e.error.message,this.buttonDisabled=!1,this.loader.hide()})}openFeaturesInfo(e){this.modalService.open(this.featuresInfoModal,{size:"lg",centered:!0}),this.featuresInfoType=e}upgradeYearly(){this.plan=Object(ku.c)(this.currentPaymentType.label.split("_2021")[0].concat("_YEAR").concat("_2021")),this.paymentService.previewPrice(this.plan.value,this.activeMembers).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.price=e.price,this.modalService.open(this.upgradeModal,{centered:!0})})}cancelPaymentSubscription(e){this.buttonDisabled=!0,this.loader.show("Terminating subscription"),this.paymentService.cancelSubscription(this.workspace.id,e).subscribe(()=>{this.buttonDisabled=!1,this.loader.hide(),this.workspaceService.getPaymentDate(this.workspace.id),this.modalService.dismissAll()},e=>{var t;this.buttonDisabled=!1,this.loader.hide(),this.modalService.dismissAll(),this.toaster.pop("error",(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Cancel subscription failed.")})}openModal(e){this.modalService.open(e,{centered:!0})}saveQuantity(e,t){this.loader.show();const i=this.isAddingSeats?this.payment.quantity+e:this.payment.quantity-e;this.inProgress=!0,this.paymentService.updateQuantity(i,this.payment.quantity).subscribe(e=>{this.payment=e,this.workspaceService.payment$.next(e),this.percentage=this.payment.quantity?100*this.activeMembers/this.payment.quantity:0,this.isUsedAllSeats=this.percentage>=100,this.loader.hide(),this.inProgress=!1,t.close()},e=>{e.error&&e.error.message&&e.error.message.includes("incomplete")&&this.modalService.open(this.subscriptionFailedModal),this.loader.hide(),this.inProgress=!1})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Ce.a),c.Rb(U.a),c.Rb(Cu.a),c.Rb(wi.a),c.Rb(M.a),c.Rb(Lt.a),c.Rb(g.q),c.Rb(D.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["subscription-payment"]],viewQuery:function(e,t){var i;1&e&&(c.ed(HD,!0),c.ed(zD,!0),c.ed(qD,!0),c.ed(KD,!0),c.ed(ZD,!0)),2&e&&(c.Kc(i=c.kc())&&(t.successModal=i.first),c.Kc(i=c.kc())&&(t.featuresInfoModal=i.first),c.Kc(i=c.kc())&&(t.upgradeModal=i.first),c.Kc(i=c.kc())&&(t.userSeatsModal=i.first),c.Kc(i=c.kc())&&(t.subscriptionFailedModal=i.first))},decls:19,vars:1,consts:[[4,"ngIf"],["featuresInfoModal",""],["invoiceInfoModal",""],["paymentInfoModal",""],["cancelSubscriptionModal",""],["reactivateModal",""],["upgradeModal",""],["successModal",""],["userSeatsModal",""],["subscriptionFailedModal",""],[1,"cl-row","cl-upgrade-row"],[1,"cl-col-lg-custom-4","cl-upgrade-col","cl-mb-2","cl-mb-lg-custom-0",3,"ngClass"],[1,"cl-card","cl-h-100","cl-border-bottom"],[1,"cl-card-header","cl-border-0","cl-bg-transparent","cl-pt-3","cl-flex-column","cl-align-items-start"],["class","cl-alert cl-alert-primary cl-w-100",4,"ngIf"],["class","cl-alert cl-alert-warning cl-w-100",4,"ngIf"],[1,"cl-h2"],["class","cl-h3 cl-text-gray-6",4,"ngIf"],[1,"cl-h2","cl-text-color","cl-d-flex","cl-justify-content-between","cl-w-100"],["class","cl-h3 cl-ml-1 cl-text-gray-6",4,"ngIf"],[1,"cl-card-body","cl-py-0","cl-px-3"],[1,"cl-d-flex","cl-justify-content-between"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-start","cl-mr-2"],[1,"cl-mr-1"],[1,"cl-display-1","cl-lh-1","cl-mb-0","cl-text-gray-3"],["class","cl-align-self-end",4,"ngIf"],[1,"cl-text-gray-6","cl-small","cl-lh-1"],["class","cl-text-gray-6 cl-small cl-text-right",4,"ngIf"],[1,"cl-d-lg-custom-block"],["class","cl-list-unstyled cl-add-lh cl-ml-0",4,"ngIf"],[1,"cl-col-lg-custom-8","cl-upgrade-col"],["class","cl-row cl-h-100",4,"ngIf"],[1,"cl-d-flex","cl-justify-content-between","cl-my-3"],[1,"cl-small","cl-mb-0"],["target","_blank","href","https://clockify.me/help/"],[3,"href"],["class","cl-text-danger",3,"click",4,"ngIf"],[1,"cl-alert","cl-alert-primary","cl-w-100"],[1,"cl-btn",3,"click"],[1,"cl-alert","cl-alert-warning","cl-w-100"],["class","cl-btn",3,"click",4,"ngIf"],[1,"cl-h3","cl-text-gray-6"],[1,"cl-h3","cl-ml-1","cl-text-gray-6"],[1,"cl-small","cl-color-blue",3,"click"],[1,"cl-align-self-end"],[1,"cl-text-gray-6","cl-small","cl-text-right"],[1,"cl-mb-1","cl-d-flex","cl-justify-content-between"],[1,"cl-ml-1","cl-d-inline-flex",3,"click"],["src","assets/ui-icons/info-9.svg"],[3,"title"],[1,"cl-color-blue","cl-small",3,"ngClass","click"],[1,"cl-color-blue","cl-small",3,"click"],[1,"cl-progress",2,"height","5px"],["role","progressbar",1,"cl-progress-bar"],[1,"cl-mt-1"],[1,"cl-list-unstyled","cl-add-lh","cl-ml-0"],["viewBox","0 0 15 13","fill","none",1,"cl-checkmark-svg","cl-mr-1","cl-dynamic-color"],["d","M13 2L5.47368 10L2 6.30769"],[4,"ngFor","ngForOf"],["class","cl-ml-1 cl-d-inline-flex",3,"click",4,"ngIf"],[1,"cl-h3"],["fragment","plans",3,"routerLink"],[1,"cl-mt-3"],[1,"cl-row","cl-h-100"],[1,"cl-col-lg-6","cl-mb-2","cl-mb-lg-0"],[1,"cl-h-100","cl-pt-2","cl-px-3","cl-bg-white","cl-border","cl-rounded"],[1,"cl-pt-2"],[1,"cl-d-flex","cl-justify-content-start","cl-align-items-center","cl-mb-3"],[1,"cl-h1"],[1,"cl-btn","cl-btn-sm","cl-btn-primary","cl-ml-3",3,"click"],[1,"cl-text-gray-9"],[1,"cl-col-lg-6"],[1,"cl-text-danger",3,"click"],[3,"type","close"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[3,"editInvoiceInformation","workspaceName","mode","turnAddress"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[3,"editPaymentInformation","invoiceInformation","mode","isMonthly","paymentFailedMessage","closeDialog","paymentInformation"],["stripe",""],[3,"disableButton","isLegacy","closeModal","cancelSubscription"],[1,"cl-modal-body","cl-text-center","cl-py-4"],[1,"cl-mb-3"],["src","assets/images/illustrations/reactivate.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-mb-0","cl-text-gray-6"],[1,"cl-btn","cl-btn-primary",3,"click"],[3,"disableButton","workspace","type","price","pay","closeModal"],["src","assets/images/illustrations/success.svg",1,"cl-img-fluid"],["ngbAutofocus","",1,"cl-color-blue",3,"click"],[3,"activeUsers","currentQuantity","unusedSeats","isAdd","inProgress","currentType","amount","closeModal","saveQuantity"],[3,"close"]],template:function(e,t){1&e&&(c.Wc(0,JR,55,28,"ng-container",0),c.Wc(1,eA,1,1,"ng-template",null,1,c.Xc),c.Wc(3,tA,13,4,"ng-template",null,2,c.Xc),c.Wc(5,iA,9,5,"ng-template",null,3,c.Xc),c.Wc(7,nA,1,2,"ng-template",null,4,c.Xc),c.Wc(9,sA,12,2,"ng-template",null,5,c.Xc),c.Wc(11,cA,1,4,"ng-template",null,6,c.Xc),c.Wc(13,rA,10,1,"ng-template",null,7,c.Xc),c.Wc(15,oA,1,7,"ng-template",null,8,c.Xc),c.Wc(17,aA,1,0,"ng-template",null,9,c.Xc)),2&e&&c.wc("ngIf",t.payment)},directives:[s.u,s.r,s.t,W.f,qu,gf,Of,VD,Vu,sS,Uu],pipes:[s.g],encapsulation:2}),e})();function bA(e,t){if(1&e&&(c.Xb(0,"a",18),c.Yc(1,"Download invoice"),c.Wb()),2&e){const e=c.nc().$implicit;c.xc("href",e.invoicePdf,c.Qc)}}function uA(e,t){if(1&e&&(c.Xb(0,"a",19),c.Yc(1,"Pay invoice "),c.Wb()),2&e){const e=c.nc().$implicit;c.xc("href",e.invoicePay,c.Qc)}}function dA(e,t){if(1&e&&(c.Xb(0,"tr"),c.Xb(1,"td",11),c.Xb(2,"div",12),c.Xb(3,"span"),c.Yc(4),c.Wb(),c.Wb(),c.Wb(),c.Xb(5,"td",13),c.Xb(6,"div",14),c.Xb(7,"span"),c.Yc(8),c.Wb(),c.Wb(),c.Wb(),c.Xb(9,"td",8),c.Xb(10,"span"),c.Yc(11),c.Wb(),c.Wb(),c.Xb(12,"td",11),c.Xb(13,"div",15),c.Wc(14,bA,2,1,"a",16),c.Wc(15,uA,2,1,"a",17),c.Wb(),c.Wb(),c.Wb()),2&e){const e=t.$implicit;c.Cb(4),c.Zc(e.date),c.Cb(4),c.Zc(e.status.toUpperCase()),c.Cb(3),c.ad("",e.amount," USD"),c.Cb(3),c.wc("ngIf",e.invoicePdf),c.Cb(1),c.wc("ngIf","open"===e.status)}}let pA=(()=>{class e{constructor(e,t,i){this.paymentService=e,this.workspaceService=t,this.cd=i,this.unsubscribe$=new Ee.a}ngOnInit(){this.paymentService.invoices$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.invoices=e,this.cd.markForCheck()}),this.paymentService.getInvoices()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(Cu.a),c.Rb(U.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["invoices"]],decls:21,vars:1,consts:[[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-page-component-wrapper","cl-mb-0"],[1,"cl-table-responsive"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6"],[1,"cl-pl-lg-3"],[1,"cl-h5"],[1,"cl-pr-lg-3","cl-text-right"],[1,"cl-px-0"],[4,"ngFor","ngForOf"],[1,"cl-p-0"],[1,"cl-py-2","cl-px-2","cl-px-lg-3"],[1,"cl-pr-lg-3"],[1,"cl-component-divided-left","cl-justify-content-start","cl-pl-2","cl-pl-lg-3"],[1,"cl-component-divided-left","cl-w-100","cl-py-2","cl-px-2","cl-px-lg-3"],["class","cl-d-inline-block cl-ml-lg-auto cl-color-blue",3,"href",4,"ngIf"],["class","cl-d-inline-block cl-ml-lg-auto cl-color-blue","target","_blank",3,"href",4,"ngIf"],[1,"cl-d-inline-block","cl-ml-lg-auto","cl-color-blue",3,"href"],["target","_blank",1,"cl-d-inline-block","cl-ml-lg-auto","cl-color-blue",3,"href"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"span",2),c.Yc(3,"Past billing statements"),c.Wb(),c.Wb(),c.Wb(),c.Xb(4,"div",3),c.Xb(5,"div",4),c.Xb(6,"table",5),c.Xb(7,"thead"),c.Xb(8,"tr"),c.Xb(9,"th",6),c.Xb(10,"span",7),c.Yc(11,"Date"),c.Wb(),c.Wb(),c.Xb(12,"th",6),c.Xb(13,"span",7),c.Yc(14,"Status"),c.Wb(),c.Wb(),c.Xb(15,"th",8),c.Xb(16,"span",7),c.Yc(17,"Amount"),c.Wb(),c.Wb(),c.Sb(18,"th",9),c.Wb(),c.Wb(),c.Xb(19,"tbody"),c.Wc(20,dA,16,5,"tr",10),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(20),c.wc("ngForOf",t.invoices))},directives:[s.t,s.u],encapsulation:2,changeDetection:0}),e})();function hA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"li",6),c.Xb(1,"a",7),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.activatePill(t.SubscriptionPills.PAYMENT)})),c.Yc(2," Payment "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.Hb("cl-active",e.activePill===e.SubscriptionPills.PAYMENT)}}function mA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"li",6),c.Xb(1,"a",7),c.jc("click",(function(){c.Oc(e);const t=c.nc();return t.activatePill(t.SubscriptionPills.PLANS)})),c.Yc(2," Plans "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.Hb("cl-active",e.activePill===e.SubscriptionPills.PLANS)}}function gA(e,t){1&e&&c.Sb(0,"subscription-payment")}function fA(e,t){if(1&e&&(c.Vb(0),c.Wc(1,gA,1,0,"subscription-payment",12),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.activePill===e.SubscriptionPills.PAYMENT)}}function vA(e,t){1&e&&c.Sb(0,"invoices")}function wA(e,t){1&e&&c.Sb(0,"upgrade")}function yA(e,t){if(1&e&&(c.Vb(0),c.Wc(1,wA,1,0,"upgrade",12),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.wc("ngIf",e.activePill===e.SubscriptionPills.PLANS)}}let WA=(()=>{class e{constructor(e,t,i,n,s,c,r){this.workspaceService=e,this.userService=t,this.paymentService=i,this.activatedRoute=n,this.router=s,this.cd=c,this.loader=r,this.SubscriptionPills=MD,this.unsubscribe$=new mi.a}ngOnInit(){this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.isEnterprise2021Ws=Object(ku.g)(e.featureSubscriptionType)}),this.activatedRoute.fragment.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{const t=MD[(e||"").toUpperCase()];this.activePill=t||MD.PAYMENT}),this.paymentService.getPaymentInformation().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.hasPaymentInfo=!!e.cardHolder});const e=this.paymentService.getEverHadSubscription$(),t=this.paymentService.getInvoices$(),i=this.workspaceService.getPaymentDate$();this.loader.show(),Object(la.a)(e,t,i).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.everHadPaidSubscription=e[0],this.hasOpenInvoice=e[1]&&e[1].some(e=>"open"===e.status),this.hasPaidInvoice=e[1]&&e[1].some(e=>"paid"===e.status),this.isPaid=e[2].paid,this.cd.markForCheck(),this.checkTabPermission(),this.loader.hide()},e=>{this.loader.hide()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}get showPlans(){return!(this.hasPaidInvoice&&!this.hasPaymentInfo&&!this.everHadPaidSubscription||this.hasOpenInvoice||this.isEnterprise2021Ws&&!1!==this.isPaid)}activatePill(e){this.activePill=e,this.router.navigate([],{fragment:e.toString().toLowerCase()})}get showPayment(){return this.everHadPaidSubscription||this.isPaid}checkTabPermission(){this.activePill!==MD.PLANS||this.showPlans||this.activatePill(MD.PAYMENT),this.activePill!==MD.PAYMENT||this.showPayment||this.activatePill(MD.INVOICES),this.activePill===MD.INVOICES&&this.showPayment&&this.activatePill(MD.PAYMENT)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(U.a),c.Rb(ys.a),c.Rb(Cu.a),c.Rb(W.a),c.Rb(W.c),c.Rb(c.h),c.Rb(wi.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["subscription-tabs"]],decls:17,vars:7,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-scroll-tabs-wrapper"],["tabs","",1,"cl-nav","cl-nav-tabs","cl-m-0","cl-scroll-tabs"],["tabs","tabs"],["class","cl-nav-item",4,"ngIf"],[1,"cl-nav-item"],[1,"cl-nav-link",3,"click"],[1,"cl-card"],[1,"cl-card-body"],[1,"cl-tab-content"],[1,"cl-tab-pane","cl-fade","cl-active","cl-show"],[4,"ngIf"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"ul",3,4),c.Wc(5,hA,3,2,"li",5),c.Xb(6,"li",6),c.Xb(7,"a",7),c.jc("click",(function(){return t.activatePill(t.SubscriptionPills.INVOICES)})),c.Yc(8," Invoices "),c.Wb(),c.Wb(),c.Wc(9,mA,3,2,"li",5),c.Wb(),c.Wb(),c.Xb(10,"div",8),c.Xb(11,"div",9),c.Xb(12,"div",10),c.Xb(13,"div",11),c.Wc(14,fA,2,1,"ng-container",12),c.Wc(15,vA,1,0,"invoices",12),c.Wc(16,yA,2,1,"ng-container",12),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(5),c.wc("ngIf",t.showPayment),c.Cb(2),c.Hb("cl-active",t.activePill===t.SubscriptionPills.INVOICES),c.Cb(2),c.wc("ngIf",t.showPlans),c.Cb(5),c.wc("ngIf",t.showPayment),c.Cb(1),c.wc("ngIf",t.activePill===t.SubscriptionPills.INVOICES),c.Cb(1),c.wc("ngIf",t.showPlans))},directives:[er.a,s.u,lA,pA,Nd],encapsulation:2}),e})(),CA=(()=>{class e{constructor(e){this.router=e}canActivate(){const e=tr.a.environment.selfHosted;return e&&this.router.navigate(["/tracker"]),!e}}return e.\u0275fac=function(t){return new(t||e)(c.fc(W.c))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})(),kA=(()=>{class e{constructor(e,t,i,n){this.workspaceService=e,this.router=t,this.paymentService=i,this.authService=n}canActivate(e){return e.data||console.warn("HadSubscriptionGuard: missing data"),this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(Yt.a)(1)).pipe(Object(wa.a)(t=>t.isAdminOrOwner?this.getHasInvoiceData(e.data):(this.router.navigate(["tracker"]),Object(Jb.a)(!1))))}getHasInvoiceData(e){return"boolean"==typeof this.paymentService.hasInvoice$.getValue()||this.paymentService.getInvoices(),this.paymentService.hasInvoice$.pipe(Object(It.a)(e=>null!==e),Object(Yt.a)(1),Object(Y.a)(t=>{const i=null==e?void 0:e.allowIfHasInvoice;return!(!i||!t)||!i&&!t||("subscription"===e.redirectionPage?this.router.navigate([e.redirectionPage],{fragment:MD.PLANS}):this.router.navigate([e.redirectionPage]),!1)}))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(U.a),c.fc(W.c),c.fc(Cu.a),c.fc(Ce.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})(),SA=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(){const e=this.workspaceService.getDefaultWorkspaceId(),t=this.workspaceService.paymentMap$.getValue();return t&&t.has(e)||this.workspaceService.getPaymentDate(),this.workspaceService.paymentMap$.pipe(Object(It.a)(e=>null!==e),Object(It.a)(t=>t.has(e)),Object(Yt.a)(1),Object(Y.a)(t=>{const i=t.get(e);if(!i.paid||i.type!==ku.b.ENTERPRISE&&i.type!==ku.b.ENTERPRISE_YEAR)return!0;this.router.navigate(["tracker"])}))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(U.a),c.fc(W.c))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var IA=function(e){return e.TAGS="TAGS",e.CLIENTS="CLIENTS",e}({});function OA(e,t){if(1&e&&(c.Xb(0,"div",10),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" ",e.itemAddress," ")}}function XA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",14),c.jc("click",(function(){return c.Oc(e),c.nc(2).onArchive.emit(!0)})),c.Yc(1," Archive "),c.Wb()}}function EA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",14),c.jc("click",(function(){return c.Oc(e),c.nc(2).onArchive.emit(!1)})),c.Yc(1," Restore "),c.Wb()}}function TA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"a",14),c.jc("click",(function(){return c.Oc(e),c.nc(2).onDelete.emit()})),c.Yc(1," Delete "),c.Wb()}}function DA(e,t){if(1&e&&(c.Xb(0,"div",11),c.Xb(1,"div",12),c.Wc(2,XA,2,0,"a",13),c.Wc(3,EA,2,0,"a",13),c.Wc(4,TA,2,0,"a",13),c.Wb(),c.Wb()),2&e){const e=c.nc();c.Cb(2),c.wc("ngIf",!e.isArchived),c.Cb(1),c.wc("ngIf",e.isArchived),c.Cb(1),c.wc("ngIf",e.isArchived)}}let RA=(()=>{class e{constructor(){this.onEdit=new c.n,this.onDelete=new c.n,this.onArchive=new c.n,this.hasSecondColumn=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["entity-row"]],inputs:{itemName:"itemName",itemAddress:"itemAddress",isArchived:"isArchived",hasSecondColumn:"hasSecondColumn"},outputs:{onEdit:"onEdit",onDelete:"onDelete",onArchive:"onArchive"},decls:12,vars:4,consts:[[1,"cl-d-flex","cl-flex-column","cl-flex-lg-row","cl-w-100","cl-align-items-start","cl-align-items-lg-center"],[1,"cl-px-2","cl-px-lg-3","cl-py-3","cl-cut-text","cl-w-100","cl-w-lg-auto","cl-clients-table-col-1"],["class","cl-component-divided-left cl-remove-divider-mob cl-pl-2 cl-pl-lg-1 cl-pb-3 cl-pb-lg-0 cl-justify-content-start cl-clients-table-col-2",4,"ngIf"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end","cl-template-separator-mob","cl-min-height-40","cl-w-100","cl-w-lg-auto","cl-ml-auto"],["title","Edit",1,"cl-component-divided-left",3,"click"],["src","assets/images/ui-icons/edit.svg"],["dropdown","",1,"cl-dropdown","cl-d-flex","cl-justify-content-lg-custom-end","cl-w-100","pointer"],["closeDropdown","","role","button",1,"cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownContent"],[1,"cl-component-divided-left","cl-remove-divider-mob","cl-pl-2","cl-pl-lg-1","cl-pb-3","cl-pb-lg-0","cl-justify-content-start","cl-clients-table-col-2"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area"],["class","cl-dropdown-item","closeDropdown","",3,"click",4,"ngIf"],["closeDropdown","",1,"cl-dropdown-item",3,"click"]],template:function(e,t){1&e&&(c.Xb(0,"div"),c.Xb(1,"div",0),c.Xb(2,"div",1),c.Yc(3),c.Wb(),c.Wc(4,OA,2,1,"div",2),c.Xb(5,"div",3),c.Xb(6,"a",4),c.jc("click",(function(){return t.onEdit.emit()})),c.Sb(7,"img",5),c.Wb(),c.Xb(8,"div",6),c.Xb(9,"div",7),c.Sb(10,"img",8),c.Wb(),c.Wc(11,DA,5,3,"div",9),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(2),c.Vc("text-decoration",t.isArchived?"line-through":""),c.Cb(1),c.ad(" ",t.itemName," "),c.Cb(1),c.wc("ngIf",t.hasSecondColumn))},directives:[s.u,Es.a,Ts.a],encapsulation:2,changeDetection:0}),e})();var AA=i("nAmH");function jA(e,t){1&e&&(c.Xb(0,"span",10),c.Yc(1,"&"),c.Wb())}function xA(e,t){1&e&&(c.Xb(0,"span",11),c.Yc(1,"Address"),c.Wb())}function PA(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Xb(1,"entity-row",12),c.jc("onEdit",(function(){c.Oc(e);const i=t.$implicit,n=c.nc(),s=c.Lc(10),r=c.Lc(8);return n.openModal(i,n.hasSecondColumn?s:r)}))("onDelete",(function(){c.Oc(e);const i=t.$implicit,n=c.nc(),s=c.Lc(12);return n.openModal(i,s)}))("onArchive",(function(i){c.Oc(e);const n=t.$implicit,s=c.nc(),r=c.Lc(14);return s.archiveProjects=!1,s.openModal(n,r,i)})),c.Wb(),c.Ub()}if(2&e){const e=t.$implicit,i=c.nc();c.Cb(1),c.wc("itemName",e.name)("itemAddress",e.address)("isArchived",e.archived)("hasSecondColumn",i.hasSecondColumn)}}function MA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"rename-modal",13),c.jc("editedValue",(function(i){c.Oc(e);const n=t.$implicit,s=c.nc();return s.editItem(i,s.selected.address),n.close()}))("isOpen",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Edit "+e.label)("inputValue",e.selected.name)}}function YA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"edit-client-modal",14),c.jc("onEdit",(function(i){c.Oc(e);const n=t.$implicit;return c.nc().editItem(i.name,i.address),n.close()}))("onClose",(function(){return t.$implicit.close()})),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Edit "+e.label)("item",e.selected)("clientLabel",e.label)}}function LA(e,t){if(1&e&&(c.Xb(0,"span",19),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" Warning: Approved time for '",e.selected.name,"' will lose tag information. ")}}function FA(e,t){if(1&e&&(c.Xb(0,"p",20),c.Yc(1),c.Wb()),2&e){const e=c.nc(2);c.Cb(1),c.ad(" ",e.infoMessageForDelete," ")}}function NA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"delete-confirm-modal",15),c.jc("onDelete",(function(){c.Oc(e);const i=t.$implicit,n=c.nc();return n.deleteItem(n.selected),i.close()}))("onClose",(function(){return t.$implicit.close()})),c.Xb(1,"p",16),c.Yc(2),c.Wb(),c.Wc(3,LA,2,1,"span",17),c.Wc(4,FA,2,1,"p",18),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Delete")("btnText","Delete")("showConfirmation",e.timeApprovalEnabled&&e.entity===e.EntityTab.TAGS),c.Cb(1),c.wc("ngClass",e.infoMessageForDelete?"cl-h2 cl-cut-text-wrap":"cl-text-muted cl-cut-text-wrap cl-mb-0"),c.Cb(1),c.ad(" Are you sure you want to delete ",e.selected.name,"? "),c.Cb(1),c.wc("ngIf",e.timeApprovalEnabled&&e.entity===e.EntityTab.TAGS),c.Cb(1),c.wc("ngIf",e.infoMessageForDelete)}}function UA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",23),c.Xb(1,"div",24),c.Xb(2,"input",25),c.jc("ngModelChange",(function(t){return c.Oc(e),c.nc(2).archiveProjects=t})),c.Wb(),c.Xb(3,"label",26),c.Yc(4),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc(2);c.Cb(2),c.wc("ngModel",e.archiveProjects),c.Cb(2),c.ad(" Also archive all project assigned to this ",e.label," ")}}function $A(e,t){if(1&e){const e=c.Yb();c.Xb(0,"simple-modal",21),c.jc("confirmed",(function(){c.Oc(e);const i=t.$implicit;return c.nc().archiveOrRestore(),i.close()}))("close",(function(){return t.$implicit.close()})),c.Xb(1,"p",16),c.Yc(2),c.Wb(),c.Wc(3,UA,5,2,"div",22),c.Wb()}if(2&e){const e=c.nc();c.wc("title",e.isArchived?"Archive":"Restore")("btnText",e.isArchived?"Archive":"Restore")("isDanger",!0),c.Cb(1),c.wc("ngClass",e.infoMessageForDelete?"cl-h2 cl-cut-text-wrap":"cl-text-muted cl-cut-text-wrap cl-mb-0"),c.Cb(1),c.bd(" Are you sure you want to ",e.isArchived?"archive":"restore"," ",e.selected.name,"? "),c.Cb(1),c.wc("ngIf",e.isArchived&&e.entity===e.EntityTab.CLIENTS)}}let _A=(()=>{class e{constructor(e,t,i,n){this.toaster=e,this.cd=t,this.modalService=i,this.workspaceService=n,this.hasSecondColumn=!1,this.onEditItem=new c.n,this.onDeleteItem=new c.n,this.EntityTab=IA,this.sortByNameMapper=e=>e.name}ngOnInit(){this.timeApprovalEnabled=this.workspaceService.getLocalDefaultWorkspace().timeApprovalEnabled}editItem(e,t){if(!this.hasSecondColumn&&this.items.filter(t=>t.name===e.trim()).length>0)return void this.toaster.error(`${Object(bW.a)(this.label)} with name ${e} already exists.`);const i={name:this.selected.name,archived:this.selected.archived};this.selected.name=e,this.entity===IA.CLIENTS&&(this.selected.address=t,i.address=this.selected.address),this.onEditItem.emit({item:this.selected,backup:i})}archiveOrRestore(){const e={name:this.selected.name,archived:this.isArchived};this.selected.archived=this.isArchived,this.onEditItem.emit({item:this.selected,archiveProjects:this.archiveProjects,backup:e})}openModal(e,t,i){this.selected=e,this.setInfoMessage(e),this.isArchived=i,this.modalService.open(t,{centered:!0})}deleteItem(e){const t=this.items.indexOf(e);this.onDeleteItem.emit(this.items[t])}setInfoMessage(e){switch(this.entity){case IA.TAGS:this.infoMessageForDelete=`The ${e.name} tag will also be removed from\n          all time entries it is assigned to. This action cannot be reversed.`;break;case IA.CLIENTS:this.infoMessageForDelete=`The ${e.name} ${this.label} will also be removed\n          from projects it is assigned to. This action cannot be reversed.`}}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(M.a),c.Rb(c.h),c.Rb(g.q),c.Rb(U.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["entity-table"]],inputs:{items:"items",entity:"entity",label:"label",hasSecondColumn:"hasSecondColumn"},outputs:{onEditItem:"onEditItem",onDeleteItem:"onDeleteItem"},decls:15,vars:5,consts:[[1,"cl-card","cl-mb-1","cl-mb-lg-2","cl-border-bottom"],[1,"cl-card-header","cl-px-2","cl-px-lg-3",2,"justify-content","start"],[1,"cl-h6","cl-mb-0","cl-mr-1","cl-mr-lg-0","cl-clients-table-col-1"],["class","cl-h6 cl-mb-0 cl-d-inline cl-d-lg-none cl-mr-1",4,"ngIf"],["class","cl-h6 cl-mb-0 cl-clients-table-col-2",4,"ngIf"],[4,"ngFor","ngForOf"],["renameModal",""],["editFullModal",""],["deleteModal",""],["archiveModal",""],[1,"cl-h6","cl-mb-0","cl-d-inline","cl-d-lg-none","cl-mr-1"],[1,"cl-h6","cl-mb-0","cl-clients-table-col-2"],[1,"cl-component-row","cl-component-row-divide-md","cl-px-0","cl-d-block",3,"itemName","itemAddress","isArchived","hasSecondColumn","onEdit","onDelete","onArchive"],[3,"title","inputValue","editedValue","isOpen"],[3,"title","item","clientLabel","onEdit","onClose"],[3,"title","btnText","showConfirmation","onDelete","onClose"],[3,"ngClass"],["class","cl-alert cl-alert-warning cl-justify-content-center ng-star-inserted",4,"ngIf"],["class","cl-text-muted cl-cut-text-wrap cl-mb-0",4,"ngIf"],[1,"cl-alert","cl-alert-warning","cl-justify-content-center","ng-star-inserted"],[1,"cl-text-muted","cl-cut-text-wrap","cl-mb-0"],[3,"title","btnText","isDanger","confirmed","close"],["class","cl-form-group cl-mb-0",4,"ngIf"],[1,"cl-form-group","cl-mb-0"],[1,"cl-custom-control","cl-custom-checkbox"],["type","checkbox","id","customCheck1",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","customCheck1",1,"cl-custom-control-label"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"span",2),c.Yc(3,"Name"),c.Wb(),c.Wc(4,jA,2,0,"span",3),c.Wc(5,xA,2,0,"span",4),c.Wb(),c.Wc(6,PA,2,4,"ng-container",5),c.Wb(),c.Wc(7,MA,1,2,"ng-template",null,6,c.Xc),c.Wc(9,YA,1,3,"ng-template",null,7,c.Xc),c.Wc(11,NA,5,7,"ng-template",null,8,c.Xc),c.Wc(13,$A,4,7,"ng-template",null,9,c.Xc)),2&e&&(c.Hb("cl-has-second-column",t.hasSecondColumn),c.Cb(4),c.wc("ngIf",t.hasSecondColumn),c.Cb(1),c.wc("ngIf",t.hasSecondColumn),c.Cb(1),c.wc("ngForOf",t.items))},directives:[s.u,s.t,RA,AA.a,Ln,yl.a,s.r,Ui.a,p.a,p.s,p.v],encapsulation:2,changeDetection:0}),e})();function GA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",20),c.Xb(1,"pager",21,22),c.jc("pageChanged",(function(t){return c.Oc(e),c.nc().pageChanged(t)}))("limitChanged",(function(t){return c.Oc(e),c.nc().limitChanged(t)})),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.wc("page",null==e.pagination?null:e.pagination.page)("limit",null==e.pagination?null:e.pagination.pageSize)}}let BA=(()=>{class e{constructor(e,t,i,n,s,c,r){this.router=e,this.activatedRoute=t,this.tagService=i,this.workspaceService=n,this.formBuilder=s,this.uiSettingsService=c,this.cd=r,this._searchName="",this.items=[],this.pageDebouncer$=new Ee.a,this.searchDebouncer$=new Ee.a,this.unsubscribe$=new Ee.a,this.label="tag",this.EntityTab=IA,this.statusDropdownValues=[new uc.a(ni.a.ACTIVE,"Show active"),new uc.a(ni.a.ARCHIVED,"Show archived"),new uc.a(ni.a.ALL,"Show all")],this.entityStatus=this.statusDropdownValues[0].value}set searchName(e){this._searchName=e,this.searchDebouncer$.next(this.searchName)}get searchName(){return this._searchName}ngOnInit(){this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>this.workspace=e),this.createForm=this.formBuilder.group({name:["",[on.a.required]],inProgress:[!1,[on.a.requiredFalse]]}),this.initPagination(),this.subscribeToData(),this.getRouteParamsFromUrl(),this.setRouteDebouncer(),this.setSearchDebouncer()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}subscribeToData(){this.tagService.tags.pipe(Object(De.a)(this.unsubscribe$)).subscribe(this.onSuccessGetData.bind(this))}onSuccessGetData(e){const t=e.length<this.pagination.pageSize,i=e.length;this.items=e,this.isMultiplePages=this.pagination.page>1||i>=ei.j||i>=this.pagination.pageSize,this.cd.detectChanges(),this.pager&&!this.reachedTheLimit&&this.pager.allowNextPage(!t)}setInProgress(e){this.createForm.patchValue({inProgress:e})}setName(e){this.createForm.patchValue({name:e})}trimName(){const e=Object(Pt.H)(this.createForm.value.name);this.setName(e)}getData(e){this.tagService.getAllTagsV1(e,this.workspace.id,Object.assign(Object.assign({},this.pagination),{name:this.searchName})).pipe(Object(De.a)(this.unsubscribe$)).subscribe(this.onSuccessGetData.bind(this))}createItem(){this.trimName();const e=this.createForm.value.name;this.setInProgress(!0),this.tagService.create(e,this.workspace.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.items.unshift(e),this.setName(""),this.setInProgress(!1),this.entityTable.cd.detectChanges()},()=>this.setInProgress(!1))}editItem({item:e,backup:t}){this.tagService.clearTagsSubject(),this.tagService.update(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(null,i=>{e.name=t.name,this.entityTable.cd.detectChanges()})}deleteItem(e){this.tagService.delete(e).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.items=this.items.filter(t=>t.id!==e.id),0===this.items.length&&this.pagination.page>1&&(this.pagination.page--,this.getData(this.entityStatus)),this.cd.detectChanges()})}pageChanged(e){if(this.pagination.page>e.page)this.reachedTheLimit=!1;else if(this.reachedTheLimit)return;this.pagination.page=e.page,this.pageDebouncer$.next()}limitChanged(e){this.reachedTheLimit=!1,this.pagination.page=1,this.pagination.pageSize=e.limit,this.pageDebouncer$.next()}initPagination(){const e=this.uiSettingsService.getSettings(hi.b.ENTITY_PAGESIZE);this.pagination={page:1,pageSize:e||ei.j}}setSearchDebouncer(){this.searchDebouncer$.pipe(Object(Te.a)(350),Object(Cp.a)(),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.pagination.page=1,this.getData(this.entityStatus)})}setRouteDebouncer(){this.pageDebouncer$.pipe(Object(Te.a)(350),Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.router.navigate([],{queryParams:this.pagination,relativeTo:this.activatedRoute})})}getRouteParamsFromUrl(){this.activatedRoute.queryParams.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{Object(Pt.u)(e.page)&&e.page>0&&(this.pagination.page=Number(e.page)),Object(Pt.u)(e.pageSize)&&e.pageSize>0&&e.pageSize<=200&&(this.pagination.pageSize=Number(e.pageSize)),this.getData(this.entityStatus)})}filterEntity(e){this.entityStatus=e,this.getData(e),this.cd.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.c),c.Rb(W.a),c.Rb(Qt.a),c.Rb(U.a),c.Rb(p.f),c.Rb(hi.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["entity-tab"]],viewQuery:function(e,t){var i;1&e&&(c.ed(_A,!0),c.ed(cn.a,!0)),2&e&&(c.Kc(i=c.kc())&&(t.entityTable=i.first),c.Kc(i=c.kc())&&(t.pager=i.first))},decls:24,vars:10,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center"],[1,"cl-col"],[1,"cl-text-capitalize"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-d-flex","cl-col-lg-custom-9","cl-mb-2","cl-mb-lg-custom-0"],[1,"cl-d-inline-block",3,"list","value","onChanged"],[1,"cl-form-group","cl-mb-2","cl-mb-lg-custom-0","cl-ml-2","cl-w-1"],["type","text","placeholder","Search by name",1,"cl-form-control",3,"ngModel","ngModelChange"],[1,"cl-col-lg-custom-3"],[1,"cl-form-group","cl-mb-0"],[1,"cl-form-row",3,"formGroup","ngSubmit"],["type","text","autocomplete","off","preventMultipleSpaces","","formControlName","name",1,"cl-form-control",3,"placeholder","blur"],[1,"cl-col-auto"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"],[3,"items","label","entity","onEditItem","onDeleteItem"],["entityTable",""],["class","cl-mt-2 cl-mt-lg-3",4,"ngIf"],[1,"cl-mt-2","cl-mt-lg-3"],[3,"page","limit","pageChanged","limitChanged"],["pager",""]],template:function(e,t){1&e&&(c.Xb(0,"main",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"h1",5),c.Yc(6,"Tags"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(7,"div",6),c.Xb(8,"div",3),c.Xb(9,"div",7),c.Xb(10,"dropdown-items",8),c.jc("onChanged",(function(e){return t.filterEntity(e)})),c.Wb(),c.Xb(11,"div",9),c.Xb(12,"input",10),c.jc("ngModelChange",(function(e){return t.searchName=e})),c.Wb(),c.Wb(),c.Wb(),c.Xb(13,"div",11),c.Xb(14,"div",12),c.Xb(15,"form",13),c.jc("ngSubmit",(function(){return t.createItem()})),c.Xb(16,"div",4),c.Xb(17,"input",14),c.jc("blur",(function(){return t.trimName()})),c.Wb(),c.Wb(),c.Xb(18,"div",15),c.Xb(19,"button",16),c.Yc(20,"Add"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(21,"entity-table",17,18),c.jc("onEditItem",(function(e){return t.editItem(e)}))("onDeleteItem",(function(e){return t.deleteItem(e)})),c.Wb(),c.Wc(23,GA,3,2,"div",19),c.Wb(),c.Wb()),2&e&&(c.Cb(10),c.wc("list",t.statusDropdownValues)("value",t.entityStatus),c.Cb(2),c.wc("ngModel",t.searchName),c.Cb(3),c.wc("formGroup",t.createForm),c.Cb(2),c.wc("placeholder","Add new "+t.label),c.Cb(2),c.wc("disabled",t.createForm.invalid),c.Cb(2),c.wc("items",t.items)("label",t.label)("entity",t.EntityTab.TAGS),c.Cb(2),c.wc("ngIf",t.isMultiplePages))},directives:[pn.a,p.c,p.s,p.v,p.I,p.t,p.k,WS.a,p.i,_A,s.u,cn.a],encapsulation:2,changeDetection:0}),e})(),VA=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(){return!!this.workspaceService.getLocalDefaultWorkspace().invoicingEnabled||(this.router.navigate(["tracker"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(c.fc(U.a),c.fc(W.c))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();function HA(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",20),c.Xb(1,"pager",21,22),c.jc("pageChanged",(function(t){return c.Oc(e),c.nc().pageChanged(t)}))("limitChanged",(function(t){return c.Oc(e),c.nc().limitChanged(t)})),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.wc("page",null==e.pagination?null:e.pagination.page)("limit",null==e.pagination?null:e.pagination.pageSize)}}let zA=(()=>{class e{constructor(e,t,i,n,s,c,r){this.router=e,this.activatedRoute=t,this.workspaceService=i,this.clientService=n,this.formBuilder=s,this.uiSettingsService=c,this.cd=r,this._searchName="",this.items=[],this.pageDebouncer$=new Ee.a,this.searchDebouncer$=new Ee.a,this.unsubscribe$=new Ee.a,this.EntityTab=IA,this.statusDropdownValues=[new uc.a(ni.a.ACTIVE,"Show active"),new uc.a(ni.a.ARCHIVED,"Show archived"),new uc.a(ni.a.ALL,"Show all")],this.entityStatus=this.statusDropdownValues[0].value}set searchName(e){this._searchName=e,this.searchDebouncer$.next(this.searchName)}get searchName(){return this._searchName}ngOnInit(){this.workspaceService.defaultWorkspace$.pipe(Object(It.a)(e=>!!e),Object(Yt.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{var t;this.workspace=e,this.label=null===(t=this.workspace.projectGroupingLabel)||void 0===t?void 0:t.toLowerCase(),this.labelPlural=Object(Pt.l)(this.workspace.projectGroupingLabel),this.showAddress=this.workspace.invoicingEnabled}),this.createForm=this.formBuilder.group({name:["",[on.a.required]],inProgress:[!1,[on.a.requiredFalse]]}),this.initPagination(),this.subscribeToData(),this.getRouteParamsFromUrl(),this.setRouteDebouncer(),this.setSearchDebouncer()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}subscribeToData(){this.clientService.clients.pipe(Object(De.a)(this.unsubscribe$)).subscribe(this.onSuccessGetData.bind(this))}onSuccessGetData(e){const t=e.length<this.pagination.pageSize,i=e.length;this.items=e,this.isMultiplePages=this.pagination.page>1||i>=ei.j||i>=this.pagination.pageSize,this.cd.detectChanges(),this.pager&&!this.reachedTheLimit&&this.pager.allowNextPage(!t)}setInProgress(e){this.createForm.patchValue({inProgress:e})}setName(e){this.createForm.patchValue({name:e})}trimName(){const e=Object(Pt.H)(this.createForm.value.name);this.setName(e)}getData(e){this.clientService.getAllClientsV1(e,this.workspace.id,Object.assign(Object.assign({},this.pagination),{name:this.searchName})).pipe(Object(De.a)(this.unsubscribe$)).subscribe(this.onSuccessGetData.bind(this))}createItem(){this.trimName();const e=this.createForm.value.name;this.setInProgress(!0),this.clientService.create(e,this.label,this.workspace.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.items.unshift(e),this.setName(""),this.setInProgress(!1),this.entityTable.cd.detectChanges()},()=>this.setInProgress(!1))}editItem({item:e,backup:t,archiveProjects:i}){this.clientService.update(e,!!i,this.label).pipe(Object(De.a)(this.unsubscribe$)).subscribe(null,i=>{e.name=t.name,e.address=t.address,this.entityTable.cd.detectChanges()})}deleteItem(e){this.clientService.delete(e,this.label).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.items=this.items.filter(t=>t.id!==e.id),0===this.items.length&&this.pagination.page>1&&(this.pagination.page--,this.getData(this.entityStatus)),this.cd.detectChanges()})}pageChanged(e){if(this.pagination.page>e.page)this.reachedTheLimit=!1;else if(this.reachedTheLimit)return;this.pagination.page=e.page,this.pageDebouncer$.next()}limitChanged(e){this.reachedTheLimit=!1,this.pagination.page=1,this.pagination.pageSize=e.limit,this.pageDebouncer$.next()}initPagination(){const e=this.uiSettingsService.getSettings(hi.b.ENTITY_PAGESIZE);this.pagination={page:1,pageSize:e||ei.j}}setSearchDebouncer(){this.searchDebouncer$.pipe(Object(Te.a)(350),Object(Cp.a)(),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.pagination.page=1,this.getData(this.entityStatus)})}setRouteDebouncer(){this.pageDebouncer$.pipe(Object(Te.a)(350),Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.router.navigate([],{queryParams:this.pagination,relativeTo:this.activatedRoute})})}getRouteParamsFromUrl(){this.activatedRoute.queryParams.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{Object(Pt.u)(e.page)&&e.page>0&&(this.pagination.page=Number(e.page)),Object(Pt.u)(e.pageSize)&&e.pageSize>0&&e.pageSize<=200&&(this.pagination.pageSize=Number(e.pageSize)),this.getData(this.entityStatus)})}filterEntity(e){this.entityStatus=e,this.getData(e),this.cd.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.c),c.Rb(W.a),c.Rb(U.a),c.Rb(rn.a),c.Rb(p.f),c.Rb(hi.a),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["clients-tab"]],viewQuery:function(e,t){var i;1&e&&(c.ed(_A,!0),c.ed(cn.a,!0)),2&e&&(c.Kc(i=c.kc())&&(t.entityTable=i.first),c.Kc(i=c.kc())&&(t.pager=i.first))},decls:24,vars:12,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center"],[1,"cl-col"],[1,"cl-text-capitalize"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-d-flex","cl-col-lg-custom-9","cl-mb-2","cl-mb-lg-custom-0"],[1,"cl-d-inline-block",3,"list","value","onChanged"],[1,"cl-form-group","cl-mb-2","cl-mb-lg-custom-0","cl-ml-2","cl-w-1"],["type","text","placeholder","Search by name",1,"cl-form-control",3,"ngModel","ngModelChange"],[1,"cl-col-lg-custom-3"],[1,"cl-form-group","cl-mb-0"],[1,"cl-form-row",3,"formGroup","ngSubmit"],["type","text","autocomplete","off","preventMultipleSpaces","","formControlName","name",1,"cl-form-control",3,"placeholder","blur"],[1,"cl-col-auto"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"],[3,"items","label","hasSecondColumn","entity","onEditItem","onDeleteItem"],["entityTable",""],["class","cl-mt-2 cl-mt-lg-3",4,"ngIf"],[1,"cl-mt-2","cl-mt-lg-3"],[3,"page","limit","pageChanged","limitChanged"],["pager",""]],template:function(e,t){1&e&&(c.Xb(0,"main",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"h1",5),c.Yc(6),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(7,"div",6),c.Xb(8,"div",3),c.Xb(9,"div",7),c.Xb(10,"dropdown-items",8),c.jc("onChanged",(function(e){return t.filterEntity(e)})),c.Wb(),c.Xb(11,"div",9),c.Xb(12,"input",10),c.jc("ngModelChange",(function(e){return t.searchName=e})),c.Wb(),c.Wb(),c.Wb(),c.Xb(13,"div",11),c.Xb(14,"div",12),c.Xb(15,"form",13),c.jc("ngSubmit",(function(){return t.createItem()})),c.Xb(16,"div",4),c.Xb(17,"input",14),c.jc("blur",(function(){return t.trimName()})),c.Wb(),c.Wb(),c.Xb(18,"div",15),c.Xb(19,"button",16),c.Yc(20,"Add"),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(21,"entity-table",17,18),c.jc("onEditItem",(function(e){return t.editItem(e)}))("onDeleteItem",(function(e){return t.deleteItem(e)})),c.Wb(),c.Wc(23,HA,3,2,"div",19),c.Wb(),c.Wb()),2&e&&(c.Cb(6),c.Zc(t.labelPlural),c.Cb(4),c.wc("list",t.statusDropdownValues)("value",t.entityStatus),c.Cb(2),c.wc("ngModel",t.searchName),c.Cb(3),c.wc("formGroup",t.createForm),c.Cb(2),c.wc("placeholder","Add new "+t.label),c.Cb(2),c.wc("disabled",t.createForm.invalid),c.Cb(2),c.wc("items",t.items)("label",t.label)("hasSecondColumn",t.showAddress)("entity",t.EntityTab.CLIENTS),c.Cb(2),c.wc("ngIf",t.isMultiplePages))},directives:[pn.a,p.c,p.s,p.v,p.I,p.t,p.k,WS.a,p.i,_A,s.u,cn.a],encapsulation:2,changeDetection:0}),e})();class qA{constructor(e){this.screenshotId=e.screenshotId,this.screenshotUrl=e.screenshotUrl,this.timeEntryId=e.timeEntryId,this.createdAt=e.createdAt}}let KA=(()=>{class e{constructor(e,t,i){this.http=e,this.workspaceService=t,this.toaster=i,this.error=new Ee.a}getCountForUsers(e,t,i){const n=this.workspaceService.getDefaultWorkspaceId();let s=(new P.f).append("start",t).append("end",i);return e.forEach(e=>{s=s.append("userIds",e)}),this.http.get(`${ct.e}/workspaces/${n}/users/screenshots-count`,{params:s}).pipe(Object(L.a)(()=>{},e=>{this.toaster.error("Couldn't get screenshots for users")}))}getCountForUser(e,t,i){const n=this.workspaceService.getDefaultWorkspaceId(),s=(new P.f).append("userIds",e).append("start",t).append("end",i);return this.http.get(`${ct.e}/workspaces/${n}/users/screenshots-count`,{params:s}).pipe(Object(Y.a)(t=>t[e]||0),Object(L.a)(()=>{},e=>{var t;return(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Couldn't get screenshots for users"}))}getScreenshots(e,t){const i=this.workspaceService.getDefaultWorkspaceId(),n=(new P.f).append("start",t.start).append("end",t.end).append("page",t.page);return this.http.get(`${ct.e}/workspaces/${i}/users/${e}/screenshots`,{params:n}).pipe(Object(Y.a)(e=>e.map(e=>new qA(e))),Object(L.a)(()=>{},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Couldn't get screenshots for users")}))}adminDelete(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`${ct.e}/workspaces/${t}/screenshots/${e}`).pipe(Object(L.a)(()=>this.toaster.success("Successfully deleted screenshot "),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Couldn't delete screenshot")}))}delete(e,t){const i=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(ct.e+`/workspaces/${i}/time-entries/${t}/screenshots/${e}`).pipe(Object(L.a)(()=>this.toaster.success("Successfully deleted screenshot "),e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Couldn't delete screenshot")}))}getScreenshot(e,t){const i=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`${ct.e}/workspaces/${i}/users/${t}/screenshots/${e}`).pipe(Object(Y.a)(e=>new qA(e)),Object(L.a)(()=>{},e=>this.toaster.error("Couldn't get screenshot")))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(P.b),c.fc(U.a),c.fc(M.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var ZA=i("WjWa");class QA{constructor(e){this.id=e.id,this.name=e.name,this.count=e.count}}var JA=i("e0xV"),ej=i("BhhM");function tj(e,t){1&e&&c.Sb(0,"img",20)}function ij(e,t){if(1&e&&(c.Xb(0,"div",21),c.Xb(1,"span",22),c.Yc(2),c.Wb(),c.Sb(3,"img",23),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(2),c.Zc(e.count)}}function nj(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",14),c.jc("click",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).setValue(i)}))("keyup.enter",(function(){c.Oc(e);const i=t.$implicit;return c.nc(3).setValue(i)})),c.Xb(1,"div",15),c.Xb(2,"div",16),c.Xb(3,"div",17),c.Wc(4,tj,1,0,"img",18),c.Wb(),c.Xb(5,"span",2),c.Yc(6),c.Wb(),c.Wb(),c.Wc(7,ij,4,1,"div",19),c.Wb(),c.Wb()}if(2&e){const e=t.$implicit,i=c.nc(3);c.Cb(4),c.wc("ngIf",e.id===(null==i.selectedItem?null:i.selectedItem.id)),c.Cb(2),c.Zc(e.name),c.Cb(1),c.wc("ngIf",e.count)}}function sj(e,t){1&e&&(c.Xb(0,"span",24),c.Yc(1," No results "),c.Wb())}function cj(e,t){if(1&e&&(c.Vb(0),c.Wc(1,nj,8,3,"div",12),c.Wc(2,sj,2,0,"span",13),c.Ub()),2&e){const e=t.ngIf,i=c.nc(2);c.Cb(1),c.wc("ngForOf",e),c.Cb(1),c.wc("ngIf",i.search&&!(null!=e&&e.length))}}function rj(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",4),c.Xb(1,"div",5),c.Xb(2,"div",6),c.Xb(3,"input-search",7),c.jc("onSearchChange",(function(t){c.Oc(e);const i=c.nc();return i.search=t,i.onSearchChange()})),c.Wb(),c.Wb(),c.Wb(),c.Xb(4,"div",8,9),c.jc("scrolled",(function(){return c.Oc(e),c.nc().onScroll()})),c.Wc(6,cj,3,2,"ng-container",10),c.oc(7,"filter"),c.Sb(8,"span",11),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.wc("debounceTime",e.debounceTime)("search",e.search)("placeholder",e.placeholder),c.Cb(1),c.wc("infiniteScrollDistance",3)("infiniteScrollThrottle",150)("scrollWindow",!1),c.Cb(2),c.wc("ngIf",c.rc(7,7,e.list,e.searchOffline&&e.search,e.nameMapper))}}let oj=(()=>{class e{constructor(e,t){this.cd=e,this.router=t,this.debounceTime=300,this.search="",this.searchOffline=!0,this.onChanged=new c.n,this.onSearch=new c.n,this.onOpen=new c.n,this.onClose=new c.n,this.loadMore=new c.n,this.unsubscribe$=new Ee.a}set list(e){this._list=e,this.isInitialized&&this.updateSelectedItem()}get list(){return this._list}set value(e){this._value=e,this.isInitialized&&this.updateSelectedItem()}get value(){return this._value}ngOnInit(){this.updateSelectedItem(),this.isInitialized=!0}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}onScroll(){this.loadMore.emit()}triggerDetection(){this.updateSelectedItem(),this.cd.markForCheck()}onSearchChange(){this.searchOffline||this.onSearch.emit(this.search)}opened(){this.onOpen.emit()}closed(){this.onClose.emit()}updateSelectedItem(){const e=(this.list||[]).find(e=>e.id===this.value);e&&(this.selectedItem=new QA(e))}setValue(e){e.id!==this.value&&(this.value=e.id,this.updateSelectedItem(),this.onChanged.emit(this.selectedItem))}nameMapper(e){return e.name}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.h),c.Rb(W.c))},e.\u0275cmp=c.Lb({type:e,selectors:[["dropdown-searchable"]],inputs:{placeholder:"placeholder",selectedName:"selectedName",overrideTitle:"overrideTitle",debounceTime:"debounceTime",search:"search",searchOffline:"searchOffline",list:"list",value:"value"},outputs:{onChanged:"onChanged",onSearch:"onSearch",onOpen:"onOpen",onClose:"onClose",loadMore:"loadMore"},decls:5,vars:2,consts:[[1,"cl-dropdown",3,"dropdownKey","onOpen","onClose"],["tabindex","0","dropdownKeyButton","",1,"cl-btn","cl-btn-outline-light","cl-text-left","cl-dropdown-toggle","pointer","cl-d-flex"],[1,"cl-cut-text"],["class","cl-dropdown-menu cl-sm-down-r-0","style","width: 300px;","openUpAtBottom","",4,"dropdownKeyContent"],["openUpAtBottom","",1,"cl-dropdown-menu","cl-sm-down-r-0",2,"width","300px"],[1,"cl-dropdown-menu-header"],[1,"cl-input-group"],[1,"cl-w-100",3,"debounceTime","search","placeholder","onSearchChange"],["infiniteScroll","",1,"cl-scroll-area",3,"infiniteScrollDistance","infiniteScrollThrottle","scrollWindow","scrolled"],["scrollArea",""],[4,"ngIf"],["dropdownClose","","tabindex","0"],["class","cl-dropdown-item cl-px-2 cl-hover-pointer","tabindex","0","clickCloseDropdown","",3,"click","keyup.enter",4,"ngFor","ngForOf"],["class","cl-dropdown-item",4,"ngIf"],["tabindex","0","clickCloseDropdown","",1,"cl-dropdown-item","cl-px-2","cl-hover-pointer",3,"click","keyup.enter"],["clickCloseDropdown","",1,"cl-item-between"],["clickCloseDropdown","",1,"cl-d-flex","cl-cut-text-wrapper"],["clickCloseDropdown","",1,"cl-mr-2",2,"min-width","15px","width","15px"],["src","assets/ui-icons/checkmark-green.svg","class","cl-mr-2",4,"ngIf"],["class","cl-d-flex cl-ml-1","clickCloseDropdown","",4,"ngIf"],["src","assets/ui-icons/checkmark-green.svg",1,"cl-mr-2"],["clickCloseDropdown","",1,"cl-d-flex","cl-ml-1"],[1,"cl-small","cl-text-muted"],["src","assets/ui-icons/camera-icon.svg",1,"cl-ml-1"],[1,"cl-dropdown-item"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.jc("onOpen",(function(){return t.opened()}))("onClose",(function(){return t.closed()})),c.Xb(1,"div",1),c.Xb(2,"span",2),c.Yc(3),c.Wb(),c.Wb(),c.Wc(4,rj,9,11,"div",3),c.Wb()),2&e&&(c.wc("dropdownKey",!1),c.Cb(3),c.ad(" ",t.overrideTitle||(null==t.selectedItem?null:t.selectedItem.name)||t.selectedName||(null==t.selectedItem?null:t.selectedItem.id)||"Select"," "))},directives:[Si.a,Ii.a,Oi.a,JA.a,le.a,s.u,s.t],pipes:[ej.a],encapsulation:2,changeDetection:0}),e})();var aj=i("+W0u");let lj=(()=>{class e{constructor(){this.onClose=new c.n,this.onPrevious=new c.n,this.onNext=new c.n,this.onImageError=new c.n}handleKeyboardEvent(e){"ArrowLeft"!==e.key||this.noPrevious||this.onPrevious.emit(!0),"ArrowRight"!==e.key||this.noNext||this.onNext.emit(!0)}next(){this.onNext.emit(!0)}previous(){this.onPrevious.emit(!0)}close(){this.onClose.emit(!0)}onError(){const e=this.screenshot.screenshotUrl;e!==this.lastErrorImageUrl&&(this.lastErrorImageUrl=e,this.onImageError.emit())}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["preview-screenshot"]],hostBindings:function(e,t){1&e&&c.jc("keydown",(function(e){return t.handleKeyboardEvent(e)}),!1,c.Mc)},inputs:{title:"title",screenshot:"screenshot",noPrevious:"noPrevious",noNext:"noNext"},outputs:{onClose:"onClose",onPrevious:"onPrevious",onNext:"onNext",onImageError:"onImageError"},decls:19,vars:7,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close","cl-no-outline",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-d-flex","cl-mb-3"],[1,"cl-my-auto","cl-mr-3"],[1,"cl-btn","cl-btn-fixed-40","cl-btn-outline-light","cl-d-print-none",3,"disabled","click"],["src","assets/images/ui-icons/chevron-left.svg"],[1,"cl-w-100"],[1,"cl-w-100",3,"src","error"],[1,"cl-my-auto","cl-ml-3"],["src","assets/images/ui-icons/chevron-right.svg"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"h1",1),c.Yc(2),c.Wb(),c.Xb(3,"button",2),c.jc("click",(function(){return t.close()})),c.Xb(4,"span",3),c.Sb(5,"img",4),c.Wb(),c.Wb(),c.Wb(),c.Xb(6,"div",5),c.Xb(7,"div",6),c.Xb(8,"div",7),c.Xb(9,"button",8),c.jc("click",(function(){return t.previous()})),c.Sb(10,"img",9),c.Wb(),c.Wb(),c.Xb(11,"div",10),c.Xb(12,"p"),c.Yc(13),c.oc(14,"hourFormat"),c.Wb(),c.Xb(15,"img",11),c.jc("error",(function(){return t.onError()})),c.Wb(),c.Wb(),c.Xb(16,"div",12),c.Xb(17,"button",8),c.jc("click",(function(){return t.next()})),c.Sb(18,"img",13),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(2),c.Zc(t.title),c.Cb(7),c.wc("disabled",t.noPrevious),c.Cb(4),c.ad("Recorded at ",c.pc(14,5,null==t.screenshot?null:t.screenshot.createdAt),""),c.Cb(2),c.xc("src",t.screenshot.screenshotUrl,c.Qc),c.Cb(2),c.wc("disabled",t.noNext))},pipes:[hD.a],encapsulation:2}),e})(),bj=(()=>{class e{constructor(e){this.formatIs12Hour=e.getTimeFormatForUser()===gg.a.HOUR12}transform(e,t){const i=Se().set("hour",e).set("minute",0);return t&&i.add(t,"hour"),this.formatIs12Hour?i.format("h:mmA").toString():i.format("HH:mm").toString()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(ys.a))},e.\u0275pipe=c.Qb({name:"numberToHoursFormat",type:e,pure:!0}),e})();const uj=["dropdownUsers"];function dj(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",9),c.Xb(1,"dropdown-searchable",19,20),c.jc("onOpen",(function(){c.Oc(e);const t=c.nc();return!t.isGetUsersTriggered&&t.getUsers()}))("loadMore",(function(){return c.Oc(e),c.nc().loadMoreUsers()}))("onSearch",(function(t){return c.Oc(e),c.nc().onSearchUser(t)}))("onChanged",(function(t){return c.Oc(e),c.nc().userChange(t)})),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(1),c.wc("list",e.users)("value",e.selectedUser.id)("selectedName",e.selectedUser.name)("placeholder","Search teammates")("overrideTitle",e.selectedUser.id===e.loggedInUser.id?"Teammates":"")("searchOffline",e.areAllUsersLoaded)}}function pj(e,t){if(1&e&&(c.Xb(0,"span",21),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad("(",e.screenshotCount,")")}}function hj(e,t){if(1&e&&(c.Xb(0,"div",40),c.Yc(1),c.oc(2,"hourFormat"),c.Wb()),2&e){const e=c.nc().$implicit;c.Cb(1),c.ad(" ",c.pc(2,1,e.createdAt)," ")}}function mj(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",31),c.Xb(1,"div",32),c.Xb(2,"span",33),c.Xb(3,"button",34),c.jc("click",(function(){c.Oc(e);const i=t.$implicit,n=c.nc(3),s=c.Lc(21);return n.openModal(s,i)})),c.Yc(4,"View image"),c.Wb(),c.Wb(),c.Xb(5,"span",35),c.Xb(6,"button",36),c.jc("click",(function(){c.Oc(e);const i=t.$implicit,n=c.nc(3),s=c.Lc(19);return n.openModal(s,i)})),c.Sb(7,"img",37),c.Wb(),c.Wb(),c.Sb(8,"img",38),c.Wb(),c.Wc(9,hj,3,3,"div",39),c.Wb()}if(2&e){const e=t.$implicit;c.Cb(8),c.xc("src",e.screenshotUrl,c.Qc),c.Cb(1),c.wc("ngIf",e.createdAt)}}function gj(e,t){if(1&e&&(c.Xb(0,"div",27),c.Xb(1,"div",28),c.Xb(2,"div",29),c.Yc(3),c.oc(4,"numberToHoursFormat"),c.oc(5,"numberToHoursFormat"),c.Wb(),c.Wb(),c.Wc(6,mj,10,2,"div",30),c.Wb()),2&e){const e=t.$implicit;c.Cb(3),c.bd(" ",c.pc(4,3,e.hour)," - ",c.qc(5,5,e.hour,1)," "),c.Cb(3),c.wc("ngForOf",e.screenshots)}}function fj(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",22),c.Xb(1,"div",23),c.Xb(2,"div",24),c.Xb(3,"div",25),c.jc("scrolled",(function(){return c.Oc(e),c.nc().onScroll()})),c.Wc(4,gj,7,8,"div",26),c.Wb(),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(3),c.wc("infiniteScrollDistance",3)("infiniteScrollThrottle",150),c.Cb(1),c.wc("ngForOf",e.screenshotGroups)}}function vj(e,t){1&e&&(c.Vb(0),c.Xb(1,"p",46),c.Yc(2," Download desktop app to start capturing screenshots every 5 minutes while the timer is running. "),c.Wb(),c.Xb(3,"a",47),c.Yc(4,"Get screenshot recording app"),c.Wb(),c.Ub())}function wj(e,t){if(1&e&&(c.Xb(0,"div",41),c.Xb(1,"div",42),c.Sb(2,"img",43),c.Wb(),c.Xb(3,"span",44),c.Yc(4,"No screenshots this day"),c.Wb(),c.Wc(5,vj,5,0,"ng-container",45),c.Wb()),2&e){const e=c.nc();c.Cb(5),c.wc("ngIf",e.loggedInUser.id===e.selectedUser.id)}}function yj(e,t){if(1&e){const e=c.Yb();c.Xb(0,"delete-confirm-modal",48),c.jc("onClose",(function(){return t.$implicit.close()}))("onDelete",(function(){c.Oc(e);const i=t.$implicit,n=c.nc();return n.delete(n.selectedScreenshot),i.close()})),c.Xb(1,"p",49),c.Yc(2),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.wc("title","Delete screenshot")("btnText","Delete")("showConfirmation",!1),c.Cb(2),c.ad(" ",e.deleteMessage," ")}}function Wj(e,t){if(1&e){const e=c.Yb();c.Xb(0,"preview-screenshot",50),c.jc("onPrevious",(function(){return c.Oc(e),c.nc().previous()}))("onNext",(function(){return c.Oc(e),c.nc().next()}))("onClose",(function(){return t.$implicit.close()}))("onImageError",(function(){return c.Oc(e),c.nc().updateUrl()})),c.Wb()}if(2&e){const e=c.nc();c.wc("title",e.selectedUser.name)("screenshot",e.selectedScreenshot)("noPrevious",e.screenshots.indexOf(e.selectedScreenshot)<1)("noNext",e.screenshots.indexOf(e.selectedScreenshot)===e.screenshots.length-1)}}let Cj=(()=>{class e{constructor(e,t,i,n,s,c){this.cd=e,this.userService=t,this.authService=i,this.screenshotsService=n,this.modal=s,this.loader=c,this.screenshotGroups=[],this.ActivityPills=ZA.a,this.unsubscribe$=new Ee.a,this.dateRange={start:Se().startOf("day").toISOString(),end:Se().endOf("day").toISOString()},this.usersQuery={page:1,name:"",limit:ei.j,status:Xs.a.ACTIVE},this.users=[]}ngOnInit(){this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.authService.permissionData$.pipe(Object(It.a)(e=>null!==e),Object(De.a)(this.unsubscribe$)).subscribe(({isAdminOrOwner:e})=>this.isAdminOrOwner=e),this.loggedInUser=this.authService.getUser(),this.selectedUser=new QA({id:this.loggedInUser.id,name:this.loggedInUser.name}),this.resetScreenshots(),this.getScreenshotsWithCount()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}resetScreenshots(){this.screenshotPage=1,this.screenshotGroups=[],this.screenshots=[],this.screenshotCount=null}dateRangeChanged(e){this.dateRange={start:e.dateRange.start.clone().toISOString(),end:e.dateRange.end.clone().toISOString()},this.resetScreenshots(),this.getScreenshotsWithCount(),this.users.length>190?(this.users=[],this.usersQuery.page=1,this.areAllUsersLoaded=!1,this.isGetUsersTriggered=!1):(this.clearAllUsersCount(),this.getScreenshotCountForUsers(this.users))}userChange(e){this.resetScreenshots(),this.selectedUser=e,Object(Pt.t)(e.count)?(this.screenshotCount=e.count,this.getScreenshots()):this.getScreenshotsWithCount()}getScreenshotsWithCount(){this.loader.show(),this.screenshotsService.getCountForUser(this.selectedUser.id,this.dateRange.start,this.dateRange.end).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.screenshotCount=e||0,this.screenshotCount?this.getScreenshots():this.loader.hide(),this.cd.detectChanges()},()=>this.loader.hide())}getScreenshots(){this.screenshotsService.getScreenshots(this.selectedUser.id,{page:this.screenshotPage,start:this.dateRange.start,end:this.dateRange.end}).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.groupScreenshots(e),this.screenshots=[...this.screenshots,...e],this.loader.hide(),this.cd.detectChanges()},()=>this.loader.hide())}groupScreenshots(e){if(!(null==e?void 0:e.length))return;let t=this.screenshotGroups.length;e.forEach(e=>{var i;const n=Se(e.createdAt).hours();(null===(i=this.screenshotGroups[t-1])||void 0===i?void 0:i.hour)===n?this.screenshotGroups[t-1].screenshots.push(e):(this.screenshotGroups.push({hour:n,screenshots:[e]}),t++)}),this.cd.detectChanges()}onScroll(){this.screenshots.length>=this.screenshotCount||(this.screenshotPage++,this.getScreenshots())}openModal(e,t){this.selectedScreenshot=t,this.deleteMessage=this.getDeleteMessage(t),this.modal.open(e,{centered:!0,size:"lg"})}delete(e){this.loader.showBar(),this.isAdminOrOwner?this.screenshotsService.adminDelete(e.screenshotId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.screenshotDeleted(e),this.loader.hide()},()=>this.loader.hide()):this.screenshotsService.delete(e.screenshotId,e.timeEntryId).pipe(Object(De.a)(this.unsubscribe$)).subscribe(()=>{this.screenshotDeleted(e),this.loader.hide()},()=>this.loader.hide())}getDeleteMessage(e){if(this.isAdminOrOwner)return"Are you sure you want to delete this screenshot ?";const t=this.screenshots.filter(t=>t.timeEntryId===e.timeEntryId);if(1===t.length)return"If you delete this screenshot, its time entry will be deleted from your timesheet.";let i;i=0===t.indexOf(e)?Se(e.createdAt).diff(Se(t[1].createdAt)):t.indexOf(e)===t.length-1?Se(t[t.length-2].createdAt).diff(Se(e.createdAt)):Se(t[t.indexOf(e)-1].createdAt).diff(Se(e.createdAt));const n=Object(Se.duration)(Math.abs(i)).format("m:ss");return`If you delete this screenshot,\n    ${n.split(":")[0]} min\n    and\n    ${n.split(":")[1]} sec\n    will be subtracted from your tracked time.`}updateUrl(){this.screenshotsService.getScreenshot(this.selectedScreenshot.screenshotId,this.selectedUser.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.selectedScreenshot.screenshotUrl=e.screenshotUrl,this.cd.detectChanges()})}next(){const e=this.screenshots.indexOf(this.selectedScreenshot)+1;this.selectedScreenshot=this.screenshots[e],this.cd.detectChanges()}previous(){const e=this.screenshots.indexOf(this.selectedScreenshot)-1;this.selectedScreenshot=this.screenshots[e],this.cd.detectChanges()}screenshotDeleted(e){this.screenshots=this.screenshots.filter(t=>t.screenshotId!==e.screenshotId),this.cd.detectChanges()}onSearchUser(e){this.usersQuery.name=e,this.usersQuery.page=1,this.getUsers()}loadMoreUsers(){this.usersQuery.page++,this.getUsers()}getUsers(){if(this.areAllUsersLoaded)return;if(!this.isAdminOrOwner)return;this.isGetUsersTriggered=!0;const{name:e,page:t}=this.usersQuery;this.userService.getUserNames(this.usersQuery).pipe(Object(De.a)(this.unsubscribe$)).subscribe(i=>{this.areAllUsersLoaded=!e&&i.length<this.usersQuery.limit;const n=i.map(e=>new QA(e));this.users=1===t?n:[...this.users,...n],this.getScreenshotCountForUsers(n),this.cd.detectChanges()})}getScreenshotCountForUsers(e){e.length&&this.isAdminOrOwner&&this.screenshotsService.getCountForUsers(e.map(e=>e.id),this.dateRange.start,this.dateRange.end).pipe(Object(De.a)(this.unsubscribe$)).subscribe(t=>{e.map(e=>(e.count=t[e.id]||0,e)),this.dropdownUsers&&this.dropdownUsers.triggerDetection(),this.cd.detectChanges()})}clearAllUsersCount(){this.users=(this.users||[]).map(e=>(e.count=null,e)),this.dropdownUsers&&this.dropdownUsers.triggerDetection()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(c.h),c.Rb(ys.a),c.Rb(Ce.a),c.Rb(KA),c.Rb(g.q),c.Rb(wi.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["screenshots"]],viewQuery:function(e,t){var i;1&e&&c.ed(uj,!0),2&e&&c.Kc(i=c.kc())&&(t.dropdownUsers=i.first)},decls:22,vars:10,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center","cl-justify-content-between"],[1,"cl-col-auto","cl-mb-3","cl-mb-md-0","cl-d-flex","cl-align-items-center","cl-justify-content-between"],[1,"cl-btn-group",3,"page"],[1,"cl-col-auto","cl-ml-auto","cl-mb-3","cl-mb-md-0"],["class","cl-d-flex cl-align-items-center",4,"ngIf"],[1,"cl-col-md-auto"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-page-header-action","cl-w-100","cl-w-md-auto"],[3,"isDaily","disableOpenPicker","onlyLastDays","getOfUtc","dateRangeOut"],[1,"cl-page-component-wrapper"],[1,"cl-h1","cl-mb-3"],["class","cl-text-gray-9",4,"ngIf"],["class","cl-card cl-p-2",4,"ngIf"],["class","cl-no-entries","style","margin-top: 10%;",4,"ngIf"],["deleteModal",""],["previewModal",""],[1,"cl-cut-text-wrapper",3,"list","value","selectedName","placeholder","overrideTitle","searchOffline","onOpen","loadMore","onSearch","onChanged"],["dropdownUsers",""],[1,"cl-text-gray-9"],[1,"cl-card","cl-p-2"],[1,"cl-card-body","cl-p-3"],[1,"cl-screenshots-wrapper"],["infiniteScroll","",1,"cl-container-fluid",3,"infiniteScrollDistance","infiniteScrollThrottle","scrolled"],["class","cl-row cl-mb-2",4,"ngFor","ngForOf"],[1,"cl-row","cl-mb-2"],[1,"cl-col-12","cl-mb-2"],[1,"cl-screenshots-time-range"],["class","cl-col-auto cl-col-screenshot-thumb",4,"ngFor","ngForOf"],[1,"cl-col-auto","cl-col-screenshot-thumb"],[1,"cl-border","cl-relative","cl-rounded","cl-screenshot",2,"width","205px","height","115px"],[1,"screenshot-btn-wrapper"],[1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-absolute-right"],[1,"cl-btn","cl-btn-sm","cl-btn-outline-light","cl-p-0","cl-border-top-0","cl-border-right-0",3,"click"],["src","assets/images/ui-icons/delete.svg",1,"cl-p-1"],[1,"cl-img-fluid","cl-screenshot-img",2,"width","203px","height","113px",3,"src"],["class","cl-mt-2 cl-text-center cl-text-muted cl-small",4,"ngIf"],[1,"cl-mt-2","cl-text-center","cl-text-muted","cl-small"],[1,"cl-no-entries",2,"margin-top","10%"],[1,"cl-no-entries-image-wrapper"],["src","assets/images/no_screenshots.svg",1,"no__entries--image"],[1,"cl-h2","cl-mb-1"],[4,"ngIf"],[1,"cl-mb-0","cl-mb-3",2,"max-width","380px"],["href","https://clockify.me/screenshot-recording-app","target","_blank",1,"cl-btn","cl-btn-primary"],[3,"title","btnText","showConfirmation","onClose","onDelete"],[1,"cl-text-muted","cl-mb-0"],[3,"title","screenshot","noPrevious","noNext","onPrevious","onNext","onClose","onImageError"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Sb(5,"activity-tabs",5),c.Wb(),c.Xb(6,"div",6),c.Wc(7,dj,3,6,"div",7),c.Wb(),c.Xb(8,"div",8),c.Xb(9,"div",9),c.Xb(10,"div",10),c.Xb(11,"datepicker-range",11),c.jc("dateRangeOut",(function(e){return t.dateRangeChanged(e)})),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(12,"div",12),c.Xb(13,"div",13),c.Yc(14),c.Wc(15,pj,2,1,"span",14),c.Wb(),c.Wc(16,fj,5,3,"div",15),c.Wc(17,wj,6,1,"div",16),c.Wb(),c.Wb(),c.Wb(),c.Wc(18,yj,3,4,"ng-template",null,17,c.Xc),c.Wc(20,Wj,1,4,"ng-template",null,18,c.Xc)),2&e&&(c.Cb(5),c.wc("page",t.ActivityPills.SCREENSHOTS),c.Cb(2),c.wc("ngIf",t.isAdminOrOwner),c.Cb(4),c.wc("isDaily",!0)("disableOpenPicker",!0)("onlyLastDays",7)("getOfUtc",!0),c.Cb(3),c.ad(" ",t.selectedUser.name," "),c.Cb(1),c.wc("ngIf",t.screenshotCount),c.Cb(1),c.wc("ngIf",null==t.screenshots?null:t.screenshots.length),c.Cb(1),c.wc("ngIf",0===t.screenshotCount))},directives:[aj.a,s.u,jn.a,oj,le.a,s.t,yl.a,lj],pipes:[bj,hD.a],encapsulation:2,changeDetection:0}),e})(),kj=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(e){const t=this.workspaceService.getLocalDefaultWorkspace();return!(!e.data.locations||!t.locationsEnabled)||!(!e.data.screenshots||!t.screenshotsEnabled)||(this.router.navigate(["tracker"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(c.fc(U.a),c.fc(W.c))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();function Sj(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}function Ij(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}function Oj(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}function Xj(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}function Ej(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}function Tj(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}function Dj(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}function Rj(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}function Aj(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}function jj(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}function xj(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}function Pj(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}function Mj(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}function Yj(e,t){if(1&e&&(c.Xb(0,"small",40),c.Yc(1),c.Wb()),2&e){const e=c.nc();c.Cb(1),c.ad(" Value must be no longer than ",e.maxLabelLength," characters. ")}}let Lj=(()=>{class e{constructor(e,t,i,n){this.router=e,this.invoiceService=t,this.formBuilder=i,this.cd=n,this.maxLabelLength=20,this.unsubscribe$=new mi.a,this.canUpdate=!1}ngOnInit(){this.initDefaultFormControls(),this.invoiceService.getInvoiceSettings().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.invoiceSettings=e,this.form.patchValue({issueDate:this.invoiceSettings.issueDate,dueDate:this.invoiceSettings.dueDate,billFrom:this.invoiceSettings.billFrom,billTo:this.invoiceSettings.billTo,description:this.invoiceSettings.description,quantity:this.invoiceSettings.quantity,unitPrice:this.invoiceSettings.unitPrice,amount:this.invoiceSettings.amount,subtotal:this.invoiceSettings.subtotal,discount:this.invoiceSettings.discount,tax:this.invoiceSettings.tax,tax2:this.invoiceSettings.tax2,totalAmount:this.invoiceSettings.totalAmount,notes:this.invoiceSettings.notes}),this.canUpdate=!0,this.cd.detectChanges()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}modelChanged(e=!1){this.canUpdate&&this.form.valid&&this.save()}notValid(e){const t=this.form.get(e);return!!t&&t.dirty&&t.touched&&!!t.errors}initDefaultFormControls(){this.form=this.formBuilder.group({issueDate:["",p.G.maxLength(this.maxLabelLength)],dueDate:["",p.G.maxLength(this.maxLabelLength)],billFrom:["",p.G.maxLength(this.maxLabelLength)],billTo:["",p.G.maxLength(this.maxLabelLength)],description:["",p.G.maxLength(this.maxLabelLength)],quantity:["",p.G.maxLength(this.maxLabelLength)],unitPrice:["",p.G.maxLength(this.maxLabelLength)],amount:["",p.G.maxLength(this.maxLabelLength)],subtotal:["",p.G.maxLength(this.maxLabelLength)],discount:["",p.G.maxLength(this.maxLabelLength)],tax:["",p.G.maxLength(this.maxLabelLength)],tax2:["",p.G.maxLength(this.maxLabelLength)],totalAmount:["",p.G.maxLength(this.maxLabelLength)],notes:["",p.G.maxLength(this.maxLabelLength)]})}save(){this.invoiceService.editInvoiceSettings(this.form.value).subscribe()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(W.c),c.Rb(ki),c.Rb(p.f),c.Rb(c.h))},e.\u0275cmp=c.Lb({type:e,selectors:[["invoice-settings"]],decls:82,vars:43,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],["routerLink","/invoices",1,"cl-d-inline-block","cl-mb-2","cl-d-print-none"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-card"],[1,"cl-card-body"],[1,"cl-text-wrap","cl-mb-3"],[3,"formGroup"],[1,"cl-form-group"],["for","issueDate"],["type","text","id","issueDate","formControlName","issueDate","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["class","cl-form-text cl-text-danger",4,"ngIf"],["for","dueDate"],["type","text","id","dueDate","formControlName","dueDate","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","billFrom"],["type","text","id","billFrom","formControlName","billFrom","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["class","cl-form-text  cl-text-danger",4,"ngIf"],["for","billTo"],["type","text","id","billTo","formControlName","billTo","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","description"],["type","text","id","description","formControlName","description","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","quantity"],["type","text","id","quantity","formControlName","quantity","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","unitPrice"],["type","text","id","unitPrice","formControlName","unitPrice","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","amount"],["type","text","id","amount","formControlName","amount","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","subtotal"],["type","text","id","subtotal","formControlName","subtotal","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","discount"],["type","text","id","discount","formControlName","discount","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","tax"],["type","text","id","tax","formControlName","tax","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","tax2"],["type","text","id","tax2","formControlName","tax2","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","totalAmount"],["type","text","id","totalAmount","formControlName","totalAmount","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","notes"],["type","text","id","notes","formControlName","notes","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],[1,"cl-form-text","cl-text-danger"]],template:function(e,t){1&e&&(c.Xb(0,"main",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"a",3),c.Yc(4,"Invoices"),c.Wb(),c.Xb(5,"h1",4),c.Yc(6,"Invoice Settings"),c.Wb(),c.Wb(),c.Xb(7,"div",5),c.Xb(8,"div",6),c.Xb(9,"div",7),c.Yc(10," Translate every label on a Clockify invoice. Your translation will show up on the printed and PDF versions of all your invoices. "),c.Wb(),c.Xb(11,"form",8),c.Xb(12,"div",9),c.Xb(13,"label",10),c.Yc(14,"Issue date"),c.Wb(),c.Xb(15,"input",11),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(16,Sj,2,1,"small",12),c.Wb(),c.Xb(17,"div",9),c.Xb(18,"label",13),c.Yc(19,"Due date"),c.Wb(),c.Xb(20,"input",14),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(21,Ij,2,1,"small",12),c.Wb(),c.Xb(22,"div",9),c.Xb(23,"label",15),c.Yc(24,"Bill from"),c.Wb(),c.Xb(25,"input",16),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(26,Oj,2,1,"small",17),c.Wb(),c.Xb(27,"div",9),c.Xb(28,"label",18),c.Yc(29,"Bill to"),c.Wb(),c.Xb(30,"input",19),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(31,Xj,2,1,"small",12),c.Wb(),c.Xb(32,"div",9),c.Xb(33,"label",20),c.Yc(34,"Description"),c.Wb(),c.Xb(35,"input",21),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(36,Ej,2,1,"small",12),c.Wb(),c.Xb(37,"div",9),c.Xb(38,"label",22),c.Yc(39,"Quantity"),c.Wb(),c.Xb(40,"input",23),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(41,Tj,2,1,"small",12),c.Wb(),c.Xb(42,"div",9),c.Xb(43,"label",24),c.Yc(44,"Unit price"),c.Wb(),c.Xb(45,"input",25),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(46,Dj,2,1,"small",12),c.Wb(),c.Xb(47,"div",9),c.Xb(48,"label",26),c.Yc(49,"Amount"),c.Wb(),c.Xb(50,"input",27),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(51,Rj,2,1,"small",12),c.Wb(),c.Xb(52,"div",9),c.Xb(53,"label",28),c.Yc(54,"Subtotal"),c.Wb(),c.Xb(55,"input",29),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(56,Aj,2,1,"small",12),c.Wb(),c.Xb(57,"div",9),c.Xb(58,"label",30),c.Yc(59,"Discount"),c.Wb(),c.Xb(60,"input",31),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(61,jj,2,1,"small",12),c.Wb(),c.Xb(62,"div",9),c.Xb(63,"label",32),c.Yc(64,"Tax"),c.Wb(),c.Xb(65,"input",33),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(66,xj,2,1,"small",12),c.Wb(),c.Xb(67,"div",9),c.Xb(68,"label",34),c.Yc(69,"Tax 2"),c.Wb(),c.Xb(70,"input",35),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(71,Pj,2,1,"small",12),c.Wb(),c.Xb(72,"div",9),c.Xb(73,"label",36),c.Yc(74,"Total amount due"),c.Wb(),c.Xb(75,"input",37),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(76,Mj,2,1,"small",12),c.Wb(),c.Xb(77,"div",9),c.Xb(78,"label",38),c.Yc(79,"Notes"),c.Wb(),c.Xb(80,"input",39),c.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),c.Wb(),c.Wc(81,Yj,2,1,"small",12),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&e&&(c.Cb(11),c.wc("formGroup",t.form),c.Cb(4),c.Hb("cl-border-danger",t.notValid("issueDate")),c.Cb(1),c.wc("ngIf",t.notValid("issueDate")),c.Cb(4),c.Hb("cl-border-danger",t.notValid("dueDate")),c.Cb(1),c.wc("ngIf",t.notValid("dueDate")),c.Cb(4),c.Hb("cl-border-danger",t.notValid("billFrom")),c.Cb(1),c.wc("ngIf",t.notValid("billFrom")),c.Cb(4),c.Hb("cl-border-danger",t.notValid("billTo")),c.Cb(1),c.wc("ngIf",t.notValid("billTo")),c.Cb(4),c.Hb("cl-border-danger",t.notValid("description")),c.Cb(1),c.wc("ngIf",t.notValid("description")),c.Cb(4),c.Hb("cl-border-danger",t.notValid("quantity")),c.Cb(1),c.wc("ngIf",t.notValid("quantity")),c.Cb(4),c.Hb("cl-border-danger",t.notValid("unitPrice")),c.Cb(1),c.wc("ngIf",t.notValid("unitPrice")),c.Cb(4),c.Hb("cl-border-danger",t.notValid("amount")),c.Cb(1),c.wc("ngIf",t.notValid("amount")),c.Cb(4),c.Hb("cl-border-danger",t.notValid("subtotal")),c.Cb(1),c.wc("ngIf",t.notValid("subtotal")),c.Cb(4),c.Hb("cl-border-danger",t.notValid("discount")),c.Cb(1),c.wc("ngIf",t.notValid("discount")),c.Cb(4),c.Hb("cl-border-danger",t.notValid("tax")),c.Cb(1),c.wc("ngIf",t.notValid("tax")),c.Cb(4),c.Hb("cl-border-danger",t.notValid("tax2")),c.Cb(1),c.wc("ngIf",t.notValid("tax2")),c.Cb(4),c.Hb("cl-border-danger",t.notValid("totalAmount")),c.Cb(1),c.wc("ngIf",t.notValid("totalAmount")),c.Cb(4),c.Hb("cl-border-danger",t.notValid("notes")),c.Cb(1),c.wc("ngIf",t.notValid("notes")))},directives:[W.f,p.I,p.t,p.k,p.c,p.s,p.i,s.u],encapsulation:2}),e})();function Fj(e,t){1&e&&c.Sb(0,"img",23)}function Nj(e,t){if(1&e){const e=c.Yb();c.Xb(0,"stripe-invoice",24),c.jc("turnAddress",(function(t){return c.Oc(e),c.nc(2).addressOn=t}))("nextStep",(function(){return c.Oc(e),c.nc(2).toggleInformation(!0)})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("editInvoiceInformation",e.invoiceInformation)("workspaceName",e.workspace.name)("mode","create")}}function Uj(e,t){if(1&e){const e=c.Yb();c.Xb(0,"stripe",25),c.jc("paymentInformation",(function(t){c.Oc(e);const i=c.nc(2),n=c.Lc(12);return i.getPaymentInformation(t,n)}))("closeDialog",(function(){return c.Oc(e),c.nc(2).toggleInformation(!1)})),c.Wb()}if(2&e){const e=c.nc(2);c.wc("editPaymentInformation",e.paymentInformation)("invoiceInformation",e.invoiceInformation)("mode","create")("isPaymentInfo",!0)("isMonthly",!1)("paymentFailedMessage",e.failMessage)}}function $j(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",11),c.Xb(1,"div",12),c.Xb(2,"div",11),c.Xb(3,"div",13),c.Xb(4,"ul",14),c.Xb(5,"li",15),c.Xb(6,"a",16),c.jc("click",(function(){return c.Oc(e),c.nc().toggleInformation(!1)})),c.Xb(7,"div",17),c.Yc(8,"step 1 "),c.Wc(9,Fj,1,0,"img",18),c.Wb(),c.Xb(10,"div",19),c.Yc(11,"Invoice information "),c.Wb(),c.Wb(),c.Wb(),c.Xb(12,"li",15),c.Xb(13,"a",16),c.jc("click",(function(){return c.Oc(e),c.nc().toggleInformation(!0)})),c.Xb(14,"div",17),c.Yc(15,"step 2"),c.Wb(),c.Xb(16,"div",19),c.Yc(17,"Payment information "),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(18,"div",20),c.Wc(19,Nj,1,3,"stripe-invoice",21),c.Wc(20,Uj,1,6,"stripe",22),c.Wb(),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(6),c.Hb("cl-active",!e.isPayment),c.Cb(3),c.wc("ngIf",e.isPayment),c.Cb(4),c.Hb("cl-active",e.isPayment),c.Cb(6),c.wc("ngIf",!e.isPayment),c.Cb(1),c.wc("ngIf",e.isPayment)}}function _j(e,t){1&e&&(c.Xb(0,"div",26),c.Yc(1," You have no permission to add or edit payment info for this workspace! "),c.Wb())}function Gj(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",27),c.Xb(1,"h1"),c.Yc(2,"Save payment info"),c.Wb(),c.Wb(),c.Xb(3,"div",28),c.Xb(4,"p"),c.Yc(5,"Save payment info for "),c.Xb(6,"b"),c.Yc(7),c.Wb(),c.Yc(8," workspace"),c.Wb(),c.Wb(),c.Xb(9,"div",29),c.Xb(10,"a",30),c.jc("click",(function(){return t.$implicit.close()})),c.Yc(11,"Cancel"),c.Wb(),c.Xb(12,"button",31),c.jc("click",(function(){return c.Oc(e),c.nc().savePaymentInfo()})),c.Yc(13,"Save "),c.Wb(),c.Wb()}if(2&e){const e=c.nc();c.Cb(7),c.Zc(e.workspace.name)}}const Bj=[{path:"redirect/:id",canActivate:[xT]},{path:"",redirectTo:ei.o,pathMatch:"full"},{path:"",component:EE,canActivate:[af,Qc,Ft,cf],resolve:{role:rf},children:[{path:ei.o,component:ug,canActivate:[TI]},{path:"dashboard",component:Kc},{path:"projects",component:mC.a,canActivate:[Ud],data:{page:Gr.PROJECT}},{path:"projects/:projectId/edit",component:gC.a},{path:"approvals",component:RT,canActivate:[AT,jT,PT],data:{feature:nr.a.APPROVAL}},{path:"approvals/:id",component:PD,canActivate:[AT,jT,PT],data:{feature:nr.a.APPROVAL}},{path:"workspaces",canActivate:[hC],component:Jc.a},{path:"teams",component:EI,canActivate:[Ud],data:{page:Gr.TEAM}},{path:"clients",component:zA,canActivate:[nu]},{path:"tags",component:BA,canActivate:[nu]},{path:"subscription",component:WA,canActivate:[nu,CA,kA],data:{allowIfHasInvoice:!0,redirectionPage:"upgrade"}},{path:"payment-info",component:(()=>{class e{constructor(e,t,i,n,s,c){this.toaster=e,this.workspaceService=t,this.paymentService=i,this.loader=n,this.modal=s,this.authService=c,this.unsubscribe$=new Ee.a,this.invoiceInformation=new lf.a,this.paymentInformation=new bf.a}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.isAdmin=this.authService.isAdminOrOwner(),this.isAdmin&&(this.paymentService.getPaymentInformation().pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.paymentInformation=e}),this.paymentService.getInvoiceInformation(this.workspace.id).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.invoiceInformation=e}))}toggleInformation(e){this.invoiceInformation.isCompanyNameEmpty()?this.toaster.pop("error","Company name is mandatory"):this.invoiceInformation.isAddressEmpty(this.addressOn)?this.toaster.pop("error","All address fields are mandatory"):this.invoiceInformation.isVatEmpty()?this.toaster.pop("error","Missing vat information"):(window.scrollTo(0,0),this.isPayment=e)}getPaymentInformation(e,t){this.paymentInformation=new bf.a(e),this.modal.open(t,{centered:!0})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}savePaymentInfo(){this.loader.show();const e=this.paymentService.editPaymentInformation(this.workspace.id,this.paymentInformation),t=this.paymentService.editInvoiceInformation(this.workspace.id,this.invoiceInformation);Object(la.a)(e,t).pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.paymentInformation=e[0],this.invoiceInformation=e[1],this.toaster.pop("success","Billing information changed","This new information will be applied on all your future receipts"),this.loader.hide(),this.modal.dismissAll()},e=>{var t;this.failMessage=null===(t=e.error)||void 0===t?void 0:t.message,this.loader.hide()})}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(M.a),c.Rb(U.a),c.Rb(Cu.a),c.Rb(wi.a),c.Rb(g.q),c.Rb(Ce.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["payment-info"]],decls:13,vars:2,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-align-items-center"],[1,"cl-col-md-4","cl-mb-3","cl-mb-md-0","cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-md-start"],[1,"cl-float-left"],[1,"cl-mt-3"],[1,"cl-h-100","cl-pt-2","cl-px-3","cl-pb-3","cl-bg-white","cl-border","cl-rounded"],["class","cl-row",4,"ngIf"],["class","cl-alert cl-alert-info cl-mt-3",4,"ngIf"],["confirm",""],[1,"cl-row"],[1,"cl-col-lg-custom-4"],[1,"cl-col-lg-custom-12"],["id","myTab","role","tablist",1,"cl-nav","cl-nav-tabs","cl-custom-tabs-minimal","cl-mb-2"],[1,"cl-nav-item","cl-flex-grow-1"],[1,"cl-nav-link","cl-pl-0","cl-text-left",3,"click"],[1,"cl-h5","cl-mb-0"],["src","/assets/images/ui-icons/checkmark-green.svg","class","cl-ml-2",4,"ngIf"],[1,"cl-lowercase"],[1,"cl-tab-content"],[3,"editInvoiceInformation","workspaceName","mode","turnAddress","nextStep",4,"ngIf"],[3,"editPaymentInformation","invoiceInformation","mode","isPaymentInfo","isMonthly","paymentFailedMessage","paymentInformation","closeDialog",4,"ngIf"],["src","/assets/images/ui-icons/checkmark-green.svg",1,"cl-ml-2"],[3,"editInvoiceInformation","workspaceName","mode","turnAddress","nextStep"],[3,"editPaymentInformation","invoiceInformation","mode","isPaymentInfo","isMonthly","paymentFailedMessage","paymentInformation","closeDialog"],[1,"cl-alert","cl-alert-info","cl-mt-3"],[1,"cl-modal-header"],[1,"cl-modal-body"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"div",1),c.Xb(2,"div",2),c.Xb(3,"div",3),c.Xb(4,"div",4),c.Xb(5,"h1",5),c.Yc(6,"Payment information"),c.Wb(),c.Wb(),c.Xb(7,"div",6),c.Xb(8,"div",7),c.Wc(9,$j,21,7,"div",8),c.Wc(10,_j,2,0,"div",9),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wc(11,Gj,14,1,"ng-template",null,10,c.Xc)),2&e&&(c.Cb(9),c.wc("ngIf",t.isAdmin),c.Cb(1),c.wc("ngIf",!t.isAdmin))},directives:[s.u,gf,Of],encapsulation:2}),e})(),canActivate:[CA]},{path:"activity/screenshots",component:Cj,canActivate:[PT,kj],data:{screenshots:!0,feature:nr.a.SCREENSHOTS}},{path:"activity",redirectTo:"activity/screenshots",canActivate:[kj],data:{screenshots:!0}},{path:"activity/locations",loadChildren:()=>i.e(9).then(i.bind(null,"/wdg")).then(e=>e.LocationsModule),canActivate:[PT,kj],data:{locations:!0,feature:nr.a.LOCATIONS}},{path:"workspaces/:workspaceId/settings",component:Qb,canActivate:[su]},{path:"user/settings",component:sf},{path:"reports",redirectTo:"reports/summary",pathMatch:"full",canActivate:[Ud],data:{page:Gr.REPORTS}},{path:"reports/summary",component:pC,canActivate:[Ud],data:{page:Gr.REPORTS}},{path:"reports/weekly",component:XO,canActivate:[Ud],data:{page:Gr.REPORTS}},{path:"reports/detailed",component:eC,canActivate:[Ud],data:{page:Gr.REPORTS}},{path:"reports/shared",component:dO,canActivate:[Ud],data:{page:Gr.REPORTS}},{path:"user/settings/delete",component:Wu},{path:"timesheet",component:ay,canActivate:[of]},{path:"upgrade",component:Nd,canActivate:[nu,CA,kA],data:{allowIfHasInvoice:!1,redirectionPage:"subscription"}},{path:"upgrade/:workspaceId",component:bv,canActivate:[nu,CA,SA]},{path:"invoices",component:kn,canActivate:[nu,VA,PT],data:{feature:nr.a.INVOICING}},{path:"invoices/settings",component:Lj,canActivate:[nu,VA]},{path:"invoices/:id",component:ms,canActivate:[nu]},{path:"webhooks",component:bT},{path:"workspaces/:workspaceId/webhooks/:webhookId",component:yT},{path:"calendar",loadChildren:()=>i.e(7).then(i.bind(null,"wcpF")).then(e=>e.RegisterLayoutModule)}]}];let Vj=(()=>{class e{}return e.components=[EE],e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},imports:[[W.g.forChild(Bj)],W.g]}),e})(),Hj=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},imports:[[se.a,s.c,g.M,W.g]]}),e})();var zj=i("Ww9u");let qj=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,p.C,g.s,l.a,Hj,zj.a]]}),e})(),Kj=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,f.a,p.m,H.a,d.a,Wt.a]]}),e})(),Zj=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,Kj]]}),e})(),Qj=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,p.C,g.s,l.a,m.a,l.a,j.a]]}),e})(),Jj=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,p.C,z.a]]}),e})(),ex=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[ki],imports:[[s.c,p.m,W.g,f.a,x.a,w.a,he.a,Fe,Wt.a,d.a,E.a,_.a,Jj,qj,Qj,ie,Zj,H.a,p.C]]}),e})(),tx=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[p.m,s.c,g.ab]]}),e})();var ix=i("b7Rv");let nx=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,d.a,E.a,_.a,f.a,ve,Xe.a,m.a,g.r,tx,g.ab,ix.a,ce.a,be.a,We.a,Ae.a,we.a]]}),e})(),sx=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[Sg.a],imports:[[s.c,p.m]]}),e})(),cx=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[pg],imports:[[p.m,s.c,d.a,X.a,E.a,g.ab,g.M,f.a,p.C,Ze.a,l.a,v.a,re.a,et,Qe,sx,W.g]]}),e})(),rx=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[$e,p.m,s.c,_e,Q,g.M]]}),e})(),ox=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,p.C]]}),e})(),ax=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c]]}),e})(),lx=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,ax,g.ab,E.a]]}),e})(),bx=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,E.a]]}),e})(),ux=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[AT],imports:[[s.c,p.m,W.g,p.C,E.a,w.a,l.a,ue.a,Ze.a,lx,u.a,b.a,Me.a,bx,_.a,ox,Wt.a,d.a]]}),e})();var dx=i("aLCL");let px=(()=>{class e{constructor(e,t,i,n){this.http=e,this.workspaceService=t,this.centUSDConverter=i,this.toaster=n,this.error=new Ee.a}create(e,t,i){const n=this.workspaceService.getDefaultWorkspaceId();return this.http.post(`/v1/workspaces/${n}/projects/${t}/tasks/`,{name:e,projectId:t,assigneeIds:i}).pipe(Object(L.a)(()=>{this.toaster.pop("success",`Task ${e} has been created.`)},t=>{400==t.status&&(this.error.next(t),this.toaster.pop("error","Task not created",t&&t.error&&t.error.message||`Task with name ${e} already exists.`))}))}update(e,t=!0,i=""){const n=this.workspaceService.getDefaultWorkspaceId(),s={name:e.name,assigneeIds:e.assigneeIds,estimate:e.estimate,budgetEstimate:100*e.budgetEstimate,status:e.status?e.status:null,billable:e.billable},c=(new P.f).append("contains-assignee",t.toString()).append("membership-status",i);return this.http.put(`/v1/workspaces/${n}/projects/${e.projectId}/tasks/${e.id}`,s,{params:c}).pipe(Object(Y.a)(e=>new gv.a(this.centUSDConverter.setAllHourlyRatesFromCentToUSD(e))),Object(L.a)(()=>{this.toaster.pop("success",`Task ${e.name} has been updated.`)},t=>{400==t.status&&(this.error.next(t),this.toaster.pop("error","Task not updated",t&&t.error&&t.error.message||`Task with name ${e.name} already exists.`))}))}delete(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`/v1/workspaces/${t}/projects/${e.projectId}/tasks/${e.id}`).pipe(Object(L.a)(()=>{this.toaster.pop("success",`Task ${e.name} has been deleted.`)},e=>{this.error.next(e)}))}}return e.\u0275fac=function(t){return new(t||e)(c.fc(P.b),c.fc(U.a),c.fc(ot.a),c.fc(M.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac}),e})();var hx=i("C1xe");let mx=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[hx.a,Jj,s.c,p.m,p.C,d.a,_.a,X.a,f.a,l.a]]}),e})(),gx=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,p.C,hx.a,w.a,_.a,mx,H.a,f.a,l.a]]}),e})();var fx=i("TuBP");let vx=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[s.c,p.m,f.a,Nt.a,d.a,le.b,Xe.a,g.M]]}),e})(),wx=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[KA],imports:[[s.c,w.a,ge.a,fx.a,m.a,p.m,le.b,X.a,E.a,vx]]}),e})(),yx=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[$e,p.m,s.c,_e,Q,g.M]]}),e})(),Wx=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[r,Mt,o.a,Zd,_d.a,Ky.a,Ft,rn.a,mg.a,Qt.a,hg.a,qd.a,dx.a,px,V.a,su,nu,kj,xT,CA,SA,kA,Ud,of,VA,TI,jT,PT,Qd],imports:[[y,R,St.a,ne,vt,Ke,wx,Ne,gx,n.c,s.c,wt,kt,ui,ex,nx,Vj,cx,qe,rx,yx,ux]]}),e})()},WjWa:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(e){return e.SCREENSHOTS="SCREENSHOTS",e.LOCATIONS="LOCATIONS",e}({})},awBr:function(e,t,i){"use strict";function n(e,t){return e.start.toISOString()===t.start.toISOString()&&e.end.toISOString()===t.end.toISOString()}i.d(t,"a",(function(){return n}))},b7Rv:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("ofXK"),s=i("9Trn"),c=i("1kSV"),r=i("tyNb"),o=i("fXoL");let a=(()=>{class e{}return e.\u0275mod=o.Pb({type:e}),e.\u0275inj=o.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[n.c,s.a,c.M,r.g]]}),e})()},d0Wf:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("tk/3"),s=i("Ymxs"),c=i("1Tmk"),r=i("8v23"),o=i("lJxs"),a=i("vkgz"),l=i("XNiG"),b=i("fXoL");let u=(()=>{class e{constructor(e,t,i){this.http=e,this.toaster=t,this.workspaceService=i,this.roles$=new l.a}updateRoles(e,t){e=e||[];const i=this.workspaceService.getDefaultWorkspaceId(),s={roles:e.map(e=>e.asBodyParam())},c=(new n.f).append("detailed-role-info","true");return this.http.put(`/workspaces/${i}/users/${t}/roles`,s,{params:c}).pipe(Object(o.a)(e=>(e.userRoles||[]).map(e=>new r.a(e))),Object(a.a)(()=>{this.toaster.pop("success","Role was updated successfully")},e=>{var t;return this.toaster.pop("error",(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"Update failed")}))}getRolesForUser(e){const t=this.workspaceService.getDefaultWorkspaceId();if(!t)return;const i=new l.a,s=(new n.f).append("detailed-role-info","true");return this.http.get(`/workspaces/${t}/users/${e}/roles`,{params:s}).pipe(Object(o.a)(e=>e.userRoles.map(e=>new r.a(e)))).subscribe(e=>{this.roles$.next(e)},e=>{this.toaster.pop("error","Get permissions failed"),i.error(e)}),i}}return e.\u0275fac=function(t){return new(t||e)(b.fc(n.b),b.fc(s.a),b.fc(c.a))},e.\u0275prov=b.Nb({token:e,factory:e.\u0275fac}),e})()},xDdU:function(e,t,i){var n,s,c=i("4fRq"),r=i("I2ZF"),o=0,a=0;e.exports=function(e,t,i){var l=t&&i||0,b=t||[],u=(e=e||{}).node||n,d=void 0!==e.clockseq?e.clockseq:s;if(null==u||null==d){var p=c();null==u&&(u=n=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==d&&(d=s=16383&(p[6]<<8|p[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:a+1,g=h-o+(m-a)/1e4;if(g<0&&void 0===e.clockseq&&(d=d+1&16383),(g<0||h>o)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=h,a=m,s=d;var f=(1e4*(268435455&(h+=122192928e5))+m)%4294967296;b[l++]=f>>>24&255,b[l++]=f>>>16&255,b[l++]=f>>>8&255,b[l++]=255&f;var v=h/4294967296*1e4&268435455;b[l++]=v>>>8&255,b[l++]=255&v,b[l++]=v>>>24&15|16,b[l++]=v>>>16&255,b[l++]=d>>>8|128,b[l++]=255&d;for(var w=0;w<6;++w)b[l+w]=u[w];return t||r(b)}},xk4V:function(e,t,i){var n=i("4fRq"),s=i("I2ZF");e.exports=function(e,t,i){var c=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||n)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(var o=0;o<16;++o)t[c+o]=r[o];return t||s(r)}}}]);